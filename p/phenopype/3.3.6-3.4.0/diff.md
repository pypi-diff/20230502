# Comparing `tmp/phenopype-3.3.6-py3-none-any.whl.zip` & `tmp/phenopype-3.4.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,39 +1,39 @@
-Zip file size: 106290 bytes, number of entries: 37
+Zip file size: 107999 bytes, number of entries: 37
 -rw-rw-rw-  2.0 fat      461 b- defN 22-Jun-21 12:31 phenopype/__init__.py
 -rw-rw-rw-  2.0 fat      232 b- defN 22-Nov-14 09:19 phenopype/_config.py
--rw-rw-rw-  2.0 fat      280 b- defN 22-Nov-14 09:19 phenopype/_version.py
--rw-rw-rw-  2.0 fat    94437 b- defN 22-Nov-14 09:19 phenopype/main.py
--rw-rw-rw-  2.0 fat     8056 b- defN 22-Nov-08 13:02 phenopype/settings.py
+-rw-rw-rw-  2.0 fat      280 b- defN 23-May-02 09:52 phenopype/_version.py
+-rw-rw-rw-  2.0 fat    95615 b- defN 23-May-02 09:52 phenopype/main.py
+-rw-rw-rw-  2.0 fat     8113 b- defN 23-May-02 09:52 phenopype/settings.py
 -rw-rw-rw-  2.0 fat    32918 b- defN 22-Feb-03 14:48 phenopype/tracking.py
--rw-rw-rw-  2.0 fat    31113 b- defN 22-Nov-14 09:19 phenopype/utils.py
--rw-rw-rw-  2.0 fat    74682 b- defN 22-Nov-14 09:19 phenopype/utils_lowlevel.py
+-rw-rw-rw-  2.0 fat    31497 b- defN 23-May-02 09:52 phenopype/utils.py
+-rw-rw-rw-  2.0 fat    75575 b- defN 23-May-02 09:52 phenopype/utils_lowlevel.py
 -rw-rw-rw-  2.0 fat    53700 b- defN 22-Jun-16 11:49 phenopype/assets/wc3_colours.html
 -rw-rw-rw-  2.0 fat       79 b- defN 22-Jun-16 11:49 phenopype/core/__init__.py
--rw-rw-rw-  2.0 fat    28999 b- defN 22-Nov-14 09:19 phenopype/core/export.py
--rw-rw-rw-  2.0 fat    22138 b- defN 22-Nov-08 13:02 phenopype/core/measurement.py
--rw-rw-rw-  2.0 fat    31002 b- defN 22-Jun-16 11:49 phenopype/core/preprocessing.py
+-rw-rw-rw-  2.0 fat    28967 b- defN 23-May-02 09:52 phenopype/core/export.py
+-rw-rw-rw-  2.0 fat    22142 b- defN 23-May-02 09:52 phenopype/core/measurement.py
+-rw-rw-rw-  2.0 fat    35997 b- defN 23-May-02 09:52 phenopype/core/preprocessing.py
 -rw-rw-rw-  2.0 fat    35186 b- defN 22-Nov-14 09:19 phenopype/core/segmentation.py
--rw-rw-rw-  2.0 fat    24730 b- defN 22-Nov-02 14:19 phenopype/core/visualization.py
+-rw-rw-rw-  2.0 fat    27898 b- defN 23-May-02 09:52 phenopype/core/visualization.py
 -rw-rw-rw-  2.0 fat      253 b- defN 22-Jun-16 11:49 phenopype/plugins/__init__.py
 -rw-rw-rw-  2.0 fat     3567 b- defN 22-Jun-21 12:31 phenopype/plugins/measurement.py
 -rw-rw-rw-  2.0 fat     6009 b- defN 22-Nov-14 09:19 phenopype/plugins/segmentation.py
 -rw-rw-rw-  2.0 fat      695 b- defN 22-Nov-02 14:04 phenopype/plugins/libraries/__init__.py
 -rw-rw-rw-  2.0 fat        0 b- defN 22-Jan-13 12:05 tests/__init__.py
 -rw-rw-rw-  2.0 fat     6375 b- defN 22-Mar-07 14:40 tests/conftest.py
 -rw-rw-rw-  2.0 fat        0 b- defN 22-Jan-13 12:05 tests/test_00_prep.py
 -rw-rw-rw-  2.0 fat     3351 b- defN 22-Jun-16 11:49 tests/test_01_project.py
 -rw-rw-rw-  2.0 fat     3594 b- defN 22-Jun-16 11:49 tests/test_02_core_preprocessing.py
 -rw-rw-rw-  2.0 fat     3111 b- defN 22-Jun-16 11:49 tests/test_03_core_segmentation.py
 -rw-rw-rw-  2.0 fat     1571 b- defN 22-Jun-16 11:49 tests/test_04_core_measurement.py
 -rw-rw-rw-  2.0 fat     3879 b- defN 22-Jan-13 12:05 tests/test_05_core_visualization.py
 -rw-rw-rw-  2.0 fat     3609 b- defN 22-Nov-14 09:19 tests/test_06_core_export.py
 -rw-rw-rw-  2.0 fat     1584 b- defN 22-Jun-16 11:49 tests/test_07_pype.py
--rw-rw-rw-  2.0 fat     3654 b- defN 22-Jan-13 12:05 tests/test_08_tracking.py
+-rw-rw-rw-  2.0 fat     3654 b- defN 23-May-02 09:52 tests/test_08_tracking.py
 -rw-rw-rw-  2.0 fat     2277 b- defN 22-Jun-16 11:49 tests/test_09_utils.py
 -rw-rw-rw-  2.0 fat      312 b- defN 22-Jan-13 12:05 tests/test_10_utils_lowlevel.py
--rw-rw-rw-  2.0 fat     7815 b- defN 22-Nov-14 09:20 phenopype-3.3.6.dist-info/LICENSE
--rw-rw-rw-  2.0 fat     5684 b- defN 22-Nov-14 09:20 phenopype-3.3.6.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 22-Nov-14 09:20 phenopype-3.3.6.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       16 b- defN 22-Nov-14 09:20 phenopype-3.3.6.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     3062 b- defN 22-Nov-14 09:20 phenopype-3.3.6.dist-info/RECORD
-37 files, 498523 bytes uncompressed, 101426 bytes compressed:  79.7%
+-rw-rw-rw-  2.0 fat     7815 b- defN 23-May-02 09:53 phenopype-3.4.0.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat     5922 b- defN 23-May-02 09:53 phenopype-3.4.0.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-May-02 09:53 phenopype-3.4.0.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       16 b- defN 23-May-02 09:53 phenopype-3.4.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     3062 b- defN 23-May-02 09:53 phenopype-3.4.0.dist-info/RECORD
+37 files, 509408 bytes uncompressed, 103135 bytes compressed:  79.8%
```

## zipnote {}

```diff
@@ -90,23 +90,23 @@
 
 Filename: tests/test_09_utils.py
 Comment: 
 
 Filename: tests/test_10_utils_lowlevel.py
 Comment: 
 
-Filename: phenopype-3.3.6.dist-info/LICENSE
+Filename: phenopype-3.4.0.dist-info/LICENSE
 Comment: 
 
-Filename: phenopype-3.3.6.dist-info/METADATA
+Filename: phenopype-3.4.0.dist-info/METADATA
 Comment: 
 
-Filename: phenopype-3.3.6.dist-info/WHEEL
+Filename: phenopype-3.4.0.dist-info/WHEEL
 Comment: 
 
-Filename: phenopype-3.3.6.dist-info/top_level.txt
+Filename: phenopype-3.4.0.dist-info/top_level.txt
 Comment: 
 
-Filename: phenopype-3.3.6.dist-info/RECORD
+Filename: phenopype-3.4.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## phenopype/_version.py

```diff
@@ -1,5 +1,5 @@
 # Semantic Versioning 2.0.0: https://semver.org/
 # 1. MAJOR version when you make incompatible API changes;
 # 2. MINOR version when you add functionality in a backwards-compatible manner;
 # 3. PATCH version when you make backwards-compatible bug fixes.
-__version__ = "3.3.6"
+__version__ = "3.4.0"
```

## phenopype/main.py

```diff
@@ -1591,4313 +1591,4386 @@
 00006360: 2020 2020 2020 2020 6163 7469 7661 7465          activate
 00006370: 3d54 7275 652c 0d0a 2020 2020 2020 2020  =True,..        
 00006380: 6f76 6572 7772 6974 653d 4661 6c73 652c  overwrite=False,
 00006390: 0d0a 2020 2020 2020 2020 636f 7079 3d54  ..        copy=T
 000063a0: 7275 652c 0d0a 2020 2020 2020 2020 2a2a  rue,..        **
 000063b0: 6b77 6172 6773 0d0a 2020 2020 293a 0d0a  kwargs..    ):..
 000063c0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-000063d0: 2020 2020 2041 6464 2070 7970 6520 636f       Add pype co
-000063e0: 6e66 6967 7572 6174 696f 6e20 7072 6573  nfiguration pres
-000063f0: 6574 7320 746f 2061 6c6c 2070 726f 6a65  ets to all proje
-00006400: 6374 2064 6972 6563 746f 7269 6573 2e20  ct directories. 
-00006410: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00006420: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00006430: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 2020  ----------....  
-00006440: 2020 2020 2020 7265 6665 7265 6e63 655f        reference_
-00006450: 696d 6167 653a 2073 7472 0d0a 2020 2020  image: str..    
-00006460: 2020 2020 2020 2020 6e61 6d65 206f 6620          name of 
-00006470: 7465 6d70 6c61 7465 2069 6d61 6765 2c20  template image, 
-00006480: 6569 7468 6572 2070 726f 6a65 6374 2064  either project d
-00006490: 6972 6563 746f 7279 206f 7220 6669 6c65  irectory or file
-000064a0: 206c 696e 6b2e 2074 656d 706c 6174 6520   link. template 
-000064b0: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
-000064c0: 6167 6520 6765 7473 2073 746f 7265 6420  age gets stored 
-000064d0: 696e 2072 6f6f 7420 6469 7265 6374 6f72  in root director
-000064e0: 792c 2061 6e64 2069 6e66 6f72 6d61 7469  y, and informati
-000064f0: 6f6e 2061 7070 656e 6465 6420 746f 2061  on appended to a
-00006500: 6c6c 200d 0a20 2020 2020 2020 2020 2020  ll ..           
-00006510: 2061 7474 7269 6275 7465 7320 6669 6c65   attributes file
-00006520: 7320 696e 2074 6865 2070 726f 6a65 6374  s in the project
-00006530: 2064 6972 6563 746f 7269 6573 0d0a 2020   directories..  
-00006540: 2020 2020 2020 6163 7469 7661 7465 3a20        activate: 
-00006550: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-00006560: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-00006570: 6573 2074 6865 2073 6574 7469 6e67 2066  es the setting f
-00006580: 6f72 2074 6865 2063 7572 7265 6e74 6c79  or the currently
-00006590: 2061 6374 6976 6520 7265 6665 7265 6e63   active referenc
-000065a0: 6520 746f 2074 6865 2061 7474 7269 6275  e to the attribu
-000065b0: 7465 7320 0d0a 2020 2020 2020 2020 2020  tes ..          
-000065c0: 2020 6669 6c65 7320 6f66 2061 6c6c 2064    files of all d
-000065d0: 6972 6563 746f 7269 6573 2077 6974 6869  irectories withi
-000065e0: 6e20 7468 6520 7072 6f6a 6563 742e 2063  n the project. c
-000065f0: 616e 2062 6520 7573 6564 2069 6e20 636f  an be used in co
-00006600: 6e6a 756e 6374 696f 6e0d 0a20 2020 2020  njunction..     
-00006610: 2020 2020 2020 2077 6974 6820 6f76 6572         with over
-00006620: 7772 6974 653d 4661 6c73 6520 736f 2074  write=False so t
-00006630: 6861 7420 7468 6520 6163 7475 616c 2072  hat the actual r
-00006640: 6566 6572 656e 6365 2072 656d 6169 6e73  eference remains
-00006650: 2075 6e63 6861 6e63 6564 2e20 7468 6973   unchanced. this
-00006660: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00006670: 7474 696e 6720 7573 6566 756c 2077 6865  tting useful whe
-00006680: 6e20 6d61 6e61 6769 6e67 206d 756c 7469  n managing multi
-00006690: 706c 6520 7265 6665 7265 6e63 6573 2070  ple references p
-000066a0: 6572 2070 726f 6a65 6374 0d0a 2020 2020  er project..    
-000066b0: 2020 2020 6f76 6572 7772 6974 653a 2062      overwrite: b
-000066c0: 6f6f 6c2c 206f 7074 696f 6e61 6c0d 0a20  ool, optional.. 
-000066d0: 2020 2020 2020 2020 2020 206f 7665 7277             overw
-000066e0: 7269 7465 206f 7074 696f 6e2c 2069 6620  rite option, if 
-000066f0: 6120 6769 7665 6e20 7079 7065 2063 6f6e  a given pype con
-00006700: 6669 672d 6669 6c65 2061 6c72 6561 6479  fig-file already
-00006710: 2065 7869 7374 0d0a 2020 2020 2020 2020   exist..        
-00006720: 7465 6d70 6c61 7465 3a20 626f 6f6c 2c20  template: bool, 
-00006730: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00006740: 2020 2020 2020 7368 6f75 6c64 2061 2074        should a t
-00006750: 656d 706c 6174 6520 666f 7220 7265 6665  emplate for refe
-00006760: 7265 6e63 6520 6465 7465 6374 696f 6e20  rence detection 
-00006770: 6265 2063 7265 6174 6564 2e20 7769 7468  be created. with
-00006780: 2061 6e20 6578 6973 7469 6e67 200d 0a20   an existing .. 
-00006790: 2020 2020 2020 2020 2020 2074 656d 706c             templ
-000067a0: 6174 652c 2070 6865 6e6f 7079 7065 2063  ate, phenopype c
-000067b0: 616e 2074 7279 2074 6f20 6669 6e64 2061  an try to find a
-000067c0: 2072 6566 6572 656e 6365 2063 6172 6420   reference card 
-000067d0: 696e 2061 2067 6976 656e 2069 6d61 6765  in a given image
-000067e0: 2c0d 0a20 2020 2020 2020 2020 2020 206d  ,..            m
-000067f0: 6561 7375 7265 2069 7473 2064 696d 656e  easure its dimen
-00006800: 7369 6f6e 732c 2061 6e64 2061 646a 7573  sions, and adjus
-00006810: 7420 7069 7865 6c2d 746f 2d6d 6d2d 7261  t pixel-to-mm-ra
-00006820: 7469 6f20 616e 6420 636f 6c6f 7572 2073  tio and colour s
-00006830: 7061 6365 0d0a 2020 2020 2020 2020 2222  pace..        ""
-00006840: 220d 0a20 2020 2020 2020 2023 203d 3d3d  "..        # ===
-00006850: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006860: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006870: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006880: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00006890: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
-000068a0: 2020 2020 2320 7365 7475 700d 0a0d 0a20      # setup.... 
-000068b0: 2020 2020 2020 2023 2320 7365 7420 666c         ## set fl
-000068c0: 6167 730d 0a20 2020 2020 2020 2066 6c61  ags..        fla
-000068d0: 6773 203d 206d 616b 655f 6461 7461 636c  gs = make_datacl
-000068e0: 6173 7328 0d0a 2020 2020 2020 2020 2020  ass(..          
-000068f0: 2020 636c 735f 6e61 6d65 3d22 666c 6167    cls_name="flag
-00006900: 7322 2c0d 0a20 2020 2020 2020 2020 2020  s",..           
-00006910: 2066 6965 6c64 733d 5b0d 0a20 2020 2020   fields=[..     
-00006920: 2020 2020 2020 2020 2020 2028 226f 7665             ("ove
-00006930: 7277 7269 7465 222c 2062 6f6f 6c2c 206f  rwrite", bool, o
-00006940: 7665 7277 7269 7465 292c 200d 0a20 2020  verwrite), ..   
-00006950: 2020 2020 2020 2020 2020 2020 2028 2261               ("a
-00006960: 6374 6976 6174 6522 2c20 626f 6f6c 2c20  ctivate", bool, 
-00006970: 6163 7469 7661 7465 292c 0d0a 2020 2020  activate),..    
-00006980: 2020 2020 2020 2020 2020 2020 5d2c 0d0a              ],..
-00006990: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-000069a0: 2020 2020 2070 7269 6e74 5f73 6176 655f       print_save_
-000069b0: 6d73 6720 3d20 223d 3d20 6e6f 206d 7367  msg = "== no msg
-000069c0: 203d 3d22 0d0a 0d0a 0d0a 2020 2020 2020   =="......      
-000069d0: 2020 2323 206c 6f61 6420 7265 6665 7265    ## load refere
-000069e0: 6e63 6520 696d 6167 650d 0a20 2020 2020  nce image..     
-000069f0: 2020 2069 6620 6d6f 6465 6c5f 7061 7468     if model_path
-00006a00: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00006a10: 655f 5f20 3d3d 2022 7374 7222 3a0d 0a20  e__ == "str":.. 
-00006a20: 2020 2020 2020 2020 2020 2069 6620 6f73             if os
-00006a30: 2e70 6174 682e 6973 6669 6c65 286d 6f64  .path.isfile(mod
-00006a40: 656c 5f70 6174 6829 3a0d 0a20 2020 2020  el_path):..     
-00006a50: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-00006a60: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00006a70: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00006a80: 2020 2020 7072 696e 7428 2244 6964 206e      print("Did n
-00006a90: 6f74 2066 696e 6420 6d6f 6465 6c20 7b7d  ot find model {}
-00006aa0: 2e22 290d 0a20 2020 2020 2020 2020 2020  .")..           
-00006ab0: 2020 2020 2072 6574 7572 6e0d 0a20 2020       return..   
-00006ac0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00006ad0: 2020 2020 2020 2020 7072 696e 7428 2257          print("W
-00006ae0: 726f 6e67 2069 6e70 7574 202d 206e 6565  rong input - nee
-00006af0: 6420 7061 7468 2074 6f20 6120 7365 676d  d path to a segm
-00006b00: 656e 7461 7469 6f6e 206d 6f64 656c 2e22  entation model."
-00006b10: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00006b20: 6574 7572 6e0d 0a0d 0a20 2020 2020 2020  eturn....       
-00006b30: 206d 6f64 656c 5f66 6f6c 6465 725f 7061   model_folder_pa
-00006b40: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-00006b50: 6e28 7365 6c66 2e72 6f6f 745f 6469 722c  n(self.root_dir,
-00006b60: 2022 6d6f 6465 6c73 2229 0d0a 2020 2020   "models")..    
-00006b70: 2020 2020 6966 206e 6f74 206f 732e 7061      if not os.pa
-00006b80: 7468 2e69 7364 6972 286d 6f64 656c 5f66  th.isdir(model_f
-00006b90: 6f6c 6465 725f 7061 7468 293a 0d0a 2020  older_path):..  
-00006ba0: 2020 2020 2020 2020 2020 6f73 2e6d 6b64            os.mkd
-00006bb0: 6972 286d 6f64 656c 5f66 6f6c 6465 725f  ir(model_folder_
-00006bc0: 7061 7468 290d 0a20 2020 2020 2020 200d  path)..        .
-00006bd0: 0a20 2020 2020 2020 2077 6869 6c65 2054  .        while T
-00006be0: 7275 653a 0d0a 0d0a 2020 2020 2020 2020  rue:....        
-00006bf0: 2020 2020 2323 2067 656e 6572 6174 6520      ## generate 
-00006c00: 6d6f 6465 6c20 6e61 6d65 2061 6e64 2063  model name and c
-00006c10: 6865 636b 2069 6620 6578 6973 7473 0d0a  heck if exists..
-00006c20: 2020 2020 2020 2020 2020 2020 7068 656e              phen
-00006c30: 6f70 7970 655f 6d6f 6465 6c5f 6e61 6d65  opype_model_name
-00006c40: 203d 2022 6d6f 6465 6c5f 2220 2b20 6d6f   = "model_" + mo
-00006c50: 6465 6c5f 6964 202b 206f 732e 7061 7468  del_id + os.path
-00006c60: 2e73 706c 6974 6578 7428 6d6f 6465 6c5f  .splitext(model_
-00006c70: 7061 7468 295b 315d 0d0a 2020 2020 2020  path)[1]..      
-00006c80: 2020 2020 2020 7068 656e 6f70 7970 655f        phenopype_
-00006c90: 6d6f 6465 6c5f 7061 7468 203d 206f 732e  model_path = os.
-00006ca0: 7061 7468 2e6a 6f69 6e28 0d0a 2020 2020  path.join(..    
-00006cb0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00006cc0: 6c5f 666f 6c64 6572 5f70 6174 682c 2070  l_folder_path, p
-00006cd0: 6865 6e6f 7079 7065 5f6d 6f64 656c 5f6e  henopype_model_n
-00006ce0: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
-00006cf0: 2029 0d0a 0d0a 2020 2020 2020 2020 2020   )....          
-00006d00: 2020 6966 206f 732e 7061 7468 2e69 7366    if os.path.isf
-00006d10: 696c 6528 7068 656e 6f70 7970 655f 6d6f  ile(phenopype_mo
-00006d20: 6465 6c5f 7061 7468 2920 616e 6420 666c  del_path) and fl
-00006d30: 6167 732e 6f76 6572 7772 6974 6520 3d3d  ags.overwrite ==
-00006d40: 2046 616c 7365 3a0d 0a20 2020 2020 2020   False:..       
-00006d50: 2020 2020 2020 2020 2070 7269 6e74 5f73           print_s
-00006d60: 6176 655f 6d73 6720 3d20 280d 0a20 2020  ave_msg = (..   
-00006d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d80: 2022 4d6f 6465 6c20 6e6f 7420 7361 7665   "Model not save
-00006d90: 642c 2066 696c 6520 616c 7265 6164 7920  d, file already 
-00006da0: 6578 6973 7473 2022 0d0a 2020 2020 2020  exists "..      
-00006db0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00006dc0: 272d 2075 7365 2022 6f76 6572 7772 6974  '- use "overwrit
-00006dd0: 653d 5472 7565 2220 6f72 2063 686f 7365  e=True" or chose
-00006de0: 2064 6966 6665 7265 6e74 206d 6f64 656c   different model
-00006df0: 5f69 642e 270d 0a20 2020 2020 2020 2020  _id.'..         
-00006e00: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00006e10: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
-00006e20: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00006e30: 6620 6f73 2e70 6174 682e 6973 6669 6c65  f os.path.isfile
-00006e40: 2870 6865 6e6f 7079 7065 5f6d 6f64 656c  (phenopype_model
-00006e50: 5f70 6174 6829 2061 6e64 2066 6c61 6773  _path) and flags
-00006e60: 2e6f 7665 7277 7269 7465 203d 3d20 5472  .overwrite == Tr
-00006e70: 7565 3a0d 0a20 2020 2020 2020 2020 2020  ue:..           
-00006e80: 2020 2020 2070 7269 6e74 5f73 6176 655f       print_save_
-00006e90: 6d73 6720 3d20 280d 0a20 2020 2020 2020  msg = (..       
-00006ea0: 2020 2020 2020 2020 2020 2020 2022 4d6f               "Mo
-00006eb0: 6465 6c20 7361 7665 6420 756e 6465 7220  del saved under 
-00006ec0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00006ed0: 2020 2020 2020 202b 2070 6865 6e6f 7079         + phenopy
-00006ee0: 7065 5f6d 6f64 656c 5f70 6174 680d 0a20  pe_model_path.. 
-00006ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006f00: 2020 202b 2022 2028 6f76 6572 7772 6974     + " (overwrit
-00006f10: 7465 6e29 2e22 0d0a 2020 2020 2020 2020  ten)."..        
-00006f20: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00006f30: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-00006f40: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00006f50: 6620 6e6f 7420 6f73 2e70 6174 682e 6973  f not os.path.is
-00006f60: 6669 6c65 2870 6865 6e6f 7079 7065 5f6d  file(phenopype_m
-00006f70: 6f64 656c 5f70 6174 6829 3a0d 0a20 2020  odel_path):..   
-00006f80: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00006f90: 6e74 5f73 6176 655f 6d73 6720 3d20 224d  nt_save_msg = "M
-00006fa0: 6f64 656c 2073 6176 6564 2075 6e64 6572  odel saved under
-00006fb0: 2022 202b 2070 6865 6e6f 7079 7065 5f6d   " + phenopype_m
-00006fc0: 6f64 656c 5f70 6174 680d 0a20 2020 2020  odel_path..     
-00006fd0: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-00006fe0: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00006ff0: 2320 636f 7079 696e 6720 2f20 7061 7468  # copying / path
-00007000: 206d 616e 6167 656d 656e 740d 0a20 2020   management..   
-00007010: 2020 2020 2020 2020 206d 6f64 656c 5f73           model_s
-00007020: 6f75 7263 655f 6e61 6d65 203d 206f 732e  ource_name = os.
-00007030: 7061 7468 2e62 6173 656e 616d 6528 6d6f  path.basename(mo
-00007040: 6465 6c5f 7061 7468 290d 0a20 2020 2020  del_path)..     
-00007050: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00007060: 2020 2020 2023 2320 7361 7665 2061 6c6c       ## save all
-00007070: 2061 6674 6572 2073 7563 6365 7373 6675   after successfu
-00007080: 6c20 636f 6d70 6c65 7469 6f6e 206f 6620  l completion of 
-00007090: 616c 6c20 6d65 7468 6f64 2d73 7465 7073  all method-steps
-000070a0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000070b0: 206d 6f64 6520 3d3d 2022 636f 7079 223a   mode == "copy":
-000070c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000070d0: 2020 7368 7574 696c 2e63 6f70 7928 6d6f    shutil.copy(mo
-000070e0: 6465 6c5f 7061 7468 2c20 7068 656e 6f70  del_path, phenop
-000070f0: 7970 655f 6d6f 6465 6c5f 7061 7468 290d  ype_model_path).
-00007100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007110: 2070 6865 6e6f 7079 7065 5f6d 6f64 656c   phenopype_model
-00007120: 5f70 6174 6820 3d20 6f73 2e70 6174 682e  _path = os.path.
-00007130: 7265 6c70 6174 6828 7068 656e 6f70 7970  relpath(phenopyp
-00007140: 655f 6d6f 6465 6c5f 7061 7468 2c20 7365  e_model_path, se
-00007150: 6c66 2e72 6f6f 745f 6469 7229 0d0a 2020  lf.root_dir)..  
-00007160: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
-00007170: 6f64 6520 3d3d 2022 6c69 6e6b 223a 0d0a  ode == "link":..
-00007180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007190: 7068 656e 6f70 7970 655f 6d6f 6465 6c5f  phenopype_model_
-000071a0: 7061 7468 203d 206f 732e 7061 7468 2e61  path = os.path.a
-000071b0: 6273 7061 7468 286d 6f64 656c 5f70 6174  bspath(model_pat
-000071c0: 6829 0d0a 200d 0a20 2020 2020 2020 2020  h).. ..         
-000071d0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-000071e0: 2023 2320 6372 6561 7465 2072 6566 6572   ## create refer
-000071f0: 656e 6365 2061 7474 7269 6275 7465 730d  ence attributes.
-00007200: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00007210: 656c 5f69 6e66 6f20 3d20 7b0d 0a20 2020  el_info = {..   
-00007220: 2020 2020 2020 2020 2020 2020 2022 6d6f               "mo
-00007230: 6465 6c5f 736f 7572 6365 5f70 6174 6822  del_source_path"
-00007240: 3a20 6d6f 6465 6c5f 7061 7468 2c0d 0a20  : model_path,.. 
-00007250: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00007260: 6d6f 6465 6c5f 736f 7572 6365 5f6e 616d  model_source_nam
-00007270: 6522 3a20 6d6f 6465 6c5f 736f 7572 6365  e": model_source
-00007280: 5f6e 616d 652c 0d0a 2020 2020 2020 2020  _name,..        
-00007290: 2020 2020 2020 2020 226d 6f64 656c 5f70          "model_p
-000072a0: 6865 6e6f 7079 7065 5f70 6174 6822 3a20  henopype_path": 
-000072b0: 7068 656e 6f70 7970 655f 6d6f 6465 6c5f  phenopype_model_
-000072c0: 7061 7468 2c0d 0a20 2020 2020 2020 2020  path,..         
-000072d0: 2020 2020 2020 2022 6d6f 6465 6c5f 7479         "model_ty
-000072e0: 7065 223a 206d 6f64 656c 5f74 7970 652c  pe": model_type,
-000072f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007300: 2020 2264 6174 655f 6164 6465 6422 3a20    "date_added": 
-00007310: 6461 7465 7469 6d65 2e74 6f64 6179 2829  datetime.today()
-00007320: 2e73 7472 6674 696d 6528 7365 7474 696e  .strftime(settin
-00007330: 6773 2e73 7472 6674 696d 655f 666f 726d  gs.strftime_form
-00007340: 6174 292c 0d0a 2020 2020 2020 2020 2020  at),..          
-00007350: 2020 7d0d 0a0d 0a20 2020 2020 2020 2020    }....         
-00007360: 2020 2023 2320 6c6f 6164 2070 726f 6a65     ## load proje
-00007370: 6374 2061 7474 7269 6275 7465 7320 616e  ct attributes an
-00007380: 6420 7465 6d70 6f72 6172 696c 7920 6472  d temporarily dr
-00007390: 6f70 2070 726f 6a65 6374 2064 6174 6120  op project data 
-000073a0: 6c69 7374 2074 6f0d 0a20 2020 2020 2020  list to..       
-000073b0: 2020 2020 2023 2320 6265 2072 6561 7474       ## be reatt
-000073c0: 6368 6564 206c 6174 6572 2c20 736f 2069  ched later, so i
-000073d0: 7420 6973 2061 6c77 6179 7320 6174 2074  t is always at t
-000073e0: 6865 6e20 656e 6420 6f66 2074 6865 2066  hen end of the f
-000073f0: 696c 650d 0a20 2020 2020 2020 2020 2020  ile..           
-00007400: 206d 6f64 656c 5f64 6963 7420 3d20 7b7d   model_dict = {}
-00007410: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00007420: 6f6a 6563 745f 6174 7472 6962 7574 6573  oject_attributes
-00007430: 203d 2075 7469 6c73 5f6c 6f77 6c65 7665   = utils_lowleve
-00007440: 6c2e 5f6c 6f61 645f 7961 6d6c 280d 0a20  l._load_yaml(.. 
-00007450: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00007460: 732e 7061 7468 2e6a 6f69 6e28 7365 6c66  s.path.join(self
-00007470: 2e72 6f6f 745f 6469 722c 2022 6174 7472  .root_dir, "attr
-00007480: 6962 7574 6573 2e79 616d 6c22 290d 0a20  ibutes.yaml").. 
-00007490: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-000074a0: 2020 2020 2020 2020 2020 6966 2022 7072            if "pr
-000074b0: 6f6a 6563 745f 6461 7461 2220 696e 2070  oject_data" in p
-000074c0: 726f 6a65 6374 5f61 7474 7269 6275 7465  roject_attribute
-000074d0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-000074e0: 2020 2020 7072 6f6a 6563 745f 6461 7461      project_data
-000074f0: 203d 2070 726f 6a65 6374 5f61 7474 7269   = project_attri
-00007500: 6275 7465 735b 2270 726f 6a65 6374 5f64  butes["project_d
-00007510: 6174 6122 5d0d 0a20 2020 2020 2020 2020  ata"]..         
-00007520: 2020 2020 2020 2070 726f 6a65 6374 5f61         project_a
-00007530: 7474 7269 6275 7465 732e 706f 7028 2270  ttributes.pop("p
-00007540: 726f 6a65 6374 5f64 6174 6122 2c20 4e6f  roject_data", No
-00007550: 6e65 290d 0a20 2020 2020 2020 2020 2020  ne)..           
-00007560: 2069 6620 226d 6f64 656c 7322 2069 6e20   if "models" in 
-00007570: 7072 6f6a 6563 745f 6174 7472 6962 7574  project_attribut
-00007580: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-00007590: 2020 2020 206d 6f64 656c 5f64 6963 7420       model_dict 
-000075a0: 3d20 7072 6f6a 6563 745f 6174 7472 6962  = project_attrib
-000075b0: 7574 6573 5b22 6d6f 6465 6c73 225d 0d0a  utes["models"]..
-000075c0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-000075d0: 6163 7469 7665 2220 696e 2070 726f 6a65  active" in proje
-000075e0: 6374 5f61 7474 7269 6275 7465 733a 0d0a  ct_attributes:..
-000075f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007600: 7061 7373 200d 0a20 2020 2020 2020 2020  pass ..         
-00007610: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00007620: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
-00007630: 745f 6174 7472 6962 7574 6573 5b22 6163  t_attributes["ac
-00007640: 7469 7665 225d 203d 207b 7d0d 0a20 2020  tive"] = {}..   
-00007650: 2020 2020 2020 2020 2070 726f 6a65 6374           project
-00007660: 5f61 7474 7269 6275 7465 735b 2261 6374  _attributes["act
-00007670: 6976 6522 5d5b 226d 6f64 656c 225d 203d  ive"]["model"] =
-00007680: 206d 6f64 656c 5f69 640d 0a20 2020 2020   model_id..     
-00007690: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-000076a0: 2020 2020 2020 2020 206d 6f64 656c 5f64           model_d
-000076b0: 6963 745b 6d6f 6465 6c5f 6964 5d20 3d20  ict[model_id] = 
-000076c0: 6d6f 6465 6c5f 696e 666f 0d0a 2020 2020  model_info..    
-000076d0: 2020 2020 2020 2020 7072 6f6a 6563 745f          project_
-000076e0: 6174 7472 6962 7574 6573 5b22 6d6f 6465  attributes["mode
-000076f0: 6c73 225d 203d 206d 6f64 656c 5f64 6963  ls"] = model_dic
-00007700: 740d 0a20 2020 2020 2020 2020 2020 2070  t..            p
-00007710: 726f 6a65 6374 5f61 7474 7269 6275 7465  roject_attribute
-00007720: 735b 2270 726f 6a65 6374 5f64 6174 6122  s["project_data"
-00007730: 5d20 3d20 7072 6f6a 6563 745f 6461 7461  ] = project_data
-00007740: 0d0a 0d0a 0d0a 0d0a 2020 2020 2020 2020  ........        
-00007750: 2020 2020 7574 696c 735f 6c6f 776c 6576      utils_lowlev
-00007760: 656c 2e5f 7361 7665 5f79 616d 6c28 0d0a  el._save_yaml(..
-00007770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007780: 7072 6f6a 6563 745f 6174 7472 6962 7574  project_attribut
-00007790: 6573 2c20 6f73 2e70 6174 682e 6a6f 696e  es, os.path.join
-000077a0: 2873 656c 662e 726f 6f74 5f64 6972 2c20  (self.root_dir, 
-000077b0: 2261 7474 7269 6275 7465 732e 7961 6d6c  "attributes.yaml
-000077c0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-000077d0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-000077e0: 2070 7269 6e74 5f73 6176 655f 6d73 6720   print_save_msg 
-000077f0: 3d20 280d 0a20 2020 2020 2020 2020 2020  = (..           
-00007800: 2020 2020 2070 7269 6e74 5f73 6176 655f       print_save_
-00007810: 6d73 6720 2b20 225c 6e53 6176 6564 206d  msg + "\nSaved m
-00007820: 6f64 656c 2069 6e66 6f20 746f 2070 726f  odel info to pro
-00007830: 6a65 6374 2061 7474 7269 6275 7465 732e  ject attributes.
-00007840: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-00007850: 0d0a 2020 2020 2020 2020 2020 2020 6272  ..            br
-00007860: 6561 6b0d 0a0d 0a20 2020 2020 2020 2070  eak....        p
-00007870: 7269 6e74 2870 7269 6e74 5f73 6176 655f  rint(print_save_
-00007880: 6d73 6729 0d0a 0d0a 2020 2020 2020 2020  msg)....        
-00007890: 6966 2066 6c61 6773 2e61 6374 6976 6174  if flags.activat
-000078a0: 6520 3d3d 2054 7275 653a 0d0a 2020 2020  e == True:..    
-000078b0: 2020 2020 2020 2020 5f63 6f6e 6669 672e          _config.
-000078c0: 6163 7469 7665 5f6d 6f64 656c 5f70 6174  active_model_pat
-000078d0: 6820 3d20 7068 656e 6f70 7970 655f 6d6f  h = phenopype_mo
-000078e0: 6465 6c5f 7061 7468 0d0a 2020 2020 2020  del_path..      
-000078f0: 2020 2020 2020 7072 696e 7428 272d 2073        print('- s
-00007900: 6574 7469 6e67 2061 6374 6976 6520 7072  etting active pr
-00007910: 6f6a 6563 7420 6d6f 6465 6c20 746f 207b  oject model to {
-00007920: 7d27 2e66 6f72 6d61 7428 6d6f 6465 6c5f  }'.format(model_
-00007930: 6964 2929 0d0a 2020 2020 2020 2020 656c  id))..        el
-00007940: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00007950: 2070 7269 6e74 280d 0a20 2020 2020 2020   print(..       
-00007960: 2020 2020 2020 2020 2022 2d20 636f 756c           "- coul
-00007970: 6420 6e6f 7420 7365 7420 6163 7469 7665  d not set active
-00007980: 2070 726f 6a65 6374 206d 6f64 656c 2028   project model (
-00007990: 6f76 6572 7772 6974 653d 4661 6c73 652f  overwrite=False/
-000079a0: 6163 7469 7661 7465 3d46 616c 7365 2922  activate=False)"
-000079b0: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
-000079c0: 0a0d 0a20 2020 2064 6566 2061 6464 5f72  ...    def add_r
-000079d0: 6566 6572 656e 6365 280d 0a20 2020 2020  eference(..     
-000079e0: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
-000079f0: 2020 7265 6665 7265 6e63 655f 696d 6167    reference_imag
-00007a00: 655f 7061 7468 2c0d 0a20 2020 2020 2020  e_path,..       
-00007a10: 2072 6566 6572 656e 6365 5f74 6167 2c0d   reference_tag,.
-00007a20: 0a20 2020 2020 2020 2061 6374 6976 6174  .        activat
-00007a30: 653d 5472 7565 2c0d 0a20 2020 2020 2020  e=True,..       
-00007a40: 2074 656d 706c 6174 653d 4661 6c73 652c   template=False,
-00007a50: 0d0a 2020 2020 2020 2020 6f76 6572 7772  ..        overwr
-00007a60: 6974 653d 4661 6c73 652c 0d0a 2020 2020  ite=False,..    
-00007a70: 2020 2020 2a2a 6b77 6172 6773 0d0a 2020      **kwargs..  
-00007a80: 2020 293a 0d0a 2020 2020 2020 2020 2222    ):..        ""
-00007a90: 220d 0a20 2020 2020 2020 2041 6464 2070  "..        Add p
-00007aa0: 7970 6520 636f 6e66 6967 7572 6174 696f  ype configuratio
-00007ab0: 6e20 7072 6573 6574 7320 746f 2061 6c6c  n presets to all
-00007ac0: 2070 726f 6a65 6374 2064 6972 6563 746f   project directo
-00007ad0: 7269 6573 2e20 0d0a 0d0a 2020 2020 2020  ries. ....      
-00007ae0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00007af0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00007b00: 0d0a 0d0a 2020 2020 2020 2020 7265 6665  ....        refe
-00007b10: 7265 6e63 655f 696d 6167 653a 2073 7472  rence_image: str
-00007b20: 0d0a 2020 2020 2020 2020 2020 2020 6e61  ..            na
-00007b30: 6d65 206f 6620 7465 6d70 6c61 7465 2069  me of template i
-00007b40: 6d61 6765 2c20 6569 7468 6572 2070 726f  mage, either pro
-00007b50: 6a65 6374 2064 6972 6563 746f 7279 206f  ject directory o
-00007b60: 7220 6669 6c65 206c 696e 6b2e 2074 656d  r file link. tem
-00007b70: 706c 6174 6520 0d0a 2020 2020 2020 2020  plate ..        
-00007b80: 2020 2020 696d 6167 6520 6765 7473 2073      image gets s
-00007b90: 746f 7265 6420 696e 2072 6f6f 7420 6469  tored in root di
-00007ba0: 7265 6374 6f72 792c 2061 6e64 2069 6e66  rectory, and inf
-00007bb0: 6f72 6d61 7469 6f6e 2061 7070 656e 6465  ormation appende
-00007bc0: 6420 746f 2061 6c6c 200d 0a20 2020 2020  d to all ..     
-00007bd0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-00007be0: 7320 6669 6c65 7320 696e 2074 6865 2070  s files in the p
-00007bf0: 726f 6a65 6374 2064 6972 6563 746f 7269  roject directori
-00007c00: 6573 0d0a 2020 2020 2020 2020 6163 7469  es..        acti
-00007c10: 7661 7465 3a20 626f 6f6c 2c20 6f70 7469  vate: bool, opti
-00007c20: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-00007c30: 2020 7772 6974 6573 2074 6865 2073 6574    writes the set
-00007c40: 7469 6e67 2066 6f72 2074 6865 2063 7572  ting for the cur
-00007c50: 7265 6e74 6c79 2061 6374 6976 6520 7265  rently active re
-00007c60: 6665 7265 6e63 6520 746f 2074 6865 2061  ference to the a
-00007c70: 7474 7269 6275 7465 7320 0d0a 2020 2020  ttributes ..    
-00007c80: 2020 2020 2020 2020 6669 6c65 7320 6f66          files of
-00007c90: 2061 6c6c 2064 6972 6563 746f 7269 6573   all directories
-00007ca0: 2077 6974 6869 6e20 7468 6520 7072 6f6a   within the proj
-00007cb0: 6563 742e 2063 616e 2062 6520 7573 6564  ect. can be used
-00007cc0: 2069 6e20 636f 6e6a 756e 6374 696f 6e0d   in conjunction.
-00007cd0: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
-00007ce0: 6820 6f76 6572 7772 6974 653d 4661 6c73  h overwrite=Fals
-00007cf0: 6520 736f 2074 6861 7420 7468 6520 6163  e so that the ac
-00007d00: 7475 616c 2072 6566 6572 656e 6365 2072  tual reference r
-00007d10: 656d 6169 6e73 2075 6e63 6861 6e63 6564  emains unchanced
-00007d20: 2e20 7468 6973 0d0a 2020 2020 2020 2020  . this..        
-00007d30: 2020 2020 7365 7474 696e 6720 7573 6566      setting usef
-00007d40: 756c 2077 6865 6e20 6d61 6e61 6769 6e67  ul when managing
-00007d50: 206d 756c 7469 706c 6520 7265 6665 7265   multiple refere
-00007d60: 6e63 6573 2070 6572 2070 726f 6a65 6374  nces per project
-00007d70: 0d0a 2020 2020 2020 2020 6f76 6572 7772  ..        overwr
-00007d80: 6974 653a 2062 6f6f 6c2c 206f 7074 696f  ite: bool, optio
-00007d90: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-00007da0: 206f 7665 7277 7269 7465 206f 7074 696f   overwrite optio
-00007db0: 6e2c 2069 6620 6120 6769 7665 6e20 7079  n, if a given py
-00007dc0: 7065 2063 6f6e 6669 672d 6669 6c65 2061  pe config-file a
-00007dd0: 6c72 6561 6479 2065 7869 7374 0d0a 2020  lready exist..  
-00007de0: 2020 2020 2020 7465 6d70 6c61 7465 3a20        template: 
-00007df0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-00007e00: 2020 2020 2020 2020 2020 2020 7368 6f75              shou
-00007e10: 6c64 2061 2074 656d 706c 6174 6520 666f  ld a template fo
-00007e20: 7220 7265 6665 7265 6e63 6520 6465 7465  r reference dete
-00007e30: 6374 696f 6e20 6265 2063 7265 6174 6564  ction be created
-00007e40: 2e20 7769 7468 2061 6e20 6578 6973 7469  . with an existi
-00007e50: 6e67 200d 0a20 2020 2020 2020 2020 2020  ng ..           
-00007e60: 2074 656d 706c 6174 652c 2070 6865 6e6f   template, pheno
-00007e70: 7079 7065 2063 616e 2074 7279 2074 6f20  pype can try to 
-00007e80: 6669 6e64 2061 2072 6566 6572 656e 6365  find a reference
-00007e90: 2063 6172 6420 696e 2061 2067 6976 656e   card in a given
-00007ea0: 2069 6d61 6765 2c0d 0a20 2020 2020 2020   image,..       
-00007eb0: 2020 2020 206d 6561 7375 7265 2069 7473       measure its
-00007ec0: 2064 696d 656e 7369 6f6e 732c 2061 6e64   dimensions, and
-00007ed0: 2061 646a 7573 7420 7069 7865 6c2d 746f   adjust pixel-to
-00007ee0: 2d6d 6d2d 7261 7469 6f20 616e 6420 636f  -mm-ratio and co
-00007ef0: 6c6f 7572 2073 7061 6365 0d0a 2020 2020  lour space..    
-00007f00: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00007f10: 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   # =============
-00007f20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00007f30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00007f40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00007f50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00007f60: 0d0a 2020 2020 2020 2020 2320 7365 7475  ..        # setu
-00007f70: 700d 0a0d 0a20 2020 2020 2020 2023 2320  p....        ## 
-00007f80: 7365 7420 666c 6167 730d 0a20 2020 2020  set flags..     
-00007f90: 2020 2066 6c61 6773 203d 206d 616b 655f     flags = make_
-00007fa0: 6461 7461 636c 6173 7328 0d0a 2020 2020  dataclass(..    
-00007fb0: 2020 2020 2020 2020 636c 735f 6e61 6d65          cls_name
-00007fc0: 3d22 666c 6167 7322 2c0d 0a20 2020 2020  ="flags",..     
-00007fd0: 2020 2020 2020 2066 6965 6c64 733d 5b28         fields=[(
-00007fe0: 226f 7665 7277 7269 7465 222c 2062 6f6f  "overwrite", boo
-00007ff0: 6c2c 206f 7665 7277 7269 7465 292c 2028  l, overwrite), (
-00008000: 2261 6374 6976 6174 6522 2c20 626f 6f6c  "activate", bool
-00008010: 2c20 6163 7469 7661 7465 292c 5d2c 0d0a  , activate),],..
-00008020: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-00008030: 2020 2020 2070 7269 6e74 5f73 6176 655f       print_save_
-00008040: 6d73 6720 3d20 223d 3d20 6e6f 206d 7367  msg = "== no msg
-00008050: 203d 3d22 0d0a 0d0a 2020 2020 2020 2020   =="....        
-00008060: 7265 6665 7265 6e63 655f 736f 7572 6365  reference_source
-00008070: 5f70 6174 6820 3d20 636f 7079 2e64 6565  _path = copy.dee
-00008080: 7063 6f70 7928 7265 6665 7265 6e63 655f  pcopy(reference_
-00008090: 696d 6167 655f 7061 7468 290d 0a0d 0a20  image_path).... 
-000080a0: 2020 2020 2020 2023 2320 6c6f 6164 2072         ## load r
-000080b0: 6566 6572 656e 6365 2069 6d61 6765 0d0a  eference image..
-000080c0: 2020 2020 2020 2020 6966 2072 6566 6572          if refer
-000080d0: 656e 6365 5f73 6f75 7263 655f 7061 7468  ence_source_path
-000080e0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-000080f0: 655f 5f20 3d3d 2022 7374 7222 3a0d 0a20  e__ == "str":.. 
-00008100: 2020 2020 2020 2020 2020 2072 6566 6572             refer
-00008110: 656e 6365 5f69 6d61 6765 203d 2075 7469  ence_image = uti
-00008120: 6c73 2e6c 6f61 645f 696d 6167 6528 7265  ls.load_image(re
-00008130: 6665 7265 6e63 655f 736f 7572 6365 5f70  ference_source_p
-00008140: 6174 6829 0d0a 0d0a 2020 2020 2020 2020  ath)....        
-00008150: 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  # ==============
-00008160: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008170: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008180: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008190: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-000081a0: 0a20 2020 2020 2020 2023 2065 7865 6375  .        # execu
-000081b0: 7465 0d0a 0d0a 2020 2020 2020 2020 7265  te....        re
-000081c0: 6665 7265 6e63 655f 666f 6c64 6572 5f70  ference_folder_p
-000081d0: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
-000081e0: 696e 2873 656c 662e 726f 6f74 5f64 6972  in(self.root_dir
-000081f0: 2c20 2272 6566 6572 656e 6365 2229 0d0a  , "reference")..
-00008200: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
-00008210: 732e 7061 7468 2e69 7364 6972 2872 6566  s.path.isdir(ref
-00008220: 6572 656e 6365 5f66 6f6c 6465 725f 7061  erence_folder_pa
-00008230: 7468 293a 0d0a 2020 2020 2020 2020 2020  th):..          
-00008240: 2020 6f73 2e6d 6b64 6972 2872 6566 6572    os.mkdir(refer
-00008250: 656e 6365 5f66 6f6c 6465 725f 7061 7468  ence_folder_path
-00008260: 290d 0a0d 0a20 2020 2020 2020 2077 6869  )....        whi
-00008270: 6c65 2054 7275 653a 0d0a 0d0a 2020 2020  le True:....    
-00008280: 2020 2020 2020 2020 2323 2067 656e 6572          ## gener
-00008290: 6174 6520 7265 6665 7265 6e63 6520 6e61  ate reference na
-000082a0: 6d65 2061 6e64 2063 6865 636b 2069 6620  me and check if 
-000082b0: 6578 6973 7473 0d0a 2020 2020 2020 2020  exists..        
-000082c0: 2020 2020 7265 6665 7265 6e63 655f 696d      reference_im
-000082d0: 6167 655f 6e61 6d65 203d 2072 6566 6572  age_name = refer
-000082e0: 656e 6365 5f74 6167 202b 2022 5f66 756c  ence_tag + "_ful
-000082f0: 6c5f 696d 6167 652e 7469 6622 0d0a 2020  l_image.tif"..  
-00008300: 2020 2020 2020 2020 2020 7265 6665 7265            refere
-00008310: 6e63 655f 696d 6167 655f 7061 7468 203d  nce_image_path =
-00008320: 206f 732e 7061 7468 2e6a 6f69 6e28 0d0a   os.path.join(..
-00008330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008340: 7365 6c66 2e72 6f6f 745f 6469 722c 2022  self.root_dir, "
-00008350: 7265 6665 7265 6e63 6522 2c20 7265 6665  reference", refe
-00008360: 7265 6e63 655f 696d 6167 655f 6e61 6d65  rence_image_name
-00008370: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
-00008380: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-00008390: 6620 6f73 2e70 6174 682e 6973 6669 6c65  f os.path.isfile
-000083a0: 2872 6566 6572 656e 6365 5f69 6d61 6765  (reference_image
-000083b0: 5f70 6174 6829 2061 6e64 2066 6c61 6773  _path) and flags
-000083c0: 2e6f 7665 7277 7269 7465 203d 3d20 4661  .overwrite == Fa
-000083d0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000083e0: 2020 2020 2020 7072 696e 745f 7361 7665        print_save
-000083f0: 5f6d 7367 203d 2028 0d0a 2020 2020 2020  _msg = (..      
-00008400: 2020 2020 2020 2020 2020 2020 2020 2252                "R
-00008410: 6566 6572 656e 6365 2069 6d61 6765 206e  eference image n
-00008420: 6f74 2073 6176 6564 2c20 6669 6c65 2061  ot saved, file a
-00008430: 6c72 6561 6479 2065 7869 7374 7320 220d  lready exists ".
-00008440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008450: 2020 2020 202b 2027 2d20 7573 6520 226f       + '- use "o
-00008460: 7665 7277 7269 7465 3d3d 5472 7565 2220  verwrite==True" 
-00008470: 6f72 2063 686f 7365 2064 6966 6665 7265  or chose differe
-00008480: 6e74 206e 616d 652e 270d 0a20 2020 2020  nt name.'..     
-00008490: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-000084a0: 2020 2020 2020 2020 2020 2020 2020 6272                br
-000084b0: 6561 6b0d 0a20 2020 2020 2020 2020 2020  eak..           
-000084c0: 2065 6c69 6620 6f73 2e70 6174 682e 6973   elif os.path.is
-000084d0: 6669 6c65 2872 6566 6572 656e 6365 5f69  file(reference_i
-000084e0: 6d61 6765 5f70 6174 6829 2061 6e64 2066  mage_path) and f
-000084f0: 6c61 6773 2e6f 7665 7277 7269 7465 203d  lags.overwrite =
-00008500: 3d20 5472 7565 3a0d 0a20 2020 2020 2020  = True:..       
-00008510: 2020 2020 2020 2020 2070 7269 6e74 5f73           print_s
-00008520: 6176 655f 6d73 6720 3d20 280d 0a20 2020  ave_msg = (..   
-00008530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008540: 2022 5265 6665 7265 6e63 6520 696d 6167   "Reference imag
-00008550: 6520 7361 7665 6420 756e 6465 7220 220d  e saved under ".
-00008560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008570: 2020 2020 202b 2072 6566 6572 656e 6365       + reference
-00008580: 5f69 6d61 6765 5f70 6174 680d 0a20 2020  _image_path..   
-00008590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085a0: 202b 2022 2028 6f76 6572 7772 6974 7465   + " (overwritte
-000085b0: 6e29 2e22 0d0a 2020 2020 2020 2020 2020  n)."..          
-000085c0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-000085d0: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-000085e0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-000085f0: 6e6f 7420 6f73 2e70 6174 682e 6973 6669  not os.path.isfi
-00008600: 6c65 2872 6566 6572 656e 6365 5f69 6d61  le(reference_ima
-00008610: 6765 5f70 6174 6829 3a0d 0a20 2020 2020  ge_path):..     
-00008620: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00008630: 5f73 6176 655f 6d73 6720 3d20 2252 6566  _save_msg = "Ref
-00008640: 6572 656e 6365 2069 6d61 6765 2073 6176  erence image sav
-00008650: 6564 2075 6e64 6572 2022 202b 2072 6566  ed under " + ref
-00008660: 6572 656e 6365 5f69 6d61 6765 5f70 6174  erence_image_pat
-00008670: 680d 0a20 2020 2020 2020 2020 2020 2020  h..             
-00008680: 2020 2070 6173 730d 0a0d 0a20 2020 2020     pass....     
-00008690: 2020 2020 2020 2023 2320 6765 6e65 7261         ## genera
-000086a0: 7465 2074 656d 706c 6174 6520 6e61 6d65  te template name
-000086b0: 2061 6e64 2063 6865 636b 2069 6620 6578   and check if ex
-000086c0: 6973 7473 0d0a 2020 2020 2020 2020 2020  ists..          
-000086d0: 2020 7465 6d70 6c61 7465 5f6e 616d 6520    template_name 
-000086e0: 3d20 7265 6665 7265 6e63 655f 7461 6720  = reference_tag 
-000086f0: 2b20 225f 7365 6172 6368 5f74 656d 706c  + "_search_templ
-00008700: 6174 652e 7469 6622 0d0a 2020 2020 2020  ate.tif"..      
-00008710: 2020 2020 2020 7465 6d70 6c61 7465 5f70        template_p
-00008720: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
-00008730: 696e 2873 656c 662e 726f 6f74 5f64 6972  in(self.root_dir
-00008740: 2c20 2272 6566 6572 656e 6365 222c 2074  , "reference", t
-00008750: 656d 706c 6174 655f 6e61 6d65 290d 0a0d  emplate_name)...
-00008760: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00008770: 6f73 2e70 6174 682e 6973 6669 6c65 2874  os.path.isfile(t
-00008780: 656d 706c 6174 655f 7061 7468 2920 616e  emplate_path) an
-00008790: 6420 666c 6167 732e 6f76 6572 7772 6974  d flags.overwrit
-000087a0: 6520 3d3d 2046 616c 7365 3a0d 0a20 2020  e == False:..   
-000087b0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000087c0: 6e74 5f73 6176 655f 6d73 6720 3d20 2752  nt_save_msg = 'R
-000087d0: 6566 6572 656e 6365 2074 656d 706c 6174  eference templat
-000087e0: 6520 6e6f 7420 7361 7665 642c 2066 696c  e not saved, fil
-000087f0: 6520 616c 7265 6164 7920 6578 6973 7473  e already exists
-00008800: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
-00008810: 2020 2020 2d20 7573 6520 226f 7665 7277      - use "overw
-00008820: 7269 7465 3d3d 5472 7565 2220 6f72 2063  rite==True" or c
-00008830: 686f 7365 2064 6966 6665 7265 6e74 206e  hose different n
-00008840: 616d 652e 270d 0a20 2020 2020 2020 2020  ame.'..         
-00008850: 2020 2020 2020 2062 7265 616b 0d0a 2020         break..  
-00008860: 2020 2020 2020 2020 2020 656c 6966 206f            elif o
-00008870: 732e 7061 7468 2e69 7366 696c 6528 7465  s.path.isfile(te
-00008880: 6d70 6c61 7465 5f70 6174 6829 2061 6e64  mplate_path) and
-00008890: 2066 6c61 6773 2e6f 7665 7277 7269 7465   flags.overwrite
-000088a0: 203d 3d20 5472 7565 3a0d 0a20 2020 2020   == True:..     
-000088b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000088c0: 5f73 6176 655f 6d73 6720 3d20 280d 0a20  _save_msg = (.. 
-000088d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088e0: 2020 2070 7269 6e74 5f73 6176 655f 6d73     print_save_ms
-000088f0: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
-00008900: 2020 2020 2020 202b 2022 5c6e 5265 6665         + "\nRefe
-00008910: 7265 6e63 6520 696d 6167 6520 7361 7665  rence image save
-00008920: 6420 756e 6465 7220 220d 0a20 2020 2020  d under "..     
-00008930: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-00008940: 2074 656d 706c 6174 655f 7061 7468 0d0a   template_path..
-00008950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008960: 2020 2020 2b20 2220 286f 7665 7277 7269      + " (overwri
-00008970: 7474 656e 292e 220d 0a20 2020 2020 2020  tten)."..       
-00008980: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-00008990: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-000089a0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-000089b0: 6966 206e 6f74 206f 732e 7061 7468 2e69  if not os.path.i
-000089c0: 7366 696c 6528 7465 6d70 6c61 7465 5f70  sfile(template_p
-000089d0: 6174 6829 3a0d 0a20 2020 2020 2020 2020  ath):..         
-000089e0: 2020 2020 2020 2070 7269 6e74 5f73 6176         print_sav
-000089f0: 655f 6d73 6720 3d20 280d 0a20 2020 2020  e_msg = (..     
-00008a00: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00008a10: 7269 6e74 5f73 6176 655f 6d73 6720 2b20  rint_save_msg + 
-00008a20: 225c 6e52 6566 6572 656e 6365 2069 6d61  "\nReference ima
-00008a30: 6765 2073 6176 6564 2075 6e64 6572 2022  ge saved under "
-00008a40: 202b 2074 656d 706c 6174 655f 7061 7468   + template_path
-00008a50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008a60: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-00008a70: 2020 2020 2070 6173 730d 0a0d 0a20 2020       pass....   
-00008a80: 2020 2020 2020 2020 2023 203d 3d3d 3d3d           # =====
-00008a90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008aa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008ab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008ac0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008ad0: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 2020  ========..      
-00008ae0: 2020 2020 2020 2320 616e 6e6f 7461 7469        # annotati
-00008af0: 6f6e 206d 616e 6167 656d 656e 7420 2866  on management (f
-00008b00: 6f72 2074 6573 7473 290d 0a0d 0a20 2020  or tests)....   
-00008b10: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
-00008b20: 696f 6e73 203d 206b 7761 7267 732e 6765  ions = kwargs.ge
-00008b30: 7428 2261 6e6e 6f74 6174 696f 6e73 2229  t("annotations")
-00008b40: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00008b50: 6966 206e 6f74 2061 6e6e 6f74 6174 696f  if not annotatio
-00008b60: 6e73 3a0d 0a0d 0a20 2020 2020 2020 2020  ns:....         
-00008b70: 2020 2020 2020 2023 2320 6d65 6173 7572         ## measur
-00008b80: 6520 7265 6665 7265 6e63 650d 0a20 2020  e reference..   
-00008b90: 2020 2020 2020 2020 2020 2020 2061 6e6e               ann
-00008ba0: 6f74 6174 696f 6e73 203d 2070 7265 7072  otations = prepr
-00008bb0: 6f63 6573 7369 6e67 2e63 7265 6174 655f  ocessing.create_
-00008bc0: 7265 6665 7265 6e63 6528 7265 6665 7265  reference(refere
-00008bd0: 6e63 655f 696d 6167 6529 0d0a 2020 2020  nce_image)..    
-00008be0: 2020 2020 2020 2020 2020 2020 616e 6e6f              anno
-00008bf0: 7461 7469 6f6e 7320 3d20 7072 6570 726f  tations = prepro
-00008c00: 6365 7373 696e 672e 6372 6561 7465 5f6d  cessing.create_m
-00008c10: 6173 6b28 0d0a 2020 2020 2020 2020 2020  ask(..          
-00008c20: 2020 2020 2020 2020 2020 7265 6665 7265            refere
-00008c30: 6e63 655f 696d 6167 652c 2061 6e6e 6f74  nce_image, annot
-00008c40: 6174 696f 6e73 3d61 6e6e 6f74 6174 696f  ations=annotatio
-00008c50: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
-00008c60: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
-00008c70: 2020 2020 2023 2320 6372 6561 7465 2074       ## create t
-00008c80: 656d 706c 6174 6520 6672 6f6d 206d 6173  emplate from mas
-00008c90: 6b20 636f 6f72 6469 6e61 7465 730d 0a20  k coordinates.. 
-00008ca0: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
-00008cb0: 7320 3d20 616e 6e6f 7461 7469 6f6e 735b  s = annotations[
-00008cc0: 7365 7474 696e 6773 2e5f 6d61 736b 5f74  settings._mask_t
-00008cd0: 7970 655d 5b22 6122 5d5b 2264 6174 6122  ype]["a"]["data"
-00008ce0: 5d5b 7365 7474 696e 6773 2e5f 6d61 736b  ][settings._mask
-00008cf0: 5f74 7970 655d 5b0d 0a20 2020 2020 2020  _type][..       
-00008d00: 2020 2020 2020 2020 2030 0d0a 2020 2020           0..    
-00008d10: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
-00008d20: 2020 2020 2020 2074 656d 706c 6174 6520         template 
-00008d30: 3d20 7265 6665 7265 6e63 655f 696d 6167  = reference_imag
-00008d40: 655b 0d0a 2020 2020 2020 2020 2020 2020  e[..            
-00008d50: 2020 2020 636f 6f72 6473 5b30 5d5b 315d      coords[0][1]
-00008d60: 203a 2063 6f6f 7264 735b 325d 5b31 5d2c   : coords[2][1],
-00008d70: 2063 6f6f 7264 735b 305d 5b30 5d20 3a20   coords[0][0] : 
-00008d80: 636f 6f72 6473 5b31 5d5b 305d 0d0a 2020  coords[1][0]..  
-00008d90: 2020 2020 2020 2020 2020 5d0d 0a0d 0a20            ].... 
-00008da0: 2020 2020 2020 2020 2020 2023 2320 6372             ## cr
-00008db0: 6561 7465 2072 6566 6572 656e 6365 2061  eate reference a
-00008dc0: 7474 7269 6275 7465 730d 0a20 2020 2020  ttributes..     
-00008dd0: 2020 2020 2020 2072 6566 6572 656e 6365         reference
-00008de0: 5f69 6e66 6f20 3d20 7b0d 0a20 2020 2020  _info = {..     
-00008df0: 2020 2020 2020 2020 2020 2022 7265 6665             "refe
-00008e00: 7265 6e63 655f 736f 7572 6365 5f70 6174  rence_source_pat
-00008e10: 6822 3a20 7265 6665 7265 6e63 655f 736f  h": reference_so
-00008e20: 7572 6365 5f70 6174 682c 0d0a 2020 2020  urce_path,..    
-00008e30: 2020 2020 2020 2020 2020 2020 2272 6566              "ref
-00008e40: 6572 656e 6365 5f66 696c 655f 6e61 6d65  erence_file_name
-00008e50: 223a 2072 6566 6572 656e 6365 5f69 6d61  ": reference_ima
-00008e60: 6765 5f6e 616d 652c 0d0a 2020 2020 2020  ge_name,..      
-00008e70: 2020 2020 2020 2020 2020 2274 656d 706c            "templ
-00008e80: 6174 655f 6669 6c65 5f6e 616d 6522 3a20  ate_file_name": 
-00008e90: 7465 6d70 6c61 7465 5f6e 616d 652c 0d0a  template_name,..
-00008ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008eb0: 2274 656d 706c 6174 655f 7078 5f72 6174  "template_px_rat
-00008ec0: 696f 223a 2061 6e6e 6f74 6174 696f 6e73  io": annotations
-00008ed0: 5b73 6574 7469 6e67 732e 5f72 6566 6572  [settings._refer
-00008ee0: 656e 6365 5f74 7970 655d 5b22 6122 5d5b  ence_type]["a"][
-00008ef0: 2264 6174 6122 5d5b 0d0a 2020 2020 2020  "data"][..      
-00008f00: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00008f10: 7474 696e 6773 2e5f 7265 6665 7265 6e63  ttings._referenc
-00008f20: 655f 7479 7065 0d0a 2020 2020 2020 2020  e_type..        
-00008f30: 2020 2020 2020 2020 5d5b 305d 2c0d 0a20          ][0],.. 
-00008f40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00008f50: 756e 6974 223a 2061 6e6e 6f74 6174 696f  unit": annotatio
-00008f60: 6e73 5b73 6574 7469 6e67 732e 5f72 6566  ns[settings._ref
-00008f70: 6572 656e 6365 5f74 7970 655d 5b22 6122  erence_type]["a"
-00008f80: 5d5b 2264 6174 6122 5d5b 0d0a 2020 2020  ]["data"][..    
-00008f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fa0: 7365 7474 696e 6773 2e5f 7265 6665 7265  settings._refere
-00008fb0: 6e63 655f 7479 7065 0d0a 2020 2020 2020  nce_type..      
-00008fc0: 2020 2020 2020 2020 2020 5d5b 315d 2c0d            ][1],.
-00008fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008fe0: 2022 6461 7465 5f61 6464 6564 223a 2064   "date_added": d
-00008ff0: 6174 6574 696d 652e 746f 6461 7928 292e  atetime.today().
-00009000: 7374 7266 7469 6d65 2873 6574 7469 6e67  strftime(setting
-00009010: 732e 7374 7266 7469 6d65 5f66 6f72 6d61  s.strftime_forma
-00009020: 7429 2c0d 0a20 2020 2020 2020 2020 2020  t),..           
-00009030: 207d 0d0a 0d0a 2020 2020 2020 2020 2020   }....          
-00009040: 2020 2323 206c 6f61 6420 7072 6f6a 6563    ## load projec
-00009050: 7420 6174 7472 6962 7574 6573 2061 6e64  t attributes and
-00009060: 2074 656d 706f 7261 7269 6c79 2064 726f   temporarily dro
-00009070: 7020 7072 6f6a 6563 7420 6461 7461 206c  p project data l
-00009080: 6973 7420 746f 0d0a 2020 2020 2020 2020  ist to..        
-00009090: 2020 2020 2323 2062 6520 7265 6174 7463      ## be reattc
-000090a0: 6865 6420 6c61 7465 722c 2073 6f20 6974  hed later, so it
-000090b0: 2069 7320 616c 7761 7973 2061 7420 7468   is always at th
-000090c0: 656e 2065 6e64 206f 6620 7468 6520 6669  en end of the fi
-000090d0: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
-000090e0: 7265 6665 7265 6e63 655f 6469 6374 203d  reference_dict =
-000090f0: 207b 7d0d 0a20 2020 2020 2020 2020 2020   {}..           
-00009100: 2070 726f 6a65 6374 5f61 7474 7269 6275   project_attribu
-00009110: 7465 7320 3d20 7574 696c 735f 6c6f 776c  tes = utils_lowl
-00009120: 6576 656c 2e5f 6c6f 6164 5f79 616d 6c28  evel._load_yaml(
-00009130: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009140: 2020 6f73 2e70 6174 682e 6a6f 696e 2873    os.path.join(s
-00009150: 656c 662e 726f 6f74 5f64 6972 2c20 2261  elf.root_dir, "a
-00009160: 7474 7269 6275 7465 732e 7961 6d6c 2229  ttributes.yaml")
-00009170: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
-00009180: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00009190: 2270 726f 6a65 6374 5f64 6174 6122 2069  "project_data" i
-000091a0: 6e20 7072 6f6a 6563 745f 6174 7472 6962  n project_attrib
-000091b0: 7574 6573 3a0d 0a20 2020 2020 2020 2020  utes:..         
-000091c0: 2020 2020 2020 2070 726f 6a65 6374 5f64         project_d
-000091d0: 6174 6120 3d20 7072 6f6a 6563 745f 6174  ata = project_at
-000091e0: 7472 6962 7574 6573 5b22 7072 6f6a 6563  tributes["projec
-000091f0: 745f 6461 7461 225d 0d0a 2020 2020 2020  t_data"]..      
-00009200: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
-00009210: 745f 6174 7472 6962 7574 6573 2e70 6f70  t_attributes.pop
-00009220: 2822 7072 6f6a 6563 745f 6461 7461 222c  ("project_data",
-00009230: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
-00009240: 2020 2020 6966 2022 7265 6665 7265 6e63      if "referenc
-00009250: 6522 2069 6e20 7072 6f6a 6563 745f 6174  e" in project_at
-00009260: 7472 6962 7574 6573 3a0d 0a20 2020 2020  tributes:..     
-00009270: 2020 2020 2020 2020 2020 2072 6566 6572             refer
-00009280: 656e 6365 5f64 6963 7420 3d20 7072 6f6a  ence_dict = proj
-00009290: 6563 745f 6174 7472 6962 7574 6573 5b22  ect_attributes["
-000092a0: 7265 6665 7265 6e63 6522 5d0d 0a20 2020  reference"]..   
-000092b0: 2020 2020 2020 2020 2072 6566 6572 656e           referen
-000092c0: 6365 5f64 6963 745b 7265 6665 7265 6e63  ce_dict[referenc
-000092d0: 655f 7461 675d 203d 2072 6566 6572 656e  e_tag] = referen
-000092e0: 6365 5f69 6e66 6f0d 0a0d 0a20 2020 2020  ce_info....     
-000092f0: 2020 2020 2020 2070 726f 6a65 6374 5f61         project_a
-00009300: 7474 7269 6275 7465 735b 2272 6566 6572  ttributes["refer
-00009310: 656e 6365 225d 203d 2072 6566 6572 656e  ence"] = referen
-00009320: 6365 5f64 6963 740d 0a20 2020 2020 2020  ce_dict..       
-00009330: 2020 2020 2070 726f 6a65 6374 5f61 7474       project_att
-00009340: 7269 6275 7465 735b 2270 726f 6a65 6374  ributes["project
-00009350: 5f64 6174 6122 5d20 3d20 7072 6f6a 6563  _data"] = projec
-00009360: 745f 6461 7461 0d0a 0d0a 2020 2020 2020  t_data....      
-00009370: 2020 2020 2020 2323 2073 6176 6520 616c        ## save al
-00009380: 6c20 6166 7465 7220 7375 6363 6573 7366  l after successf
-00009390: 756c 2063 6f6d 706c 6574 696f 6e20 6f66  ul completion of
-000093a0: 2061 6c6c 206d 6574 686f 642d 7374 6570   all method-step
-000093b0: 730d 0a20 2020 2020 2020 2020 2020 2063  s..            c
-000093c0: 7632 2e69 6d77 7269 7465 2872 6566 6572  v2.imwrite(refer
-000093d0: 656e 6365 5f69 6d61 6765 5f70 6174 682c  ence_image_path,
-000093e0: 2072 6566 6572 656e 6365 5f69 6d61 6765   reference_image
-000093f0: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
-00009400: 7632 2e69 6d77 7269 7465 2874 656d 706c  v2.imwrite(templ
-00009410: 6174 655f 7061 7468 2c20 7465 6d70 6c61  ate_path, templa
-00009420: 7465 290d 0a0d 0a20 2020 2020 2020 2020  te)....         
-00009430: 2020 2075 7469 6c73 5f6c 6f77 6c65 7665     utils_lowleve
-00009440: 6c2e 5f73 6176 655f 7961 6d6c 280d 0a20  l._save_yaml(.. 
-00009450: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00009460: 726f 6a65 6374 5f61 7474 7269 6275 7465  roject_attribute
-00009470: 732c 206f 732e 7061 7468 2e6a 6f69 6e28  s, os.path.join(
-00009480: 7365 6c66 2e72 6f6f 745f 6469 722c 2022  self.root_dir, "
-00009490: 6174 7472 6962 7574 6573 2e79 616d 6c22  attributes.yaml"
-000094a0: 290d 0a20 2020 2020 2020 2020 2020 2029  )..            )
-000094b0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-000094c0: 696e 745f 7361 7665 5f6d 7367 203d 2028  int_save_msg = (
-000094d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000094e0: 2020 7072 696e 745f 7361 7665 5f6d 7367    print_save_msg
-000094f0: 202b 2022 5c6e 5361 7665 6420 7265 6665   + "\nSaved refe
-00009500: 7265 6e63 6520 696e 666f 2074 6f20 7072  rence info to pr
-00009510: 6f6a 6563 7420 6174 7472 6962 7574 6573  oject attributes
-00009520: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
-00009530: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
-00009540: 7265 616b 0d0a 0d0a 2020 2020 2020 2020  reak....        
-00009550: 7072 696e 7428 7072 696e 745f 7361 7665  print(print_save
-00009560: 5f6d 7367 290d 0a0d 0a20 2020 2020 2020  _msg)....       
-00009570: 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   # =============
-00009580: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009590: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000095a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000095b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000095c0: 0d0a 2020 2020 2020 2020 2320 4d45 5448  ..        # METH
-000095d0: 4f44 2045 4e44 0d0a 2020 2020 2020 2020  OD END..        
-000095e0: 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  # ==============
-000095f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009600: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009610: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009620: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-00009630: 0a0d 0a20 2020 2020 2020 2023 2320 7365  ...        ## se
-00009640: 7420 6163 7469 7665 2072 6566 6572 656e  t active referen
-00009650: 6365 2069 6e66 6f72 6d61 7469 6f6e 2069  ce information i
-00009660: 6e20 6669 6c65 2073 7065 6369 6669 6320  n file specific 
-00009670: 6174 7472 6962 7574 6573 0d0a 2020 2020  attributes..    
-00009680: 2020 2020 666f 7220 6469 725f 6e61 6d65      for dir_name
-00009690: 2c20 6469 725f 7061 7468 2069 6e20 7a69  , dir_path in zi
-000096a0: 7028 7365 6c66 2e64 6972 5f6e 616d 6573  p(self.dir_names
-000096b0: 2c20 7365 6c66 2e64 6972 5f70 6174 6873  , self.dir_paths
-000096c0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000096d0: 6174 7472 203d 2075 7469 6c73 5f6c 6f77  attr = utils_low
-000096e0: 6c65 7665 6c2e 5f6c 6f61 645f 7961 6d6c  level._load_yaml
-000096f0: 286f 732e 7061 7468 2e6a 6f69 6e28 6469  (os.path.join(di
-00009700: 725f 7061 7468 2c20 2261 7474 7269 6275  r_path, "attribu
-00009710: 7465 732e 7961 6d6c 2229 290d 0a0d 0a20  tes.yaml")).... 
-00009720: 2020 2020 2020 2020 2020 2023 2320 6372             ## cr
-00009730: 6561 7465 206e 6573 7465 6420 6469 6374  eate nested dict
-00009740: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00009750: 206e 6f74 2022 7265 6665 7265 6e63 655f   not "reference_
-00009760: 676c 6f62 616c 2220 696e 2061 7474 723a  global" in attr:
-00009770: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009780: 2020 6174 7472 5b22 7265 6665 7265 6e63    attr["referenc
-00009790: 655f 676c 6f62 616c 225d 203d 207b 7d0d  e_global"] = {}.
-000097a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000097b0: 6e6f 7420 7265 6665 7265 6e63 655f 7461  not reference_ta
-000097c0: 6720 696e 2061 7474 725b 2272 6566 6572  g in attr["refer
-000097d0: 656e 6365 5f67 6c6f 6261 6c22 5d3a 0d0a  ence_global"]:..
-000097e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000097f0: 6174 7472 5b22 7265 6665 7265 6e63 655f  attr["reference_
-00009800: 676c 6f62 616c 225d 5b72 6566 6572 656e  global"][referen
-00009810: 6365 5f74 6167 5d20 3d20 7b7d 0d0a 0d0a  ce_tag] = {}....
-00009820: 2020 2020 2020 2020 2020 2020 2323 206c              ## l
-00009830: 6f6f 7020 7468 726f 7567 6820 656e 7472  oop through entr
-00009840: 6965 7320 616e 6420 7365 7420 6163 7469  ies and set acti
-00009850: 7665 2072 6566 6572 656e 6365 0d0a 2020  ve reference..  
-00009860: 2020 2020 2020 2020 2020 6966 2066 6c61            if fla
-00009870: 6773 2e61 6374 6976 6174 6520 3d3d 2054  gs.activate == T
-00009880: 7275 653a 0d0a 2020 2020 2020 2020 2020  rue:..          
-00009890: 2020 2020 2020 666f 7220 6b65 792c 2076        for key, v
-000098a0: 616c 7565 2069 6e20 6174 7472 5b22 7265  alue in attr["re
-000098b0: 6665 7265 6e63 655f 676c 6f62 616c 225d  ference_global"]
-000098c0: 2e69 7465 6d73 2829 3a0d 0a20 2020 2020  .items():..     
-000098d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000098e0: 6620 6b65 7920 3d3d 2072 6566 6572 656e  f key == referen
-000098f0: 6365 5f74 6167 3a0d 0a20 2020 2020 2020  ce_tag:..       
-00009900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009910: 2061 7474 725b 2272 6566 6572 656e 6365   attr["reference
-00009920: 5f67 6c6f 6261 6c22 5d5b 6b65 795d 5b22  _global"][key]["
-00009930: 6163 7469 7665 225d 203d 2054 7275 650d  active"] = True.
-00009940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009950: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00009960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009970: 2020 2020 6174 7472 5b22 7265 6665 7265      attr["refere
-00009980: 6e63 655f 676c 6f62 616c 225d 5b6b 6579  nce_global"][key
-00009990: 5d5b 2261 6374 6976 6522 5d20 3d20 4661  ]["active"] = Fa
-000099a0: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
-000099b0: 2020 2020 2075 7469 6c73 5f6c 6f77 6c65       utils_lowle
-000099c0: 7665 6c2e 5f73 6176 655f 7961 6d6c 280d  vel._save_yaml(.
-000099d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000099e0: 2020 2020 2061 7474 722c 206f 732e 7061       attr, os.pa
-000099f0: 7468 2e6a 6f69 6e28 6469 725f 7061 7468  th.join(dir_path
-00009a00: 2c20 2261 7474 7269 6275 7465 732e 7961  , "attributes.ya
-00009a10: 6d6c 2229 0d0a 2020 2020 2020 2020 2020  ml")..          
-00009a20: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-00009a30: 2020 2020 2020 2020 2070 7269 6e74 280d           print(.
-00009a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009a50: 2020 2020 2027 7365 7474 696e 6720 6163       'setting ac
-00009a60: 7469 7665 2067 6c6f 6261 6c20 7072 6f6a  tive global proj
-00009a70: 6563 7420 7265 6665 7265 6e63 6520 746f  ect reference to
-00009a80: 2022 270d 0a20 2020 2020 2020 2020 2020   "'..           
-00009a90: 2020 2020 2020 2020 202b 2072 6566 6572           + refer
-00009aa0: 656e 6365 5f74 6167 0d0a 2020 2020 2020  ence_tag..      
-00009ab0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00009ac0: 2722 2066 6f72 2027 0d0a 2020 2020 2020  '" for '..      
-00009ad0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00009ae0: 6469 725f 6e61 6d65 0d0a 2020 2020 2020  dir_name..      
-00009af0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00009b00: 2220 2861 6374 6976 653d 5472 7565 2922  " (active=True)"
-00009b10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009b20: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-00009b30: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00009b40: 2020 2020 2020 2020 7072 696e 7428 0d0a          print(..
-00009b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b60: 2020 2020 2263 6f75 6c64 206e 6f74 2073      "could not s
-00009b70: 6574 2067 6c6f 6261 6c20 7072 6f6a 6563  et global projec
-00009b80: 7420 7265 6665 7265 6e63 6520 666f 7220  t reference for 
-00009b90: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00009ba0: 2020 2020 2020 202b 2064 6972 5f6e 616d         + dir_nam
-00009bb0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00009bc0: 2020 2020 2020 202b 2022 2028 6f76 6572         + " (over
-00009bd0: 7772 6974 653d 4661 6c73 652f 6163 7469  write=False/acti
-00009be0: 7661 7465 3d46 616c 7365 2922 0d0a 2020  vate=False)"..  
-00009bf0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00009c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009c10: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00009c20: 2020 200d 0a20 2020 2064 6566 2063 6865     ..    def che
-00009c30: 636b 5f66 696c 6573 280d 0a20 2020 2020  ck_files(..     
-00009c40: 2020 2020 2020 2073 656c 662c 200d 0a20         self, .. 
-00009c50: 2020 2020 2020 2020 2020 2066 6565 6462             feedb
-00009c60: 6163 6b3d 5472 7565 2c0d 0a20 2020 2020  ack=True,..     
-00009c70: 2020 2020 2020 2069 6d61 6765 5f6c 696e         image_lin
-00009c80: 6b73 3d46 616c 7365 2c0d 0a0d 0a20 2020  ks=False,....   
-00009c90: 2020 2020 2020 2020 2029 3a0d 0a20 2020           ):..   
-00009ca0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00009cb0: 2020 4368 6563 6b20 616c 6c20 7072 6f6a    Check all proj
-00009cc0: 6563 7420 6669 6c65 7320 666f 7220 636f  ect files for co
-00009cd0: 6d70 6c65 7465 6e65 7373 2062 7920 636f  mpleteness by co
-00009ce0: 6d70 6172 696e 6720 7468 6520 696d 6167  mparing the imag
-00009cf0: 6573 2069 6e20 7468 650d 0a20 2020 2020  es in the..     
-00009d00: 2020 2022 6461 7461 2220 666f 6c64 6572     "data" folder
-00009d10: 2074 6f20 7468 6520 6669 6c65 206c 6973   to the file lis
-00009d20: 7420 7468 6520 7072 6f6a 6563 7420 6174  t the project at
-00009d30: 7472 6962 7574 6573 2e20 5769 6c6c 2061  tributes. Will a
-00009d40: 7474 656d 7074 2074 6f20 0d0a 2020 2020  ttempt to ..    
-00009d50: 2020 2020 6669 7820 6469 7363 7265 7061      fix discrepa
-00009d60: 6e63 6965 732c 2062 7574 2061 736b 2066  ncies, but ask f
-00009d70: 6f72 2066 6565 6462 6163 6b20 6669 7273  or feedback firs
-00009d80: 742e 0d0a 0d0a 2020 2020 2020 2020 5061  t.....        Pa
-00009d90: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00009da0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00009db0: 2020 2020 2020 6665 6564 6261 636b 203a        feedback :
-00009dc0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0d   bool, optional.
-00009dd0: 0a20 2020 2020 2020 2020 2020 2041 736b  .            Ask
-00009de0: 7320 7768 6574 6865 7220 7072 6f6a 6563  s whether projec
-00009df0: 7420 6174 7472 6962 7574 6573 2073 686f  t attributes sho
-00009e00: 756c 6420 6265 2075 7064 6174 6564 2e20  uld be updated. 
-00009e10: 5468 6520 6465 6661 756c 7420 6973 2054  The default is T
-00009e20: 7275 652e 0d0a 2020 2020 2020 2020 696d  rue...        im
-00009e30: 6167 6573 203a 2062 6f6f 6c2c 206f 7074  ages : bool, opt
-00009e40: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
-00009e50: 2020 2063 6865 636b 7320 7768 6574 6865     checks whethe
-00009e60: 7220 696d 6167 6520 6361 6e20 6265 206c  r image can be l
-00009e70: 6f61 6465 6420 6672 6f6d 2070 6174 682c  oaded from path,
-00009e80: 206f 7468 6572 7769 7365 2074 7269 6573   otherwise tries
-00009e90: 2074 6f20 6c6f 6164 200d 0a20 2020 2020   to load ..     
-00009ea0: 2020 2020 2020 2066 726f 6d20 6f72 6967         from orig
-00009eb0: 696e 616c 2066 696c 6570 6174 6820 2877  inal filepath (w
-00009ec0: 696c 6c20 6173 6b20 6669 7273 7429 2e20  ill ask first). 
-00009ed0: 5468 6520 6465 6661 756c 7420 6973 2046  The default is F
-00009ee0: 616c 7365 2e0d 0a20 2020 2020 2020 2020  alse...         
-00009ef0: 2020 200d 0a0d 0a20 2020 2020 2020 2052     ....        R
-00009f00: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00009f10: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00009f20: 204e 6f6e 652e 0d0a 0d0a 2020 2020 2020   None.....      
-00009f30: 2020 2222 220d 0a20 2020 2020 2020 200d    """..        .
-00009f40: 0a20 2020 2020 2020 2023 203d 3d3d 3d3d  .        # =====
-00009f50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009f60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009f70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009f80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009f90: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 2020  ========..      
-00009fa0: 2020 2320 7365 7475 700d 0a0d 0a20 2020    # setup....   
-00009fb0: 2020 2020 2023 2320 7365 7420 666c 6167       ## set flag
-00009fc0: 730d 0a20 2020 2020 2020 2066 6c61 6773  s..        flags
-00009fd0: 203d 206d 616b 655f 6461 7461 636c 6173   = make_dataclas
-00009fe0: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-00009ff0: 636c 735f 6e61 6d65 3d22 666c 6167 7322  cls_name="flags"
-0000a000: 2c0d 0a20 2020 2020 2020 2020 2020 2066  ,..            f
-0000a010: 6965 6c64 733d 5b0d 0a20 2020 2020 2020  ields=[..       
-0000a020: 2020 2020 2020 2020 2028 2269 6d61 6765           ("image
-0000a030: 5f6c 696e 6b73 222c 2062 6f6f 6c2c 2069  _links", bool, i
-0000a040: 6d61 6765 5f6c 696e 6b73 292c 200d 0a20  mage_links), .. 
-0000a050: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0000a060: 2266 6565 6462 6163 6b22 2c20 626f 6f6c  "feedback", bool
-0000a070: 2c20 6665 6564 6261 636b 292c 0d0a 2020  , feedback),..  
-0000a080: 2020 2020 2020 2020 2020 2020 2020 2822                ("
-0000a090: 6368 6563 6b22 2c20 626f 6f6c 2c20 4e6f  check", bool, No
-0000a0a0: 6e65 292c 0d0a 2020 2020 2020 2020 2020  ne),..          
-0000a0b0: 2020 2020 2020 5d2c 0d0a 2020 2020 2020        ],..      
-0000a0c0: 2020 290d 0a0d 0a20 2020 2020 2020 2020    )....         
-0000a0d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000a0e0: 2023 2320 6c6f 6164 2066 696c 656e 616d   ## load filenam
-0000a0f0: 6573 0d0a 2020 2020 2020 2020 6966 2022  es..        if "
-0000a100: 6669 6c65 6e61 6d65 7322 2069 6e20 7365  filenames" in se
-0000a110: 6c66 2e61 7474 7269 6275 7465 735b 2270  lf.attributes["p
-0000a120: 726f 6a65 6374 5f64 6174 6122 5d3a 0d0a  roject_data"]:..
-0000a130: 2020 2020 2020 2020 2020 2020 6669 6c65              file
-0000a140: 6e61 6d65 7320 3d20 7365 6c66 2e61 7474  names = self.att
-0000a150: 7269 6275 7465 735b 2270 726f 6a65 6374  ributes["project
-0000a160: 5f64 6174 6122 5d5b 2266 696c 656e 616d  _data"]["filenam
-0000a170: 6573 225d 0d0a 2020 2020 2020 2020 2020  es"]..          
-0000a180: 2020 6469 726e 616d 6573 203d 2073 656c    dirnames = sel
-0000a190: 662e 6174 7472 6962 7574 6573 5b22 7072  f.attributes["pr
-0000a1a0: 6f6a 6563 745f 6461 7461 225d 5b22 6469  oject_data"]["di
-0000a1b0: 726e 616d 6573 225d 0d0a 2020 2020 2020  rnames"]..      
-0000a1c0: 2020 656c 6966 2073 656c 662e 6174 7472    elif self.attr
-0000a1d0: 6962 7574 6573 5b22 7072 6f6a 6563 745f  ibutes["project_
-0000a1e0: 6461 7461 225d 2e5f 5f63 6c61 7373 5f5f  data"].__class__
-0000a1f0: 2e5f 5f6e 616d 655f 5f20 696e 205b 226c  .__name__ in ["l
-0000a200: 6973 7422 2c22 436f 6d6d 656e 7465 6453  ist","CommentedS
-0000a210: 6571 225d 3a0d 0a20 2020 2020 2020 2020  eq"]:..         
-0000a220: 2020 2020 6469 726e 616d 6573 203d 2073      dirnames = s
-0000a230: 656c 662e 6174 7472 6962 7574 6573 5b22  elf.attributes["
-0000a240: 7072 6f6a 6563 745f 6461 7461 225d 0d0a  project_data"]..
-0000a250: 2020 2020 2020 2020 2020 2020 2066 696c               fil
-0000a260: 656e 616d 6573 203d 205b 5d0d 0a20 2020  enames = []..   
-0000a270: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0000a280: 7474 7269 6275 7465 735b 2270 726f 6a65  ttributes["proje
-0000a290: 6374 5f64 6174 6122 5d20 3d20 7b7d 0d0a  ct_data"] = {}..
-0000a2a0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0000a2b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0000a2c0: 2822 636f 756c 6420 6e6f 7420 7265 6164  ("could not read
-0000a2d0: 2070 726f 6a65 6374 2061 7474 7269 6275   project attribu
-0000a2e0: 7465 7320 6669 6c65 2122 290d 0a20 2020  tes file!")..   
-0000a2f0: 2020 2020 2020 2020 2072 6574 7572 6e0d           return.
-0000a300: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000a310: 2020 2066 696c 656e 616d 6573 5f63 6865     filenames_che
-0000a320: 636b 2c20 6469 726e 616d 6573 5f63 6865  ck, dirnames_che
-0000a330: 636b 203d 205b 5d2c 205b 5d0d 0a0d 0a20  ck = [], [].... 
-0000a340: 2020 2020 2020 2066 6f72 2064 6972 7061         for dirpa
-0000a350: 7468 2069 6e20 7365 6c66 2e64 6972 5f70  th in self.dir_p
-0000a360: 6174 6873 3a0d 0a20 2020 2020 2020 2020  aths:..         
-0000a370: 2020 2061 7474 7269 6275 7465 735f 7061     attributes_pa
-0000a380: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-0000a390: 6e28 6469 7270 6174 682c 2022 6174 7472  n(dirpath, "attr
-0000a3a0: 6962 7574 6573 2e79 616d 6c22 290d 0a20  ibutes.yaml").. 
-0000a3b0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-0000a3c0: 6275 7465 7320 3d20 7574 696c 735f 6c6f  butes = utils_lo
-0000a3d0: 776c 6576 656c 2e5f 6c6f 6164 5f79 616d  wlevel._load_yam
-0000a3e0: 6c28 6174 7472 6962 7574 6573 5f70 6174  l(attributes_pat
-0000a3f0: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-0000a400: 6669 6c65 6e61 6d65 203d 2061 7474 7269  filename = attri
-0000a410: 6275 7465 735b 2269 6d61 6765 5f6f 7269  butes["image_ori
-0000a420: 6769 6e61 6c22 5d5b 2266 696c 656e 616d  ginal"]["filenam
-0000a430: 6522 5d0d 0a20 2020 2020 2020 2020 2020  e"]..           
-0000a440: 2066 696c 656e 616d 6573 5f63 6865 636b   filenames_check
-0000a450: 2e61 7070 656e 6428 6669 6c65 6e61 6d65  .append(filename
-0000a460: 290d 0a20 2020 2020 2020 2020 2020 2064  )..            d
-0000a470: 6972 6e61 6d65 735f 6368 6563 6b2e 6170  irnames_check.ap
-0000a480: 7065 6e64 286f 732e 7061 7468 2e62 6173  pend(os.path.bas
-0000a490: 656e 616d 6528 6469 7270 6174 6829 290d  ename(dirpath)).
-0000a4a0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0000a4b0: 2020 2020 2020 2020 2020 2069 6620 666c             if fl
-0000a4c0: 6167 732e 696d 6167 655f 6c69 6e6b 733a  ags.image_links:
-0000a4d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a4e0: 2020 6669 6c65 7061 7468 203d 2061 7474    filepath = att
-0000a4f0: 7269 6275 7465 735b 2269 6d61 6765 5f70  ributes["image_p
-0000a500: 6865 6e6f 7079 7065 225d 5b22 6669 6c65  henopype"]["file
-0000a510: 7061 7468 225d 0d0a 2020 2020 2020 2020  path"]..        
-0000a520: 2020 2020 2020 2020 6966 2061 7474 7269          if attri
-0000a530: 6275 7465 735b 2269 6d61 6765 5f70 6865  butes["image_phe
-0000a540: 6e6f 7079 7065 225d 5b22 6d6f 6465 225d  nopype"]["mode"]
-0000a550: 203d 3d20 226c 696e 6b22 3a0d 0a20 2020   == "link":..   
-0000a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a570: 2069 6620 6e6f 7420 6f73 2e70 6174 682e   if not os.path.
-0000a580: 6973 6669 6c65 286f 732e 7061 7468 2e6a  isfile(os.path.j
-0000a590: 6f69 6e28 6469 7270 6174 682c 2066 696c  oin(dirpath, fil
-0000a5a0: 6570 6174 6829 293a 0d0a 2020 2020 2020  epath)):..      
-0000a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a5c0: 2020 7072 696e 7428 2243 6f75 6c64 206e    print("Could n
-0000a5d0: 6f74 2066 696e 6420 696d 6167 6528 7329  ot find image(s)
-0000a5e0: 2073 6176 6564 206f 7220 6c69 6e6b 6564   saved or linked
-0000a5f0: 2074 6f20 7068 656e 6f70 7970 6520 7072   to phenopype pr
-0000a600: 6f6a 6563 743a 7b7d 222e 666f 726d 6174  oject:{}".format
-0000a610: 2866 696c 656e 616d 6529 290d 0a20 2020  (filename))..   
-0000a620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a630: 2020 2020 2069 6620 666c 6167 732e 6368       if flags.ch
-0000a640: 6563 6b2e 5f5f 636c 6173 735f 5f2e 5f5f  eck.__class__.__
-0000a650: 6e61 6d65 5f5f 203d 3d20 224e 6f6e 6554  name__ == "NoneT
-0000a660: 7970 6522 3a0d 0a20 2020 2020 2020 2020  ype":..         
-0000a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a680: 2020 2066 6c61 6773 2e63 6865 636b 203d     flags.check =
-0000a690: 2069 6e70 7574 2822 5c6e 4368 6563 6b20   input("\nCheck 
-0000a6a0: 6f72 6967 696e 616c 2066 696c 6570 6174  original filepat
-0000a6b0: 6820 616e 6420 7265 6c69 6e6b 2069 6620  h and relink if 
-0000a6c0: 706f 7373 6962 6c65 205b 616c 736f 2066  possible [also f
-0000a6d0: 6f72 2061 6c6c 206f 7468 6572 2062 726f  or all other bro
-0000a6e0: 6b65 6e20 7061 7468 735d 2028 792f 6e29  ken paths] (y/n)
-0000a6f0: 3f5c 6e22 290d 0a20 2020 2020 2020 2020  ?\n")..         
-0000a700: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000a710: 6620 666c 6167 732e 6368 6563 6b20 696e  f flags.check in
-0000a720: 2073 6574 7469 6e67 732e 636f 6e66 6972   settings.confir
-0000a730: 6d5f 6f70 7469 6f6e 733a 0d0a 2020 2020  m_options:..    
-0000a740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a750: 2020 2020 2020 2020 6669 6c65 7061 7468          filepath
-0000a760: 203d 2061 7474 7269 6275 7465 735b 2269   = attributes["i
-0000a770: 6d61 6765 5f6f 7269 6769 6e61 6c22 5d5b  mage_original"][
-0000a780: 2266 696c 6570 6174 6822 5d0d 0a20 2020  "filepath"]..   
-0000a790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a7a0: 2020 2020 2020 2020 2069 6620 6f73 2e70           if os.p
-0000a7b0: 6174 682e 6973 6669 6c65 2866 696c 6570  ath.isfile(filep
-0000a7c0: 6174 6829 3a0d 0a20 2020 2020 2020 2020  ath):..         
-0000a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a7e0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-0000a7f0: 735b 2269 6d61 6765 5f70 6865 6e6f 7079  s["image_phenopy
-0000a800: 7065 225d 5b22 6669 6c65 7061 7468 225d  pe"]["filepath"]
-0000a810: 203d 206f 732e 7061 7468 2e72 656c 7061   = os.path.relpa
-0000a820: 7468 2866 696c 6570 6174 682c 2064 6972  th(filepath, dir
-0000a830: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
-0000a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a850: 2020 2020 2020 2070 7269 6e74 2822 5265         print("Re
-0000a860: 2d6c 696e 6b69 6e67 2073 7563 6365 7373  -linking success
-0000a870: 6675 6c20 2d20 7361 7669 6e67 206e 6577  ful - saving new
-0000a880: 2070 6174 6820 746f 2061 7474 7269 6275   path to attribu
-0000a890: 7465 7321 2229 0d0a 2020 2020 2020 2020  tes!")..        
-0000a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a8b0: 2020 2020 2020 2020 7574 696c 735f 6c6f          utils_lo
-0000a8c0: 776c 6576 656c 2e5f 7361 7665 5f79 616d  wlevel._save_yam
-0000a8d0: 6c28 6174 7472 6962 7574 6573 2c20 6174  l(attributes, at
-0000a8e0: 7472 6962 7574 6573 5f70 6174 6829 0d0a  tributes_path)..
-0000a8f0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-0000a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a910: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0000a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a930: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-0000a940: 4669 6c65 206e 6f74 2066 6f75 6e64 202d  File not found -
-0000a950: 2063 6f75 6c64 206e 6f74 2072 652d 6c69   could not re-li
-0000a960: 6e6b 2122 290d 0a0d 0a20 2020 2020 2020  nk!")....       
-0000a970: 2066 696c 656e 616d 6573 5f75 6e6d 6174   filenames_unmat
-0000a980: 6368 6564 2c20 6469 726e 616d 6573 5f75  ched, dirnames_u
-0000a990: 6e6d 6174 6368 6564 203d 205b 5d2c 205b  nmatched = [], [
-0000a9a0: 5d0d 0a20 2020 2020 2020 200d 0a20 2020  ]..        ..   
-0000a9b0: 2020 2020 2066 6f72 2066 696c 656e 616d       for filenam
-0000a9c0: 6520 696e 2066 696c 656e 616d 6573 3a0d  e in filenames:.
-0000a9d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000a9e0: 6e6f 7420 6669 6c65 6e61 6d65 2069 6e20  not filename in 
-0000a9f0: 6669 6c65 6e61 6d65 735f 6368 6563 6b3a  filenames_check:
-0000aa00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000aa10: 2020 6669 6c65 6e61 6d65 735f 756e 6d61    filenames_unma
-0000aa20: 7463 6865 642e 6170 7065 6e64 2866 696c  tched.append(fil
-0000aa30: 656e 616d 6529 0d0a 0d0a 2020 2020 2020  ename)....      
-0000aa40: 2020 666f 7220 6469 726e 616d 6520 696e    for dirname in
-0000aa50: 2064 6972 6e61 6d65 733a 0d0a 2020 2020   dirnames:..    
-0000aa60: 2020 2020 2020 2020 6966 206e 6f74 2066          if not f
-0000aa70: 696c 656e 616d 6520 696e 2064 6972 6e61  ilename in dirna
-0000aa80: 6d65 735f 6368 6563 6b3a 0d0a 2020 2020  mes_check:..    
-0000aa90: 2020 2020 2020 2020 2020 2020 6469 726e              dirn
-0000aaa0: 616d 6573 5f75 6e6d 6174 6368 6564 2e61  ames_unmatched.a
-0000aab0: 7070 656e 6428 6669 6c65 6e61 6d65 2920  ppend(filename) 
-0000aac0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000aad0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-0000aae0: 6c65 6e28 6669 6c65 6e61 6d65 735f 756e  len(filenames_un
-0000aaf0: 6d61 7463 6865 6429 203e 2030 3a0d 0a20  matched) > 0:.. 
-0000ab00: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0000ab10: 2866 696c 656e 616d 6573 5f75 6e6d 6174  (filenames_unmat
-0000ab20: 6368 6564 290d 0a20 2020 2020 2020 2020  ched)..         
-0000ab30: 2020 2070 7269 6e74 2822 5c6e 2229 0d0a     print("\n")..
-0000ab40: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0000ab50: 7428 222d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  t("-------------
-0000ab60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ab70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d22  ---------------"
-0000ab80: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-0000ab90: 7269 6e74 2822 7068 656e 6f70 7970 6520  rint("phenopype 
-0000aba0: 666f 756e 6420 7b7d 2066 696c 6573 2069  found {} files i
-0000abb0: 6e20 7468 6520 6461 7461 2066 6f6c 6465  n the data folde
-0000abc0: 722c 2062 7574 207b 7d20 6672 6f6d 2074  r, but {} from t
-0000abd0: 6865 2070 726f 6a65 6374 2061 7474 7269  he project attri
-0000abe0: 6275 7465 7320 6172 6520 756e 6163 636f  butes are unacco
-0000abf0: 756e 7465 6420 666f 722e 222e 666f 726d  unted for.".form
-0000ac00: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
-0000ac10: 2020 2020 206c 656e 2866 696c 656e 616d       len(filenam
-0000ac20: 6573 5f63 6865 636b 292c 0d0a 2020 2020  es_check),..    
-0000ac30: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
-0000ac40: 6669 6c65 6e61 6d65 735f 756e 6d61 7463  filenames_unmatc
-0000ac50: 6865 6429 2929 0d0a 2020 2020 2020 2020  hed)))..        
-0000ac60: 2020 2020 7469 6d65 2e73 6c65 6570 2831      time.sleep(1
-0000ac70: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0000ac80: 6620 666c 6167 732e 6665 6564 6261 636b  f flags.feedback
-0000ac90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000aca0: 2020 2063 6865 636b 203d 2069 6e70 7574     check = input
-0000acb0: 2822 7570 6461 7465 2070 726f 6a65 6374  ("update project
-0000acc0: 2061 7474 7269 6275 7465 7320 2879 2f6e   attributes (y/n
-0000acd0: 293f 2229 0d0a 2020 2020 2020 2020 2020  )?")..          
-0000ace0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0000acf0: 2020 2020 2020 2020 2063 6865 636b 203d           check =
-0000ad00: 2022 7922 0d0a 2020 2020 2020 2020 656c   "y"..        el
-0000ad10: 6966 206c 656e 2866 696c 656e 616d 6573  if len(filenames
-0000ad20: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
-0000ad30: 2020 2020 2070 7269 6e74 2822 5c6e 2229       print("\n")
-0000ad40: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-0000ad50: 696e 7428 222d 2d2d 2d2d 2d2d 2d2d 2d2d  int("-----------
-0000ad60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ad70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ad80: 2d22 290d 0a20 2020 2020 2020 2020 2020  -")..           
-0000ad90: 2070 7269 6e74 2822 7068 656e 6f70 7970   print("phenopyp
-0000ada0: 6520 666f 756e 6420 7b7d 2066 696c 6573  e found {} files
-0000adb0: 2069 6e20 7468 6520 6461 7461 2066 6f6c   in the data fol
-0000adc0: 6465 722c 2062 7574 2030 2061 7265 206c  der, but 0 are l
-0000add0: 6973 7465 6420 696e 2074 6865 2070 726f  isted in the pro
-0000ade0: 6a65 6374 2061 7474 7269 6275 7465 732e  ject attributes.
-0000adf0: 222e 666f 726d 6174 286c 656e 2866 696c  ".format(len(fil
-0000ae00: 656e 616d 6573 5f63 6865 636b 2929 290d  enames_check))).
-0000ae10: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-0000ae20: 652e 736c 6565 7028 3129 0d0a 2020 2020  e.sleep(1)..    
-0000ae30: 2020 2020 2020 2020 6966 2066 6c61 6773          if flags
-0000ae40: 2e66 6565 6462 6163 6b3a 0d0a 2020 2020  .feedback:..    
-0000ae50: 2020 2020 2020 2020 2020 2020 6368 6563              chec
-0000ae60: 6b20 3d20 696e 7075 7428 2275 7064 6174  k = input("updat
-0000ae70: 6520 7072 6f6a 6563 7420 6174 7472 6962  e project attrib
-0000ae80: 7574 6573 2028 792f 6e29 3f22 290d 0a20  utes (y/n)?").. 
-0000ae90: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000aea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000aeb0: 2020 6368 6563 6b20 3d20 2279 220d 0a20    check = "y".. 
-0000aec0: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
-0000aed0: 6669 6c65 6e61 6d65 7329 203c 206c 656e  filenames) < len
-0000aee0: 2866 696c 656e 616d 6573 5f63 6865 636b  (filenames_check
-0000aef0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000af00: 7072 696e 7428 225c 6e22 290d 0a20 2020  print("\n")..   
-0000af10: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-0000af20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000af30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000af40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2229 0d0a  ------------")..
-0000af50: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0000af60: 7428 2270 6865 6e6f 7079 7065 2066 6f75  t("phenopype fou
-0000af70: 6e64 207b 7d20 6669 6c65 7320 696e 2074  nd {} files in t
-0000af80: 6865 2064 6174 6120 666f 6c64 6572 2c20  he data folder, 
-0000af90: 6275 7420 6f6e 6c79 207b 7d20 6172 6520  but only {} are 
-0000afa0: 6c69 7374 6564 2069 6e20 7468 6520 7072  listed in the pr
-0000afb0: 6f6a 6563 7420 6174 7472 6962 7574 6573  oject attributes
-0000afc0: 2e22 2e66 6f72 6d61 7428 0d0a 2020 2020  .".format(..    
-0000afd0: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
-0000afe0: 6669 6c65 6e61 6d65 735f 6368 6563 6b29  filenames_check)
-0000aff0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000b000: 2020 206c 656e 2866 696c 656e 616d 6573     len(filenames
-0000b010: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000b020: 2020 2029 290d 0a20 2020 2020 2020 2020     ))..         
-0000b030: 2020 2074 696d 652e 736c 6565 7028 3129     time.sleep(1)
-0000b040: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000b050: 2066 6c61 6773 2e66 6565 6462 6163 6b3a   flags.feedback:
-0000b060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b070: 2020 6368 6563 6b20 3d20 696e 7075 7428    check = input(
-0000b080: 2275 7064 6174 6520 7072 6f6a 6563 7420  "update project 
-0000b090: 6174 7472 6962 7574 6573 2028 792f 6e29  attributes (y/n)
-0000b0a0: 3f22 290d 0a20 2020 2020 2020 2020 2020  ?")..           
-0000b0b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0000b0c0: 2020 2020 2020 2020 6368 6563 6b20 3d20          check = 
-0000b0d0: 2279 220d 0a20 2020 2020 2020 2065 6c73  "y"..        els
-0000b0e0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000b0f0: 7072 696e 7428 2241 6c6c 2063 6865 636b  print("All check
-0000b100: 7320 7061 7373 6564 202d 206e 756d 6265  s passed - numbe
-0000b110: 7273 2069 6e20 6461 7461 2066 6f6c 6465  rs in data folde
-0000b120: 7220 616e 6420 6174 7472 6962 7574 6573  r and attributes
-0000b130: 2066 696c 6520 6d61 7463 682e 2229 0d0a   file match.")..
-0000b140: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000b150: 726e 0d0a 0d0a 2020 2020 2020 2020 6966  rn....        if
-0000b160: 2063 6865 636b 2069 6e20 7365 7474 696e   check in settin
-0000b170: 6773 2e63 6f6e 6669 726d 5f6f 7074 696f  gs.confirm_optio
-0000b180: 6e73 3a0d 0a20 2020 2020 2020 2020 2020  ns:..           
-0000b190: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-0000b1a0: 656c 662e 6174 7472 6962 7574 6573 5b22  elf.attributes["
-0000b1b0: 7072 6f6a 6563 745f 6461 7461 225d 2e70  project_data"].p
-0000b1c0: 6f70 2822 6669 6c65 6e61 6d65 7322 2c20  op("filenames", 
-0000b1d0: 4e6f 6e65 290d 0a20 2020 2020 2020 2020  None)..         
-0000b1e0: 2020 2073 656c 662e 6174 7472 6962 7574     self.attribut
-0000b1f0: 6573 5b22 7072 6f6a 6563 745f 6461 7461  es["project_data
-0000b200: 225d 2e70 6f70 2822 6469 726e 616d 6573  "].pop("dirnames
-0000b210: 222c 204e 6f6e 6529 0d0a 2020 2020 2020  ", None)..      
-0000b220: 2020 2020 2020 7365 6c66 2e61 7474 7269        self.attri
-0000b230: 6275 7465 735b 2270 726f 6a65 6374 5f64  butes["project_d
-0000b240: 6174 6122 5d5b 2266 696c 656e 616d 6573  ata"]["filenames
-0000b250: 225d 203d 2066 696c 656e 616d 6573 5f63  "] = filenames_c
-0000b260: 6865 636b 0d0a 2020 2020 2020 2020 2020  heck..          
-0000b270: 2020 7365 6c66 2e61 7474 7269 6275 7465    self.attribute
-0000b280: 735b 2270 726f 6a65 6374 5f64 6174 6122  s["project_data"
-0000b290: 5d5b 2264 6972 6e61 6d65 7322 5d20 3d20  ]["dirnames"] = 
-0000b2a0: 6469 726e 616d 6573 5f63 6865 636b 0d0a  dirnames_check..
-0000b2b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000b2c0: 2e66 696c 655f 6e61 6d65 7320 3d20 6669  .file_names = fi
-0000b2d0: 6c65 6e61 6d65 735f 6368 6563 6b0d 0a20  lenames_check.. 
-0000b2e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000b2f0: 6469 725f 6e61 6d65 7320 3d20 6469 726e  dir_names = dirn
-0000b300: 616d 6573 5f63 6865 636b 0d0a 2020 2020  ames_check..    
-0000b310: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000b320: 2020 2020 2020 7574 696c 735f 6c6f 776c        utils_lowl
-0000b330: 6576 656c 2e5f 7361 7665 5f79 616d 6c28  evel._save_yaml(
-0000b340: 7365 6c66 2e61 7474 7269 6275 7465 732c  self.attributes,
-0000b350: 2073 656c 662e 6174 7472 6962 7574 6573   self.attributes
-0000b360: 5f70 6174 6829 0d0a 2020 2020 2020 2020  _path)..        
-0000b370: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-0000b380: 2020 7072 696e 7428 2270 726f 6a65 6374    print("project
-0000b390: 2061 7474 7269 6275 7465 7320 7570 6461   attributes upda
-0000b3a0: 7465 643b 206e 6f77 2068 6173 207b 7d20  ted; now has {} 
-0000b3b0: 6669 6c65 7322 2e66 6f72 6d61 7428 6c65  files".format(le
-0000b3c0: 6e28 6669 6c65 6e61 6d65 735f 6368 6563  n(filenames_chec
-0000b3d0: 6b29 2929 0d0a 2020 2020 2020 2020 656c  k)))..        el
-0000b3e0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0000b3f0: 2070 7269 6e74 2822 7072 6f6a 6563 7420   print("project 
-0000b400: 6174 7472 6962 7574 6573 206e 6f74 2075  attributes not u
-0000b410: 7064 6174 6564 2229 0d0a 2020 2020 2020  pdated")..      
-0000b420: 2020 7072 696e 7428 222d 2d2d 2d2d 2d2d    print("-------
-0000b430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b450: 2d2d 2d2d 2d22 2920 2020 200d 0a20 2020  -----")    ..   
-0000b460: 2020 2020 200d 0a0d 0a20 2020 2064 6566       ....    def
-0000b470: 2063 6f6c 6c65 6374 5f72 6573 756c 7473   collect_results
-0000b480: 2873 656c 662c 2074 6167 2c20 6669 6c65  (self, tag, file
-0000b490: 732c 2066 6f6c 6465 722c 206f 7665 7277  s, folder, overw
-0000b4a0: 7269 7465 3d46 616c 7365 2c20 2a2a 6b77  rite=False, **kw
-0000b4b0: 6172 6773 293a 0d0a 0d0a 2020 2020 2020  args):....      
-0000b4c0: 2020 2222 220d 0a20 2020 2020 2020 2043    """..        C
-0000b4d0: 6f6c 6c65 6374 2063 616e 7661 7320 6672  ollect canvas fr
-0000b4e0: 6f6d 2065 6163 6820 666f 6c64 6572 2069  om each folder i
-0000b4f0: 6e20 7468 6520 7072 6f6a 6563 7420 7472  n the project tr
-0000b500: 6565 2e20 5365 6172 6368 2062 7920 0d0a  ee. Search by ..
-0000b510: 2020 2020 2020 2020 6e61 6d65 2f73 6166          name/saf
-0000b520: 655f 7375 6666 6978 2028 652e 672e 2022  e_suffix (e.g. "
-0000b530: 7631 2229 2e0d 0a0d 0a20 2020 2020 2020  v1").....       
-0000b540: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0000b550: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0000b560: 0a20 2020 2020 2020 206e 616d 6520 3a20  .        name : 
-0000b570: 7374 720d 0a20 2020 2020 2020 2020 2020  str..           
-0000b580: 206e 616d 6520 6f66 2074 6865 2070 7970   name of the pyp
-0000b590: 6520 6f72 2073 6176 655f 7375 6666 6978  e or save_suffix
-0000b5a0: 0d0a 2020 2020 2020 2020 666f 6c64 6572  ..        folder
-0000b5b0: 203a 2073 7472 2c20 6f70 7469 6f6e 616c   : str, optional
-0000b5c0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0000b5d0: 6c64 6572 2069 6e20 7468 6520 726f 6f74  lder in the root
-0000b5e0: 2064 6972 6563 746f 7279 2077 6865 7265   directory where
-0000b5f0: 2074 6865 2072 6573 756c 7473 2061 7265   the results are
-0000b600: 2073 746f 7265 640d 0a20 2020 2020 2020   stored..       
-0000b610: 206f 7665 7277 7269 7465 203a 2062 6f6f   overwrite : boo
-0000b620: 6c2c 206f 7074 696f 6e61 6c0d 0a20 2020  l, optional..   
-0000b630: 2020 2020 2020 2020 2073 686f 756c 6420           should 
-0000b640: 7468 6520 7265 7375 6c74 7320 6265 206f  the results be o
-0000b650: 7665 7277 7269 7474 656e 0d0a 0d0a 2020  verwritten....  
-0000b660: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-0000b670: 2020 2020 2023 2320 7365 7420 666c 6167       ## set flag
-0000b680: 730d 0a20 2020 2020 2020 2066 6c61 6773  s..        flags
-0000b690: 203d 206d 616b 655f 6461 7461 636c 6173   = make_dataclas
-0000b6a0: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-0000b6b0: 636c 735f 6e61 6d65 3d22 666c 6167 7322  cls_name="flags"
-0000b6c0: 2c20 6669 656c 6473 3d5b 2822 6f76 6572  , fields=[("over
-0000b6d0: 7772 6974 6522 2c20 626f 6f6c 2c20 6f76  write", bool, ov
-0000b6e0: 6572 7772 6974 6529 5d0d 0a20 2020 2020  erwrite)]..     
-0000b6f0: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
-0000b700: 7265 7375 6c74 735f 7061 7468 203d 206f  results_path = o
-0000b710: 732e 7061 7468 2e6a 6f69 6e28 7365 6c66  s.path.join(self
-0000b720: 2e72 6f6f 745f 6469 722c 2022 7265 7375  .root_dir, "resu
-0000b730: 6c74 7322 2c20 666f 6c64 6572 290d 0a0d  lts", folder)...
-0000b740: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0000b750: 6f73 2e70 6174 682e 6973 6469 7228 7265  os.path.isdir(re
-0000b760: 7375 6c74 735f 7061 7468 293a 0d0a 2020  sults_path):..  
-0000b770: 2020 2020 2020 2020 2020 6f73 2e6d 616b            os.mak
-0000b780: 6564 6972 7328 7265 7375 6c74 735f 7061  edirs(results_pa
-0000b790: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
-0000b7a0: 2070 7269 6e74 2822 4372 6561 7465 6420   print("Created 
-0000b7b0: 2220 2b20 7265 7375 6c74 735f 7061 7468  " + results_path
-0000b7c0: 290d 0a0d 0a20 2020 2020 2020 2023 2320  )....        ## 
-0000b7d0: 7365 6172 6368 2073 7472 696e 670d 0a20  search string.. 
-0000b7e0: 2020 2020 2020 2069 6620 6e6f 7420 6669         if not fi
-0000b7f0: 6c65 732e 5f5f 636c 6173 735f 5f2e 5f5f  les.__class__.__
-0000b800: 6e61 6d65 5f5f 203d 3d20 224e 6f6e 6554  name__ == "NoneT
-0000b810: 7970 6522 3a0d 0a20 2020 2020 2020 2020  ype":..         
-0000b820: 2020 2069 6620 6e6f 7420 6669 6c65 732e     if not files.
-0000b830: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-0000b840: 5f5f 203d 3d20 226c 6973 7422 3a0d 0a20  __ == "list":.. 
-0000b850: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000b860: 696c 6573 203d 205b 6669 6c65 735d 0d0a  iles = [files]..
-0000b870: 2020 2020 2020 2020 2020 2020 7365 6172              sear
-0000b880: 6368 5f73 7472 696e 6773 203d 205b 5d0d  ch_strings = [].
-0000b890: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0000b8a0: 2066 696c 6520 696e 2066 696c 6573 3a0d   file in files:.
-0000b8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b8c0: 2069 6620 6e6f 7420 7461 6720 3d3d 2022   if not tag == "
-0000b8d0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0000b8e0: 2020 2020 2020 2020 7365 6172 6368 5f73          search_s
-0000b8f0: 7472 696e 6773 2e61 7070 656e 6428 6669  trings.append(fi
-0000b900: 6c65 202b 2022 5f22 202b 2074 6167 290d  le + "_" + tag).
-0000b910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b920: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0000b930: 2020 2020 2020 2020 2020 2020 7365 6172              sear
-0000b940: 6368 5f73 7472 696e 6773 2e61 7070 656e  ch_strings.appen
-0000b950: 6428 6669 6c65 290d 0a20 2020 2020 2020  d(file)..       
-0000b960: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0000b970: 2020 2020 7365 6172 6368 5f73 7472 696e      search_strin
-0000b980: 6773 203d 2074 6167 0d0a 0d0a 2020 2020  gs = tag....    
-0000b990: 2020 2020 2323 2061 7070 656e 6420 6e61      ## append na
-0000b9a0: 6d65 0d0a 2020 2020 2020 2020 7072 696e  me..        prin
-0000b9b0: 7428 2253 6561 7263 6820 7374 7269 6e67  t("Search string
-0000b9c0: 3a20 2220 2b20 7374 7228 7365 6172 6368  : " + str(search
-0000b9d0: 5f73 7472 696e 6773 2929 0d0a 0d0a 2020  _strings))....  
-0000b9e0: 2020 2020 2020 2323 2065 7863 6c75 6465        ## exclude
-0000b9f0: 2073 7472 696e 6773 0d0a 2020 2020 2020   strings..      
-0000ba00: 2020 6578 636c 7564 6520 3d20 6b77 6172    exclude = kwar
-0000ba10: 6773 2e67 6574 2822 6578 636c 7564 6522  gs.get("exclude"
-0000ba20: 2c20 5b5d 290d 0a20 2020 2020 2020 2069  , [])..        i
-0000ba30: 6620 6e6f 7420 6578 636c 7564 652e 5f5f  f not exclude.__
-0000ba40: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-0000ba50: 203d 3d20 224e 6f6e 6554 7970 6522 3a0d   == "NoneType":.
-0000ba60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000ba70: 6578 636c 7564 652e 5f5f 636c 6173 735f  exclude.__class_
-0000ba80: 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20 2273  _.__name__ == "s
-0000ba90: 7472 223a 0d0a 2020 2020 2020 2020 2020  tr":..          
-0000baa0: 2020 2020 2020 6578 636c 7564 6520 3d20        exclude = 
-0000bab0: 5b65 7863 6c75 6465 5d0d 0a0d 0a20 2020  [exclude]....   
-0000bac0: 2020 2020 2023 2320 7365 6172 6368 0d0a       ## search..
-0000bad0: 2020 2020 2020 2020 666f 756e 642c 2064          found, d
-0000bae0: 7570 6c69 6361 7465 7320 3d20 7574 696c  uplicates = util
-0000baf0: 735f 6c6f 776c 6576 656c 2e5f 6669 6c65  s_lowlevel._file
-0000bb00: 5f77 616c 6b65 7228 0d0a 2020 2020 2020  _walker(..      
-0000bb10: 2020 2020 2020 6f73 2e70 6174 682e 6a6f        os.path.jo
-0000bb20: 696e 2873 656c 662e 726f 6f74 5f64 6972  in(self.root_dir
-0000bb30: 2c20 2264 6174 6122 292c 0d0a 2020 2020  , "data"),..    
-0000bb40: 2020 2020 2020 2020 7265 6375 7273 6976          recursiv
-0000bb50: 653d 5472 7565 2c0d 0a20 2020 2020 2020  e=True,..       
-0000bb60: 2020 2020 2069 6e63 6c75 6465 3d73 6561       include=sea
-0000bb70: 7263 685f 7374 7269 6e67 732c 0d0a 2020  rch_strings,..  
-0000bb80: 2020 2020 2020 2020 2020 6578 636c 7564            exclud
-0000bb90: 653d 5b22 7079 7065 5f63 6f6e 6669 6722  e=["pype_config"
-0000bba0: 5d20 2b20 6578 636c 7564 652c 0d0a 2020  ] + exclude,..  
-0000bbb0: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-0000bbc0: 2020 2023 2320 636f 6c6c 6563 740d 0a20     ## collect.. 
-0000bbd0: 2020 2020 2020 2066 6f72 2066 696c 655f         for file_
-0000bbe0: 7061 7468 2069 6e20 666f 756e 643a 0d0a  path in found:..
-0000bbf0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0000bc00: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
-0000bc10: 2020 2020 2243 6f6c 6c65 6374 6564 2022      "Collected "
-0000bc20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000bc30: 2020 2b20 6f73 2e70 6174 682e 6261 7365    + os.path.base
-0000bc40: 6e61 6d65 2866 696c 655f 7061 7468 290d  name(file_path).
-0000bc50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bc60: 202b 2022 2066 726f 6d20 220d 0a20 2020   + " from "..   
-0000bc70: 2020 2020 2020 2020 2020 2020 202b 206f               + o
-0000bc80: 732e 7061 7468 2e62 6173 656e 616d 6528  s.path.basename(
-0000bc90: 6f73 2e70 6174 682e 6469 726e 616d 6528  os.path.dirname(
-0000bca0: 6669 6c65 5f70 6174 6829 290d 0a20 2020  file_path))..   
-0000bcb0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-0000bcc0: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-0000bcd0: 203d 2028 0d0a 2020 2020 2020 2020 2020   = (..          
-0000bce0: 2020 2020 2020 6f73 2e70 6174 682e 6261        os.path.ba
-0000bcf0: 7365 6e61 6d65 286f 732e 7061 7468 2e64  sename(os.path.d
-0000bd00: 6972 6e61 6d65 2866 696c 655f 7061 7468  irname(file_path
-0000bd10: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-0000bd20: 2020 2020 2b20 225f 220d 0a20 2020 2020      + "_"..     
-0000bd30: 2020 2020 2020 2020 2020 202b 206f 732e             + os.
-0000bd40: 7061 7468 2e62 6173 656e 616d 6528 6669  path.basename(fi
-0000bd50: 6c65 5f70 6174 6829 0d0a 2020 2020 2020  le_path)..      
-0000bd60: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-0000bd70: 2020 2020 2070 6174 6820 3d20 6f73 2e70       path = os.p
-0000bd80: 6174 682e 6a6f 696e 2872 6573 756c 7473  ath.join(results
-0000bd90: 5f70 6174 682c 2066 696c 656e 616d 6529  _path, filename)
-0000bda0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0000bdb0: 2323 206f 7665 7277 7269 7465 2063 6865  ## overwrite che
-0000bdc0: 636b 0d0a 2020 2020 2020 2020 2020 2020  ck..            
-0000bdd0: 7768 696c 6520 5472 7565 3a0d 0a20 2020  while True:..   
-0000bde0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000bdf0: 6f73 2e70 6174 682e 6973 6669 6c65 2870  os.path.isfile(p
-0000be00: 6174 6829 2061 6e64 2066 6c61 6773 2e6f  ath) and flags.o
-0000be10: 7665 7277 7269 7465 203d 3d20 4661 6c73  verwrite == Fals
-0000be20: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000be30: 2020 2020 2020 2020 7072 696e 7428 0d0a          print(..
-0000be40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be50: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-0000be60: 202b 2022 206e 6f74 2073 6176 6564 202d   + " not saved -
-0000be70: 2066 696c 6520 616c 7265 6164 7920 6578   file already ex
-0000be80: 6973 7473 2028 6f76 6572 7772 6974 653d  ists (overwrite=
-0000be90: 4661 6c73 6529 2e22 0d0a 2020 2020 2020  False)."..      
-0000bea0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-0000beb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bec0: 2020 2020 2062 7265 616b 0d0a 2020 2020       break..    
-0000bed0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000bee0: 206f 732e 7061 7468 2e69 7366 696c 6528   os.path.isfile(
-0000bef0: 7061 7468 2920 616e 6420 666c 6167 732e  path) and flags.
-0000bf00: 6f76 6572 7772 6974 6520 3d3d 2054 7275  overwrite == Tru
-0000bf10: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000bf20: 2020 2020 2020 2020 7072 696e 7428 6669          print(fi
-0000bf30: 6c65 6e61 6d65 202b 2022 2073 6176 6564  lename + " saved
-0000bf40: 2075 6e64 6572 2022 202b 2070 6174 6820   under " + path 
-0000bf50: 2b20 2220 286f 7665 7277 7269 7474 656e  + " (overwritten
-0000bf60: 292e 2229 0d0a 2020 2020 2020 2020 2020  ).")..          
-0000bf70: 2020 2020 2020 2020 2020 7061 7373 0d0a            pass..
-0000bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf90: 656c 6966 206e 6f74 206f 732e 7061 7468  elif not os.path
-0000bfa0: 2e69 7366 696c 6528 7061 7468 293a 0d0a  .isfile(path):..
-0000bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bfc0: 2020 2020 7072 696e 7428 6669 6c65 6e61      print(filena
-0000bfd0: 6d65 202b 2022 2073 6176 6564 2075 6e64  me + " saved und
-0000bfe0: 6572 2022 202b 2070 6174 6820 2b20 222e  er " + path + ".
-0000bff0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-0000c000: 2020 2020 2020 2020 7061 7373 0d0a 2020          pass..  
-0000c010: 2020 2020 2020 2020 2020 2020 2020 7368                sh
-0000c020: 7574 696c 2e63 6f70 7966 696c 6528 6669  util.copyfile(fi
-0000c030: 6c65 5f70 6174 682c 2070 6174 6829 0d0a  le_path, path)..
-0000c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c050: 6272 6561 6b0d 0a20 2020 2020 2020 2020  break..         
-0000c060: 2020 200d 0a20 2020 2064 6566 2063 6f70     ..    def cop
-0000c070: 795f 7461 6728 0d0a 2020 2020 2020 2020  y_tag(..        
-0000c080: 2020 2020 7365 6c66 2c20 0d0a 2020 2020      self, ..    
-0000c090: 2020 2020 2020 2020 7461 675f 7372 632c          tag_src,
-0000c0a0: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
-0000c0b0: 6167 5f64 7374 2c20 0d0a 2020 2020 2020  ag_dst, ..      
-0000c0c0: 2020 2020 2020 636f 7079 5f61 6e6e 6f74        copy_annot
-0000c0d0: 6174 696f 6e73 3d54 7275 652c 200d 0a20  ations=True, .. 
-0000c0e0: 2020 2020 2020 2020 2020 2063 6f70 795f             copy_
-0000c0f0: 636f 6e66 6967 3d54 7275 652c 0d0a 2020  config=True,..  
-0000c100: 2020 2020 2020 2020 2020 6f76 6572 7772            overwr
-0000c110: 6974 653d 4661 6c73 652c 200d 0a20 2020  ite=False, ..   
-0000c120: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-0000c130: 7329 3a0d 0a20 2020 2020 2020 2022 2222  s):..        """
-0000c140: 0d0a 2020 2020 2020 2020 4d61 6b65 2061  ..        Make a
-0000c150: 2063 6f70 7920 6f66 2064 6174 6120 6765   copy of data ge
-0000c160: 6e65 7261 7465 6420 756e 6465 7220 6120  nerated under a 
-0000c170: 7370 6563 6966 6963 2074 6167 2061 6e64  specific tag and
-0000c180: 2073 6176 6520 6974 2075 6e64 6572 2061   save it under a
-0000c190: 200d 0a20 2020 2020 2020 206e 6577 2074   ..        new t
-0000c1a0: 6167 202d 2065 2e67 2e3a 200d 0a20 2020  ag - e.g.: ..   
-0000c1b0: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
-0000c1c0: 696f 6e73 5f76 312e 6a73 6f6e 203d 3d3e  ions_v1.json ==>
-0000c1d0: 2061 6e6e 6f74 6174 696f 6e73 5f76 322e   annotations_v2.
-0000c1e0: 6a73 6f6e 0d0a 2020 2020 2020 2020 2020  json..          
-0000c1f0: 2020 7079 7065 5f63 6f6e 6669 675f 7631    pype_config_v1
-0000c200: 2e79 616d 6c20 3d3d 3e20 7079 7065 5f63  .yaml ==> pype_c
-0000c210: 6f6e 6669 675f 7632 2e79 616d 6c0d 0a0d  onfig_v2.yaml...
-0000c220: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0000c230: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0000c240: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000c250: 2074 6167 5f73 7263 203a 2073 7472 0d0a   tag_src : str..
-0000c260: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-0000c270: 206f 6620 7461 6720 746f 2062 6520 636f   of tag to be co
-0000c280: 7069 6564 2028 736f 7572 6365 2074 6167  pied (source tag
-0000c290: 290d 0a20 2020 2020 2020 2074 6167 5f64  )..        tag_d
-0000c2a0: 7374 203a 2073 7472 0d0a 2020 2020 2020  st : str..      
-0000c2b0: 2020 2020 2020 6e61 6d65 206f 6620 6e65        name of ne
-0000c2c0: 7720 7461 6720 2864 6573 7469 6e61 7469  w tag (destinati
-0000c2d0: 6f6e 2074 6167 290d 0a20 2020 2020 2020  on tag)..       
-0000c2e0: 2063 6f70 795f 616e 6e6f 7461 7469 6f6e   copy_annotation
-0000c2f0: 7320 3a20 626f 6f6c 2c20 6f70 7469 6f6e  s : bool, option
-0000c300: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-0000c310: 636f 7079 2061 6e6e 6f74 6174 696f 6e73  copy annotations
-0000c320: 2066 696c 652e 2054 6865 2064 6566 6175   file. The defau
-0000c330: 6c74 2069 7320 5472 7565 2e0d 0a20 2020  lt is True...   
-0000c340: 2020 2020 2063 6f70 795f 616e 6e6f 7461       copy_annota
-0000c350: 7469 6f6e 7320 3a20 626f 6f6c 2c20 6f70  tions : bool, op
-0000c360: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0000c370: 2020 2020 636f 7079 2063 6f6e 6669 6720      copy config 
-0000c380: 6669 6c65 2e20 5468 6520 6465 6661 756c  file. The defaul
-0000c390: 7420 6973 2054 7275 652e 0d0a 2020 2020  t is True...    
-0000c3a0: 2020 2020 6f76 6572 7772 6974 6520 3a20      overwrite : 
-0000c3b0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-0000c3c0: 2020 2020 2020 2020 2020 2020 206f 7665               ove
-0000c3d0: 7277 7269 7465 7320 6966 2074 6167 2065  rwrites if tag e
-0000c3e0: 7869 7374 732e 2054 6865 2064 6566 6175  xists. The defau
-0000c3f0: 6c74 2069 7320 4661 6c73 652e 0d0a 2020  lt is False...  
-0000c400: 2020 2020 2020 6b77 6172 6773 3a20 0d0a        kwargs: ..
-0000c410: 2020 2020 2020 2020 2020 2020 6465 7665              deve
-0000c420: 6c6f 7065 7220 6f70 7469 6f6e 730d 0a0d  loper options...
-0000c430: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000c440: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000c450: 2d0d 0a20 2020 2020 2020 204e 6f6e 652e  -..        None.
-0000c460: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-0000c470: 0a20 2020 0d0a 2020 2020 2020 2020 2323  .   ..        ##
-0000c480: 2067 6f20 7468 726f 7567 6820 7072 6f6a   go through proj
-0000c490: 6563 7420 6469 7265 6374 6f72 6965 730d  ect directories.
-0000c4a0: 0a20 2020 2020 2020 2066 6f72 2064 6972  .        for dir
-0000c4b0: 6563 746f 7279 2069 6e20 7365 6c66 2e64  ectory in self.d
-0000c4c0: 6972 5f70 6174 6873 3a0d 0a20 2020 2020  ir_paths:..     
-0000c4d0: 2020 2020 2020 2064 6972 5f6e 616d 6520         dir_name 
-0000c4e0: 3d20 6f73 2e70 6174 682e 6261 7365 6e61  = os.path.basena
-0000c4f0: 6d65 2864 6972 6563 746f 7279 290d 0a0d  me(directory)...
-0000c500: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000c510: 636f 7079 5f61 6e6e 6f74 6174 696f 6e73  copy_annotations
-0000c520: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000c530: 2020 2061 6e6e 6f74 6174 696f 6e73 5f70     annotations_p
-0000c540: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
-0000c550: 696e 280d 0a20 2020 2020 2020 2020 2020  in(..           
-0000c560: 2020 2020 2020 2020 2073 656c 662e 726f           self.ro
-0000c570: 6f74 5f64 6972 2c20 2264 6174 6122 2c20  ot_dir, "data", 
-0000c580: 6469 725f 6e61 6d65 2c20 2261 6e6e 6f74  dir_name, "annot
-0000c590: 6174 696f 6e73 5f22 202b 2074 6167 5f73  ations_" + tag_s
-0000c5a0: 7263 202b 2022 2e6a 736f 6e22 0d0a 2020  rc + ".json"..  
-0000c5b0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-0000c5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c5d0: 206e 6577 5f61 6e6e 6f74 6174 696f 6e73   new_annotations
-0000c5e0: 5f70 6174 6820 3d20 6f73 2e70 6174 682e  _path = os.path.
-0000c5f0: 6a6f 696e 280d 0a20 2020 2020 2020 2020  join(..         
-0000c600: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000c610: 726f 6f74 5f64 6972 2c20 2264 6174 6122  root_dir, "data"
-0000c620: 2c20 6469 725f 6e61 6d65 2c20 2261 6e6e  , dir_name, "ann
-0000c630: 6f74 6174 696f 6e73 5f22 202b 2074 6167  otations_" + tag
-0000c640: 5f64 7374 202b 2022 2e6a 736f 6e22 0d0a  _dst + ".json"..
-0000c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c660: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000c670: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000c680: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
-0000c690: 6973 6669 6c65 2861 6e6e 6f74 6174 696f  isfile(annotatio
-0000c6a0: 6e73 5f70 6174 6829 3a20 0d0a 2020 2020  ns_path): ..    
-0000c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c6c0: 6966 2075 7469 6c73 5f6c 6f77 6c65 7665  if utils_lowleve
-0000c6d0: 6c2e 5f6f 7665 7277 7269 7465 5f63 6865  l._overwrite_che
-0000c6e0: 636b 5f66 696c 6528 6e65 775f 616e 6e6f  ck_file(new_anno
-0000c6f0: 7461 7469 6f6e 735f 7061 7468 2c20 6f76  tations_path, ov
-0000c700: 6572 7772 6974 6529 3a0d 0a20 2020 2020  erwrite):..     
-0000c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c720: 2020 2073 6875 7469 6c2e 636f 7079 6669     shutil.copyfi
-0000c730: 6c65 2861 6e6e 6f74 6174 696f 6e73 5f70  le(annotations_p
-0000c740: 6174 682c 206e 6577 5f61 6e6e 6f74 6174  ath, new_annotat
-0000c750: 696f 6e73 5f70 6174 6829 0d0a 2020 2020  ions_path)..    
-0000c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c770: 2020 2020 7072 696e 7428 2243 6f70 7920      print("Copy 
-0000c780: 616e 6e6f 7461 7469 6f6e 7320 666f 7220  annotations for 
-0000c790: 7b7d 222e 666f 726d 6174 2864 6972 5f6e  {}".format(dir_n
-0000c7a0: 616d 6529 290d 0a20 2020 2020 2020 2020  ame))..         
-0000c7b0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0000c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7d0: 2020 7072 696e 7428 224d 6973 7369 6e67    print("Missing
-0000c7e0: 2061 6e6e 6f74 6174 696f 6e73 2066 6f72   annotations for
-0000c7f0: 207b 7d20 2d20 736b 6970 7069 6e67 222e   {} - skipping".
-0000c800: 666f 726d 6174 2864 6972 5f6e 616d 6529  format(dir_name)
-0000c810: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000c820: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000c830: 2020 2020 2020 2069 6620 636f 7079 5f63         if copy_c
-0000c840: 6f6e 6669 673a 0d0a 2020 2020 2020 2020  onfig:..        
-0000c850: 2020 2020 2020 2020 636f 6e66 6967 5f70          config_p
-0000c860: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
-0000c870: 696e 280d 0a20 2020 2020 2020 2020 2020  in(..           
-0000c880: 2020 2020 2020 2020 2073 656c 662e 726f           self.ro
-0000c890: 6f74 5f64 6972 2c20 2264 6174 6122 2c20  ot_dir, "data", 
-0000c8a0: 6469 725f 6e61 6d65 2c20 2270 7970 655f  dir_name, "pype_
-0000c8b0: 636f 6e66 6967 5f22 202b 2074 6167 5f73  config_" + tag_s
-0000c8c0: 7263 202b 2022 2e79 616d 6c22 0d0a 2020  rc + ".yaml"..  
-0000c8d0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-0000c8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c8f0: 206e 6577 5f63 6f6e 6669 675f 7061 7468   new_config_path
-0000c900: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-0000c910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c920: 2020 2020 2020 7365 6c66 2e72 6f6f 745f        self.root_
-0000c930: 6469 722c 2022 6461 7461 222c 2064 6972  dir, "data", dir
-0000c940: 5f6e 616d 652c 2022 7079 7065 5f63 6f6e  _name, "pype_con
-0000c950: 6669 675f 2220 2b20 7461 675f 6473 7420  fig_" + tag_dst 
-0000c960: 2b20 222e 7961 6d6c 220d 0a20 2020 2020  + ".yaml"..     
-0000c970: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-0000c980: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0000c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c9a0: 6966 206f 732e 7061 7468 2e69 7366 696c  if os.path.isfil
-0000c9b0: 6528 636f 6e66 6967 5f70 6174 6829 3a20  e(config_path): 
-0000c9c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c9d0: 2020 2020 2020 6966 2075 7469 6c73 5f6c        if utils_l
-0000c9e0: 6f77 6c65 7665 6c2e 5f6f 7665 7277 7269  owlevel._overwri
-0000c9f0: 7465 5f63 6865 636b 5f66 696c 6528 6e65  te_check_file(ne
-0000ca00: 775f 636f 6e66 6967 5f70 6174 682c 206f  w_config_path, o
-0000ca10: 7665 7277 7269 7465 293a 0d0a 2020 2020  verwrite):..    
-0000ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca30: 2020 2020 7368 7574 696c 2e63 6f70 7966      shutil.copyf
-0000ca40: 696c 6528 636f 6e66 6967 5f70 6174 682c  ile(config_path,
-0000ca50: 206e 6577 5f63 6f6e 6669 675f 7061 7468   new_config_path
-0000ca60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000ca70: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0000ca80: 2822 436f 7079 2063 6f6e 6669 6720 666f  ("Copy config fo
-0000ca90: 7220 7b7d 222e 666f 726d 6174 2864 6972  r {}".format(dir
-0000caa0: 5f6e 616d 6529 290d 0a20 2020 2020 2020  _name))..       
-0000cab0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0000cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cad0: 2020 2020 7072 696e 7428 224d 6973 7369      print("Missi
-0000cae0: 6e67 2063 6f6e 6669 6720 666f 7220 7b7d  ng config for {}
-0000caf0: 202d 2073 6b69 7070 696e 6722 2e66 6f72   - skipping".for
-0000cb00: 6d61 7428 6469 725f 6e61 6d65 2929 0d0a  mat(dir_name))..
-0000cb10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000cb20: 2020 0d0a 2020 2020 6465 6620 6564 6974    ..    def edit
-0000cb30: 5f63 6f6e 6669 6728 7365 6c66 2c20 7461  _config(self, ta
-0000cb40: 672c 2074 6172 6765 742c 2072 6570 6c61  g, target, repla
-0000cb50: 6365 6d65 6e74 2c20 2a2a 6b77 6172 6773  cement, **kwargs
-0000cb60: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
-0000cb70: 0a20 2020 2020 2020 2041 6464 206f 7220  .        Add or 
-0000cb80: 6564 6974 2066 756e 6374 696f 6e73 2069  edit functions i
-0000cb90: 6e20 616c 6c20 636f 6e66 6967 7572 6174  n all configurat
-0000cba0: 696f 6e20 6669 6c65 7320 6f66 2061 2070  ion files of a p
-0000cbb0: 726f 6a65 6374 2e20 4669 6e64 7320 616e  roject. Finds an
-0000cbc0: 640d 0a20 2020 2020 2020 2072 6570 6c61  d..        repla
-0000cbd0: 6365 7320 7369 6e67 6c65 206f 7220 6d75  ces single or mu
-0000cbe0: 6c74 696c 696e 6520 7374 7269 6e67 2d70  ltiline string-p
-0000cbf0: 6174 7465 726e 732e 2049 6465 616c 6c79  atterns. Ideally
-0000cc00: 2074 6869 7320 6973 2064 6f6e 6520 7669   this is done vi
-0000cc10: 6120 0d0a 2020 2020 2020 2020 7079 7468  a ..        pyth
-0000cc20: 6f6e 2064 6f63 7374 7269 6e67 7320 7468  on docstrings th
-0000cc30: 6174 2072 6570 7265 7365 6e74 2074 6865  at represent the
-0000cc40: 2070 6172 7473 206f 6620 7468 6520 7961   parts of the ya
-0000cc50: 6d6c 2066 696c 6520 746f 2062 6520 7265  ml file to be re
-0000cc60: 706c 6163 6564 2e0d 0a20 2020 2020 2020  placed...       
-0000cc70: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000cc80: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0000cc90: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000cca0: 2d0d 0a0d 0a20 2020 2020 2020 2074 6167  -....        tag
-0000ccb0: 3a20 7374 720d 0a20 2020 2020 2020 2020  : str..         
-0000ccc0: 2020 2074 6167 2028 7375 6666 6978 2920     tag (suffix) 
-0000ccd0: 6f66 2063 6f6e 6669 672d 6669 6c65 2028  of config-file (
-0000cce0: 652e 672e 2022 7631 2220 696e 2022 7079  e.g. "v1" in "py
-0000ccf0: 7065 5f63 6f6e 6669 675f 7631 2e79 616d  pe_config_v1.yam
-0000cd00: 6c22 290d 0a20 2020 2020 2020 2074 6172  l")..        tar
-0000cd10: 6765 743a 2073 7472 0d0a 2020 2020 2020  get: str..      
-0000cd20: 2020 2020 2020 7374 7269 6e67 2070 6174        string pat
-0000cd30: 7465 726e 2074 6f20 6265 2072 6570 6c61  tern to be repla
-0000cd40: 6365 642e 2073 686f 756c 6420 6265 2069  ced. should be i
-0000cd50: 6e20 7472 6970 6c65 2d71 756f 7465 7320  n triple-quotes 
-0000cd60: 746f 2062 6520 6578 6163 740d 0a20 2020  to be exact..   
-0000cd70: 2020 2020 2072 6570 6c61 6365 6d65 6e74       replacement
-0000cd80: 3a20 7374 720d 0a20 2020 2020 2020 2020  : str..         
-0000cd90: 2020 2073 7472 696e 6720 7061 7474 6572     string patter
-0000cda0: 6e20 666f 7220 7265 706c 6163 656d 656e  n for replacemen
-0000cdb0: 742e 2073 686f 756c 6420 6265 2069 6e20  t. should be in 
-0000cdc0: 7472 6970 6c65 2d71 756f 7465 7320 746f  triple-quotes to
-0000cdd0: 2062 6520 6578 6163 740d 0a20 2020 2020   be exact..     
-0000cde0: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-0000cdf0: 2020 2323 2073 6574 7570 0d0a 2020 2020    ## setup..    
-0000ce00: 2020 2020 666c 6167 5f63 6865 636b 6564      flag_checked
-0000ce10: 203d 2046 616c 7365 0d0a 0d0a 2020 2020   = False....    
-0000ce20: 2020 2020 2323 2067 6f20 7468 726f 7567      ## go throug
-0000ce30: 6820 7072 6f6a 6563 7420 6469 7265 6374  h project direct
-0000ce40: 6f72 6965 730d 0a20 2020 2020 2020 2066  ories..        f
-0000ce50: 6f72 2064 6972 6563 746f 7279 2069 6e20  or directory in 
-0000ce60: 7365 6c66 2e64 6972 5f70 6174 6873 3a0d  self.dir_paths:.
-0000ce70: 0a20 2020 2020 2020 2020 2020 2064 6972  .            dir
-0000ce80: 5f6e 616d 6520 3d20 6f73 2e70 6174 682e  _name = os.path.
-0000ce90: 6261 7365 6e61 6d65 2864 6972 6563 746f  basename(directo
-0000cea0: 7279 290d 0a0d 0a20 2020 2020 2020 2020  ry)....         
-0000ceb0: 2020 2023 2320 6765 7420 636f 6e66 6967     ## get config
-0000cec0: 2070 6174 680d 0a20 2020 2020 2020 2020   path..         
-0000ced0: 2020 2063 6f6e 6669 675f 7061 7468 203d     config_path =
-0000cee0: 206f 732e 7061 7468 2e6a 6f69 6e28 0d0a   os.path.join(..
-0000cef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf00: 7365 6c66 2e72 6f6f 745f 6469 722c 2022  self.root_dir, "
-0000cf10: 6461 7461 222c 2064 6972 5f6e 616d 652c  data", dir_name,
-0000cf20: 2022 7079 7065 5f63 6f6e 6669 675f 2220   "pype_config_" 
-0000cf30: 2b20 7461 6720 2b20 222e 7961 6d6c 220d  + tag + ".yaml".
-0000cf40: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
-0000cf50: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0000cf60: 206f 7065 6e20 636f 6e66 6967 2d66 696c   open config-fil
-0000cf70: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
-0000cf80: 6620 6f73 2e70 6174 682e 6973 6669 6c65  f os.path.isfile
-0000cf90: 2863 6f6e 6669 675f 7061 7468 293a 0d0a  (config_path):..
-0000cfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cfb0: 7769 7468 206f 7065 6e28 636f 6e66 6967  with open(config
-0000cfc0: 5f70 6174 682c 2022 7222 2920 6173 2063  _path, "r") as c
-0000cfd0: 6f6e 6669 675f 7465 7874 3a0d 0a20 2020  onfig_text:..   
-0000cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cff0: 2063 6f6e 6669 675f 7374 7269 6e67 203d   config_string =
-0000d000: 2063 6f6e 6669 675f 7465 7874 2e72 6561   config_text.rea
-0000d010: 6428 290d 0a20 2020 2020 2020 2020 2020  d()..           
-0000d020: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0000d030: 2020 2020 2020 2020 7072 696e 7428 2244          print("D
-0000d040: 6964 206e 6f74 2066 696e 6420 636f 6e66  id not find conf
-0000d050: 6967 2066 696c 6520 746f 2065 6469 7420  ig file to edit 
-0000d060: 2d20 6368 6563 6b20 7072 6f76 6964 6564  - check provided
-0000d070: 2074 6167 2f73 7566 6669 782e 2229 0d0a   tag/suffix.")..
-0000d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d090: 7265 7475 726e 0d0a 2020 2020 2020 2020  return..        
-0000d0a0: 2020 2020 2323 2073 7472 696e 6720 7265      ## string re
-0000d0b0: 706c 6163 656d 656e 740d 0a20 2020 2020  placement..     
-0000d0c0: 2020 2020 2020 206e 6577 5f63 6f6e 6669         new_confi
-0000d0d0: 675f 7374 7269 6e67 203d 2063 6f6e 6669  g_string = confi
-0000d0e0: 675f 7374 7269 6e67 2e72 6570 6c61 6365  g_string.replace
-0000d0f0: 2874 6172 6765 742c 2072 6570 6c61 6365  (target, replace
-0000d100: 6d65 6e74 290d 0a0d 0a20 2020 2020 2020  ment)....       
-0000d110: 2020 2020 2023 2320 7368 6f77 2075 7365       ## show use
-0000d120: 7220 7265 706c 6163 656d 656e 742d 7265  r replacement-re
-0000d130: 7375 6c74 2061 6e64 2061 736b 2066 6f72  sult and ask for
-0000d140: 2063 6f6e 6669 726d 6174 696f 6e0d 0a20   confirmation.. 
-0000d150: 2020 2020 2020 2020 2020 2069 6620 666c             if fl
-0000d160: 6167 5f63 6865 636b 6564 203d 3d20 4661  ag_checked == Fa
-0000d170: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0000d180: 2020 2020 2020 7072 696e 7428 6e65 775f        print(new_
-0000d190: 636f 6e66 6967 5f73 7472 696e 6729 0d0a  config_string)..
-0000d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1b0: 6368 6563 6b20 3d20 696e 7075 7428 0d0a  check = input(..
-0000d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1d0: 2020 2020 2254 6869 7320 6973 2077 6861      "This is wha
-0000d1e0: 7420 7468 6520 6e65 7720 636f 6e66 6967  t the new config
-0000d1f0: 206d 6179 206c 6f6f 6b20 6c69 6b65 2028   may look like (
-0000d200: 6361 6e20 6469 6666 6572 2062 6574 6565  can differ betee
-0000d210: 656e 2066 696c 6573 2920 2d20 7072 6f63  en files) - proc
-0000d220: 6565 643f 220d 0a20 2020 2020 2020 2020  eed?"..         
-0000d230: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
-0000d240: 2020 2020 2020 2020 2323 2072 6570 6c61          ## repla
-0000d250: 6365 2066 6f72 2061 6c6c 2063 6f6e 6669  ce for all confi
-0000d260: 6720 6669 6c65 7320 6166 7465 7220 706f  g files after po
-0000d270: 7369 7469 7665 2075 7365 7220 6368 6563  sitive user chec
-0000d280: 6b0d 0a20 2020 2020 2020 2020 2020 2069  k..            i
-0000d290: 6620 6368 6563 6b20 696e 2073 6574 7469  f check in setti
-0000d2a0: 6e67 732e 636f 6e66 6972 6d5f 6f70 7469  ngs.confirm_opti
-0000d2b0: 6f6e 733a 0d0a 2020 2020 2020 2020 2020  ons:..          
-0000d2c0: 2020 2020 2020 666c 6167 5f63 6865 636b        flag_check
-0000d2d0: 6564 203d 2054 7275 650d 0a20 2020 2020  ed = True..     
-0000d2e0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-0000d2f0: 6f70 656e 2863 6f6e 6669 675f 7061 7468  open(config_path
-0000d300: 2c20 2277 2229 2061 7320 636f 6e66 6967  , "w") as config
-0000d310: 5f74 6578 743a 0d0a 2020 2020 2020 2020  _text:..        
-0000d320: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-0000d330: 6967 5f74 6578 742e 7772 6974 6528 6e65  ig_text.write(ne
-0000d340: 775f 636f 6e66 6967 5f73 7472 696e 6729  w_config_string)
-0000d350: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0000d360: 2020 2020 7072 696e 7428 224e 6577 2063      print("New c
-0000d370: 6f6e 6669 6720 7361 7665 6420 666f 7220  onfig saved for 
-0000d380: 2220 2b20 6469 725f 6e61 6d65 290d 0a20  " + dir_name).. 
-0000d390: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000d3a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d3b0: 2020 7072 696e 7428 2255 7365 7220 6368    print("User ch
-0000d3c0: 6563 6b20 6661 696c 6564 202d 2061 626f  eck failed - abo
-0000d3d0: 7274 696e 672e 2229 0d0a 2020 2020 2020  rting.")..      
-0000d3e0: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
-0000d3f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d400: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000d410: 2020 200d 0a0d 0a20 2020 2064 6566 2065     ....    def e
-0000d420: 7870 6f72 745f 7a69 7028 0d0a 2020 2020  xport_zip(..    
-0000d430: 2020 2020 2020 2020 7365 6c66 2c20 0d0a          self, ..
-0000d440: 2020 2020 2020 2020 2020 2020 7461 673d              tag=
-0000d450: 4e6f 6e65 2c20 0d0a 2020 2020 2020 2020  None, ..        
-0000d460: 2020 2020 7265 7375 6c74 733d 4661 6c73      results=Fals
-0000d470: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-0000d480: 6d6f 6465 6c73 3d46 616c 7365 2c20 0d0a  models=False, ..
-0000d490: 2020 2020 2020 2020 2020 2020 696d 6167              imag
-0000d4a0: 6573 3d46 616c 7365 2c20 0d0a 2020 2020  es=False, ..    
-0000d4b0: 2020 2020 2020 2020 6578 706f 7274 733d          exports=
-0000d4c0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
-0000d4d0: 2020 2020 6f76 6572 7772 6974 653d 5472      overwrite=Tr
-0000d4e0: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
-0000d4f0: 202a 2a6b 7761 7267 730d 0a20 2020 2020   **kwargs..     
-0000d500: 2020 2020 2020 2029 3a0d 0a20 2020 2020         ):..     
-0000d510: 2020 2022 2222 0d0a 2020 2020 0d0a 2020     """..    ..  
-0000d520: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0000d530: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000d540: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7461  ----..        ta
-0000d550: 673a 2073 7472 2c20 6f70 7469 6f6e 616c  g: str, optional
-0000d560: 0d0a 2020 2020 2020 2020 2020 2020 4578  ..            Ex
-0000d570: 706f 7274 206f 6e6c 7920 6669 6c65 7320  port only files 
-0000d580: 6173 736f 6369 6174 6564 2077 6974 6820  associated with 
-0000d590: 6120 7370 6563 6966 6965 6420 7461 672e  a specified tag.
-0000d5a0: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
-0000d5b0: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2069  None...        i
-0000d5c0: 6d61 6765 7320 3a20 626f 6f6c 2c20 6f70  mages : bool, op
-0000d5d0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0000d5e0: 2020 2020 446f 6e27 7420 696e 636c 7564      Don't includ
-0000d5f0: 6520 696d 6167 6573 2066 726f 6d20 7468  e images from th
-0000d600: 6520 6461 7461 2066 6f6c 6465 722e 2054  e data folder. T
-0000d610: 6865 2064 6566 6175 6c74 2069 7320 5472  he default is Tr
-0000d620: 7565 2e0d 0a0d 0a20 2020 2020 2020 2052  ue.....        R
-0000d630: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-0000d640: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000d650: 204e 6f6e 652e 0d0a 0d0a 2020 2020 2020   None.....      
-0000d660: 2020 2222 220d 0a0d 0a0d 0a20 2020 2020    """......     
-0000d670: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000d680: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-0000d690: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-0000d6a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000d6b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000d6c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000d6d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-0000d6e0: 2020 2020 2020 2020 2320 7365 7475 700d          # setup.
-0000d6f0: 0a0d 0a20 2020 2020 2020 2023 2320 7365  ...        ## se
-0000d700: 7420 666c 6167 730d 0a20 2020 2020 2020  t flags..       
-0000d710: 2066 6c61 6773 203d 206d 616b 655f 6461   flags = make_da
-0000d720: 7461 636c 6173 7328 0d0a 2020 2020 2020  taclass(..      
-0000d730: 2020 2020 2020 636c 735f 6e61 6d65 3d22        cls_name="
-0000d740: 666c 6167 7322 2c0d 0a20 2020 2020 2020  flags",..       
-0000d750: 2020 2020 2066 6965 6c64 733d 5b0d 0a20       fields=[.. 
-0000d760: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0000d770: 2274 6167 222c 2073 7472 2c20 7461 6729  "tag", str, tag)
-0000d780: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0000d790: 2020 2020 2822 7265 7375 6c74 7322 2c20      ("results", 
-0000d7a0: 626f 6f6c 2c20 7265 7375 6c74 7329 2c0d  bool, results),.
-0000d7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d7c0: 2028 226d 6f64 656c 7322 2c20 626f 6f6c   ("models", bool
-0000d7d0: 2c20 6d6f 6465 6c73 292c 0d0a 2020 2020  , models),..    
-0000d7e0: 2020 2020 2020 2020 2020 2020 2822 696d              ("im
-0000d7f0: 6167 6573 222c 2062 6f6f 6c2c 2069 6d61  ages", bool, ima
-0000d800: 6765 7329 2c0d 0a20 2020 2020 2020 2020  ges),..         
-0000d810: 2020 2020 2020 2028 2265 7870 6f72 7473         ("exports
-0000d820: 222c 2062 6f6f 6c2c 2065 7870 6f72 7473  ", bool, exports
-0000d830: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0000d840: 2020 2020 2822 6f76 6572 7772 6974 6522      ("overwrite"
-0000d850: 2c20 626f 6f6c 2c20 6f76 6572 7772 6974  , bool, overwrit
-0000d860: 6529 2c0d 0a20 2020 2020 2020 2020 2020  e),..           
-0000d870: 2020 2020 205d 2c0d 0a20 2020 2020 2020       ],..       
-0000d880: 2029 0d0a 0d0a 2020 2020 2020 2020 6966   )....        if
-0000d890: 206b 7761 7267 732e 6765 7428 2273 6176   kwargs.get("sav
-0000d8a0: 655f 7375 6666 6978 2229 3a0d 0a20 2020  e_suffix"):..   
-0000d8b0: 2020 2020 2020 2020 2073 6176 655f 7375           save_su
-0000d8c0: 6666 6978 203d 2022 5f22 202b 206b 7761  ffix = "_" + kwa
-0000d8d0: 7267 732e 6765 7428 2273 6176 655f 7375  rgs.get("save_su
-0000d8e0: 6666 6978 2229 0d0a 2020 2020 2020 2020  ffix")..        
-0000d8f0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000d900: 2020 2073 6176 655f 7375 6666 6978 203d     save_suffix =
-0000d910: 2022 220d 0a20 2020 2020 2020 2020 2020   ""..           
-0000d920: 200d 0a20 2020 2020 2020 2023 2320 636f   ..        ## co
-0000d930: 6e73 7472 7563 7420 7361 7665 2070 6174  nstruct save pat
-0000d940: 680d 0a20 2020 2020 2020 2072 6f6f 745f  h..        root_
-0000d950: 6469 7220 3d20 6f73 2e70 6174 682e 6261  dir = os.path.ba
-0000d960: 7365 6e61 6d65 2873 656c 662e 726f 6f74  sename(self.root
-0000d970: 5f64 6972 2920 0d0a 2020 2020 2020 2020  _dir) ..        
-0000d980: 7361 7665 5f70 6174 6820 3d20 6f73 2e70  save_path = os.p
-0000d990: 6174 682e 6a6f 696e 2873 656c 662e 726f  ath.join(self.ro
-0000d9a0: 6f74 5f64 6972 2c20 726f 6f74 5f64 6972  ot_dir, root_dir
-0000d9b0: 202b 2073 6176 655f 7375 6666 6978 202b   + save_suffix +
-0000d9c0: 2022 2e7a 6970 2229 0d0a 2020 2020 2020   ".zip")..      
-0000d9d0: 2020 0d0a 2020 2020 2020 2020 6966 206f    ..        if o
-0000d9e0: 732e 7061 7468 2e69 7366 696c 6528 7361  s.path.isfile(sa
-0000d9f0: 7665 5f70 6174 6829 2061 6e64 2066 6c61  ve_path) and fla
-0000da00: 6773 2e6f 7665 7277 7269 7465 3a0d 0a20  gs.overwrite:.. 
-0000da10: 2020 2020 2020 2020 2020 206f 732e 7265             os.re
-0000da20: 6d6f 7665 2873 6176 655f 7061 7468 290d  move(save_path).
-0000da30: 0a0d 0a20 2020 2020 2020 2023 203d 3d3d  ...        # ===
-0000da40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000da50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000da60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000da70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000da80: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
-0000da90: 2020 2020 2320 6578 6563 7574 650d 0a0d      # execute...
-0000daa0: 0a20 2020 2020 2020 2023 2320 7374 6172  .        ## star
-0000dab0: 7420 7a69 7020 7072 6f63 6573 730d 0a20  t zip process.. 
-0000dac0: 2020 2020 2020 2077 6974 6820 7a69 7066         with zipf
-0000dad0: 696c 652e 5a69 7046 696c 6528 7361 7665  ile.ZipFile(save
-0000dae0: 5f70 6174 682c 2022 7722 2c20 7a69 7066  _path, "w", zipf
-0000daf0: 696c 652e 5a49 505f 4445 464c 4154 4544  ile.ZIP_DEFLATED
-0000db00: 2920 6173 207a 6970 3a0d 0a20 2020 200d  ) as zip:..    .
-0000db10: 0a20 2020 2020 2020 2020 2020 2023 2320  .            ## 
-0000db20: 7072 6f6a 6563 7420 726f 6f74 2064 6972  project root dir
-0000db30: 0d0a 2020 2020 2020 2020 2020 2020 7a69  ..            zi
-0000db40: 702e 7772 6974 6528 6f73 2e70 6174 682e  p.write(os.path.
-0000db50: 6a6f 696e 2873 656c 662e 726f 6f74 5f64  join(self.root_d
-0000db60: 6972 292c 2072 6f6f 745f 6469 7229 2020  ir), root_dir)  
-0000db70: 2020 0d0a 2020 2020 0d0a 2020 2020 2020    ..    ..      
-0000db80: 2020 2020 2020 2323 2070 726f 6a65 6374        ## project
-0000db90: 2061 7474 7269 6275 7465 730d 0a20 2020   attributes..   
-0000dba0: 2020 2020 2020 2020 207a 6970 2e77 7269           zip.wri
-0000dbb0: 7465 280d 0a20 2020 2020 2020 2020 2020  te(..           
-0000dbc0: 2020 2020 206f 732e 7061 7468 2e6a 6f69       os.path.joi
-0000dbd0: 6e28 7365 6c66 2e72 6f6f 745f 6469 722c  n(self.root_dir,
-0000dbe0: 2022 6174 7472 6962 7574 6573 2e79 616d   "attributes.yam
-0000dbf0: 6c22 292c 200d 0a20 2020 2020 2020 2020  l"), ..         
-0000dc00: 2020 2020 2020 206f 732e 7061 7468 2e6a         os.path.j
-0000dc10: 6f69 6e28 726f 6f74 5f64 6972 2c20 2261  oin(root_dir, "a
-0000dc20: 7474 7269 6275 7465 732e 7961 6d6c 2229  ttributes.yaml")
-0000dc30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000dc40: 2020 2920 2020 200d 0a20 2020 2020 2020    )    ..       
-0000dc50: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000dc60: 2020 2023 2320 6461 7461 2066 6f6c 6465     ## data folde
-0000dc70: 720d 0a20 2020 2020 2020 2020 2020 2064  r..            d
-0000dc80: 6174 615f 6469 725f 6162 7370 6174 6820  ata_dir_abspath 
-0000dc90: 3d20 6f73 2e70 6174 682e 6a6f 696e 2873  = os.path.join(s
-0000dca0: 656c 662e 726f 6f74 5f64 6972 2c20 2264  elf.root_dir, "d
-0000dcb0: 6174 6122 2920 2020 2020 2020 0d0a 2020  ata")       ..  
-0000dcc0: 2020 2020 2020 2020 2020 6461 7461 5f64            data_d
-0000dcd0: 6972 5f72 656c 7061 7468 203d 206f 732e  ir_relpath = os.
-0000dce0: 7061 7468 2e6a 6f69 6e28 726f 6f74 5f64  path.join(root_d
-0000dcf0: 6972 2c20 2264 6174 6122 2920 2020 2020  ir, "data")     
-0000dd00: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000dd10: 7a69 702e 7772 6974 6528 6461 7461 5f64  zip.write(data_d
-0000dd20: 6972 5f61 6273 7061 7468 2c20 6461 7461  ir_abspath, data
-0000dd30: 5f64 6972 5f72 656c 7061 7468 2920 2020  _dir_relpath)   
-0000dd40: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-0000dd50: 0a20 2020 2020 2020 2020 2020 2023 2320  .            ## 
-0000dd60: 6c6f 6f70 2074 6872 6f70 7567 6820 6461  loop thropugh da
-0000dd70: 7461 2066 6f6c 6465 7220 2020 2020 2020  ta folder       
-0000dd80: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000dd90: 2020 2020 2020 666f 7220 666f 6c64 6572        for folder
-0000dda0: 2069 6e20 6f73 2e6c 6973 7464 6972 2864   in os.listdir(d
-0000ddb0: 6174 615f 6469 725f 6162 7370 6174 6829  ata_dir_abspath)
-0000ddc0: 3a0d 0a20 2020 200d 0a20 2020 2020 2020  :..    ..       
-0000ddd0: 2020 2020 2020 2020 2066 6f6c 6465 725f           folder_
-0000dde0: 6162 7370 6174 6820 3d20 6f73 2e70 6174  abspath = os.pat
-0000ddf0: 682e 6a6f 696e 2864 6174 615f 6469 725f  h.join(data_dir_
-0000de00: 6162 7370 6174 682c 2066 6f6c 6465 7229  abspath, folder)
-0000de10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000de20: 2020 666f 6c64 6572 5f72 656c 7061 7468    folder_relpath
-0000de30: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-0000de40: 6461 7461 5f64 6972 5f72 656c 7061 7468  data_dir_relpath
-0000de50: 2c20 666f 6c64 6572 290d 0a20 2020 2020  , folder)..     
-0000de60: 2020 2020 2020 2020 2020 207a 6970 2e77             zip.w
-0000de70: 7269 7465 2866 6f6c 6465 725f 6162 7370  rite(folder_absp
-0000de80: 6174 682c 2066 6f6c 6465 725f 7265 6c70  ath, folder_relp
-0000de90: 6174 6829 2020 2020 2020 2020 2020 2020  ath)            
-0000dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000deb0: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-0000dec0: 2020 2020 2020 2020 666f 7220 6669 6c65          for file
-0000ded0: 2069 6e20 6f73 2e6c 6973 7464 6972 2866   in os.listdir(f
-0000dee0: 6f6c 6465 725f 6162 7370 6174 6829 3a0d  older_abspath):.
-0000def0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000df00: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000df10: 2020 2020 2020 2020 2020 2066 696c 655f             file_
-0000df20: 6e61 6d65 2c20 6669 6c65 5f65 7874 2020  name, file_ext  
-0000df30: 3d20 6f73 2e70 6174 682e 7370 6c69 7465  = os.path.splite
-0000df40: 7874 2866 696c 6529 0d0a 2020 2020 2020  xt(file)..      
-0000df50: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0000df60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df70: 2020 2020 6966 206e 6f74 2066 696c 6520      if not file 
-0000df80: 696e 205b 2261 7474 7269 6275 7465 732e  in ["attributes.
-0000df90: 7961 6d6c 225d 3a0d 0a20 2020 2020 2020  yaml"]:..       
-0000dfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dfb0: 2069 6620 6e6f 7420 666c 6167 732e 7461   if not flags.ta
-0000dfc0: 672e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  g.__class__.__na
-0000dfd0: 6d65 5f5f 203d 3d20 224e 6f6e 6554 7970  me__ == "NoneTyp
-0000dfe0: 6522 3a0d 0a20 2020 2020 2020 2020 2020  e":..           
-0000dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e000: 2074 6573 745f 7061 7474 6572 6e20 3d20   test_pattern = 
-0000e010: 6669 6c65 5f6e 616d 655b 2d6c 656e 2866  file_name[-len(f
-0000e020: 6c61 6773 2e74 6167 293a 6c65 6e28 6669  lags.tag):len(fi
-0000e030: 6c65 5f6e 616d 6529 5d0d 0a20 2020 2020  le_name)]..     
-0000e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e050: 2020 2020 2020 2069 6620 6e6f 7420 666c         if not fl
-0000e060: 6167 732e 7461 6720 3d3d 2074 6573 745f  ags.tag == test_
-0000e070: 7061 7474 6572 6e3a 0d0a 2020 2020 2020  pattern:..      
-0000e080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e090: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-0000e0a0: 7565 2020 2020 2020 2020 0d0a 2020 2020  ue        ..    
-0000e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0c0: 2020 2020 6966 2066 696c 655f 6578 742e      if file_ext.
-0000e0d0: 7374 7269 7028 222e 2229 2069 6e20 7365  strip(".") in se
-0000e0e0: 7474 696e 6773 2e64 6566 6175 6c74 5f66  ttings.default_f
-0000e0f0: 696c 6574 7970 6573 3a0d 0a20 2020 2020  iletypes:..     
-0000e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e110: 2020 2020 2020 2069 6620 6e6f 7420 666c         if not fl
-0000e120: 6167 732e 696d 6167 6573 3a0d 0a20 2020  ags.images:..   
-0000e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e140: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-0000e150: 7469 6e75 650d 0a20 2020 2020 2020 2020  tinue..         
-0000e160: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000e170: 6620 6669 6c65 5f65 7874 2e73 7472 6970  f file_ext.strip
-0000e180: 2822 2e22 2920 3d3d 2022 6373 7622 2061  (".") == "csv" a
-0000e190: 6e64 2066 6c61 6773 2e65 7870 6f72 7473  nd flags.exports
-0000e1a0: 203d 3d20 4661 6c73 653a 0d0a 2020 2020   == False:..    
-0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e1c0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-0000e1d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000063d0: 2020 2020 2041 6464 2061 2064 6565 7020       Add a deep 
+000063e0: 6c65 6172 6e69 6e67 206d 6f64 656c 2e20  learning model. 
+000063f0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00006400: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00006410: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 2020  ----------....  
+00006420: 2020 2020 2020 6163 7469 7661 7465 3a20        activate: 
+00006430: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
+00006440: 2020 2020 2020 2020 2020 2020 7772 6974              writ
+00006450: 6573 2074 6865 2073 6574 7469 6e67 2066  es the setting f
+00006460: 6f72 2074 6865 2063 7572 7265 6e74 6c79  or the currently
+00006470: 2061 6374 6976 6520 7265 6665 7265 6e63   active referenc
+00006480: 6520 746f 2074 6865 2061 7474 7269 6275  e to the attribu
+00006490: 7465 7320 0d0a 2020 2020 2020 2020 2020  tes ..          
+000064a0: 2020 6669 6c65 7320 6f66 2061 6c6c 2064    files of all d
+000064b0: 6972 6563 746f 7269 6573 2077 6974 6869  irectories withi
+000064c0: 6e20 7468 6520 7072 6f6a 6563 742e 2063  n the project. c
+000064d0: 616e 2062 6520 7573 6564 2069 6e20 636f  an be used in co
+000064e0: 6e6a 756e 6374 696f 6e0d 0a20 2020 2020  njunction..     
+000064f0: 2020 2020 2020 2077 6974 6820 6f76 6572         with over
+00006500: 7772 6974 653d 4661 6c73 6520 736f 2074  write=False so t
+00006510: 6861 7420 7468 6520 6163 7475 616c 2072  hat the actual r
+00006520: 6566 6572 656e 6365 2072 656d 6169 6e73  eference remains
+00006530: 2075 6e63 6861 6e63 6564 2e20 7468 6973   unchanced. this
+00006540: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00006550: 7474 696e 6720 7573 6566 756c 2077 6865  tting useful whe
+00006560: 6e20 6d61 6e61 6769 6e67 206d 756c 7469  n managing multi
+00006570: 706c 6520 7265 6665 7265 6e63 6573 2070  ple references p
+00006580: 6572 2070 726f 6a65 6374 0d0a 2020 2020  er project..    
+00006590: 2020 2020 6f76 6572 7772 6974 653a 2062      overwrite: b
+000065a0: 6f6f 6c2c 206f 7074 696f 6e61 6c0d 0a20  ool, optional.. 
+000065b0: 2020 2020 2020 2020 2020 206f 7665 7277             overw
+000065c0: 7269 7465 206f 7074 696f 6e2c 2069 6620  rite option, if 
+000065d0: 6120 6769 7665 6e20 7079 7065 2063 6f6e  a given pype con
+000065e0: 6669 672d 6669 6c65 2061 6c72 6561 6479  fig-file already
+000065f0: 2065 7869 7374 0d0a 2020 2020 2020 2020   exist..        
+00006600: 7465 6d70 6c61 7465 3a20 626f 6f6c 2c20  template: bool, 
+00006610: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00006620: 2020 2020 2020 7368 6f75 6c64 2061 2074        should a t
+00006630: 656d 706c 6174 6520 666f 7220 7265 6665  emplate for refe
+00006640: 7265 6e63 6520 6465 7465 6374 696f 6e20  rence detection 
+00006650: 6265 2063 7265 6174 6564 2e20 7769 7468  be created. with
+00006660: 2061 6e20 6578 6973 7469 6e67 200d 0a20   an existing .. 
+00006670: 2020 2020 2020 2020 2020 2074 656d 706c             templ
+00006680: 6174 652c 2070 6865 6e6f 7079 7065 2063  ate, phenopype c
+00006690: 616e 2074 7279 2074 6f20 6669 6e64 2061  an try to find a
+000066a0: 2072 6566 6572 656e 6365 2063 6172 6420   reference card 
+000066b0: 696e 2061 2067 6976 656e 2069 6d61 6765  in a given image
+000066c0: 2c0d 0a20 2020 2020 2020 2020 2020 206d  ,..            m
+000066d0: 6561 7375 7265 2069 7473 2064 696d 656e  easure its dimen
+000066e0: 7369 6f6e 732c 2061 6e64 2061 646a 7573  sions, and adjus
+000066f0: 7420 7069 7865 6c2d 746f 2d6d 6d2d 7261  t pixel-to-mm-ra
+00006700: 7469 6f20 616e 6420 636f 6c6f 7572 2073  tio and colour s
+00006710: 7061 6365 0d0a 2020 2020 2020 2020 2222  pace..        ""
+00006720: 220d 0a20 2020 2020 2020 2023 203d 3d3d  "..        # ===
+00006730: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00006740: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00006750: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00006760: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00006770: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
+00006780: 2020 2020 2320 7365 7475 700d 0a0d 0a20      # setup.... 
+00006790: 2020 2020 2020 2023 2320 7365 7420 666c         ## set fl
+000067a0: 6167 730d 0a20 2020 2020 2020 2066 6c61  ags..        fla
+000067b0: 6773 203d 206d 616b 655f 6461 7461 636c  gs = make_datacl
+000067c0: 6173 7328 0d0a 2020 2020 2020 2020 2020  ass(..          
+000067d0: 2020 636c 735f 6e61 6d65 3d22 666c 6167    cls_name="flag
+000067e0: 7322 2c0d 0a20 2020 2020 2020 2020 2020  s",..           
+000067f0: 2066 6965 6c64 733d 5b0d 0a20 2020 2020   fields=[..     
+00006800: 2020 2020 2020 2020 2020 2028 226f 7665             ("ove
+00006810: 7277 7269 7465 222c 2062 6f6f 6c2c 206f  rwrite", bool, o
+00006820: 7665 7277 7269 7465 292c 200d 0a20 2020  verwrite), ..   
+00006830: 2020 2020 2020 2020 2020 2020 2028 2261               ("a
+00006840: 6374 6976 6174 6522 2c20 626f 6f6c 2c20  ctivate", bool, 
+00006850: 6163 7469 7661 7465 292c 0d0a 2020 2020  activate),..    
+00006860: 2020 2020 2020 2020 2020 2020 5d2c 0d0a              ],..
+00006870: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+00006880: 2020 2020 2070 7269 6e74 5f73 6176 655f       print_save_
+00006890: 6d73 6720 3d20 223d 3d20 6e6f 206d 7367  msg = "== no msg
+000068a0: 203d 3d22 0d0a 0d0a 0d0a 2020 2020 2020   =="......      
+000068b0: 2020 2323 206c 6f61 6420 7265 6665 7265    ## load refere
+000068c0: 6e63 6520 696d 6167 650d 0a20 2020 2020  nce image..     
+000068d0: 2020 2069 6620 6d6f 6465 6c5f 7061 7468     if model_path
+000068e0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
+000068f0: 655f 5f20 3d3d 2022 7374 7222 3a0d 0a20  e__ == "str":.. 
+00006900: 2020 2020 2020 2020 2020 2069 6620 6f73             if os
+00006910: 2e70 6174 682e 6973 6669 6c65 286d 6f64  .path.isfile(mod
+00006920: 656c 5f70 6174 6829 3a0d 0a20 2020 2020  el_path):..     
+00006930: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
+00006940: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00006950: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00006960: 2020 2020 7072 696e 7428 2244 6964 206e      print("Did n
+00006970: 6f74 2066 696e 6420 6d6f 6465 6c20 7b7d  ot find model {}
+00006980: 2e22 2e66 6f72 6d61 7428 6d6f 6465 6c5f  .".format(model_
+00006990: 7061 7468 2929 0d0a 2020 2020 2020 2020  path))..        
+000069a0: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
+000069b0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000069c0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000069d0: 2822 5772 6f6e 6720 696e 7075 7420 2d20  ("Wrong input - 
+000069e0: 6e65 6564 2070 6174 6820 746f 2061 2073  need path to a s
+000069f0: 6567 6d65 6e74 6174 696f 6e20 6d6f 6465  egmentation mode
+00006a00: 6c2e 2229 0d0a 2020 2020 2020 2020 2020  l.")..          
+00006a10: 2020 7265 7475 726e 0d0a 0d0a 2020 2020    return....    
+00006a20: 2020 2020 6d6f 6465 6c5f 666f 6c64 6572      model_folder
+00006a30: 5f70 6174 6820 3d20 6f73 2e70 6174 682e  _path = os.path.
+00006a40: 6a6f 696e 2873 656c 662e 726f 6f74 5f64  join(self.root_d
+00006a50: 6972 2c20 226d 6f64 656c 7322 290d 0a20  ir, "models").. 
+00006a60: 2020 2020 2020 2069 6620 6e6f 7420 6f73         if not os
+00006a70: 2e70 6174 682e 6973 6469 7228 6d6f 6465  .path.isdir(mode
+00006a80: 6c5f 666f 6c64 6572 5f70 6174 6829 3a0d  l_folder_path):.
+00006a90: 0a20 2020 2020 2020 2020 2020 206f 732e  .            os.
+00006aa0: 6d6b 6469 7228 6d6f 6465 6c5f 666f 6c64  mkdir(model_fold
+00006ab0: 6572 5f70 6174 6829 0d0a 2020 2020 2020  er_path)..      
+00006ac0: 2020 0d0a 2020 2020 2020 2020 7768 696c    ..        whil
+00006ad0: 6520 5472 7565 3a0d 0a0d 0a20 2020 2020  e True:....     
+00006ae0: 2020 2020 2020 2023 2320 6765 6e65 7261         ## genera
+00006af0: 7465 206d 6f64 656c 206e 616d 6520 616e  te model name an
+00006b00: 6420 6368 6563 6b20 6966 2065 7869 7374  d check if exist
+00006b10: 730d 0a20 2020 2020 2020 2020 2020 2070  s..            p
+00006b20: 6865 6e6f 7079 7065 5f6d 6f64 656c 5f6e  henopype_model_n
+00006b30: 616d 6520 3d20 226d 6f64 656c 5f22 202b  ame = "model_" +
+00006b40: 206d 6f64 656c 5f69 6420 2b20 6f73 2e70   model_id + os.p
+00006b50: 6174 682e 7370 6c69 7465 7874 286d 6f64  ath.splitext(mod
+00006b60: 656c 5f70 6174 6829 5b31 5d0d 0a20 2020  el_path)[1]..   
+00006b70: 2020 2020 2020 2020 2070 6865 6e6f 7079           phenopy
+00006b80: 7065 5f6d 6f64 656c 5f70 6174 6820 3d20  pe_model_path = 
+00006b90: 6f73 2e70 6174 682e 6a6f 696e 280d 0a20  os.path.join(.. 
+00006ba0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00006bb0: 6f64 656c 5f66 6f6c 6465 725f 7061 7468  odel_folder_path
+00006bc0: 2c20 7068 656e 6f70 7970 655f 6d6f 6465  , phenopype_mode
+00006bd0: 6c5f 6e61 6d65 0d0a 2020 2020 2020 2020  l_name..        
+00006be0: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
+00006bf0: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
+00006c00: 6973 6669 6c65 2870 6865 6e6f 7079 7065  isfile(phenopype
+00006c10: 5f6d 6f64 656c 5f70 6174 6829 2061 6e64  _model_path) and
+00006c20: 2066 6c61 6773 2e6f 7665 7277 7269 7465   flags.overwrite
+00006c30: 203d 3d20 4661 6c73 653a 0d0a 2020 2020   == False:..    
+00006c40: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00006c50: 745f 7361 7665 5f6d 7367 203d 2028 0d0a  t_save_msg = (..
+00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c70: 2020 2020 224d 6f64 656c 206e 6f74 2073      "Model not s
+00006c80: 6176 6564 2c20 6669 6c65 2061 6c72 6561  aved, file alrea
+00006c90: 6479 2065 7869 7374 7320 220d 0a20 2020  dy exists "..   
+00006ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cb0: 202b 2027 2d20 7573 6520 226f 7665 7277   + '- use "overw
+00006cc0: 7269 7465 3d54 7275 6522 206f 7220 6368  rite=True" or ch
+00006cd0: 6f73 6520 6469 6666 6572 656e 7420 6d6f  ose different mo
+00006ce0: 6465 6c5f 6964 2e27 0d0a 2020 2020 2020  del_id.'..      
+00006cf0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00006d00: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+00006d10: 616b 0d0a 2020 2020 2020 2020 2020 2020  ak..            
+00006d20: 656c 6966 206f 732e 7061 7468 2e69 7366  elif os.path.isf
+00006d30: 696c 6528 7068 656e 6f70 7970 655f 6d6f  ile(phenopype_mo
+00006d40: 6465 6c5f 7061 7468 2920 616e 6420 666c  del_path) and fl
+00006d50: 6167 732e 6f76 6572 7772 6974 6520 3d3d  ags.overwrite ==
+00006d60: 2054 7275 653a 0d0a 2020 2020 2020 2020   True:..        
+00006d70: 2020 2020 2020 2020 7072 696e 745f 7361          print_sa
+00006d80: 7665 5f6d 7367 203d 2028 0d0a 2020 2020  ve_msg = (..    
+00006d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006da0: 224d 6f64 656c 2073 6176 6564 2075 6e64  "Model saved und
+00006db0: 6572 2022 0d0a 2020 2020 2020 2020 2020  er "..          
+00006dc0: 2020 2020 2020 2020 2020 2b20 7068 656e            + phen
+00006dd0: 6f70 7970 655f 6d6f 6465 6c5f 7061 7468  opype_model_path
+00006de0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006df0: 2020 2020 2020 2b20 2220 286f 7665 7277        + " (overw
+00006e00: 7269 7474 656e 292e 220d 0a20 2020 2020  ritten)."..     
+00006e10: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00006e20: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00006e30: 7373 0d0a 2020 2020 2020 2020 2020 2020  ss..            
+00006e40: 656c 6966 206e 6f74 206f 732e 7061 7468  elif not os.path
+00006e50: 2e69 7366 696c 6528 7068 656e 6f70 7970  .isfile(phenopyp
+00006e60: 655f 6d6f 6465 6c5f 7061 7468 293a 0d0a  e_model_path):..
+00006e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e80: 7072 696e 745f 7361 7665 5f6d 7367 203d  print_save_msg =
+00006e90: 2022 4d6f 6465 6c20 7361 7665 6420 756e   "Model saved un
+00006ea0: 6465 7220 2220 2b20 7068 656e 6f70 7970  der " + phenopyp
+00006eb0: 655f 6d6f 6465 6c5f 7061 7468 0d0a 2020  e_model_path..  
+00006ec0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00006ed0: 7373 0d0a 0d0a 2020 2020 2020 2020 2020  ss....          
+00006ee0: 2020 2323 2063 6f70 7969 6e67 202f 2070    ## copying / p
+00006ef0: 6174 6820 6d61 6e61 6765 6d65 6e74 0d0a  ath management..
+00006f00: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00006f10: 6c5f 736f 7572 6365 5f6e 616d 6520 3d20  l_source_name = 
+00006f20: 6f73 2e70 6174 682e 6261 7365 6e61 6d65  os.path.basename
+00006f30: 286d 6f64 656c 5f70 6174 6829 0d0a 2020  (model_path)..  
+00006f40: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00006f50: 2020 2020 2020 2020 2323 2073 6176 6520          ## save 
+00006f60: 616c 6c20 6166 7465 7220 7375 6363 6573  all after succes
+00006f70: 7366 756c 2063 6f6d 706c 6574 696f 6e20  sful completion 
+00006f80: 6f66 2061 6c6c 206d 6574 686f 642d 7374  of all method-st
+00006f90: 6570 730d 0a20 2020 2020 2020 2020 2020  eps..           
+00006fa0: 2069 6620 6d6f 6465 203d 3d20 2263 6f70   if mode == "cop
+00006fb0: 7922 3a0d 0a20 2020 2020 2020 2020 2020  y":..           
+00006fc0: 2020 2020 2073 6875 7469 6c2e 636f 7079       shutil.copy
+00006fd0: 286d 6f64 656c 5f70 6174 682c 2070 6865  (model_path, phe
+00006fe0: 6e6f 7079 7065 5f6d 6f64 656c 5f70 6174  nopype_model_pat
+00006ff0: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
+00007000: 2020 2020 7068 656e 6f70 7970 655f 6d6f      phenopype_mo
+00007010: 6465 6c5f 7061 7468 203d 206f 732e 7061  del_path = os.pa
+00007020: 7468 2e72 656c 7061 7468 2870 6865 6e6f  th.relpath(pheno
+00007030: 7079 7065 5f6d 6f64 656c 5f70 6174 682c  pype_model_path,
+00007040: 2073 656c 662e 726f 6f74 5f64 6972 290d   self.root_dir).
+00007050: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00007060: 6620 6d6f 6465 203d 3d20 226c 696e 6b22  f mode == "link"
+00007070: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00007080: 2020 2070 6865 6e6f 7079 7065 5f6d 6f64     phenopype_mod
+00007090: 656c 5f70 6174 6820 3d20 6f73 2e70 6174  el_path = os.pat
+000070a0: 682e 6162 7370 6174 6828 6d6f 6465 6c5f  h.abspath(model_
+000070b0: 7061 7468 290d 0a20 0d0a 2020 2020 2020  path).. ..      
+000070c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000070d0: 2020 2020 2323 2063 7265 6174 6520 7265      ## create re
+000070e0: 6665 7265 6e63 6520 6174 7472 6962 7574  ference attribut
+000070f0: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
+00007100: 6d6f 6465 6c5f 696e 666f 203d 207b 0d0a  model_info = {..
+00007110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007120: 226d 6f64 656c 5f73 6f75 7263 655f 7061  "model_source_pa
+00007130: 7468 223a 206d 6f64 656c 5f70 6174 682c  th": model_path,
+00007140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007150: 2020 226d 6f64 656c 5f73 6f75 7263 655f    "model_source_
+00007160: 6e61 6d65 223a 206d 6f64 656c 5f73 6f75  name": model_sou
+00007170: 7263 655f 6e61 6d65 2c0d 0a20 2020 2020  rce_name,..     
+00007180: 2020 2020 2020 2020 2020 2022 6d6f 6465             "mode
+00007190: 6c5f 7068 656e 6f70 7970 655f 7061 7468  l_phenopype_path
+000071a0: 223a 2070 6865 6e6f 7079 7065 5f6d 6f64  ": phenopype_mod
+000071b0: 656c 5f70 6174 682c 0d0a 2020 2020 2020  el_path,..      
+000071c0: 2020 2020 2020 2020 2020 226d 6f64 656c            "model
+000071d0: 5f74 7970 6522 3a20 6d6f 6465 6c5f 7479  _type": model_ty
+000071e0: 7065 2c0d 0a20 2020 2020 2020 2020 2020  pe,..           
+000071f0: 2020 2020 2022 6461 7465 5f61 6464 6564       "date_added
+00007200: 223a 2064 6174 6574 696d 652e 746f 6461  ": datetime.toda
+00007210: 7928 292e 7374 7266 7469 6d65 2873 6574  y().strftime(set
+00007220: 7469 6e67 732e 7374 7266 7469 6d65 5f66  tings.strftime_f
+00007230: 6f72 6d61 7429 2c0d 0a20 2020 2020 2020  ormat),..       
+00007240: 2020 2020 207d 0d0a 0d0a 2020 2020 2020       }....      
+00007250: 2020 2020 2020 2323 206c 6f61 6420 7072        ## load pr
+00007260: 6f6a 6563 7420 6174 7472 6962 7574 6573  oject attributes
+00007270: 2061 6e64 2074 656d 706f 7261 7269 6c79   and temporarily
+00007280: 2064 726f 7020 7072 6f6a 6563 7420 6461   drop project da
+00007290: 7461 206c 6973 7420 746f 0d0a 2020 2020  ta list to..    
+000072a0: 2020 2020 2020 2020 2323 2062 6520 7265          ## be re
+000072b0: 6174 7463 6865 6420 6c61 7465 722c 2073  attched later, s
+000072c0: 6f20 6974 2069 7320 616c 7761 7973 2061  o it is always a
+000072d0: 7420 7468 656e 2065 6e64 206f 6620 7468  t then end of th
+000072e0: 6520 6669 6c65 0d0a 2020 2020 2020 2020  e file..        
+000072f0: 2020 2020 6d6f 6465 6c5f 6469 6374 203d      model_dict =
+00007300: 207b 7d0d 0a20 2020 2020 2020 2020 2020   {}..           
+00007310: 2070 726f 6a65 6374 5f61 7474 7269 6275   project_attribu
+00007320: 7465 7320 3d20 7574 696c 735f 6c6f 776c  tes = utils_lowl
+00007330: 6576 656c 2e5f 6c6f 6164 5f79 616d 6c28  evel._load_yaml(
+00007340: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007350: 2020 6f73 2e70 6174 682e 6a6f 696e 2873    os.path.join(s
+00007360: 656c 662e 726f 6f74 5f64 6972 2c20 2261  elf.root_dir, "a
+00007370: 7474 7269 6275 7465 732e 7961 6d6c 2229  ttributes.yaml")
+00007380: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+00007390: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000073a0: 2270 726f 6a65 6374 5f64 6174 6122 2069  "project_data" i
+000073b0: 6e20 7072 6f6a 6563 745f 6174 7472 6962  n project_attrib
+000073c0: 7574 6573 3a0d 0a20 2020 2020 2020 2020  utes:..         
+000073d0: 2020 2020 2020 2070 726f 6a65 6374 5f64         project_d
+000073e0: 6174 6120 3d20 7072 6f6a 6563 745f 6174  ata = project_at
+000073f0: 7472 6962 7574 6573 5b22 7072 6f6a 6563  tributes["projec
+00007400: 745f 6461 7461 225d 0d0a 2020 2020 2020  t_data"]..      
+00007410: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
+00007420: 745f 6174 7472 6962 7574 6573 2e70 6f70  t_attributes.pop
+00007430: 2822 7072 6f6a 6563 745f 6461 7461 222c  ("project_data",
+00007440: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
+00007450: 2020 2020 6966 2022 6d6f 6465 6c73 2220      if "models" 
+00007460: 696e 2070 726f 6a65 6374 5f61 7474 7269  in project_attri
+00007470: 6275 7465 733a 0d0a 2020 2020 2020 2020  butes:..        
+00007480: 2020 2020 2020 2020 6d6f 6465 6c5f 6469          model_di
+00007490: 6374 203d 2070 726f 6a65 6374 5f61 7474  ct = project_att
+000074a0: 7269 6275 7465 735b 226d 6f64 656c 7322  ributes["models"
+000074b0: 5d0d 0a20 2020 2020 2020 2020 2020 2069  ]..            i
+000074c0: 6620 2261 6374 6976 6522 2069 6e20 7072  f "active" in pr
+000074d0: 6f6a 6563 745f 6174 7472 6962 7574 6573  oject_attributes
+000074e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000074f0: 2020 2070 6173 7320 0d0a 2020 2020 2020     pass ..      
+00007500: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00007510: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+00007520: 6a65 6374 5f61 7474 7269 6275 7465 735b  ject_attributes[
+00007530: 2261 6374 6976 6522 5d20 3d20 7b7d 0d0a  "active"] = {}..
+00007540: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
+00007550: 6563 745f 6174 7472 6962 7574 6573 5b22  ect_attributes["
+00007560: 6163 7469 7665 225d 5b22 6d6f 6465 6c22  active"]["model"
+00007570: 5d20 3d20 6d6f 6465 6c5f 6964 0d0a 2020  ] = model_id..  
+00007580: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00007590: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+000075a0: 6c5f 6469 6374 5b6d 6f64 656c 5f69 645d  l_dict[model_id]
+000075b0: 203d 206d 6f64 656c 5f69 6e66 6f0d 0a20   = model_info.. 
+000075c0: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
+000075d0: 6374 5f61 7474 7269 6275 7465 735b 226d  ct_attributes["m
+000075e0: 6f64 656c 7322 5d20 3d20 6d6f 6465 6c5f  odels"] = model_
+000075f0: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
+00007600: 2020 7072 6f6a 6563 745f 6174 7472 6962    project_attrib
+00007610: 7574 6573 5b22 7072 6f6a 6563 745f 6461  utes["project_da
+00007620: 7461 225d 203d 2070 726f 6a65 6374 5f64  ta"] = project_d
+00007630: 6174 610d 0a0d 0a0d 0a0d 0a20 2020 2020  ata........     
+00007640: 2020 2020 2020 2075 7469 6c73 5f6c 6f77         utils_low
+00007650: 6c65 7665 6c2e 5f73 6176 655f 7961 6d6c  level._save_yaml
+00007660: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00007670: 2020 2070 726f 6a65 6374 5f61 7474 7269     project_attri
+00007680: 6275 7465 732c 206f 732e 7061 7468 2e6a  butes, os.path.j
+00007690: 6f69 6e28 7365 6c66 2e72 6f6f 745f 6469  oin(self.root_di
+000076a0: 722c 2022 6174 7472 6962 7574 6573 2e79  r, "attributes.y
+000076b0: 616d 6c22 290d 0a20 2020 2020 2020 2020  aml")..         
+000076c0: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
+000076d0: 2020 2020 7072 696e 745f 7361 7665 5f6d      print_save_m
+000076e0: 7367 203d 2028 0d0a 2020 2020 2020 2020  sg = (..        
+000076f0: 2020 2020 2020 2020 7072 696e 745f 7361          print_sa
+00007700: 7665 5f6d 7367 202b 2022 5c6e 5361 7665  ve_msg + "\nSave
+00007710: 6420 6d6f 6465 6c20 696e 666f 2074 6f20  d model info to 
+00007720: 7072 6f6a 6563 7420 6174 7472 6962 7574  project attribut
+00007730: 6573 2e22 0d0a 2020 2020 2020 2020 2020  es."..          
+00007740: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+00007750: 2062 7265 616b 0d0a 0d0a 2020 2020 2020   break....      
+00007760: 2020 7072 696e 7428 7072 696e 745f 7361    print(print_sa
+00007770: 7665 5f6d 7367 290d 0a0d 0a20 2020 2020  ve_msg)....     
+00007780: 2020 2069 6620 666c 6167 732e 6163 7469     if flags.acti
+00007790: 7661 7465 203d 3d20 5472 7565 3a0d 0a20  vate == True:.. 
+000077a0: 2020 2020 2020 2020 2020 205f 636f 6e66             _conf
+000077b0: 6967 2e61 6374 6976 655f 6d6f 6465 6c5f  ig.active_model_
+000077c0: 7061 7468 203d 2070 6865 6e6f 7079 7065  path = phenopype
+000077d0: 5f6d 6f64 656c 5f70 6174 680d 0a20 2020  _model_path..   
+000077e0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000077f0: 2d20 7365 7474 696e 6720 6163 7469 7665  - setting active
+00007800: 2070 726f 6a65 6374 206d 6f64 656c 2074   project model t
+00007810: 6f20 7b7d 272e 666f 726d 6174 286d 6f64  o {}'.format(mod
+00007820: 656c 5f69 6429 290d 0a20 2020 2020 2020  el_id))..       
+00007830: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00007840: 2020 2020 7072 696e 7428 0d0a 2020 2020      print(..    
+00007850: 2020 2020 2020 2020 2020 2020 222d 2063              "- c
+00007860: 6f75 6c64 206e 6f74 2073 6574 2061 6374  ould not set act
+00007870: 6976 6520 7072 6f6a 6563 7420 6d6f 6465  ive project mode
+00007880: 6c20 286f 7665 7277 7269 7465 3d46 616c  l (overwrite=Fal
+00007890: 7365 2f61 6374 6976 6174 653d 4661 6c73  se/activate=Fals
+000078a0: 6529 220d 0a20 2020 2020 2020 2020 2020  e)"..           
+000078b0: 2029 0d0a 0d0a 2020 2020 6465 6620 6164   )....    def ad
+000078c0: 645f 7265 6665 7265 6e63 6528 0d0a 2020  d_reference(..  
+000078d0: 2020 2020 2020 7365 6c66 2c0d 0a20 2020        self,..   
+000078e0: 2020 2020 2072 6566 6572 656e 6365 5f69       reference_i
+000078f0: 6d61 6765 5f70 6174 682c 0d0a 2020 2020  mage_path,..    
+00007900: 2020 2020 7265 6665 7265 6e63 655f 7461      reference_ta
+00007910: 672c 0d0a 2020 2020 2020 2020 6163 7469  g,..        acti
+00007920: 7661 7465 3d54 7275 652c 0d0a 2020 2020  vate=True,..    
+00007930: 2020 2020 7465 6d70 6c61 7465 3d46 616c      template=Fal
+00007940: 7365 2c0d 0a20 2020 2020 2020 206f 7665  se,..        ove
+00007950: 7277 7269 7465 3d46 616c 7365 2c0d 0a20  rwrite=False,.. 
+00007960: 2020 2020 2020 202a 2a6b 7761 7267 730d         **kwargs.
+00007970: 0a20 2020 2029 3a0d 0a20 2020 2020 2020  .    ):..       
+00007980: 2022 2222 0d0a 2020 2020 2020 2020 4164   """..        Ad
+00007990: 6420 7079 7065 2063 6f6e 6669 6775 7261  d pype configura
+000079a0: 7469 6f6e 2070 7265 7365 7473 2074 6f20  tion presets to 
+000079b0: 616c 6c20 7072 6f6a 6563 7420 6469 7265  all project dire
+000079c0: 6374 6f72 6965 732e 200d 0a0d 0a20 2020  ctories. ....   
+000079d0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+000079e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000079f0: 2d2d 2d0d 0a0d 0a20 2020 2020 2020 2072  ---....        r
+00007a00: 6566 6572 656e 6365 5f69 6d61 6765 3a20  eference_image: 
+00007a10: 7374 720d 0a20 2020 2020 2020 2020 2020  str..           
+00007a20: 206e 616d 6520 6f66 2074 656d 706c 6174   name of templat
+00007a30: 6520 696d 6167 652c 2065 6974 6865 7220  e image, either 
+00007a40: 7072 6f6a 6563 7420 6469 7265 6374 6f72  project director
+00007a50: 7920 6f72 2066 696c 6520 6c69 6e6b 2e20  y or file link. 
+00007a60: 7465 6d70 6c61 7465 200d 0a20 2020 2020  template ..     
+00007a70: 2020 2020 2020 2069 6d61 6765 2067 6574         image get
+00007a80: 7320 7374 6f72 6564 2069 6e20 726f 6f74  s stored in root
+00007a90: 2064 6972 6563 746f 7279 2c20 616e 6420   directory, and 
+00007aa0: 696e 666f 726d 6174 696f 6e20 6170 7065  information appe
+00007ab0: 6e64 6564 2074 6f20 616c 6c20 0d0a 2020  nded to all ..  
+00007ac0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+00007ad0: 7574 6573 2066 696c 6573 2069 6e20 7468  utes files in th
+00007ae0: 6520 7072 6f6a 6563 7420 6469 7265 6374  e project direct
+00007af0: 6f72 6965 730d 0a20 2020 2020 2020 2061  ories..        a
+00007b00: 6374 6976 6174 653a 2062 6f6f 6c2c 206f  ctivate: bool, o
+00007b10: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+00007b20: 2020 2020 2077 7269 7465 7320 7468 6520       writes the 
+00007b30: 7365 7474 696e 6720 666f 7220 7468 6520  setting for the 
+00007b40: 6375 7272 656e 746c 7920 6163 7469 7665  currently active
+00007b50: 2072 6566 6572 656e 6365 2074 6f20 7468   reference to th
+00007b60: 6520 6174 7472 6962 7574 6573 200d 0a20  e attributes .. 
+00007b70: 2020 2020 2020 2020 2020 2066 696c 6573             files
+00007b80: 206f 6620 616c 6c20 6469 7265 6374 6f72   of all director
+00007b90: 6965 7320 7769 7468 696e 2074 6865 2070  ies within the p
+00007ba0: 726f 6a65 6374 2e20 6361 6e20 6265 2075  roject. can be u
+00007bb0: 7365 6420 696e 2063 6f6e 6a75 6e63 7469  sed in conjuncti
+00007bc0: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
+00007bd0: 7769 7468 206f 7665 7277 7269 7465 3d46  with overwrite=F
+00007be0: 616c 7365 2073 6f20 7468 6174 2074 6865  alse so that the
+00007bf0: 2061 6374 7561 6c20 7265 6665 7265 6e63   actual referenc
+00007c00: 6520 7265 6d61 696e 7320 756e 6368 616e  e remains unchan
+00007c10: 6365 642e 2074 6869 730d 0a20 2020 2020  ced. this..     
+00007c20: 2020 2020 2020 2073 6574 7469 6e67 2075         setting u
+00007c30: 7365 6675 6c20 7768 656e 206d 616e 6167  seful when manag
+00007c40: 696e 6720 6d75 6c74 6970 6c65 2072 6566  ing multiple ref
+00007c50: 6572 656e 6365 7320 7065 7220 7072 6f6a  erences per proj
+00007c60: 6563 740d 0a20 2020 2020 2020 206f 7665  ect..        ove
+00007c70: 7277 7269 7465 3a20 626f 6f6c 2c20 6f70  rwrite: bool, op
+00007c80: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+00007c90: 2020 2020 6f76 6572 7772 6974 6520 6f70      overwrite op
+00007ca0: 7469 6f6e 2c20 6966 2061 2067 6976 656e  tion, if a given
+00007cb0: 2070 7970 6520 636f 6e66 6967 2d66 696c   pype config-fil
+00007cc0: 6520 616c 7265 6164 7920 6578 6973 740d  e already exist.
+00007cd0: 0a20 2020 2020 2020 2074 656d 706c 6174  .        templat
+00007ce0: 653a 2062 6f6f 6c2c 206f 7074 696f 6e61  e: bool, optiona
+00007cf0: 6c0d 0a20 2020 2020 2020 2020 2020 2073  l..            s
+00007d00: 686f 756c 6420 6120 7465 6d70 6c61 7465  hould a template
+00007d10: 2066 6f72 2072 6566 6572 656e 6365 2064   for reference d
+00007d20: 6574 6563 7469 6f6e 2062 6520 6372 6561  etection be crea
+00007d30: 7465 642e 2077 6974 6820 616e 2065 7869  ted. with an exi
+00007d40: 7374 696e 6720 0d0a 2020 2020 2020 2020  sting ..        
+00007d50: 2020 2020 7465 6d70 6c61 7465 2c20 7068      template, ph
+00007d60: 656e 6f70 7970 6520 6361 6e20 7472 7920  enopype can try 
+00007d70: 746f 2066 696e 6420 6120 7265 6665 7265  to find a refere
+00007d80: 6e63 6520 6361 7264 2069 6e20 6120 6769  nce card in a gi
+00007d90: 7665 6e20 696d 6167 652c 0d0a 2020 2020  ven image,..    
+00007da0: 2020 2020 2020 2020 6d65 6173 7572 6520          measure 
+00007db0: 6974 7320 6469 6d65 6e73 696f 6e73 2c20  its dimensions, 
+00007dc0: 616e 6420 6164 6a75 7374 2070 6978 656c  and adjust pixel
+00007dd0: 2d74 6f2d 6d6d 2d72 6174 696f 2061 6e64  -to-mm-ratio and
+00007de0: 2063 6f6c 6f75 7220 7370 6163 650d 0a20   colour space.. 
+00007df0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00007e00: 2020 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d      # ==========
+00007e10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00007e20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00007e30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00007e40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00007e50: 3d3d 3d0d 0a20 2020 2020 2020 2023 2073  ===..        # s
+00007e60: 6574 7570 0d0a 0d0a 2020 2020 2020 2020  etup....        
+00007e70: 2323 2073 6574 2066 6c61 6773 0d0a 2020  ## set flags..  
+00007e80: 2020 2020 2020 666c 6167 7320 3d20 6d61        flags = ma
+00007e90: 6b65 5f64 6174 6163 6c61 7373 280d 0a20  ke_dataclass(.. 
+00007ea0: 2020 2020 2020 2020 2020 2063 6c73 5f6e             cls_n
+00007eb0: 616d 653d 2266 6c61 6773 222c 0d0a 2020  ame="flags",..  
+00007ec0: 2020 2020 2020 2020 2020 6669 656c 6473            fields
+00007ed0: 3d5b 2822 6f76 6572 7772 6974 6522 2c20  =[("overwrite", 
+00007ee0: 626f 6f6c 2c20 6f76 6572 7772 6974 6529  bool, overwrite)
+00007ef0: 2c20 2822 6163 7469 7661 7465 222c 2062  , ("activate", b
+00007f00: 6f6f 6c2c 2061 6374 6976 6174 6529 2c5d  ool, activate),]
+00007f10: 2c0d 0a20 2020 2020 2020 2029 0d0a 0d0a  ,..        )....
+00007f20: 2020 2020 2020 2020 7072 696e 745f 7361          print_sa
+00007f30: 7665 5f6d 7367 203d 2022 3d3d 206e 6f20  ve_msg = "== no 
+00007f40: 6d73 6720 3d3d 220d 0a0d 0a20 2020 2020  msg =="....     
+00007f50: 2020 2072 6566 6572 656e 6365 5f73 6f75     reference_sou
+00007f60: 7263 655f 7061 7468 203d 2063 6f70 792e  rce_path = copy.
+00007f70: 6465 6570 636f 7079 2872 6566 6572 656e  deepcopy(referen
+00007f80: 6365 5f69 6d61 6765 5f70 6174 6829 0d0a  ce_image_path)..
+00007f90: 0d0a 2020 2020 2020 2020 2323 206c 6f61  ..        ## loa
+00007fa0: 6420 7265 6665 7265 6e63 6520 696d 6167  d reference imag
+00007fb0: 650d 0a20 2020 2020 2020 2069 6620 7265  e..        if re
+00007fc0: 6665 7265 6e63 655f 736f 7572 6365 5f70  ference_source_p
+00007fd0: 6174 682e 5f5f 636c 6173 735f 5f2e 5f5f  ath.__class__.__
+00007fe0: 6e61 6d65 5f5f 203d 3d20 2273 7472 223a  name__ == "str":
+00007ff0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00008000: 6665 7265 6e63 655f 696d 6167 6520 3d20  ference_image = 
+00008010: 7574 696c 732e 6c6f 6164 5f69 6d61 6765  utils.load_image
+00008020: 2872 6566 6572 656e 6365 5f73 6f75 7263  (reference_sourc
+00008030: 655f 7061 7468 290d 0a0d 0a20 2020 2020  e_path)....     
+00008040: 2020 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d     # ===========
+00008050: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008060: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008070: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008080: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008090: 3d3d 0d0a 2020 2020 2020 2020 2320 6578  ==..        # ex
+000080a0: 6563 7574 650d 0a0d 0a20 2020 2020 2020  ecute....       
+000080b0: 2072 6566 6572 656e 6365 5f66 6f6c 6465   reference_folde
+000080c0: 725f 7061 7468 203d 206f 732e 7061 7468  r_path = os.path
+000080d0: 2e6a 6f69 6e28 7365 6c66 2e72 6f6f 745f  .join(self.root_
+000080e0: 6469 722c 2022 7265 6665 7265 6e63 6522  dir, "reference"
+000080f0: 290d 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+00008100: 7420 6f73 2e70 6174 682e 6973 6469 7228  t os.path.isdir(
+00008110: 7265 6665 7265 6e63 655f 666f 6c64 6572  reference_folder
+00008120: 5f70 6174 6829 3a0d 0a20 2020 2020 2020  _path):..       
+00008130: 2020 2020 206f 732e 6d6b 6469 7228 7265       os.mkdir(re
+00008140: 6665 7265 6e63 655f 666f 6c64 6572 5f70  ference_folder_p
+00008150: 6174 6829 0d0a 0d0a 2020 2020 2020 2020  ath)....        
+00008160: 7768 696c 6520 5472 7565 3a0d 0a0d 0a20  while True:.... 
+00008170: 2020 2020 2020 2020 2020 2023 2320 6765             ## ge
+00008180: 6e65 7261 7465 2072 6566 6572 656e 6365  nerate reference
+00008190: 206e 616d 6520 616e 6420 6368 6563 6b20   name and check 
+000081a0: 6966 2065 7869 7374 730d 0a20 2020 2020  if exists..     
+000081b0: 2020 2020 2020 2072 6566 6572 656e 6365         reference
+000081c0: 5f69 6d61 6765 5f6e 616d 6520 3d20 7265  _image_name = re
+000081d0: 6665 7265 6e63 655f 7461 6720 2b20 225f  ference_tag + "_
+000081e0: 6675 6c6c 5f69 6d61 6765 2e74 6966 220d  full_image.tif".
+000081f0: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
+00008200: 6572 656e 6365 5f69 6d61 6765 5f70 6174  erence_image_pat
+00008210: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
+00008220: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00008230: 2020 2073 656c 662e 726f 6f74 5f64 6972     self.root_dir
+00008240: 2c20 2272 6566 6572 656e 6365 222c 2072  , "reference", r
+00008250: 6566 6572 656e 6365 5f69 6d61 6765 5f6e  eference_image_n
+00008260: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
+00008270: 2029 0d0a 0d0a 2020 2020 2020 2020 2020   )....          
+00008280: 2020 6966 206f 732e 7061 7468 2e69 7366    if os.path.isf
+00008290: 696c 6528 7265 6665 7265 6e63 655f 696d  ile(reference_im
+000082a0: 6167 655f 7061 7468 2920 616e 6420 666c  age_path) and fl
+000082b0: 6167 732e 6f76 6572 7772 6974 6520 3d3d  ags.overwrite ==
+000082c0: 2046 616c 7365 3a0d 0a20 2020 2020 2020   False:..       
+000082d0: 2020 2020 2020 2020 2070 7269 6e74 5f73           print_s
+000082e0: 6176 655f 6d73 6720 3d20 280d 0a20 2020  ave_msg = (..   
+000082f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008300: 2022 5265 6665 7265 6e63 6520 696d 6167   "Reference imag
+00008310: 6520 6e6f 7420 7361 7665 642c 2066 696c  e not saved, fil
+00008320: 6520 616c 7265 6164 7920 6578 6973 7473  e already exists
+00008330: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+00008340: 2020 2020 2020 2020 2b20 272d 2075 7365          + '- use
+00008350: 2022 6f76 6572 7772 6974 653d 3d54 7275   "overwrite==Tru
+00008360: 6522 206f 7220 6368 6f73 6520 6469 6666  e" or chose diff
+00008370: 6572 656e 7420 6e61 6d65 2e27 0d0a 2020  erent name.'..  
+00008380: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00008390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000083a0: 2062 7265 616b 0d0a 2020 2020 2020 2020   break..        
+000083b0: 2020 2020 656c 6966 206f 732e 7061 7468      elif os.path
+000083c0: 2e69 7366 696c 6528 7265 6665 7265 6e63  .isfile(referenc
+000083d0: 655f 696d 6167 655f 7061 7468 2920 616e  e_image_path) an
+000083e0: 6420 666c 6167 732e 6f76 6572 7772 6974  d flags.overwrit
+000083f0: 6520 3d3d 2054 7275 653a 0d0a 2020 2020  e == True:..    
+00008400: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00008410: 745f 7361 7665 5f6d 7367 203d 2028 0d0a  t_save_msg = (..
+00008420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008430: 2020 2020 2252 6566 6572 656e 6365 2069      "Reference i
+00008440: 6d61 6765 2073 6176 6564 2075 6e64 6572  mage saved under
+00008450: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+00008460: 2020 2020 2020 2020 2b20 7265 6665 7265          + refere
+00008470: 6e63 655f 696d 6167 655f 7061 7468 0d0a  nce_image_path..
+00008480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008490: 2020 2020 2b20 2220 286f 7665 7277 7269      + " (overwri
+000084a0: 7474 656e 292e 220d 0a20 2020 2020 2020  tten)."..       
+000084b0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+000084c0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+000084d0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+000084e0: 6966 206e 6f74 206f 732e 7061 7468 2e69  if not os.path.i
+000084f0: 7366 696c 6528 7265 6665 7265 6e63 655f  sfile(reference_
+00008500: 696d 6167 655f 7061 7468 293a 0d0a 2020  image_path):..  
+00008510: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00008520: 696e 745f 7361 7665 5f6d 7367 203d 2022  int_save_msg = "
+00008530: 5265 6665 7265 6e63 6520 696d 6167 6520  Reference image 
+00008540: 7361 7665 6420 756e 6465 7220 2220 2b20  saved under " + 
+00008550: 7265 6665 7265 6e63 655f 696d 6167 655f  reference_image_
+00008560: 7061 7468 0d0a 2020 2020 2020 2020 2020  path..          
+00008570: 2020 2020 2020 7061 7373 0d0a 0d0a 2020        pass....  
+00008580: 2020 2020 2020 2020 2020 2323 2067 656e            ## gen
+00008590: 6572 6174 6520 7465 6d70 6c61 7465 206e  erate template n
+000085a0: 616d 6520 616e 6420 6368 6563 6b20 6966  ame and check if
+000085b0: 2065 7869 7374 730d 0a20 2020 2020 2020   exists..       
+000085c0: 2020 2020 2074 656d 706c 6174 655f 6e61       template_na
+000085d0: 6d65 203d 2072 6566 6572 656e 6365 5f74  me = reference_t
+000085e0: 6167 202b 2022 5f73 6561 7263 685f 7465  ag + "_search_te
+000085f0: 6d70 6c61 7465 2e74 6966 220d 0a20 2020  mplate.tif"..   
+00008600: 2020 2020 2020 2020 2074 656d 706c 6174           templat
+00008610: 655f 7061 7468 203d 206f 732e 7061 7468  e_path = os.path
+00008620: 2e6a 6f69 6e28 7365 6c66 2e72 6f6f 745f  .join(self.root_
+00008630: 6469 722c 2022 7265 6665 7265 6e63 6522  dir, "reference"
+00008640: 2c20 7465 6d70 6c61 7465 5f6e 616d 6529  , template_name)
+00008650: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00008660: 6966 206f 732e 7061 7468 2e69 7366 696c  if os.path.isfil
+00008670: 6528 7465 6d70 6c61 7465 5f70 6174 6829  e(template_path)
+00008680: 2061 6e64 2066 6c61 6773 2e6f 7665 7277   and flags.overw
+00008690: 7269 7465 203d 3d20 4661 6c73 653a 0d0a  rite == False:..
+000086a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000086b0: 7072 696e 745f 7361 7665 5f6d 7367 203d  print_save_msg =
+000086c0: 2027 5265 6665 7265 6e63 6520 7465 6d70   'Reference temp
+000086d0: 6c61 7465 206e 6f74 2073 6176 6564 2c20  late not saved, 
+000086e0: 6669 6c65 2061 6c72 6561 6479 2065 7869  file already exi
+000086f0: 7374 735c 0d0a 2020 2020 2020 2020 2020  sts\..          
+00008700: 2020 2020 2020 202d 2075 7365 2022 6f76         - use "ov
+00008710: 6572 7772 6974 653d 3d54 7275 6522 206f  erwrite==True" o
+00008720: 7220 6368 6f73 6520 6469 6666 6572 656e  r chose differen
+00008730: 7420 6e61 6d65 2e27 0d0a 2020 2020 2020  t name.'..      
+00008740: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
+00008750: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00008760: 6620 6f73 2e70 6174 682e 6973 6669 6c65  f os.path.isfile
+00008770: 2874 656d 706c 6174 655f 7061 7468 2920  (template_path) 
+00008780: 616e 6420 666c 6167 732e 6f76 6572 7772  and flags.overwr
+00008790: 6974 6520 3d3d 2054 7275 653a 0d0a 2020  ite == True:..  
+000087a0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000087b0: 696e 745f 7361 7665 5f6d 7367 203d 2028  int_save_msg = (
+000087c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000087d0: 2020 2020 2020 7072 696e 745f 7361 7665        print_save
+000087e0: 5f6d 7367 0d0a 2020 2020 2020 2020 2020  _msg..          
+000087f0: 2020 2020 2020 2020 2020 2b20 225c 6e52            + "\nR
+00008800: 6566 6572 656e 6365 2069 6d61 6765 2073  eference image s
+00008810: 6176 6564 2075 6e64 6572 2022 0d0a 2020  aved under "..  
+00008820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008830: 2020 2b20 7465 6d70 6c61 7465 5f70 6174    + template_pat
+00008840: 680d 0a20 2020 2020 2020 2020 2020 2020  h..             
+00008850: 2020 2020 2020 202b 2022 2028 6f76 6572         + " (over
+00008860: 7772 6974 7465 6e29 2e22 0d0a 2020 2020  written)."..    
+00008870: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00008880: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00008890: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
+000088a0: 2065 6c69 6620 6e6f 7420 6f73 2e70 6174   elif not os.pat
+000088b0: 682e 6973 6669 6c65 2874 656d 706c 6174  h.isfile(templat
+000088c0: 655f 7061 7468 293a 0d0a 2020 2020 2020  e_path):..      
+000088d0: 2020 2020 2020 2020 2020 7072 696e 745f            print_
+000088e0: 7361 7665 5f6d 7367 203d 2028 0d0a 2020  save_msg = (..  
+000088f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008900: 2020 7072 696e 745f 7361 7665 5f6d 7367    print_save_msg
+00008910: 202b 2022 5c6e 5265 6665 7265 6e63 6520   + "\nReference 
+00008920: 696d 6167 6520 7361 7665 6420 756e 6465  image saved unde
+00008930: 7220 2220 2b20 7465 6d70 6c61 7465 5f70  r " + template_p
+00008940: 6174 680d 0a20 2020 2020 2020 2020 2020  ath..           
+00008950: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00008960: 2020 2020 2020 2020 7061 7373 0d0a 0d0a          pass....
+00008970: 2020 2020 2020 2020 2020 2020 2320 3d3d              # ==
+00008980: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008990: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000089a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000089b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000089c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+000089d0: 2020 2020 2020 2020 2023 2061 6e6e 6f74           # annot
+000089e0: 6174 696f 6e20 6d61 6e61 6765 6d65 6e74  ation management
+000089f0: 2028 666f 7220 7465 7374 7329 0d0a 0d0a   (for tests)....
+00008a00: 2020 2020 2020 2020 2020 2020 616e 6e6f              anno
+00008a10: 7461 7469 6f6e 7320 3d20 6b77 6172 6773  tations = kwargs
+00008a20: 2e67 6574 2822 616e 6e6f 7461 7469 6f6e  .get("annotation
+00008a30: 7322 290d 0a0d 0a20 2020 2020 2020 2020  s")....         
+00008a40: 2020 2069 6620 6e6f 7420 616e 6e6f 7461     if not annota
+00008a50: 7469 6f6e 733a 0d0a 0d0a 2020 2020 2020  tions:....      
+00008a60: 2020 2020 2020 2020 2020 2323 206d 6561            ## mea
+00008a70: 7375 7265 2072 6566 6572 656e 6365 0d0a  sure reference..
+00008a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a90: 616e 6e6f 7461 7469 6f6e 7320 3d20 7072  annotations = pr
+00008aa0: 6570 726f 6365 7373 696e 672e 6372 6561  eprocessing.crea
+00008ab0: 7465 5f72 6566 6572 656e 6365 2872 6566  te_reference(ref
+00008ac0: 6572 656e 6365 5f69 6d61 6765 290d 0a20  erence_image).. 
+00008ad0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00008ae0: 6e6e 6f74 6174 696f 6e73 203d 2070 7265  nnotations = pre
+00008af0: 7072 6f63 6573 7369 6e67 2e63 7265 6174  processing.creat
+00008b00: 655f 6d61 736b 280d 0a20 2020 2020 2020  e_mask(..       
+00008b10: 2020 2020 2020 2020 2020 2020 2072 6566               ref
+00008b20: 6572 656e 6365 5f69 6d61 6765 2c20 616e  erence_image, an
+00008b30: 6e6f 7461 7469 6f6e 733d 616e 6e6f 7461  notations=annota
+00008b40: 7469 6f6e 730d 0a20 2020 2020 2020 2020  tions..         
+00008b50: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+00008b60: 2020 2020 2020 2020 2323 2063 7265 6174          ## creat
+00008b70: 6520 7465 6d70 6c61 7465 2066 726f 6d20  e template from 
+00008b80: 6d61 736b 2063 6f6f 7264 696e 6174 6573  mask coordinates
+00008b90: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00008ba0: 6f72 6473 203d 2061 6e6e 6f74 6174 696f  ords = annotatio
+00008bb0: 6e73 5b73 6574 7469 6e67 732e 5f6d 6173  ns[settings._mas
+00008bc0: 6b5f 7479 7065 5d5b 2261 225d 5b22 6461  k_type]["a"]["da
+00008bd0: 7461 225d 5b73 6574 7469 6e67 732e 5f6d  ta"][settings._m
+00008be0: 6173 6b5f 7479 7065 5d5b 0d0a 2020 2020  ask_type][..    
+00008bf0: 2020 2020 2020 2020 2020 2020 300d 0a20              0.. 
+00008c00: 2020 2020 2020 2020 2020 205d 0d0a 2020             ]..  
+00008c10: 2020 2020 2020 2020 2020 7465 6d70 6c61            templa
+00008c20: 7465 203d 2072 6566 6572 656e 6365 5f69  te = reference_i
+00008c30: 6d61 6765 5b0d 0a20 2020 2020 2020 2020  mage[..         
+00008c40: 2020 2020 2020 2063 6f6f 7264 735b 305d         coords[0]
+00008c50: 5b31 5d20 3a20 636f 6f72 6473 5b32 5d5b  [1] : coords[2][
+00008c60: 315d 2c20 636f 6f72 6473 5b30 5d5b 305d  1], coords[0][0]
+00008c70: 203a 2063 6f6f 7264 735b 315d 5b30 5d0d   : coords[1][0].
+00008c80: 0a20 2020 2020 2020 2020 2020 205d 0d0a  .            ]..
+00008c90: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00008ca0: 2063 7265 6174 6520 7265 6665 7265 6e63   create referenc
+00008cb0: 6520 6174 7472 6962 7574 6573 0d0a 2020  e attributes..  
+00008cc0: 2020 2020 2020 2020 2020 7265 6665 7265            refere
+00008cd0: 6e63 655f 696e 666f 203d 207b 0d0a 2020  nce_info = {..  
+00008ce0: 2020 2020 2020 2020 2020 2020 2020 2272                "r
+00008cf0: 6566 6572 656e 6365 5f73 6f75 7263 655f  eference_source_
+00008d00: 7061 7468 223a 2072 6566 6572 656e 6365  path": reference
+00008d10: 5f73 6f75 7263 655f 7061 7468 2c0d 0a20  _source_path,.. 
+00008d20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00008d30: 7265 6665 7265 6e63 655f 6669 6c65 5f6e  reference_file_n
+00008d40: 616d 6522 3a20 7265 6665 7265 6e63 655f  ame": reference_
+00008d50: 696d 6167 655f 6e61 6d65 2c0d 0a20 2020  image_name,..   
+00008d60: 2020 2020 2020 2020 2020 2020 2022 7465               "te
+00008d70: 6d70 6c61 7465 5f66 696c 655f 6e61 6d65  mplate_file_name
+00008d80: 223a 2074 656d 706c 6174 655f 6e61 6d65  ": template_name
+00008d90: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00008da0: 2020 2022 7465 6d70 6c61 7465 5f70 785f     "template_px_
+00008db0: 7261 7469 6f22 3a20 616e 6e6f 7461 7469  ratio": annotati
+00008dc0: 6f6e 735b 7365 7474 696e 6773 2e5f 7265  ons[settings._re
+00008dd0: 6665 7265 6e63 655f 7479 7065 5d5b 2261  ference_type]["a
+00008de0: 225d 5b22 6461 7461 225d 5b0d 0a20 2020  "]["data"][..   
+00008df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e00: 2073 6574 7469 6e67 732e 5f72 6566 6572   settings._refer
+00008e10: 656e 6365 5f74 7970 650d 0a20 2020 2020  ence_type..     
+00008e20: 2020 2020 2020 2020 2020 205d 5b30 5d2c             ][0],
+00008e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008e40: 2020 2275 6e69 7422 3a20 616e 6e6f 7461    "unit": annota
+00008e50: 7469 6f6e 735b 7365 7474 696e 6773 2e5f  tions[settings._
+00008e60: 7265 6665 7265 6e63 655f 7479 7065 5d5b  reference_type][
+00008e70: 2261 225d 5b22 6461 7461 225d 5b0d 0a20  "a"]["data"][.. 
+00008e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e90: 2020 2073 6574 7469 6e67 732e 5f72 6566     settings._ref
+00008ea0: 6572 656e 6365 5f74 7970 650d 0a20 2020  erence_type..   
+00008eb0: 2020 2020 2020 2020 2020 2020 205d 5b31               ][1
+00008ec0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00008ed0: 2020 2020 2264 6174 655f 6164 6465 6422      "date_added"
+00008ee0: 3a20 6461 7465 7469 6d65 2e74 6f64 6179  : datetime.today
+00008ef0: 2829 2e73 7472 6674 696d 6528 7365 7474  ().strftime(sett
+00008f00: 696e 6773 2e73 7472 6674 696d 655f 666f  ings.strftime_fo
+00008f10: 726d 6174 292c 0d0a 2020 2020 2020 2020  rmat),..        
+00008f20: 2020 2020 7d0d 0a0d 0a20 2020 2020 2020      }....       
+00008f30: 2020 2020 2023 2320 6c6f 6164 2070 726f       ## load pro
+00008f40: 6a65 6374 2061 7474 7269 6275 7465 7320  ject attributes 
+00008f50: 616e 6420 7465 6d70 6f72 6172 696c 7920  and temporarily 
+00008f60: 6472 6f70 2070 726f 6a65 6374 2064 6174  drop project dat
+00008f70: 6120 6c69 7374 2074 6f0d 0a20 2020 2020  a list to..     
+00008f80: 2020 2020 2020 2023 2320 6265 2072 6561         ## be rea
+00008f90: 7474 6368 6564 206c 6174 6572 2c20 736f  ttched later, so
+00008fa0: 2069 7420 6973 2061 6c77 6179 7320 6174   it is always at
+00008fb0: 2074 6865 6e20 656e 6420 6f66 2074 6865   then end of the
+00008fc0: 2066 696c 650d 0a20 2020 2020 2020 2020   file..         
+00008fd0: 2020 2072 6566 6572 656e 6365 5f64 6963     reference_dic
+00008fe0: 7420 3d20 7b7d 0d0a 2020 2020 2020 2020  t = {}..        
+00008ff0: 2020 2020 7072 6f6a 6563 745f 6174 7472      project_attr
+00009000: 6962 7574 6573 203d 2075 7469 6c73 5f6c  ibutes = utils_l
+00009010: 6f77 6c65 7665 6c2e 5f6c 6f61 645f 7961  owlevel._load_ya
+00009020: 6d6c 280d 0a20 2020 2020 2020 2020 2020  ml(..           
+00009030: 2020 2020 206f 732e 7061 7468 2e6a 6f69       os.path.joi
+00009040: 6e28 7365 6c66 2e72 6f6f 745f 6469 722c  n(self.root_dir,
+00009050: 2022 6174 7472 6962 7574 6573 2e79 616d   "attributes.yam
+00009060: 6c22 290d 0a20 2020 2020 2020 2020 2020  l")..           
+00009070: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00009080: 6966 2022 7072 6f6a 6563 745f 6461 7461  if "project_data
+00009090: 2220 696e 2070 726f 6a65 6374 5f61 7474  " in project_att
+000090a0: 7269 6275 7465 733a 0d0a 2020 2020 2020  ributes:..      
+000090b0: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
+000090c0: 745f 6461 7461 203d 2070 726f 6a65 6374  t_data = project
+000090d0: 5f61 7474 7269 6275 7465 735b 2270 726f  _attributes["pro
+000090e0: 6a65 6374 5f64 6174 6122 5d0d 0a20 2020  ject_data"]..   
+000090f0: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+00009100: 6a65 6374 5f61 7474 7269 6275 7465 732e  ject_attributes.
+00009110: 706f 7028 2270 726f 6a65 6374 5f64 6174  pop("project_dat
+00009120: 6122 2c20 4e6f 6e65 290d 0a20 2020 2020  a", None)..     
+00009130: 2020 2020 2020 2069 6620 2272 6566 6572         if "refer
+00009140: 656e 6365 2220 696e 2070 726f 6a65 6374  ence" in project
+00009150: 5f61 7474 7269 6275 7465 733a 0d0a 2020  _attributes:..  
+00009160: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00009170: 6665 7265 6e63 655f 6469 6374 203d 2070  ference_dict = p
+00009180: 726f 6a65 6374 5f61 7474 7269 6275 7465  roject_attribute
+00009190: 735b 2272 6566 6572 656e 6365 225d 0d0a  s["reference"]..
+000091a0: 2020 2020 2020 2020 2020 2020 7265 6665              refe
+000091b0: 7265 6e63 655f 6469 6374 5b72 6566 6572  rence_dict[refer
+000091c0: 656e 6365 5f74 6167 5d20 3d20 7265 6665  ence_tag] = refe
+000091d0: 7265 6e63 655f 696e 666f 0d0a 0d0a 2020  rence_info....  
+000091e0: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
+000091f0: 745f 6174 7472 6962 7574 6573 5b22 7265  t_attributes["re
+00009200: 6665 7265 6e63 6522 5d20 3d20 7265 6665  ference"] = refe
+00009210: 7265 6e63 655f 6469 6374 0d0a 2020 2020  rence_dict..    
+00009220: 2020 2020 2020 2020 7072 6f6a 6563 745f          project_
+00009230: 6174 7472 6962 7574 6573 5b22 7072 6f6a  attributes["proj
+00009240: 6563 745f 6461 7461 225d 203d 2070 726f  ect_data"] = pro
+00009250: 6a65 6374 5f64 6174 610d 0a0d 0a20 2020  ject_data....   
+00009260: 2020 2020 2020 2020 2023 2320 7361 7665           ## save
+00009270: 2061 6c6c 2061 6674 6572 2073 7563 6365   all after succe
+00009280: 7373 6675 6c20 636f 6d70 6c65 7469 6f6e  ssful completion
+00009290: 206f 6620 616c 6c20 6d65 7468 6f64 2d73   of all method-s
+000092a0: 7465 7073 0d0a 2020 2020 2020 2020 2020  teps..          
+000092b0: 2020 6376 322e 696d 7772 6974 6528 7265    cv2.imwrite(re
+000092c0: 6665 7265 6e63 655f 696d 6167 655f 7061  ference_image_pa
+000092d0: 7468 2c20 7265 6665 7265 6e63 655f 696d  th, reference_im
+000092e0: 6167 6529 0d0a 2020 2020 2020 2020 2020  age)..          
+000092f0: 2020 6376 322e 696d 7772 6974 6528 7465    cv2.imwrite(te
+00009300: 6d70 6c61 7465 5f70 6174 682c 2074 656d  mplate_path, tem
+00009310: 706c 6174 6529 0d0a 0d0a 2020 2020 2020  plate)....      
+00009320: 2020 2020 2020 7574 696c 735f 6c6f 776c        utils_lowl
+00009330: 6576 656c 2e5f 7361 7665 5f79 616d 6c28  evel._save_yaml(
+00009340: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009350: 2020 7072 6f6a 6563 745f 6174 7472 6962    project_attrib
+00009360: 7574 6573 2c20 6f73 2e70 6174 682e 6a6f  utes, os.path.jo
+00009370: 696e 2873 656c 662e 726f 6f74 5f64 6972  in(self.root_dir
+00009380: 2c20 2261 7474 7269 6275 7465 732e 7961  , "attributes.ya
+00009390: 6d6c 2229 0d0a 2020 2020 2020 2020 2020  ml")..          
+000093a0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+000093b0: 2070 7269 6e74 5f73 6176 655f 6d73 6720   print_save_msg 
+000093c0: 3d20 280d 0a20 2020 2020 2020 2020 2020  = (..           
+000093d0: 2020 2020 2070 7269 6e74 5f73 6176 655f       print_save_
+000093e0: 6d73 6720 2b20 225c 6e53 6176 6564 2072  msg + "\nSaved r
+000093f0: 6566 6572 656e 6365 2069 6e66 6f20 746f  eference info to
+00009400: 2070 726f 6a65 6374 2061 7474 7269 6275   project attribu
+00009410: 7465 732e 220d 0a20 2020 2020 2020 2020  tes."..         
+00009420: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+00009430: 2020 6272 6561 6b0d 0a0d 0a20 2020 2020    break....     
+00009440: 2020 2070 7269 6e74 2870 7269 6e74 5f73     print(print_s
+00009450: 6176 655f 6d73 6729 0d0a 0d0a 2020 2020  ave_msg)....    
+00009460: 2020 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d      # ==========
+00009470: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009480: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009490: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000094a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000094b0: 3d3d 3d0d 0a20 2020 2020 2020 2023 204d  ===..        # M
+000094c0: 4554 484f 4420 454e 440d 0a20 2020 2020  ETHOD END..     
+000094d0: 2020 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d     # ===========
+000094e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000094f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009500: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009510: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009520: 3d3d 0d0a 0d0a 2020 2020 2020 2020 2323  ==....        ##
+00009530: 2073 6574 2061 6374 6976 6520 7265 6665   set active refe
+00009540: 7265 6e63 6520 696e 666f 726d 6174 696f  rence informatio
+00009550: 6e20 696e 2066 696c 6520 7370 6563 6966  n in file specif
+00009560: 6963 2061 7474 7269 6275 7465 730d 0a20  ic attributes.. 
+00009570: 2020 2020 2020 2066 6f72 2064 6972 5f6e         for dir_n
+00009580: 616d 652c 2064 6972 5f70 6174 6820 696e  ame, dir_path in
+00009590: 207a 6970 2873 656c 662e 6469 725f 6e61   zip(self.dir_na
+000095a0: 6d65 732c 2073 656c 662e 6469 725f 7061  mes, self.dir_pa
+000095b0: 7468 7329 3a0d 0a20 2020 2020 2020 2020  ths):..         
+000095c0: 2020 2061 7474 7220 3d20 7574 696c 735f     attr = utils_
+000095d0: 6c6f 776c 6576 656c 2e5f 6c6f 6164 5f79  lowlevel._load_y
+000095e0: 616d 6c28 6f73 2e70 6174 682e 6a6f 696e  aml(os.path.join
+000095f0: 2864 6972 5f70 6174 682c 2022 6174 7472  (dir_path, "attr
+00009600: 6962 7574 6573 2e79 616d 6c22 2929 0d0a  ibutes.yaml"))..
+00009610: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00009620: 2063 7265 6174 6520 6e65 7374 6564 2064   create nested d
+00009630: 6963 740d 0a20 2020 2020 2020 2020 2020  ict..           
+00009640: 2069 6620 6e6f 7420 2272 6566 6572 656e   if not "referen
+00009650: 6365 5f67 6c6f 6261 6c22 2069 6e20 6174  ce_global" in at
+00009660: 7472 3a0d 0a20 2020 2020 2020 2020 2020  tr:..           
+00009670: 2020 2020 2061 7474 725b 2272 6566 6572       attr["refer
+00009680: 656e 6365 5f67 6c6f 6261 6c22 5d20 3d20  ence_global"] = 
+00009690: 7b7d 0d0a 2020 2020 2020 2020 2020 2020  {}..            
+000096a0: 6966 206e 6f74 2072 6566 6572 656e 6365  if not reference
+000096b0: 5f74 6167 2069 6e20 6174 7472 5b22 7265  _tag in attr["re
+000096c0: 6665 7265 6e63 655f 676c 6f62 616c 225d  ference_global"]
+000096d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000096e0: 2020 2061 7474 725b 2272 6566 6572 656e     attr["referen
+000096f0: 6365 5f67 6c6f 6261 6c22 5d5b 7265 6665  ce_global"][refe
+00009700: 7265 6e63 655f 7461 675d 203d 207b 7d0d  rence_tag] = {}.
+00009710: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00009720: 2320 6c6f 6f70 2074 6872 6f75 6768 2065  # loop through e
+00009730: 6e74 7269 6573 2061 6e64 2073 6574 2061  ntries and set a
+00009740: 6374 6976 6520 7265 6665 7265 6e63 650d  ctive reference.
+00009750: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00009760: 666c 6167 732e 6163 7469 7661 7465 203d  flags.activate =
+00009770: 3d20 5472 7565 3a0d 0a20 2020 2020 2020  = True:..       
+00009780: 2020 2020 2020 2020 2066 6f72 206b 6579           for key
+00009790: 2c20 7661 6c75 6520 696e 2061 7474 725b  , value in attr[
+000097a0: 2272 6566 6572 656e 6365 5f67 6c6f 6261  "reference_globa
+000097b0: 6c22 5d2e 6974 656d 7328 293a 0d0a 2020  l"].items():..  
+000097c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000097d0: 2020 6966 206b 6579 203d 3d20 7265 6665    if key == refe
+000097e0: 7265 6e63 655f 7461 673a 0d0a 2020 2020  rence_tag:..    
+000097f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009800: 2020 2020 6174 7472 5b22 7265 6665 7265      attr["refere
+00009810: 6e63 655f 676c 6f62 616c 225d 5b6b 6579  nce_global"][key
+00009820: 5d5b 2261 6374 6976 6522 5d20 3d20 5472  ]["active"] = Tr
+00009830: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00009840: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00009850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009860: 2020 2020 2020 2061 7474 725b 2272 6566         attr["ref
+00009870: 6572 656e 6365 5f67 6c6f 6261 6c22 5d5b  erence_global"][
+00009880: 6b65 795d 5b22 6163 7469 7665 225d 203d  key]["active"] =
+00009890: 2046 616c 7365 0d0a 2020 2020 2020 2020   False..        
+000098a0: 2020 2020 2020 2020 7574 696c 735f 6c6f          utils_lo
+000098b0: 776c 6576 656c 2e5f 7361 7665 5f79 616d  wlevel._save_yam
+000098c0: 6c28 0d0a 2020 2020 2020 2020 2020 2020  l(..            
+000098d0: 2020 2020 2020 2020 6174 7472 2c20 6f73          attr, os
+000098e0: 2e70 6174 682e 6a6f 696e 2864 6972 5f70  .path.join(dir_p
+000098f0: 6174 682c 2022 6174 7472 6962 7574 6573  ath, "attributes
+00009900: 2e79 616d 6c22 290d 0a20 2020 2020 2020  .yaml")..       
+00009910: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+00009920: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00009930: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
+00009940: 2020 2020 2020 2020 2773 6574 7469 6e67          'setting
+00009950: 2061 6374 6976 6520 676c 6f62 616c 2070   active global p
+00009960: 726f 6a65 6374 2072 6566 6572 656e 6365  roject reference
+00009970: 2074 6f20 2227 0d0a 2020 2020 2020 2020   to "'..        
+00009980: 2020 2020 2020 2020 2020 2020 2b20 7265              + re
+00009990: 6665 7265 6e63 655f 7461 670d 0a20 2020  ference_tag..   
+000099a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099b0: 202b 2027 2220 666f 7220 270d 0a20 2020   + '" for '..   
+000099c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099d0: 202b 2064 6972 5f6e 616d 650d 0a20 2020   + dir_name..   
+000099e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099f0: 202b 2022 2028 6163 7469 7665 3d54 7275   + " (active=Tru
+00009a00: 6529 220d 0a20 2020 2020 2020 2020 2020  e)"..           
+00009a10: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00009a20: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00009a30: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00009a40: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00009a50: 2020 2020 2020 2022 636f 756c 6420 6e6f         "could no
+00009a60: 7420 7365 7420 676c 6f62 616c 2070 726f  t set global pro
+00009a70: 6a65 6374 2072 6566 6572 656e 6365 2066  ject reference f
+00009a80: 6f72 2022 0d0a 2020 2020 2020 2020 2020  or "..          
+00009a90: 2020 2020 2020 2020 2020 2b20 6469 725f            + dir_
+00009aa0: 6e61 6d65 0d0a 2020 2020 2020 2020 2020  name..          
+00009ab0: 2020 2020 2020 2020 2020 2b20 2220 286f            + " (o
+00009ac0: 7665 7277 7269 7465 3d46 616c 7365 2f61  verwrite=False/a
+00009ad0: 6374 6976 6174 653d 4661 6c73 6529 220d  ctivate=False)".
+00009ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009af0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00009b00: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00009b10: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
+00009b20: 6368 6563 6b5f 6669 6c65 7328 0d0a 2020  check_files(..  
+00009b30: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+00009b40: 0d0a 2020 2020 2020 2020 2020 2020 6665  ..            fe
+00009b50: 6564 6261 636b 3d54 7275 652c 0d0a 2020  edback=True,..  
+00009b60: 2020 2020 2020 2020 2020 696d 6167 655f            image_
+00009b70: 6c69 6e6b 733d 4661 6c73 652c 0d0a 2020  links=False,..  
+00009b80: 2020 2020 2020 2020 2020 6e65 775f 6469            new_di
+00009b90: 723d 4e6f 6e65 2c0d 0a20 2020 2020 2020  r=None,..       
+00009ba0: 2020 2020 2029 3a0d 0a20 2020 2020 2020       ):..       
+00009bb0: 2022 2222 0d0a 2020 2020 2020 2020 4368   """..        Ch
+00009bc0: 6563 6b20 616c 6c20 7072 6f6a 6563 7420  eck all project 
+00009bd0: 6669 6c65 7320 666f 7220 636f 6d70 6c65  files for comple
+00009be0: 7465 6e65 7373 2062 7920 636f 6d70 6172  teness by compar
+00009bf0: 696e 6720 7468 6520 696d 6167 6573 2069  ing the images i
+00009c00: 6e20 7468 650d 0a20 2020 2020 2020 2022  n the..        "
+00009c10: 6461 7461 2220 666f 6c64 6572 2074 6f20  data" folder to 
+00009c20: 7468 6520 6669 6c65 206c 6973 7420 7468  the file list th
+00009c30: 6520 7072 6f6a 6563 7420 6174 7472 6962  e project attrib
+00009c40: 7574 6573 2e20 5769 6c6c 2061 7474 656d  utes. Will attem
+00009c50: 7074 2074 6f20 0d0a 2020 2020 2020 2020  pt to ..        
+00009c60: 6669 7820 6469 7363 7265 7061 6e63 6965  fix discrepancie
+00009c70: 732c 2062 7574 2061 736b 2066 6f72 2066  s, but ask for f
+00009c80: 6565 6462 6163 6b20 6669 7273 742e 0d0a  eedback first...
+00009c90: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00009ca0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00009cb0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00009cc0: 2020 6665 6564 6261 636b 203a 2062 6f6f    feedback : boo
+00009cd0: 6c2c 206f 7074 696f 6e61 6c0d 0a20 2020  l, optional..   
+00009ce0: 2020 2020 2020 2020 2041 736b 7320 7768           Asks wh
+00009cf0: 6574 6865 7220 7072 6f6a 6563 7420 6174  ether project at
+00009d00: 7472 6962 7574 6573 2073 686f 756c 6420  tributes should 
+00009d10: 6265 2075 7064 6174 6564 2e20 5468 6520  be updated. The 
+00009d20: 6465 6661 756c 7420 6973 2054 7275 652e  default is True.
+00009d30: 0d0a 2020 2020 2020 2020 696d 6167 655f  ..        image_
+00009d40: 6c69 6e6b 7320 3a20 626f 6f6c 2c20 6f70  links : bool, op
+00009d50: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+00009d60: 2020 2020 6368 6563 6b73 2077 6865 7468      checks wheth
+00009d70: 6572 2069 6d61 6765 2063 616e 2062 6520  er image can be 
+00009d80: 6c6f 6164 6564 2066 726f 6d20 7061 7468  loaded from path
+00009d90: 2c20 6f74 6865 7277 6973 6520 7472 6965  , otherwise trie
+00009da0: 7320 746f 206c 6f61 6420 0d0a 2020 2020  s to load ..    
+00009db0: 2020 2020 2020 2020 6672 6f6d 206f 7269          from ori
+00009dc0: 6769 6e61 6c20 6669 6c65 7061 7468 2028  ginal filepath (
+00009dd0: 7769 6c6c 2061 736b 2066 6972 7374 292e  will ask first).
+00009de0: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+00009df0: 4661 6c73 652e 0d0a 2020 2020 2020 2020  False...        
+00009e00: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
+00009e10: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00009e20: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00009e30: 2020 4e6f 6e65 2e0d 0a0d 0a20 2020 2020    None.....     
+00009e40: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00009e50: 0d0a 2020 2020 2020 2020 2320 3d3d 3d3d  ..        # ====
+00009e60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009e70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009e80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009e90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009ea0: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
+00009eb0: 2020 2023 2073 6574 7570 0d0a 0d0a 2020     # setup....  
+00009ec0: 2020 2020 2020 2323 2073 6574 2066 6c61        ## set fla
+00009ed0: 6773 0d0a 2020 2020 2020 2020 666c 6167  gs..        flag
+00009ee0: 7320 3d20 6d61 6b65 5f64 6174 6163 6c61  s = make_datacla
+00009ef0: 7373 280d 0a20 2020 2020 2020 2020 2020  ss(..           
+00009f00: 2063 6c73 5f6e 616d 653d 2266 6c61 6773   cls_name="flags
+00009f10: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
+00009f20: 6669 656c 6473 3d5b 0d0a 2020 2020 2020  fields=[..      
+00009f30: 2020 2020 2020 2020 2020 2822 696d 6167            ("imag
+00009f40: 655f 6c69 6e6b 7322 2c20 626f 6f6c 2c20  e_links", bool, 
+00009f50: 696d 6167 655f 6c69 6e6b 7329 2c20 0d0a  image_links), ..
+00009f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f70: 2822 6665 6564 6261 636b 222c 2062 6f6f  ("feedback", boo
+00009f80: 6c2c 2066 6565 6462 6163 6b29 2c0d 0a20  l, feedback),.. 
+00009f90: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00009fa0: 2263 6865 636b 222c 2062 6f6f 6c2c 204e  "check", bool, N
+00009fb0: 6f6e 6529 2c0d 0a20 2020 2020 2020 2020  one),..         
+00009fc0: 2020 2020 2020 205d 2c0d 0a20 2020 2020         ],..     
+00009fd0: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
+00009fe0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00009ff0: 2020 2323 206c 6f61 6420 6669 6c65 6e61    ## load filena
+0000a000: 6d65 730d 0a20 2020 2020 2020 2069 6620  mes..        if 
+0000a010: 2266 696c 656e 616d 6573 2220 696e 2073  "filenames" in s
+0000a020: 656c 662e 6174 7472 6962 7574 6573 5b22  elf.attributes["
+0000a030: 7072 6f6a 6563 745f 6461 7461 225d 3a0d  project_data"]:.
+0000a040: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
+0000a050: 656e 616d 6573 203d 2073 656c 662e 6174  enames = self.at
+0000a060: 7472 6962 7574 6573 5b22 7072 6f6a 6563  tributes["projec
+0000a070: 745f 6461 7461 225d 5b22 6669 6c65 6e61  t_data"]["filena
+0000a080: 6d65 7322 5d0d 0a20 2020 2020 2020 2020  mes"]..         
+0000a090: 2020 2064 6972 6e61 6d65 7320 3d20 7365     dirnames = se
+0000a0a0: 6c66 2e61 7474 7269 6275 7465 735b 2270  lf.attributes["p
+0000a0b0: 726f 6a65 6374 5f64 6174 6122 5d5b 2264  roject_data"]["d
+0000a0c0: 6972 6e61 6d65 7322 5d0d 0a20 2020 2020  irnames"]..     
+0000a0d0: 2020 2065 6c69 6620 7365 6c66 2e61 7474     elif self.att
+0000a0e0: 7269 6275 7465 735b 2270 726f 6a65 6374  ributes["project
+0000a0f0: 5f64 6174 6122 5d2e 5f5f 636c 6173 735f  _data"].__class_
+0000a100: 5f2e 5f5f 6e61 6d65 5f5f 2069 6e20 5b22  _.__name__ in ["
+0000a110: 6c69 7374 222c 2243 6f6d 6d65 6e74 6564  list","Commented
+0000a120: 5365 7122 5d3a 0d0a 2020 2020 2020 2020  Seq"]:..        
+0000a130: 2020 2020 2064 6972 6e61 6d65 7320 3d20       dirnames = 
+0000a140: 7365 6c66 2e61 7474 7269 6275 7465 735b  self.attributes[
+0000a150: 2270 726f 6a65 6374 5f64 6174 6122 5d0d  "project_data"].
+0000a160: 0a20 2020 2020 2020 2020 2020 2020 6669  .             fi
+0000a170: 6c65 6e61 6d65 7320 3d20 5b5d 0d0a 2020  lenames = []..  
+0000a180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a190: 6174 7472 6962 7574 6573 5b22 7072 6f6a  attributes["proj
+0000a1a0: 6563 745f 6461 7461 225d 203d 207b 7d0d  ect_data"] = {}.
+0000a1b0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0000a1c0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0000a1d0: 7428 2263 6f75 6c64 206e 6f74 2072 6561  t("could not rea
+0000a1e0: 6420 7072 6f6a 6563 7420 6174 7472 6962  d project attrib
+0000a1f0: 7574 6573 2066 696c 6521 2229 0d0a 2020  utes file!")..  
+0000a200: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000a210: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0000a220: 2020 2020 2323 206d 616b 6520 6c69 7374      ## make list
+0000a230: 730d 0a20 2020 2020 2020 2066 696c 656e  s..        filen
+0000a240: 616d 6573 5f63 6865 636b 2c20 6469 726e  ames_check, dirn
+0000a250: 616d 6573 5f63 6865 636b 2c20 6e65 775f  ames_check, new_
+0000a260: 6469 725f 6669 6c65 7320 3d20 5b5d 2c20  dir_files = [], 
+0000a270: 5b5d 2c20 4e6f 6e65 0d0a 0d0a 2020 2020  [], None....    
+0000a280: 2020 2020 6966 206f 732e 7061 7468 2e69      if os.path.i
+0000a290: 7364 6972 2873 7472 286e 6577 5f64 6972  sdir(str(new_dir
+0000a2a0: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+0000a2b0: 206e 6577 5f64 6972 5f66 696c 6573 203d   new_dir_files =
+0000a2c0: 206f 732e 6c69 7374 6469 7228 6e65 775f   os.listdir(new_
+0000a2d0: 6469 7229 0d0a 2020 2020 2020 2020 2020  dir)..          
+0000a2e0: 2020 0d0a 2020 2020 2020 2020 666f 7220    ..        for 
+0000a2f0: 6469 7270 6174 6820 696e 2073 656c 662e  dirpath in self.
+0000a300: 6469 725f 7061 7468 733a 0d0a 2020 2020  dir_paths:..    
+0000a310: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+0000a320: 6573 5f70 6174 6820 3d20 6f73 2e70 6174  es_path = os.pat
+0000a330: 682e 6a6f 696e 2864 6972 7061 7468 2c20  h.join(dirpath, 
+0000a340: 2261 7474 7269 6275 7465 732e 7961 6d6c  "attributes.yaml
+0000a350: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0000a360: 6174 7472 6962 7574 6573 203d 2075 7469  attributes = uti
+0000a370: 6c73 5f6c 6f77 6c65 7665 6c2e 5f6c 6f61  ls_lowlevel._loa
+0000a380: 645f 7961 6d6c 2861 7474 7269 6275 7465  d_yaml(attribute
+0000a390: 735f 7061 7468 290d 0a20 2020 2020 2020  s_path)..       
+0000a3a0: 2020 2020 2066 696c 656e 616d 6520 3d20       filename = 
+0000a3b0: 6174 7472 6962 7574 6573 5b22 696d 6167  attributes["imag
+0000a3c0: 655f 6f72 6967 696e 616c 225d 5b22 6669  e_original"]["fi
+0000a3d0: 6c65 6e61 6d65 225d 0d0a 2020 2020 2020  lename"]..      
+0000a3e0: 2020 2020 2020 6669 6c65 6e61 6d65 735f        filenames_
+0000a3f0: 6368 6563 6b2e 6170 7065 6e64 2866 696c  check.append(fil
+0000a400: 656e 616d 6529 0d0a 2020 2020 2020 2020  ename)..        
+0000a410: 2020 2020 6469 726e 616d 6573 5f63 6865      dirnames_che
+0000a420: 636b 2e61 7070 656e 6428 6f73 2e70 6174  ck.append(os.pat
+0000a430: 682e 6261 7365 6e61 6d65 2864 6972 7061  h.basename(dirpa
+0000a440: 7468 2929 0d0a 2020 2020 2020 2020 2020  th))..          
+0000a450: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000a460: 6966 2066 6c61 6773 2e69 6d61 6765 5f6c  if flags.image_l
+0000a470: 696e 6b73 3a0d 0a20 2020 2020 2020 2020  inks:..         
+0000a480: 2020 2020 2020 2066 696c 6570 6174 6820         filepath 
+0000a490: 3d20 6174 7472 6962 7574 6573 5b22 696d  = attributes["im
+0000a4a0: 6167 655f 7068 656e 6f70 7970 6522 5d5b  age_phenopype"][
+0000a4b0: 2266 696c 6570 6174 6822 5d0d 0a20 2020  "filepath"]..   
+0000a4c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000a4d0: 6174 7472 6962 7574 6573 5b22 696d 6167  attributes["imag
+0000a4e0: 655f 7068 656e 6f70 7970 6522 5d5b 226d  e_phenopype"]["m
+0000a4f0: 6f64 6522 5d20 3d3d 2022 6c69 6e6b 223a  ode"] == "link":
+0000a500: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a510: 2020 2020 2020 6966 206e 6f74 206f 732e        if not os.
+0000a520: 7061 7468 2e69 7366 696c 6528 6f73 2e70  path.isfile(os.p
+0000a530: 6174 682e 6a6f 696e 2864 6972 7061 7468  ath.join(dirpath
+0000a540: 2c20 6669 6c65 7061 7468 2929 3a0d 0a20  , filepath)):.. 
+0000a550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a560: 2020 2020 2020 2070 7269 6e74 2822 436f         print("Co
+0000a570: 756c 6420 6e6f 7420 6669 6e64 2069 6d61  uld not find ima
+0000a580: 6765 2873 2920 7361 7665 6420 6f72 206c  ge(s) saved or l
+0000a590: 696e 6b65 6420 746f 2070 6865 6e6f 7079  inked to phenopy
+0000a5a0: 7065 2070 726f 6a65 6374 3a7b 7d22 2e66  pe project:{}".f
+0000a5b0: 6f72 6d61 7428 6669 6c65 6e61 6d65 2929  ormat(filename))
+0000a5c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a5d0: 2020 2020 2020 2020 2020 6966 206e 6577            if new
+0000a5e0: 5f64 6972 5f66 696c 6573 3a0d 0a20 2020  _dir_files:..   
+0000a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a600: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0000a610: 2d20 6174 7465 6d70 7469 6e67 2074 6f20  - attempting to 
+0000a620: 7265 6c69 6e6b 2066 726f 6d20 7b7d 222e  relink from {}".
+0000a630: 666f 726d 6174 286f 732e 7061 7468 2e62  format(os.path.b
+0000a640: 6173 656e 616d 6528 6e65 775f 6469 7229  asename(new_dir)
+0000a650: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0000a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a670: 6966 2066 696c 656e 616d 6520 696e 206e  if filename in n
+0000a680: 6577 5f64 6972 5f66 696c 6573 3a0d 0a20  ew_dir_files:.. 
+0000a690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6a0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000a6b0: 6577 5f66 696c 655f 7061 7468 203d 206f  ew_file_path = o
+0000a6c0: 732e 7061 7468 2e6a 6f69 6e28 6e65 775f  s.path.join(new_
+0000a6d0: 6469 722c 2066 696c 656e 616d 6529 0d0a  dir, filename)..
+0000a6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a700: 6174 7472 6962 7574 6573 5b22 696d 6167  attributes["imag
+0000a710: 655f 7068 656e 6f70 7970 6522 5d5b 2266  e_phenopype"]["f
+0000a720: 696c 6570 6174 6822 5d20 3d20 6f73 2e70  ilepath"] = os.p
+0000a730: 6174 682e 7265 6c70 6174 6828 6e65 775f  ath.relpath(new_
+0000a740: 6669 6c65 5f70 6174 682c 2064 6972 7061  file_path, dirpa
+0000a750: 7468 2920 0d0a 2020 2020 2020 2020 2020  th) ..          
+0000a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a770: 2020 2020 2020 7574 696c 735f 6c6f 776c        utils_lowl
+0000a780: 6576 656c 2e5f 7361 7665 5f79 616d 6c28  evel._save_yaml(
+0000a790: 6174 7472 6962 7574 6573 2c20 6174 7472  attributes, attr
+0000a7a0: 6962 7574 6573 5f70 6174 6829 0d0a 2020  ibutes_path)..  
+0000a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7c0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0000a7d0: 696e 7428 2246 696c 6520 666f 756e 6420  int("File found 
+0000a7e0: 616e 6420 7375 6363 6573 7366 756c 6c79  and successfully
+0000a7f0: 2072 656c 696e 6b65 6421 2229 0d0a 2020   relinked!")..  
+0000a800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a810: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0000a820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a840: 2070 7269 6e74 2822 4669 6c65 206e 6f74   print("File not
+0000a850: 2066 6f75 6e64 2069 6e20 7072 6f76 6964   found in provid
+0000a860: 6564 206e 6577 5f64 6972 2122 290d 0a20  ed new_dir!").. 
+0000a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a880: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0000a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a8a0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0000a8b0: 224e 6f20 6469 7265 6374 6f72 7920 7072  "No directory pr
+0000a8c0: 6f76 6964 6564 2066 6f72 2072 656c 696e  ovided for relin
+0000a8d0: 6b69 6e67 2122 290d 0a20 2020 2020 2020  king!")..       
+0000a8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a8f0: 2020 2020 2069 6620 666c 6167 732e 6368       if flags.ch
+0000a900: 6563 6b2e 5f5f 636c 6173 735f 5f2e 5f5f  eck.__class__.__
+0000a910: 6e61 6d65 5f5f 203d 3d20 224e 6f6e 6554  name__ == "NoneT
+0000a920: 7970 6522 3a0d 0a20 2020 2020 2020 2020  ype":..         
+0000a930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a940: 2020 2020 2020 2066 6c61 6773 2e63 6865         flags.che
+0000a950: 636b 203d 2069 6e70 7574 2822 5c6e 4368  ck = input("\nCh
+0000a960: 6563 6b20 6f72 6967 696e 616c 2066 696c  eck original fil
+0000a970: 6570 6174 6820 616e 6420 7265 6c69 6e6b  epath and relink
+0000a980: 2069 6620 706f 7373 6962 6c65 205b 616c   if possible [al
+0000a990: 736f 2066 6f72 2061 6c6c 206f 7468 6572  so for all other
+0000a9a0: 2062 726f 6b65 6e20 7061 7468 735d 2028   broken paths] (
+0000a9b0: 792f 6e29 3f5c 6e22 290d 0a20 2020 2020  y/n)?\n")..     
+0000a9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a9d0: 2020 2020 2020 2069 6620 666c 6167 732e         if flags.
+0000a9e0: 6368 6563 6b20 696e 2073 6574 7469 6e67  check in setting
+0000a9f0: 732e 636f 6e66 6972 6d5f 6f70 7469 6f6e  s.confirm_option
+0000aa00: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+0000aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa20: 2020 2020 6669 6c65 7061 7468 203d 2061      filepath = a
+0000aa30: 7474 7269 6275 7465 735b 2269 6d61 6765  ttributes["image
+0000aa40: 5f6f 7269 6769 6e61 6c22 5d5b 2266 696c  _original"]["fil
+0000aa50: 6570 6174 6822 5d0d 0a20 2020 2020 2020  epath"]..       
+0000aa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa70: 2020 2020 2020 2020 2069 6620 6f73 2e70           if os.p
+0000aa80: 6174 682e 6973 6669 6c65 2866 696c 6570  ath.isfile(filep
+0000aa90: 6174 6829 3a0d 0a20 2020 2020 2020 2020  ath):..         
+0000aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aab0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+0000aac0: 6275 7465 735b 2269 6d61 6765 5f70 6865  butes["image_phe
+0000aad0: 6e6f 7079 7065 225d 5b22 6669 6c65 7061  nopype"]["filepa
+0000aae0: 7468 225d 203d 206f 732e 7061 7468 2e72  th"] = os.path.r
+0000aaf0: 656c 7061 7468 2866 696c 6570 6174 682c  elpath(filepath,
+0000ab00: 2064 6972 7061 7468 290d 0a20 2020 2020   dirpath)..     
+0000ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000ab30: 7269 6e74 2822 5265 2d6c 696e 6b69 6e67  rint("Re-linking
+0000ab40: 2073 7563 6365 7373 6675 6c20 2d20 7361   successful - sa
+0000ab50: 7669 6e67 206e 6577 2070 6174 6820 746f  ving new path to
+0000ab60: 2061 7474 7269 6275 7465 7321 2229 0d0a   attributes!")..
+0000ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab90: 2020 2020 7574 696c 735f 6c6f 776c 6576      utils_lowlev
+0000aba0: 656c 2e5f 7361 7665 5f79 616d 6c28 6174  el._save_yaml(at
+0000abb0: 7472 6962 7574 6573 2c20 6174 7472 6962  tributes, attrib
+0000abc0: 7574 6573 5f70 6174 6829 0d0a 2020 2020  utes_path)..    
+0000abd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000abe0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000abf0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac10: 2020 2020 2070 7269 6e74 2822 4669 6c65       print("File
+0000ac20: 206e 6f74 2066 6f75 6e64 202d 2063 6f75   not found - cou
+0000ac30: 6c64 206e 6f74 2072 652d 6c69 6e6b 2122  ld not re-link!"
+0000ac40: 290d 0a0d 0a20 2020 2020 2020 2066 696c  )....        fil
+0000ac50: 656e 616d 6573 5f75 6e6d 6174 6368 6564  enames_unmatched
+0000ac60: 2c20 6469 726e 616d 6573 5f75 6e6d 6174  , dirnames_unmat
+0000ac70: 6368 6564 203d 205b 5d2c 205b 5d0d 0a20  ched = [], [].. 
+0000ac80: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000ac90: 2066 6f72 2066 696c 656e 616d 6520 696e   for filename in
+0000aca0: 2066 696c 656e 616d 6573 3a0d 0a20 2020   filenames:..   
+0000acb0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0000acc0: 6669 6c65 6e61 6d65 2069 6e20 6669 6c65  filename in file
+0000acd0: 6e61 6d65 735f 6368 6563 6b3a 0d0a 2020  names_check:..  
+0000ace0: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+0000acf0: 6c65 6e61 6d65 735f 756e 6d61 7463 6865  lenames_unmatche
+0000ad00: 642e 6170 7065 6e64 2866 696c 656e 616d  d.append(filenam
+0000ad10: 6529 0d0a 0d0a 2020 2020 2020 2020 666f  e)....        fo
+0000ad20: 7220 6469 726e 616d 6520 696e 2064 6972  r dirname in dir
+0000ad30: 6e61 6d65 733a 0d0a 2020 2020 2020 2020  names:..        
+0000ad40: 2020 2020 6966 206e 6f74 2066 696c 656e      if not filen
+0000ad50: 616d 6520 696e 2064 6972 6e61 6d65 735f  ame in dirnames_
+0000ad60: 6368 6563 6b3a 0d0a 2020 2020 2020 2020  check:..        
+0000ad70: 2020 2020 2020 2020 6469 726e 616d 6573          dirnames
+0000ad80: 5f75 6e6d 6174 6368 6564 2e61 7070 656e  _unmatched.appen
+0000ad90: 6428 6669 6c65 6e61 6d65 2920 200d 0a20  d(filename)  .. 
+0000ada0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+0000adb0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0000adc0: 6669 6c65 6e61 6d65 735f 756e 6d61 7463  filenames_unmatc
+0000add0: 6865 6429 203e 2030 3a0d 0a20 2020 2020  hed) > 0:..     
+0000ade0: 2020 2020 2020 2070 7269 6e74 2866 696c         print(fil
+0000adf0: 656e 616d 6573 5f75 6e6d 6174 6368 6564  enames_unmatched
+0000ae00: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+0000ae10: 7269 6e74 2822 5c6e 2229 0d0a 2020 2020  rint("\n")..    
+0000ae20: 2020 2020 2020 2020 7072 696e 7428 222d          print("-
+0000ae30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ae40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ae50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d22 290d 0a20  -----------").. 
+0000ae60: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0000ae70: 2822 7068 656e 6f70 7970 6520 666f 756e  ("phenopype foun
+0000ae80: 6420 7b7d 2066 696c 6573 2069 6e20 7468  d {} files in th
+0000ae90: 6520 6461 7461 2066 6f6c 6465 722c 2062  e data folder, b
+0000aea0: 7574 207b 7d20 6672 6f6d 2074 6865 2070  ut {} from the p
+0000aeb0: 726f 6a65 6374 2061 7474 7269 6275 7465  roject attribute
+0000aec0: 7320 6172 6520 756e 6163 636f 756e 7465  s are unaccounte
+0000aed0: 6420 666f 722e 222e 666f 726d 6174 280d  d for.".format(.
+0000aee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000aef0: 206c 656e 2866 696c 656e 616d 6573 5f63   len(filenames_c
+0000af00: 6865 636b 292c 0d0a 2020 2020 2020 2020  heck),..        
+0000af10: 2020 2020 2020 2020 6c65 6e28 6669 6c65          len(file
+0000af20: 6e61 6d65 735f 756e 6d61 7463 6865 6429  names_unmatched)
+0000af30: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0000af40: 7469 6d65 2e73 6c65 6570 2831 290d 0a20  time.sleep(1).. 
+0000af50: 2020 2020 2020 2020 2020 2069 6620 666c             if fl
+0000af60: 6167 732e 6665 6564 6261 636b 3a0d 0a20  ags.feedback:.. 
+0000af70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000af80: 6865 636b 203d 2069 6e70 7574 2822 7570  heck = input("up
+0000af90: 6461 7465 2070 726f 6a65 6374 2061 7474  date project att
+0000afa0: 7269 6275 7465 7320 2879 2f6e 293f 2229  ributes (y/n)?")
+0000afb0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0000afc0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000afd0: 2020 2020 2063 6865 636b 203d 2022 7922       check = "y"
+0000afe0: 0d0a 2020 2020 2020 2020 656c 6966 206c  ..        elif l
+0000aff0: 656e 2866 696c 656e 616d 6573 2920 3d3d  en(filenames) ==
+0000b000: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+0000b010: 2070 7269 6e74 2822 5c6e 2229 0d0a 2020   print("\n")..  
+0000b020: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0000b030: 222d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  "---------------
+0000b040: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d22 290d  -------------").
+0000b060: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0000b070: 6e74 2822 7068 656e 6f70 7970 6520 666f  nt("phenopype fo
+0000b080: 756e 6420 7b7d 2066 696c 6573 2069 6e20  und {} files in 
+0000b090: 7468 6520 6461 7461 2066 6f6c 6465 722c  the data folder,
+0000b0a0: 2062 7574 2030 2061 7265 206c 6973 7465   but 0 are liste
+0000b0b0: 6420 696e 2074 6865 2070 726f 6a65 6374  d in the project
+0000b0c0: 2061 7474 7269 6275 7465 732e 222e 666f   attributes.".fo
+0000b0d0: 726d 6174 286c 656e 2866 696c 656e 616d  rmat(len(filenam
+0000b0e0: 6573 5f63 6865 636b 2929 290d 0a20 2020  es_check)))..   
+0000b0f0: 2020 2020 2020 2020 2074 696d 652e 736c           time.sl
+0000b100: 6565 7028 3129 0d0a 2020 2020 2020 2020  eep(1)..        
+0000b110: 2020 2020 6966 2066 6c61 6773 2e66 6565      if flags.fee
+0000b120: 6462 6163 6b3a 0d0a 2020 2020 2020 2020  dback:..        
+0000b130: 2020 2020 2020 2020 6368 6563 6b20 3d20          check = 
+0000b140: 696e 7075 7428 2275 7064 6174 6520 7072  input("update pr
+0000b150: 6f6a 6563 7420 6174 7472 6962 7574 6573  oject attributes
+0000b160: 2028 792f 6e29 3f22 290d 0a20 2020 2020   (y/n)?")..     
+0000b170: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0000b180: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+0000b190: 6563 6b20 3d20 2279 220d 0a20 2020 2020  eck = "y"..     
+0000b1a0: 2020 2065 6c69 6620 6c65 6e28 6669 6c65     elif len(file
+0000b1b0: 6e61 6d65 7329 203c 206c 656e 2866 696c  names) < len(fil
+0000b1c0: 656e 616d 6573 5f63 6865 636b 293a 0d0a  enames_check):..
+0000b1d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0000b1e0: 7428 225c 6e22 290d 0a20 2020 2020 2020  t("\n")..       
+0000b1f0: 2020 2020 2070 7269 6e74 2822 2d2d 2d2d       print("----
+0000b200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b220: 2d2d 2d2d 2d2d 2d2d 2229 0d0a 2020 2020  --------")..    
+0000b230: 2020 2020 2020 2020 7072 696e 7428 2270          print("p
+0000b240: 6865 6e6f 7079 7065 2066 6f75 6e64 207b  henopype found {
+0000b250: 7d20 6669 6c65 7320 696e 2074 6865 2064  } files in the d
+0000b260: 6174 6120 666f 6c64 6572 2c20 6275 7420  ata folder, but 
+0000b270: 6f6e 6c79 207b 7d20 6172 6520 6c69 7374  only {} are list
+0000b280: 6564 2069 6e20 7468 6520 7072 6f6a 6563  ed in the projec
+0000b290: 7420 6174 7472 6962 7574 6573 2e22 2e66  t attributes.".f
+0000b2a0: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
+0000b2b0: 2020 2020 2020 2020 6c65 6e28 6669 6c65          len(file
+0000b2c0: 6e61 6d65 735f 6368 6563 6b29 2c0d 0a20  names_check),.. 
+0000b2d0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0000b2e0: 656e 2866 696c 656e 616d 6573 290d 0a20  en(filenames).. 
+0000b2f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000b300: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
+0000b310: 696d 652e 736c 6565 7028 3129 0d0a 2020  ime.sleep(1)..  
+0000b320: 2020 2020 2020 2020 2020 6966 2066 6c61            if fla
+0000b330: 6773 2e66 6565 6462 6163 6b3a 0d0a 2020  gs.feedback:..  
+0000b340: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+0000b350: 6563 6b20 3d20 696e 7075 7428 2275 7064  eck = input("upd
+0000b360: 6174 6520 7072 6f6a 6563 7420 6174 7472  ate project attr
+0000b370: 6962 7574 6573 2028 792f 6e29 3f22 290d  ibutes (y/n)?").
+0000b380: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0000b390: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0000b3a0: 2020 2020 6368 6563 6b20 3d20 2279 220d      check = "y".
+0000b3b0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0000b3c0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0000b3d0: 7428 2241 6c6c 2063 6865 636b 7320 7061  t("All checks pa
+0000b3e0: 7373 6564 202d 206e 756d 6265 7273 2069  ssed - numbers i
+0000b3f0: 6e20 6461 7461 2066 6f6c 6465 7220 616e  n data folder an
+0000b400: 6420 6174 7472 6962 7574 6573 2066 696c  d attributes fil
+0000b410: 6520 6d61 7463 682e 2229 0d0a 2020 2020  e match.")..    
+0000b420: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
+0000b430: 0d0a 2020 2020 2020 2020 6966 2063 6865  ..        if che
+0000b440: 636b 2069 6e20 7365 7474 696e 6773 2e63  ck in settings.c
+0000b450: 6f6e 6669 726d 5f6f 7074 696f 6e73 3a0d  onfirm_options:.
+0000b460: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0000b470: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000b480: 6174 7472 6962 7574 6573 5b22 7072 6f6a  attributes["proj
+0000b490: 6563 745f 6461 7461 225d 2e70 6f70 2822  ect_data"].pop("
+0000b4a0: 6669 6c65 6e61 6d65 7322 2c20 4e6f 6e65  filenames", None
+0000b4b0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0000b4c0: 656c 662e 6174 7472 6962 7574 6573 5b22  elf.attributes["
+0000b4d0: 7072 6f6a 6563 745f 6461 7461 225d 2e70  project_data"].p
+0000b4e0: 6f70 2822 6469 726e 616d 6573 222c 204e  op("dirnames", N
+0000b4f0: 6f6e 6529 0d0a 2020 2020 2020 2020 2020  one)..          
+0000b500: 2020 7365 6c66 2e61 7474 7269 6275 7465    self.attribute
+0000b510: 735b 2270 726f 6a65 6374 5f64 6174 6122  s["project_data"
+0000b520: 5d5b 2266 696c 656e 616d 6573 225d 203d  ]["filenames"] =
+0000b530: 2066 696c 656e 616d 6573 5f63 6865 636b   filenames_check
+0000b540: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0000b550: 6c66 2e61 7474 7269 6275 7465 735b 2270  lf.attributes["p
+0000b560: 726f 6a65 6374 5f64 6174 6122 5d5b 2264  roject_data"]["d
+0000b570: 6972 6e61 6d65 7322 5d20 3d20 6469 726e  irnames"] = dirn
+0000b580: 616d 6573 5f63 6865 636b 0d0a 2020 2020  ames_check..    
+0000b590: 2020 2020 2020 2020 7365 6c66 2e66 696c          self.fil
+0000b5a0: 655f 6e61 6d65 7320 3d20 6669 6c65 6e61  e_names = filena
+0000b5b0: 6d65 735f 6368 6563 6b0d 0a20 2020 2020  mes_check..     
+0000b5c0: 2020 2020 2020 2073 656c 662e 6469 725f         self.dir_
+0000b5d0: 6e61 6d65 7320 3d20 6469 726e 616d 6573  names = dirnames
+0000b5e0: 5f63 6865 636b 0d0a 2020 2020 2020 2020  _check..        
+0000b5f0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000b600: 2020 7574 696c 735f 6c6f 776c 6576 656c    utils_lowlevel
+0000b610: 2e5f 7361 7665 5f79 616d 6c28 7365 6c66  ._save_yaml(self
+0000b620: 2e61 7474 7269 6275 7465 732c 2073 656c  .attributes, sel
+0000b630: 662e 6174 7472 6962 7574 6573 5f70 6174  f.attributes_pat
+0000b640: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
+0000b650: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+0000b660: 696e 7428 2270 726f 6a65 6374 2061 7474  int("project att
+0000b670: 7269 6275 7465 7320 7570 6461 7465 643b  ributes updated;
+0000b680: 206e 6f77 2068 6173 207b 7d20 6669 6c65   now has {} file
+0000b690: 7322 2e66 6f72 6d61 7428 6c65 6e28 6669  s".format(len(fi
+0000b6a0: 6c65 6e61 6d65 735f 6368 6563 6b29 2929  lenames_check)))
+0000b6b0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0000b6c0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0000b6d0: 6e74 2822 7072 6f6a 6563 7420 6174 7472  nt("project attr
+0000b6e0: 6962 7574 6573 206e 6f74 2075 7064 6174  ibutes not updat
+0000b6f0: 6564 2229 0d0a 2020 2020 2020 2020 7072  ed")..        pr
+0000b700: 696e 7428 222d 2d2d 2d2d 2d2d 2d2d 2d2d  int("-----------
+0000b710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b730: 2d22 2920 2020 200d 0a20 2020 2020 2020  -")    ..       
+0000b740: 200d 0a0d 0a20 2020 2064 6566 2063 6f6c   ....    def col
+0000b750: 6c65 6374 5f72 6573 756c 7473 2873 656c  lect_results(sel
+0000b760: 662c 2074 6167 2c20 6669 6c65 732c 2066  f, tag, files, f
+0000b770: 6f6c 6465 722c 206f 7665 7277 7269 7465  older, overwrite
+0000b780: 3d46 616c 7365 2c20 2a2a 6b77 6172 6773  =False, **kwargs
+0000b790: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+0000b7a0: 220d 0a20 2020 2020 2020 2043 6f6c 6c65  "..        Colle
+0000b7b0: 6374 2063 616e 7661 7320 6672 6f6d 2065  ct canvas from e
+0000b7c0: 6163 6820 666f 6c64 6572 2069 6e20 7468  ach folder in th
+0000b7d0: 6520 7072 6f6a 6563 7420 7472 6565 2e20  e project tree. 
+0000b7e0: 5365 6172 6368 2062 7920 0d0a 2020 2020  Search by ..    
+0000b7f0: 2020 2020 6e61 6d65 2f73 6166 655f 7375      name/safe_su
+0000b800: 6666 6978 2028 652e 672e 2022 7631 2229  ffix (e.g. "v1")
+0000b810: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+0000b820: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0000b830: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0000b840: 2020 2020 206e 616d 6520 3a20 7374 720d       name : str.
+0000b850: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+0000b860: 6520 6f66 2074 6865 2070 7970 6520 6f72  e of the pype or
+0000b870: 2073 6176 655f 7375 6666 6978 0d0a 2020   save_suffix..  
+0000b880: 2020 2020 2020 666f 6c64 6572 203a 2073        folder : s
+0000b890: 7472 2c20 6f70 7469 6f6e 616c 0d0a 2020  tr, optional..  
+0000b8a0: 2020 2020 2020 2020 2020 666f 6c64 6572            folder
+0000b8b0: 2069 6e20 7468 6520 726f 6f74 2064 6972   in the root dir
+0000b8c0: 6563 746f 7279 2077 6865 7265 2074 6865  ectory where the
+0000b8d0: 2072 6573 756c 7473 2061 7265 2073 746f   results are sto
+0000b8e0: 7265 640d 0a20 2020 2020 2020 206f 7665  red..        ove
+0000b8f0: 7277 7269 7465 203a 2062 6f6f 6c2c 206f  rwrite : bool, o
+0000b900: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+0000b910: 2020 2020 2073 686f 756c 6420 7468 6520       should the 
+0000b920: 7265 7375 6c74 7320 6265 206f 7665 7277  results be overw
+0000b930: 7269 7474 656e 0d0a 0d0a 2020 2020 2020  ritten....      
+0000b940: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+0000b950: 2023 2320 7365 7420 666c 6167 730d 0a20   ## set flags.. 
+0000b960: 2020 2020 2020 2066 6c61 6773 203d 206d         flags = m
+0000b970: 616b 655f 6461 7461 636c 6173 7328 0d0a  ake_dataclass(..
+0000b980: 2020 2020 2020 2020 2020 2020 636c 735f              cls_
+0000b990: 6e61 6d65 3d22 666c 6167 7322 2c20 6669  name="flags", fi
+0000b9a0: 656c 6473 3d5b 2822 6f76 6572 7772 6974  elds=[("overwrit
+0000b9b0: 6522 2c20 626f 6f6c 2c20 6f76 6572 7772  e", bool, overwr
+0000b9c0: 6974 6529 5d0d 0a20 2020 2020 2020 2029  ite)]..        )
+0000b9d0: 0d0a 0d0a 2020 2020 2020 2020 7265 7375  ....        resu
+0000b9e0: 6c74 735f 7061 7468 203d 206f 732e 7061  lts_path = os.pa
+0000b9f0: 7468 2e6a 6f69 6e28 7365 6c66 2e72 6f6f  th.join(self.roo
+0000ba00: 745f 6469 722c 2022 7265 7375 6c74 7322  t_dir, "results"
+0000ba10: 2c20 666f 6c64 6572 290d 0a0d 0a20 2020  , folder)....   
+0000ba20: 2020 2020 2069 6620 6e6f 7420 6f73 2e70       if not os.p
+0000ba30: 6174 682e 6973 6469 7228 7265 7375 6c74  ath.isdir(result
+0000ba40: 735f 7061 7468 293a 0d0a 2020 2020 2020  s_path):..      
+0000ba50: 2020 2020 2020 6f73 2e6d 616b 6564 6972        os.makedir
+0000ba60: 7328 7265 7375 6c74 735f 7061 7468 290d  s(results_path).
+0000ba70: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0000ba80: 6e74 2822 4372 6561 7465 6420 2220 2b20  nt("Created " + 
+0000ba90: 7265 7375 6c74 735f 7061 7468 290d 0a0d  results_path)...
+0000baa0: 0a20 2020 2020 2020 2023 2320 7365 6172  .        ## sear
+0000bab0: 6368 2073 7472 696e 670d 0a20 2020 2020  ch string..     
+0000bac0: 2020 2069 6620 6e6f 7420 6669 6c65 732e     if not files.
+0000bad0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+0000bae0: 5f5f 203d 3d20 224e 6f6e 6554 7970 6522  __ == "NoneType"
+0000baf0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+0000bb00: 6620 6e6f 7420 6669 6c65 732e 5f5f 636c  f not files.__cl
+0000bb10: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 203d  ass__.__name__ =
+0000bb20: 3d20 226c 6973 7422 3a0d 0a20 2020 2020  = "list":..     
+0000bb30: 2020 2020 2020 2020 2020 2066 696c 6573             files
+0000bb40: 203d 205b 6669 6c65 735d 0d0a 2020 2020   = [files]..    
+0000bb50: 2020 2020 2020 2020 7365 6172 6368 5f73          search_s
+0000bb60: 7472 696e 6773 203d 205b 5d0d 0a20 2020  trings = []..   
+0000bb70: 2020 2020 2020 2020 2066 6f72 2066 696c           for fil
+0000bb80: 6520 696e 2066 696c 6573 3a0d 0a20 2020  e in files:..   
+0000bb90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000bba0: 6e6f 7420 7461 6720 3d3d 2022 223a 0d0a  not tag == "":..
+0000bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bbc0: 2020 2020 7365 6172 6368 5f73 7472 696e      search_strin
+0000bbd0: 6773 2e61 7070 656e 6428 6669 6c65 202b  gs.append(file +
+0000bbe0: 2022 5f22 202b 2074 6167 290d 0a20 2020   "_" + tag)..   
+0000bbf0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0000bc00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0000bc10: 2020 2020 2020 2020 7365 6172 6368 5f73          search_s
+0000bc20: 7472 696e 6773 2e61 7070 656e 6428 6669  trings.append(fi
+0000bc30: 6c65 290d 0a20 2020 2020 2020 2065 6c73  le)..        els
+0000bc40: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0000bc50: 7365 6172 6368 5f73 7472 696e 6773 203d  search_strings =
+0000bc60: 2074 6167 0d0a 0d0a 2020 2020 2020 2020   tag....        
+0000bc70: 2323 2061 7070 656e 6420 6e61 6d65 0d0a  ## append name..
+0000bc80: 2020 2020 2020 2020 7072 696e 7428 2253          print("S
+0000bc90: 6561 7263 6820 7374 7269 6e67 3a20 2220  earch string: " 
+0000bca0: 2b20 7374 7228 7365 6172 6368 5f73 7472  + str(search_str
+0000bcb0: 696e 6773 2929 0d0a 0d0a 2020 2020 2020  ings))....      
+0000bcc0: 2020 2323 2065 7863 6c75 6465 2073 7472    ## exclude str
+0000bcd0: 696e 6773 0d0a 2020 2020 2020 2020 6578  ings..        ex
+0000bce0: 636c 7564 6520 3d20 6b77 6172 6773 2e67  clude = kwargs.g
+0000bcf0: 6574 2822 6578 636c 7564 6522 2c20 5b5d  et("exclude", []
+0000bd00: 290d 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+0000bd10: 7420 6578 636c 7564 652e 5f5f 636c 6173  t exclude.__clas
+0000bd20: 735f 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20  s__.__name__ == 
+0000bd30: 224e 6f6e 6554 7970 6522 3a0d 0a20 2020  "NoneType":..   
+0000bd40: 2020 2020 2020 2020 2069 6620 6578 636c           if excl
+0000bd50: 7564 652e 5f5f 636c 6173 735f 5f2e 5f5f  ude.__class__.__
+0000bd60: 6e61 6d65 5f5f 203d 3d20 2273 7472 223a  name__ == "str":
+0000bd70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000bd80: 2020 6578 636c 7564 6520 3d20 5b65 7863    exclude = [exc
+0000bd90: 6c75 6465 5d0d 0a0d 0a20 2020 2020 2020  lude]....       
+0000bda0: 2023 2320 7365 6172 6368 0d0a 2020 2020   ## search..    
+0000bdb0: 2020 2020 666f 756e 642c 2064 7570 6c69      found, dupli
+0000bdc0: 6361 7465 7320 3d20 7574 696c 735f 6c6f  cates = utils_lo
+0000bdd0: 776c 6576 656c 2e5f 6669 6c65 5f77 616c  wlevel._file_wal
+0000bde0: 6b65 7228 0d0a 2020 2020 2020 2020 2020  ker(..          
+0000bdf0: 2020 6f73 2e70 6174 682e 6a6f 696e 2873    os.path.join(s
+0000be00: 656c 662e 726f 6f74 5f64 6972 2c20 2264  elf.root_dir, "d
+0000be10: 6174 6122 292c 0d0a 2020 2020 2020 2020  ata"),..        
+0000be20: 2020 2020 7265 6375 7273 6976 653d 5472      recursive=Tr
+0000be30: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
+0000be40: 2069 6e63 6c75 6465 3d73 6561 7263 685f   include=search_
+0000be50: 7374 7269 6e67 732c 0d0a 2020 2020 2020  strings,..      
+0000be60: 2020 2020 2020 6578 636c 7564 653d 5b22        exclude=["
+0000be70: 7079 7065 5f63 6f6e 6669 6722 5d20 2b20  pype_config"] + 
+0000be80: 6578 636c 7564 652c 0d0a 2020 2020 2020  exclude,..      
+0000be90: 2020 290d 0a0d 0a20 2020 2020 2020 2023    )....        #
+0000bea0: 2320 636f 6c6c 6563 740d 0a20 2020 2020  # collect..     
+0000beb0: 2020 2066 6f72 2066 696c 655f 7061 7468     for file_path
+0000bec0: 2069 6e20 666f 756e 643a 0d0a 2020 2020   in found:..    
+0000bed0: 2020 2020 2020 2020 7072 696e 7428 0d0a          print(..
+0000bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bef0: 2243 6f6c 6c65 6374 6564 2022 0d0a 2020  "Collected "..  
+0000bf00: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+0000bf10: 6f73 2e70 6174 682e 6261 7365 6e61 6d65  os.path.basename
+0000bf20: 2866 696c 655f 7061 7468 290d 0a20 2020  (file_path)..   
+0000bf30: 2020 2020 2020 2020 2020 2020 202b 2022               + "
+0000bf40: 2066 726f 6d20 220d 0a20 2020 2020 2020   from "..       
+0000bf50: 2020 2020 2020 2020 202b 206f 732e 7061           + os.pa
+0000bf60: 7468 2e62 6173 656e 616d 6528 6f73 2e70  th.basename(os.p
+0000bf70: 6174 682e 6469 726e 616d 6528 6669 6c65  ath.dirname(file
+0000bf80: 5f70 6174 6829 290d 0a20 2020 2020 2020  _path))..       
+0000bf90: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0000bfa0: 2020 2020 6669 6c65 6e61 6d65 203d 2028      filename = (
+0000bfb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000bfc0: 2020 6f73 2e70 6174 682e 6261 7365 6e61    os.path.basena
+0000bfd0: 6d65 286f 732e 7061 7468 2e64 6972 6e61  me(os.path.dirna
+0000bfe0: 6d65 2866 696c 655f 7061 7468 2929 0d0a  me(file_path))..
+0000bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c000: 2b20 225f 220d 0a20 2020 2020 2020 2020  + "_"..         
+0000c010: 2020 2020 2020 202b 206f 732e 7061 7468         + os.path
+0000c020: 2e62 6173 656e 616d 6528 6669 6c65 5f70  .basename(file_p
+0000c030: 6174 6829 0d0a 2020 2020 2020 2020 2020  ath)..          
+0000c040: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+0000c050: 2070 6174 6820 3d20 6f73 2e70 6174 682e   path = os.path.
+0000c060: 6a6f 696e 2872 6573 756c 7473 5f70 6174  join(results_pat
+0000c070: 682c 2066 696c 656e 616d 6529 0d0a 0d0a  h, filename)....
+0000c080: 2020 2020 2020 2020 2020 2020 2323 206f              ## o
+0000c090: 7665 7277 7269 7465 2063 6865 636b 0d0a  verwrite check..
+0000c0a0: 2020 2020 2020 2020 2020 2020 7768 696c              whil
+0000c0b0: 6520 5472 7565 3a0d 0a20 2020 2020 2020  e True:..       
+0000c0c0: 2020 2020 2020 2020 2069 6620 6f73 2e70           if os.p
+0000c0d0: 6174 682e 6973 6669 6c65 2870 6174 6829  ath.isfile(path)
+0000c0e0: 2061 6e64 2066 6c61 6773 2e6f 7665 7277   and flags.overw
+0000c0f0: 7269 7465 203d 3d20 4661 6c73 653a 0d0a  rite == False:..
+0000c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c110: 2020 2020 7072 696e 7428 0d0a 2020 2020      print(..    
+0000c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c130: 2020 2020 6669 6c65 6e61 6d65 202b 2022      filename + "
+0000c140: 206e 6f74 2073 6176 6564 202d 2066 696c   not saved - fil
+0000c150: 6520 616c 7265 6164 7920 6578 6973 7473  e already exists
+0000c160: 2028 6f76 6572 7772 6974 653d 4661 6c73   (overwrite=Fals
+0000c170: 6529 2e22 0d0a 2020 2020 2020 2020 2020  e)."..          
+0000c180: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+0000c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c1a0: 2062 7265 616b 0d0a 2020 2020 2020 2020   break..        
+0000c1b0: 2020 2020 2020 2020 656c 6966 206f 732e          elif os.
+0000c1c0: 7061 7468 2e69 7366 696c 6528 7061 7468  path.isfile(path
+0000c1d0: 2920 616e 6420 666c 6167 732e 6f76 6572  ) and flags.over
+0000c1e0: 7772 6974 6520 3d3d 2054 7275 653a 0d0a  write == True:..
+0000c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c200: 2020 2020 7072 696e 7428 6669 6c65 6e61      print(filena
+0000c210: 6d65 202b 2022 2073 6176 6564 2075 6e64  me + " saved und
+0000c220: 6572 2022 202b 2070 6174 6820 2b20 2220  er " + path + " 
+0000c230: 286f 7665 7277 7269 7474 656e 292e 2229  (overwritten).")
+0000c240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c250: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+0000c260: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0000c270: 206e 6f74 206f 732e 7061 7468 2e69 7366   not os.path.isf
+0000c280: 696c 6528 7061 7468 293a 0d0a 2020 2020  ile(path):..    
+0000c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c2a0: 7072 696e 7428 6669 6c65 6e61 6d65 202b  print(filename +
+0000c2b0: 2022 2073 6176 6564 2075 6e64 6572 2022   " saved under "
+0000c2c0: 202b 2070 6174 6820 2b20 222e 2229 0d0a   + path + ".")..
+0000c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c2e0: 2020 2020 7061 7373 0d0a 2020 2020 2020      pass..      
+0000c2f0: 2020 2020 2020 2020 2020 7368 7574 696c            shutil
+0000c300: 2e63 6f70 7966 696c 6528 6669 6c65 5f70  .copyfile(file_p
+0000c310: 6174 682c 2070 6174 6829 0d0a 2020 2020  ath, path)..    
+0000c320: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+0000c330: 6b0d 0a20 2020 2020 2020 2020 2020 200d  k..            .
+0000c340: 0a20 2020 2064 6566 2063 6f70 795f 7461  .    def copy_ta
+0000c350: 6728 0d0a 2020 2020 2020 2020 2020 2020  g(..            
+0000c360: 7365 6c66 2c20 0d0a 2020 2020 2020 2020  self, ..        
+0000c370: 2020 2020 7461 675f 7372 632c 200d 0a20      tag_src, .. 
+0000c380: 2020 2020 2020 2020 2020 2074 6167 5f64             tag_d
+0000c390: 7374 2c20 0d0a 2020 2020 2020 2020 2020  st, ..          
+0000c3a0: 2020 636f 7079 5f61 6e6e 6f74 6174 696f    copy_annotatio
+0000c3b0: 6e73 3d54 7275 652c 200d 0a20 2020 2020  ns=True, ..     
+0000c3c0: 2020 2020 2020 2063 6f70 795f 636f 6e66         copy_conf
+0000c3d0: 6967 3d54 7275 652c 0d0a 2020 2020 2020  ig=True,..      
+0000c3e0: 2020 2020 2020 6f76 6572 7772 6974 653d        overwrite=
+0000c3f0: 4661 6c73 652c 200d 0a20 2020 2020 2020  False, ..       
+0000c400: 2020 2020 202a 2a6b 7761 7267 7329 3a0d       **kwargs):.
+0000c410: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0000c420: 2020 2020 2020 4d61 6b65 2061 2063 6f70        Make a cop
+0000c430: 7920 6f66 2064 6174 6120 6765 6e65 7261  y of data genera
+0000c440: 7465 6420 756e 6465 7220 6120 7370 6563  ted under a spec
+0000c450: 6966 6963 2074 6167 2061 6e64 2073 6176  ific tag and sav
+0000c460: 6520 6974 2075 6e64 6572 2061 200d 0a20  e it under a .. 
+0000c470: 2020 2020 2020 206e 6577 2074 6167 202d         new tag -
+0000c480: 2065 2e67 2e3a 200d 0a20 2020 2020 2020   e.g.: ..       
+0000c490: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000c4a0: 2020 2061 6e6e 6f74 6174 696f 6e73 5f76     annotations_v
+0000c4b0: 312e 6a73 6f6e 203d 3d3e 2061 6e6e 6f74  1.json ==> annot
+0000c4c0: 6174 696f 6e73 5f76 322e 6a73 6f6e 0d0a  ations_v2.json..
+0000c4d0: 2020 2020 2020 2020 2020 2020 7079 7065              pype
+0000c4e0: 5f63 6f6e 6669 675f 7631 2e79 616d 6c20  _config_v1.yaml 
+0000c4f0: 3d3d 3e20 7079 7065 5f63 6f6e 6669 675f  ==> pype_config_
+0000c500: 7632 2e79 616d 6c0d 0a0d 0a20 2020 2020  v2.yaml....     
+0000c510: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0000c520: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000c530: 2d0d 0a20 2020 2020 2020 2074 6167 5f73  -..        tag_s
+0000c540: 7263 203a 2073 7472 0d0a 2020 2020 2020  rc : str..      
+0000c550: 2020 2020 2020 6e61 6d65 206f 6620 7461        name of ta
+0000c560: 6720 746f 2062 6520 636f 7069 6564 2028  g to be copied (
+0000c570: 736f 7572 6365 2074 6167 290d 0a20 2020  source tag)..   
+0000c580: 2020 2020 2074 6167 5f64 7374 203a 2073       tag_dst : s
+0000c590: 7472 0d0a 2020 2020 2020 2020 2020 2020  tr..            
+0000c5a0: 6e61 6d65 206f 6620 6e65 7720 7461 6720  name of new tag 
+0000c5b0: 2864 6573 7469 6e61 7469 6f6e 2074 6167  (destination tag
+0000c5c0: 290d 0a20 2020 2020 2020 2063 6f70 795f  )..        copy_
+0000c5d0: 616e 6e6f 7461 7469 6f6e 7320 3a20 626f  annotations : bo
+0000c5e0: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 2020  ol, optional..  
+0000c5f0: 2020 2020 2020 2020 2020 636f 7079 2061            copy a
+0000c600: 6e6e 6f74 6174 696f 6e73 2066 696c 652e  nnotations file.
+0000c610: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+0000c620: 5472 7565 2e0d 0a20 2020 2020 2020 2063  True...        c
+0000c630: 6f70 795f 636f 6e66 6967 203a 2062 6f6f  opy_config : boo
+0000c640: 6c2c 206f 7074 696f 6e61 6c0d 0a20 2020  l, optional..   
+0000c650: 2020 2020 2020 2020 2063 6f70 7920 636f           copy co
+0000c660: 6e66 6967 2066 696c 652e 2054 6865 2064  nfig file. The d
+0000c670: 6566 6175 6c74 2069 7320 5472 7565 2e0d  efault is True..
+0000c680: 0a20 2020 2020 2020 206f 7665 7277 7269  .        overwri
+0000c690: 7465 203a 2062 6f6f 6c2c 206f 7074 696f  te : bool, optio
+0000c6a0: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+0000c6b0: 2020 6f76 6572 7772 6974 6573 2069 6620    overwrites if 
+0000c6c0: 7461 6720 6578 6973 7473 2e20 5468 6520  tag exists. The 
+0000c6d0: 6465 6661 756c 7420 6973 2046 616c 7365  default is False
+0000c6e0: 2e0d 0a20 2020 2020 2020 206b 7761 7267  ...        kwarg
+0000c6f0: 733a 200d 0a20 2020 2020 2020 2020 2020  s: ..           
+0000c700: 2064 6576 656c 6f70 6572 206f 7074 696f   developer optio
+0000c710: 6e73 0d0a 0d0a 2020 2020 2020 2020 5265  ns....        Re
+0000c720: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+0000c730: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0000c740: 4e6f 6e65 2e0d 0a0d 0a20 2020 2020 2020  None.....       
+0000c750: 2022 2222 0d0a 2020 200d 0a20 2020 2020   """..   ..     
+0000c760: 2020 2023 2320 676f 2074 6872 6f75 6768     ## go through
+0000c770: 2070 726f 6a65 6374 2064 6972 6563 746f   project directo
+0000c780: 7269 6573 0d0a 2020 2020 2020 2020 666f  ries..        fo
+0000c790: 7220 6469 7265 6374 6f72 7920 696e 2073  r directory in s
+0000c7a0: 656c 662e 6469 725f 7061 7468 733a 0d0a  elf.dir_paths:..
+0000c7b0: 2020 2020 2020 2020 2020 2020 6469 725f              dir_
+0000c7c0: 6e61 6d65 203d 206f 732e 7061 7468 2e62  name = os.path.b
+0000c7d0: 6173 656e 616d 6528 6469 7265 6374 6f72  asename(director
+0000c7e0: 7929 0d0a 0d0a 2020 2020 2020 2020 2020  y)....          
+0000c7f0: 2020 6966 2063 6f70 795f 616e 6e6f 7461    if copy_annota
+0000c800: 7469 6f6e 733a 0d0a 2020 2020 2020 2020  tions:..        
+0000c810: 2020 2020 2020 2020 616e 6e6f 7461 7469          annotati
+0000c820: 6f6e 735f 7061 7468 203d 206f 732e 7061  ons_path = os.pa
+0000c830: 7468 2e6a 6f69 6e28 0d0a 2020 2020 2020  th.join(..      
+0000c840: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000c850: 6c66 2e72 6f6f 745f 6469 722c 2022 6461  lf.root_dir, "da
+0000c860: 7461 222c 2064 6972 5f6e 616d 652c 2022  ta", dir_name, "
+0000c870: 616e 6e6f 7461 7469 6f6e 735f 2220 2b20  annotations_" + 
+0000c880: 7461 675f 7372 6320 2b20 222e 6a73 6f6e  tag_src + ".json
+0000c890: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+0000c8a0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+0000c8b0: 2020 2020 2020 6e65 775f 616e 6e6f 7461        new_annota
+0000c8c0: 7469 6f6e 735f 7061 7468 203d 206f 732e  tions_path = os.
+0000c8d0: 7061 7468 2e6a 6f69 6e28 0d0a 2020 2020  path.join(..    
+0000c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c8f0: 7365 6c66 2e72 6f6f 745f 6469 722c 2022  self.root_dir, "
+0000c900: 6461 7461 222c 2064 6972 5f6e 616d 652c  data", dir_name,
+0000c910: 2022 616e 6e6f 7461 7469 6f6e 735f 2220   "annotations_" 
+0000c920: 2b20 7461 675f 6473 7420 2b20 222e 6a73  + tag_dst + ".js
+0000c930: 6f6e 220d 0a20 2020 2020 2020 2020 2020  on"..           
+0000c940: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0000c950: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000c960: 2020 2020 2020 2020 2020 6966 206f 732e            if os.
+0000c970: 7061 7468 2e69 7366 696c 6528 616e 6e6f  path.isfile(anno
+0000c980: 7461 7469 6f6e 735f 7061 7468 293a 200d  tations_path): .
+0000c990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c9a0: 2020 2020 2069 6620 7574 696c 735f 6c6f       if utils_lo
+0000c9b0: 776c 6576 656c 2e5f 6f76 6572 7772 6974  wlevel._overwrit
+0000c9c0: 655f 6368 6563 6b5f 6669 6c65 286e 6577  e_check_file(new
+0000c9d0: 5f61 6e6e 6f74 6174 696f 6e73 5f70 6174  _annotations_pat
+0000c9e0: 682c 206f 7665 7277 7269 7465 293a 0d0a  h, overwrite):..
+0000c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca00: 2020 2020 2020 2020 7368 7574 696c 2e63          shutil.c
+0000ca10: 6f70 7966 696c 6528 616e 6e6f 7461 7469  opyfile(annotati
+0000ca20: 6f6e 735f 7061 7468 2c20 6e65 775f 616e  ons_path, new_an
+0000ca30: 6e6f 7461 7469 6f6e 735f 7061 7468 290d  notations_path).
+0000ca40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ca50: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0000ca60: 436f 7079 2061 6e6e 6f74 6174 696f 6e73  Copy annotations
+0000ca70: 2066 6f72 207b 7d22 2e66 6f72 6d61 7428   for {}".format(
+0000ca80: 6469 725f 6e61 6d65 2929 0d0a 2020 2020  dir_name))..    
+0000ca90: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000caa0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000cab0: 2020 2020 2020 2070 7269 6e74 2822 4d69         print("Mi
+0000cac0: 7373 696e 6720 616e 6e6f 7461 7469 6f6e  ssing annotation
+0000cad0: 7320 666f 7220 7b7d 202d 2073 6b69 7070  s for {} - skipp
+0000cae0: 696e 6722 2e66 6f72 6d61 7428 6469 725f  ing".format(dir_
+0000caf0: 6e61 6d65 2929 0d0a 0d0a 2020 2020 2020  name))....      
+0000cb00: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+0000cb10: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0000cb20: 6f70 795f 636f 6e66 6967 3a0d 0a20 2020  opy_config:..   
+0000cb30: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0000cb40: 6669 675f 7061 7468 203d 206f 732e 7061  fig_path = os.pa
+0000cb50: 7468 2e6a 6f69 6e28 0d0a 2020 2020 2020  th.join(..      
+0000cb60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000cb70: 6c66 2e72 6f6f 745f 6469 722c 2022 6461  lf.root_dir, "da
+0000cb80: 7461 222c 2064 6972 5f6e 616d 652c 2022  ta", dir_name, "
+0000cb90: 7079 7065 5f63 6f6e 6669 675f 2220 2b20  pype_config_" + 
+0000cba0: 7461 675f 7372 6320 2b20 222e 7961 6d6c  tag_src + ".yaml
+0000cbb0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+0000cbc0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+0000cbd0: 2020 2020 2020 6e65 775f 636f 6e66 6967        new_config
+0000cbe0: 5f70 6174 6820 3d20 6f73 2e70 6174 682e  _path = os.path.
+0000cbf0: 6a6f 696e 280d 0a20 2020 2020 2020 2020  join(..         
+0000cc00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000cc10: 726f 6f74 5f64 6972 2c20 2264 6174 6122  root_dir, "data"
+0000cc20: 2c20 6469 725f 6e61 6d65 2c20 2270 7970  , dir_name, "pyp
+0000cc30: 655f 636f 6e66 6967 5f22 202b 2074 6167  e_config_" + tag
+0000cc40: 5f64 7374 202b 2022 2e79 616d 6c22 0d0a  _dst + ".yaml"..
+0000cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000cc70: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000cc80: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
+0000cc90: 6973 6669 6c65 2863 6f6e 6669 675f 7061  isfile(config_pa
+0000cca0: 7468 293a 200d 0a20 2020 2020 2020 2020  th): ..         
+0000ccb0: 2020 2020 2020 2020 2020 2069 6620 7574             if ut
+0000ccc0: 696c 735f 6c6f 776c 6576 656c 2e5f 6f76  ils_lowlevel._ov
+0000ccd0: 6572 7772 6974 655f 6368 6563 6b5f 6669  erwrite_check_fi
+0000cce0: 6c65 286e 6577 5f63 6f6e 6669 675f 7061  le(new_config_pa
+0000ccf0: 7468 2c20 6f76 6572 7772 6974 6529 3a0d  th, overwrite):.
+0000cd00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cd10: 2020 2020 2020 2020 2073 6875 7469 6c2e           shutil.
+0000cd20: 636f 7079 6669 6c65 2863 6f6e 6669 675f  copyfile(config_
+0000cd30: 7061 7468 2c20 6e65 775f 636f 6e66 6967  path, new_config
+0000cd40: 5f70 6174 6829 0d0a 2020 2020 2020 2020  _path)..        
+0000cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cd60: 7072 696e 7428 2243 6f70 7920 636f 6e66  print("Copy conf
+0000cd70: 6967 2066 6f72 207b 7d22 2e66 6f72 6d61  ig for {}".forma
+0000cd80: 7428 6469 725f 6e61 6d65 2929 0d0a 2020  t(dir_name))..  
+0000cd90: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000cda0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000cdb0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0000cdc0: 4d69 7373 696e 6720 636f 6e66 6967 2066  Missing config f
+0000cdd0: 6f72 207b 7d20 2d20 736b 6970 7069 6e67  or {} - skipping
+0000cde0: 222e 666f 726d 6174 2864 6972 5f6e 616d  ".format(dir_nam
+0000cdf0: 6529 290d 0a0d 0a20 2020 2020 2020 2020  e))....         
+0000ce00: 2020 2020 2020 200d 0a20 2020 2064 6566         ..    def
+0000ce10: 2065 6469 745f 636f 6e66 6967 2873 656c   edit_config(sel
+0000ce20: 662c 2074 6167 2c20 7461 7267 6574 2c20  f, tag, target, 
+0000ce30: 7265 706c 6163 656d 656e 742c 202a 2a6b  replacement, **k
+0000ce40: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
+0000ce50: 2022 2222 0d0a 2020 2020 2020 2020 4164   """..        Ad
+0000ce60: 6420 6f72 2065 6469 7420 6675 6e63 7469  d or edit functi
+0000ce70: 6f6e 7320 696e 2061 6c6c 2063 6f6e 6669  ons in all confi
+0000ce80: 6775 7261 7469 6f6e 2066 696c 6573 206f  guration files o
+0000ce90: 6620 6120 7072 6f6a 6563 742e 2046 696e  f a project. Fin
+0000cea0: 6473 2061 6e64 0d0a 2020 2020 2020 2020  ds and..        
+0000ceb0: 7265 706c 6163 6573 2073 696e 676c 6520  replaces single 
+0000cec0: 6f72 206d 756c 7469 6c69 6e65 2073 7472  or multiline str
+0000ced0: 696e 672d 7061 7474 6572 6e73 2e20 4964  ing-patterns. Id
+0000cee0: 6561 6c6c 7920 7468 6973 2069 7320 646f  eally this is do
+0000cef0: 6e65 2076 6961 200d 0a20 2020 2020 2020  ne via ..       
+0000cf00: 2070 7974 686f 6e20 646f 6373 7472 696e   python docstrin
+0000cf10: 6773 2074 6861 7420 7265 7072 6573 656e  gs that represen
+0000cf20: 7420 7468 6520 7061 7274 7320 6f66 2074  t the parts of t
+0000cf30: 6865 2079 616d 6c20 6669 6c65 2074 6f20  he yaml file to 
+0000cf40: 6265 2072 6570 6c61 6365 642e 0d0a 2020  be replaced...  
+0000cf50: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+0000cf60: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000cf70: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0000cf80: 2d2d 2d2d 2d2d 0d0a 0d0a 2020 2020 2020  ------....      
+0000cf90: 2020 7461 673a 2073 7472 0d0a 2020 2020    tag: str..    
+0000cfa0: 2020 2020 2020 2020 7461 6720 2873 7566          tag (suf
+0000cfb0: 6669 7829 206f 6620 636f 6e66 6967 2d66  fix) of config-f
+0000cfc0: 696c 6520 2865 2e67 2e20 2276 3122 2069  ile (e.g. "v1" i
+0000cfd0: 6e20 2270 7970 655f 636f 6e66 6967 5f76  n "pype_config_v
+0000cfe0: 312e 7961 6d6c 2229 0d0a 2020 2020 2020  1.yaml")..      
+0000cff0: 2020 7461 7267 6574 3a20 7374 720d 0a20    target: str.. 
+0000d000: 2020 2020 2020 2020 2020 2073 7472 696e             strin
+0000d010: 6720 7061 7474 6572 6e20 746f 2062 6520  g pattern to be 
+0000d020: 7265 706c 6163 6564 2e20 7368 6f75 6c64  replaced. should
+0000d030: 2062 6520 696e 2074 7269 706c 652d 7175   be in triple-qu
+0000d040: 6f74 6573 2074 6f20 6265 2065 7861 6374  otes to be exact
+0000d050: 0d0a 2020 2020 2020 2020 7265 706c 6163  ..        replac
+0000d060: 656d 656e 743a 2073 7472 0d0a 2020 2020  ement: str..    
+0000d070: 2020 2020 2020 2020 7374 7269 6e67 2070          string p
+0000d080: 6174 7465 726e 2066 6f72 2072 6570 6c61  attern for repla
+0000d090: 6365 6d65 6e74 2e20 7368 6f75 6c64 2062  cement. should b
+0000d0a0: 6520 696e 2074 7269 706c 652d 7175 6f74  e in triple-quot
+0000d0b0: 6573 2074 6f20 6265 2065 7861 6374 0d0a  es to be exact..
+0000d0c0: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0000d0d0: 2020 2020 2020 2023 2320 7365 7475 700d         ## setup.
+0000d0e0: 0a20 2020 2020 2020 2066 6c61 675f 6368  .        flag_ch
+0000d0f0: 6563 6b65 6420 3d20 4661 6c73 650d 0a0d  ecked = False...
+0000d100: 0a20 2020 2020 2020 2023 2320 676f 2074  .        ## go t
+0000d110: 6872 6f75 6768 2070 726f 6a65 6374 2064  hrough project d
+0000d120: 6972 6563 746f 7269 6573 0d0a 2020 2020  irectories..    
+0000d130: 2020 2020 666f 7220 6469 7265 6374 6f72      for director
+0000d140: 7920 696e 2073 656c 662e 6469 725f 7061  y in self.dir_pa
+0000d150: 7468 733a 0d0a 2020 2020 2020 2020 2020  ths:..          
+0000d160: 2020 6469 725f 6e61 6d65 203d 206f 732e    dir_name = os.
+0000d170: 7061 7468 2e62 6173 656e 616d 6528 6469  path.basename(di
+0000d180: 7265 6374 6f72 7929 0d0a 0d0a 2020 2020  rectory)....    
+0000d190: 2020 2020 2020 2020 2323 2067 6574 2063          ## get c
+0000d1a0: 6f6e 6669 6720 7061 7468 0d0a 2020 2020  onfig path..    
+0000d1b0: 2020 2020 2020 2020 636f 6e66 6967 5f70          config_p
+0000d1c0: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
+0000d1d0: 696e 280d 0a20 2020 2020 2020 2020 2020  in(..           
+0000d1e0: 2020 2020 2073 656c 662e 726f 6f74 5f64       self.root_d
+0000d1f0: 6972 2c20 2264 6174 6122 2c20 6469 725f  ir, "data", dir_
+0000d200: 6e61 6d65 2c20 2270 7970 655f 636f 6e66  name, "pype_conf
+0000d210: 6967 5f22 202b 2074 6167 202b 2022 2e79  ig_" + tag + ".y
+0000d220: 616d 6c22 0d0a 2020 2020 2020 2020 2020  aml"..          
+0000d230: 2020 290d 0a0d 0a20 2020 2020 2020 2020    )....         
+0000d240: 2020 2023 2320 6f70 656e 2063 6f6e 6669     ## open confi
+0000d250: 672d 6669 6c65 0d0a 2020 2020 2020 2020  g-file..        
+0000d260: 2020 2020 6966 206f 732e 7061 7468 2e69      if os.path.i
+0000d270: 7366 696c 6528 636f 6e66 6967 5f70 6174  sfile(config_pat
+0000d280: 6829 3a0d 0a20 2020 2020 2020 2020 2020  h):..           
+0000d290: 2020 2020 2077 6974 6820 6f70 656e 2863       with open(c
+0000d2a0: 6f6e 6669 675f 7061 7468 2c20 2272 2229  onfig_path, "r")
+0000d2b0: 2061 7320 636f 6e66 6967 5f74 6578 743a   as config_text:
+0000d2c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d2d0: 2020 2020 2020 636f 6e66 6967 5f73 7472        config_str
+0000d2e0: 696e 6720 3d20 636f 6e66 6967 5f74 6578  ing = config_tex
+0000d2f0: 742e 7265 6164 2829 0d0a 2020 2020 2020  t.read()..      
+0000d300: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0000d310: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0000d320: 6e74 2822 4469 6420 6e6f 7420 6669 6e64  nt("Did not find
+0000d330: 2063 6f6e 6669 6720 6669 6c65 2074 6f20   config file to 
+0000d340: 6564 6974 202d 2063 6865 636b 2070 726f  edit - check pro
+0000d350: 7669 6465 6420 7461 672f 7375 6666 6978  vided tag/suffix
+0000d360: 2e22 290d 0a20 2020 2020 2020 2020 2020  .")..           
+0000d370: 2020 2020 2072 6574 7572 6e0d 0a20 2020       return..   
+0000d380: 2020 2020 2020 2020 2023 2320 7374 7269           ## stri
+0000d390: 6e67 2072 6570 6c61 6365 6d65 6e74 0d0a  ng replacement..
+0000d3a0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+0000d3b0: 636f 6e66 6967 5f73 7472 696e 6720 3d20  config_string = 
+0000d3c0: 636f 6e66 6967 5f73 7472 696e 672e 7265  config_string.re
+0000d3d0: 706c 6163 6528 7461 7267 6574 2c20 7265  place(target, re
+0000d3e0: 706c 6163 656d 656e 7429 0d0a 0d0a 2020  placement)....  
+0000d3f0: 2020 2020 2020 2020 2020 2323 2073 686f            ## sho
+0000d400: 7720 7573 6572 2072 6570 6c61 6365 6d65  w user replaceme
+0000d410: 6e74 2d72 6573 756c 7420 616e 6420 6173  nt-result and as
+0000d420: 6b20 666f 7220 636f 6e66 6972 6d61 7469  k for confirmati
+0000d430: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
+0000d440: 6966 2066 6c61 675f 6368 6563 6b65 6420  if flag_checked 
+0000d450: 3d3d 2046 616c 7365 3a0d 0a20 2020 2020  == False:..     
+0000d460: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0000d470: 286e 6577 5f63 6f6e 6669 675f 7374 7269  (new_config_stri
+0000d480: 6e67 290d 0a20 2020 2020 2020 2020 2020  ng)..           
+0000d490: 2020 2020 2063 6865 636b 203d 2069 6e70       check = inp
+0000d4a0: 7574 280d 0a20 2020 2020 2020 2020 2020  ut(..           
+0000d4b0: 2020 2020 2020 2020 2022 5468 6973 2069           "This i
+0000d4c0: 7320 7768 6174 2074 6865 206e 6577 2063  s what the new c
+0000d4d0: 6f6e 6669 6720 6d61 7920 6c6f 6f6b 206c  onfig may look l
+0000d4e0: 696b 6520 2863 616e 2064 6966 6665 7220  ike (can differ 
+0000d4f0: 6265 7477 6565 6e20 6669 6c65 7329 202d  between files) -
+0000d500: 2070 726f 6365 6564 3f22 0d0a 2020 2020   proceed?"..    
+0000d510: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
+0000d520: 0a20 2020 2020 2020 2020 2020 2023 2320  .            ## 
+0000d530: 7265 706c 6163 6520 666f 7220 616c 6c20  replace for all 
+0000d540: 636f 6e66 6967 2066 696c 6573 2061 6674  config files aft
+0000d550: 6572 2070 6f73 6974 6976 6520 7573 6572  er positive user
+0000d560: 2063 6865 636b 0d0a 2020 2020 2020 2020   check..        
+0000d570: 2020 2020 6966 2063 6865 636b 2069 6e20      if check in 
+0000d580: 7365 7474 696e 6773 2e63 6f6e 6669 726d  settings.confirm
+0000d590: 5f6f 7074 696f 6e73 3a0d 0a20 2020 2020  _options:..     
+0000d5a0: 2020 2020 2020 2020 2020 2066 6c61 675f             flag_
+0000d5b0: 6368 6563 6b65 6420 3d20 5472 7565 0d0a  checked = True..
+0000d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5d0: 7769 7468 206f 7065 6e28 636f 6e66 6967  with open(config
+0000d5e0: 5f70 6174 682c 2022 7722 2920 6173 2063  _path, "w") as c
+0000d5f0: 6f6e 6669 675f 7465 7874 3a0d 0a20 2020  onfig_text:..   
+0000d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d610: 2063 6f6e 6669 675f 7465 7874 2e77 7269   config_text.wri
+0000d620: 7465 286e 6577 5f63 6f6e 6669 675f 7374  te(new_config_st
+0000d630: 7269 6e67 290d 0a0d 0a20 2020 2020 2020  ring)....       
+0000d640: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0000d650: 4e65 7720 636f 6e66 6967 2073 6176 6564  New config saved
+0000d660: 2066 6f72 2022 202b 2064 6972 5f6e 616d   for " + dir_nam
+0000d670: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0000d680: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0000d690: 2020 2020 2020 2070 7269 6e74 2822 5573         print("Us
+0000d6a0: 6572 2063 6865 636b 2066 6169 6c65 6420  er check failed 
+0000d6b0: 2d20 6162 6f72 7469 6e67 2e22 290d 0a20  - aborting.").. 
+0000d6c0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000d6d0: 7265 616b 0d0a 2020 2020 2020 2020 2020  reak..          
+0000d6e0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000d6f0: 2020 2020 2020 2020 0d0a 0d0a 2020 2020          ....    
+0000d700: 6465 6620 6578 706f 7274 5f7a 6970 280d  def export_zip(.
+0000d710: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d720: 662c 200d 0a20 2020 2020 2020 2020 2020  f, ..           
+0000d730: 2074 6167 3d4e 6f6e 652c 200d 0a20 2020   tag=None, ..   
+0000d740: 2020 2020 2020 2020 2072 6573 756c 7473           results
+0000d750: 3d46 616c 7365 2c0d 0a20 2020 2020 2020  =False,..       
+0000d760: 2020 2020 206d 6f64 656c 733d 4661 6c73       models=Fals
+0000d770: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
+0000d780: 2069 6d61 6765 733d 4661 6c73 652c 200d   images=False, .
+0000d790: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
+0000d7a0: 6f72 7473 3d46 616c 7365 2c0d 0a20 2020  orts=False,..   
+0000d7b0: 2020 2020 2020 2020 206f 7665 7277 7269           overwri
+0000d7c0: 7465 3d54 7275 652c 0d0a 2020 2020 2020  te=True,..      
+0000d7d0: 2020 2020 2020 2a2a 6b77 6172 6773 0d0a        **kwargs..
+0000d7e0: 2020 2020 2020 2020 2020 2020 293a 0d0a              ):..
+0000d7f0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0000d800: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
+0000d810: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0000d820: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0000d830: 2020 2074 6167 3a20 7374 722c 206f 7074     tag: str, opt
+0000d840: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
+0000d850: 2020 2045 7870 6f72 7420 6f6e 6c79 2066     Export only f
+0000d860: 696c 6573 2061 7373 6f63 6961 7465 6420  iles associated 
+0000d870: 7769 7468 2061 2073 7065 6369 6669 6564  with a specified
+0000d880: 2074 6167 2e20 5468 6520 6465 6661 756c   tag. The defaul
+0000d890: 7420 6973 204e 6f6e 652e 0d0a 2020 2020  t is None...    
+0000d8a0: 2020 2020 696d 6167 6573 203a 2062 6f6f      images : boo
+0000d8b0: 6c2c 206f 7074 696f 6e61 6c0d 0a20 2020  l, optional..   
+0000d8c0: 2020 2020 2020 2020 2044 6f6e 2774 2069           Don't i
+0000d8d0: 6e63 6c75 6465 2069 6d61 6765 7320 6672  nclude images fr
+0000d8e0: 6f6d 2074 6865 2064 6174 6120 666f 6c64  om the data fold
+0000d8f0: 6572 2e20 5468 6520 6465 6661 756c 7420  er. The default 
+0000d900: 6973 2054 7275 652e 0d0a 0d0a 2020 2020  is True.....    
+0000d910: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0000d920: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0000d930: 2020 2020 2020 4e6f 6e65 2e0d 0a0d 0a20        None..... 
+0000d940: 2020 2020 2020 2022 2222 0d0a 0d0a 0d0a         """......
+0000d950: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0000d960: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000d970: 2020 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d      # ==========
+0000d980: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000d990: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000d9a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000d9b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000d9c0: 3d3d 3d0d 0a20 2020 2020 2020 2023 2073  ===..        # s
+0000d9d0: 6574 7570 0d0a 0d0a 2020 2020 2020 2020  etup....        
+0000d9e0: 2323 2073 6574 2066 6c61 6773 0d0a 2020  ## set flags..  
+0000d9f0: 2020 2020 2020 666c 6167 7320 3d20 6d61        flags = ma
+0000da00: 6b65 5f64 6174 6163 6c61 7373 280d 0a20  ke_dataclass(.. 
+0000da10: 2020 2020 2020 2020 2020 2063 6c73 5f6e             cls_n
+0000da20: 616d 653d 2266 6c61 6773 222c 0d0a 2020  ame="flags",..  
+0000da30: 2020 2020 2020 2020 2020 6669 656c 6473            fields
+0000da40: 3d5b 0d0a 2020 2020 2020 2020 2020 2020  =[..            
+0000da50: 2020 2020 2822 7461 6722 2c20 7374 722c      ("tag", str,
+0000da60: 2074 6167 292c 200d 0a20 2020 2020 2020   tag), ..       
+0000da70: 2020 2020 2020 2020 2028 2272 6573 756c           ("resul
+0000da80: 7473 222c 2062 6f6f 6c2c 2072 6573 756c  ts", bool, resul
+0000da90: 7473 292c 0d0a 2020 2020 2020 2020 2020  ts),..          
+0000daa0: 2020 2020 2020 2822 6d6f 6465 6c73 222c        ("models",
+0000dab0: 2062 6f6f 6c2c 206d 6f64 656c 7329 2c0d   bool, models),.
+0000dac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dad0: 2028 2269 6d61 6765 7322 2c20 626f 6f6c   ("images", bool
+0000dae0: 2c20 696d 6167 6573 292c 0d0a 2020 2020  , images),..    
+0000daf0: 2020 2020 2020 2020 2020 2020 2822 6578              ("ex
+0000db00: 706f 7274 7322 2c20 626f 6f6c 2c20 6578  ports", bool, ex
+0000db10: 706f 7274 7329 2c0d 0a20 2020 2020 2020  ports),..       
+0000db20: 2020 2020 2020 2020 2028 226f 7665 7277           ("overw
+0000db30: 7269 7465 222c 2062 6f6f 6c2c 206f 7665  rite", bool, ove
+0000db40: 7277 7269 7465 292c 0d0a 2020 2020 2020  rwrite),..      
+0000db50: 2020 2020 2020 2020 2020 5d2c 0d0a 2020            ],..  
+0000db60: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+0000db70: 2020 2069 6620 6b77 6172 6773 2e67 6574     if kwargs.get
+0000db80: 2822 7361 7665 5f73 7566 6669 7822 293a  ("save_suffix"):
+0000db90: 0d0a 2020 2020 2020 2020 2020 2020 7361  ..            sa
+0000dba0: 7665 5f73 7566 6669 7820 3d20 225f 2220  ve_suffix = "_" 
+0000dbb0: 2b20 6b77 6172 6773 2e67 6574 2822 7361  + kwargs.get("sa
+0000dbc0: 7665 5f73 7566 6669 7822 290d 0a20 2020  ve_suffix")..   
+0000dbd0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0000dbe0: 2020 2020 2020 2020 7361 7665 5f73 7566          save_suf
+0000dbf0: 6669 7820 3d20 2222 0d0a 2020 2020 2020  fix = ""..      
+0000dc00: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000dc10: 2323 2063 6f6e 7374 7275 6374 2073 6176  ## construct sav
+0000dc20: 6520 7061 7468 0d0a 2020 2020 2020 2020  e path..        
+0000dc30: 726f 6f74 5f64 6972 203d 206f 732e 7061  root_dir = os.pa
+0000dc40: 7468 2e62 6173 656e 616d 6528 7365 6c66  th.basename(self
+0000dc50: 2e72 6f6f 745f 6469 7229 200d 0a20 2020  .root_dir) ..   
+0000dc60: 2020 2020 2073 6176 655f 7061 7468 203d       save_path =
+0000dc70: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
+0000dc80: 6c66 2e72 6f6f 745f 6469 722c 2072 6f6f  lf.root_dir, roo
+0000dc90: 745f 6469 7220 2b20 7361 7665 5f73 7566  t_dir + save_suf
+0000dca0: 6669 7820 2b20 222e 7a69 7022 290d 0a20  fix + ".zip").. 
+0000dcb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000dcc0: 2069 6620 6f73 2e70 6174 682e 6973 6669   if os.path.isfi
+0000dcd0: 6c65 2873 6176 655f 7061 7468 2920 616e  le(save_path) an
+0000dce0: 6420 666c 6167 732e 6f76 6572 7772 6974  d flags.overwrit
+0000dcf0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0000dd00: 6f73 2e72 656d 6f76 6528 7361 7665 5f70  os.remove(save_p
+0000dd10: 6174 6829 0d0a 0d0a 2020 2020 2020 2020  ath)....        
+0000dd20: 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  # ==============
+0000dd30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000dd40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000dd50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000dd60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+0000dd70: 0a20 2020 2020 2020 2023 2065 7865 6375  .        # execu
+0000dd80: 7465 0d0a 0d0a 2020 2020 2020 2020 2323  te....        ##
+0000dd90: 2073 7461 7274 207a 6970 2070 726f 6365   start zip proce
+0000dda0: 7373 0d0a 2020 2020 2020 2020 7769 7468  ss..        with
+0000ddb0: 207a 6970 6669 6c65 2e5a 6970 4669 6c65   zipfile.ZipFile
+0000ddc0: 2873 6176 655f 7061 7468 2c20 2277 222c  (save_path, "w",
+0000ddd0: 207a 6970 6669 6c65 2e5a 4950 5f44 4546   zipfile.ZIP_DEF
+0000dde0: 4c41 5445 4429 2061 7320 7a69 703a 0d0a  LATED) as zip:..
+0000ddf0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000de00: 2020 2323 2070 726f 6a65 6374 2072 6f6f    ## project roo
+0000de10: 7420 6469 720d 0a20 2020 2020 2020 2020  t dir..         
+0000de20: 2020 207a 6970 2e77 7269 7465 286f 732e     zip.write(os.
+0000de30: 7061 7468 2e6a 6f69 6e28 7365 6c66 2e72  path.join(self.r
+0000de40: 6f6f 745f 6469 7229 2c20 726f 6f74 5f64  oot_dir), root_d
+0000de50: 6972 2920 2020 200d 0a20 2020 200d 0a20  ir)    ..    .. 
+0000de60: 2020 2020 2020 2020 2020 2023 2320 7072             ## pr
+0000de70: 6f6a 6563 7420 6174 7472 6962 7574 6573  oject attributes
+0000de80: 0d0a 2020 2020 2020 2020 2020 2020 7a69  ..            zi
+0000de90: 702e 7772 6974 6528 0d0a 2020 2020 2020  p.write(..      
+0000dea0: 2020 2020 2020 2020 2020 6f73 2e70 6174            os.pat
+0000deb0: 682e 6a6f 696e 2873 656c 662e 726f 6f74  h.join(self.root
+0000dec0: 5f64 6972 2c20 2261 7474 7269 6275 7465  _dir, "attribute
+0000ded0: 732e 7961 6d6c 2229 2c20 0d0a 2020 2020  s.yaml"), ..    
+0000dee0: 2020 2020 2020 2020 2020 2020 6f73 2e70              os.p
+0000def0: 6174 682e 6a6f 696e 2872 6f6f 745f 6469  ath.join(root_di
+0000df00: 722c 2022 6174 7472 6962 7574 6573 2e79  r, "attributes.y
+0000df10: 616d 6c22 290d 0a20 2020 2020 2020 2020  aml")..         
+0000df20: 2020 2020 2020 2029 2020 2020 0d0a 2020         )    ..  
+0000df30: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000df40: 2020 2020 2020 2020 2323 2064 6174 6120          ## data 
+0000df50: 666f 6c64 6572 0d0a 2020 2020 2020 2020  folder..        
+0000df60: 2020 2020 6461 7461 5f64 6972 5f61 6273      data_dir_abs
+0000df70: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
+0000df80: 6f69 6e28 7365 6c66 2e72 6f6f 745f 6469  oin(self.root_di
+0000df90: 722c 2022 6461 7461 2229 2020 2020 2020  r, "data")      
+0000dfa0: 200d 0a20 2020 2020 2020 2020 2020 2064   ..            d
+0000dfb0: 6174 615f 6469 725f 7265 6c70 6174 6820  ata_dir_relpath 
+0000dfc0: 3d20 6f73 2e70 6174 682e 6a6f 696e 2872  = os.path.join(r
+0000dfd0: 6f6f 745f 6469 722c 2022 6461 7461 2229  oot_dir, "data")
+0000dfe0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000dff0: 2020 2020 207a 6970 2e77 7269 7465 2864       zip.write(d
+0000e000: 6174 615f 6469 725f 6162 7370 6174 682c  ata_dir_abspath,
+0000e010: 2064 6174 615f 6469 725f 7265 6c70 6174   data_dir_relpat
+0000e020: 6829 2020 2020 0d0a 2020 2020 2020 2020  h)    ..        
+0000e030: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000e040: 2020 2323 206c 6f6f 7020 7468 726f 7075    ## loop thropu
+0000e050: 6768 2064 6174 6120 666f 6c64 6572 2020  gh data folder  
+0000e060: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+0000e070: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
+0000e080: 6f6c 6465 7220 696e 206f 732e 6c69 7374  older in os.list
+0000e090: 6469 7228 6461 7461 5f64 6972 5f61 6273  dir(data_dir_abs
+0000e0a0: 7061 7468 293a 0d0a 2020 2020 0d0a 2020  path):..    ..  
+0000e0b0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000e0c0: 6c64 6572 5f61 6273 7061 7468 203d 206f  lder_abspath = o
+0000e0d0: 732e 7061 7468 2e6a 6f69 6e28 6461 7461  s.path.join(data
+0000e0e0: 5f64 6972 5f61 6273 7061 7468 2c20 666f  _dir_abspath, fo
+0000e0f0: 6c64 6572 290d 0a20 2020 2020 2020 2020  lder)..         
+0000e100: 2020 2020 2020 2066 6f6c 6465 725f 7265         folder_re
+0000e110: 6c70 6174 6820 3d20 6f73 2e70 6174 682e  lpath = os.path.
+0000e120: 6a6f 696e 2864 6174 615f 6469 725f 7265  join(data_dir_re
+0000e130: 6c70 6174 682c 2066 6f6c 6465 7229 0d0a  lpath, folder)..
+0000e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e150: 7a69 702e 7772 6974 6528 666f 6c64 6572  zip.write(folder
+0000e160: 5f61 6273 7061 7468 2c20 666f 6c64 6572  _abspath, folder
+0000e170: 5f72 656c 7061 7468 2920 2020 2020 2020  _relpath)       
+0000e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e190: 2020 2020 200d 0a20 2020 200d 0a20 2020       ..    ..   
+0000e1a0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0000e1b0: 2066 696c 6520 696e 206f 732e 6c69 7374   file in os.list
+0000e1c0: 6469 7228 666f 6c64 6572 5f61 6273 7061  dir(folder_abspa
+0000e1d0: 7468 293a 0d0a 2020 2020 2020 2020 2020  th):..          
 0000e1e0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
 0000e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e200: 6669 6c65 5f61 6273 7061 7468 203d 206f  file_abspath = o
-0000e210: 732e 7061 7468 2e6a 6f69 6e28 6461 7461  s.path.join(data
-0000e220: 5f64 6972 5f61 6273 7061 7468 2c20 666f  _dir_abspath, fo
-0000e230: 6c64 6572 2c20 6669 6c65 290d 0a20 2020  lder, file)..   
-0000e240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e250: 2066 696c 655f 7265 6c70 6174 6820 3d20   file_relpath = 
-0000e260: 6f73 2e70 6174 682e 6a6f 696e 2864 6174  os.path.join(dat
-0000e270: 615f 6469 725f 7265 6c70 6174 682c 2066  a_dir_relpath, f
-0000e280: 6f6c 6465 722c 2066 696c 6529 0d0a 2020  older, file)..  
-0000e290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2a0: 2020 7a69 702e 7772 6974 6528 6669 6c65    zip.write(file
-0000e2b0: 5f61 6273 7061 7468 2c20 6669 6c65 5f72  _abspath, file_r
-0000e2c0: 656c 7061 7468 2920 2020 2020 2020 2020  elpath)         
+0000e200: 6669 6c65 5f6e 616d 652c 2066 696c 655f  file_name, file_
+0000e210: 6578 7420 203d 206f 732e 7061 7468 2e73  ext  = os.path.s
+0000e220: 706c 6974 6578 7428 6669 6c65 290d 0a20  plitext(file).. 
+0000e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e240: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000e250: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0000e260: 6669 6c65 2069 6e20 5b22 6174 7472 6962  file in ["attrib
+0000e270: 7574 6573 2e79 616d 6c22 5d3a 0d0a 2020  utes.yaml"]:..  
+0000e280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e290: 2020 2020 2020 6966 206e 6f74 2066 6c61        if not fla
+0000e2a0: 6773 2e74 6167 2e5f 5f63 6c61 7373 5f5f  gs.tag.__class__
+0000e2b0: 2e5f 5f6e 616d 655f 5f20 3d3d 2022 4e6f  .__name__ == "No
+0000e2c0: 6e65 5479 7065 223a 0d0a 2020 2020 2020  neType":..      
 0000e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2e0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000e2f0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000e300: 2020 2020 2020 2069 6620 666c 6167 732e         if flags.
-0000e310: 6d6f 6465 6c73 3a0d 0a20 2020 2020 2020  models:..       
-0000e320: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000e330: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0000e340: 735f 6469 725f 6162 7370 6174 6820 3d20  s_dir_abspath = 
-0000e350: 6f73 2e70 6174 682e 6a6f 696e 2873 656c  os.path.join(sel
-0000e360: 662e 726f 6f74 5f64 6972 2c20 226d 6f64  f.root_dir, "mod
-0000e370: 656c 7322 2920 2020 2020 2020 0d0a 2020  els")       ..  
-0000e380: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0000e390: 6465 6c73 5f64 6972 5f72 656c 7061 7468  dels_dir_relpath
-0000e3a0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-0000e3b0: 726f 6f74 5f64 6972 2c20 226d 6f64 656c  root_dir, "model
-0000e3c0: 7322 2920 0d0a 2020 2020 2020 2020 2020  s") ..          
-0000e3d0: 2020 2020 2020 7a69 702e 7772 6974 6528        zip.write(
-0000e3e0: 6d6f 6465 6c73 5f64 6972 5f61 6273 7061  models_dir_abspa
-0000e3f0: 7468 2c20 6d6f 6465 6c73 5f64 6972 5f72  th, models_dir_r
-0000e400: 656c 7061 7468 2920 2020 200d 0a20 2020  elpath)    ..   
-0000e410: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-0000e420: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000e430: 6f72 2066 696c 6520 696e 206f 732e 6c69  or file in os.li
-0000e440: 7374 6469 7228 6d6f 6465 6c73 5f64 6972  stdir(models_dir
-0000e450: 5f61 6273 7061 7468 293a 0d0a 2020 2020  _abspath):..    
-0000e460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e480: 2020 2020 2020 6669 6c65 5f61 6273 7061        file_abspa
-0000e490: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-0000e4a0: 6e28 6d6f 6465 6c73 5f64 6972 5f61 6273  n(models_dir_abs
-0000e4b0: 7061 7468 2c20 6669 6c65 290d 0a20 2020  path, file)..   
-0000e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4d0: 2066 696c 655f 7265 6c70 6174 6820 3d20   file_relpath = 
-0000e4e0: 6f73 2e70 6174 682e 6a6f 696e 286d 6f64  os.path.join(mod
-0000e4f0: 656c 735f 6469 725f 7265 6c70 6174 682c  els_dir_relpath,
-0000e500: 2066 696c 6529 0d0a 2020 2020 2020 2020   file)..        
-0000e510: 2020 2020 2020 2020 2020 2020 7a69 702e              zip.
-0000e520: 7772 6974 6528 6669 6c65 5f61 6273 7061  write(file_abspa
-0000e530: 7468 2c20 6669 6c65 5f72 656c 7061 7468  th, file_relpath
-0000e540: 2920 2020 2020 2020 2020 2020 2020 2020  )               
-0000e550: 2020 2020 2020 200d 0a20 2020 200d 0a20         ..    .. 
-0000e560: 2020 2020 2020 2020 2020 2069 6620 666c             if fl
-0000e570: 6167 732e 7265 7375 6c74 733a 0d0a 2020  ags.results:..  
-0000e580: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000e590: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0000e5a0: 7473 5f64 6972 5f61 6273 7061 7468 203d  ts_dir_abspath =
-0000e5b0: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
-0000e5c0: 6c66 2e72 6f6f 745f 6469 722c 2022 7265  lf.root_dir, "re
-0000e5d0: 7375 6c74 7322 2920 2020 2020 2020 0d0a  sults")       ..
-0000e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5f0: 7265 7375 6c74 735f 6469 725f 7265 6c70  results_dir_relp
-0000e600: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
-0000e610: 696e 2872 6f6f 745f 6469 722c 2022 7265  in(root_dir, "re
-0000e620: 7375 6c74 7322 2920 2020 2020 2020 0d0a  sults")       ..
-0000e630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e640: 7a69 702e 7772 6974 6528 7265 7375 6c74  zip.write(result
-0000e650: 735f 6469 725f 6162 7370 6174 682c 2072  s_dir_abspath, r
-0000e660: 6573 756c 7473 5f64 6972 5f72 656c 7061  esults_dir_relpa
-0000e670: 7468 2920 2020 200d 0a20 2020 2020 2020  th)    ..       
-0000e680: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000e690: 2020 2020 2020 2020 2020 2023 2320 6c6f             ## lo
-0000e6a0: 6f70 2074 6872 6f70 7567 6820 6461 7461  op thropugh data
-0000e6b0: 2066 6f6c 6465 7220 2020 2020 2020 2020   folder         
-0000e6c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000e6d0: 2020 2020 2020 2020 666f 7220 666f 6c64          for fold
-0000e6e0: 6572 2069 6e20 6f73 2e6c 6973 7464 6972  er in os.listdir
-0000e6f0: 2872 6573 756c 7473 5f64 6972 5f61 6273  (results_dir_abs
-0000e700: 7061 7468 293a 0d0a 2020 2020 2020 2020  path):..        
-0000e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e730: 2020 2020 2020 666f 6c64 6572 5f61 6273        folder_abs
-0000e740: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
-0000e750: 6f69 6e28 7265 7375 6c74 735f 6469 725f  oin(results_dir_
-0000e760: 6162 7370 6174 682c 2066 6f6c 6465 7229  abspath, folder)
-0000e770: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e780: 2020 2020 2020 666f 6c64 6572 5f72 656c        folder_rel
-0000e790: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
-0000e7a0: 6f69 6e28 7265 7375 6c74 735f 6469 725f  oin(results_dir_
-0000e7b0: 7265 6c70 6174 682c 2066 6f6c 6465 7229  relpath, folder)
-0000e7c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e7d0: 2020 2020 2020 7a69 702e 7772 6974 6528        zip.write(
-0000e7e0: 666f 6c64 6572 5f61 6273 7061 7468 2c20  folder_abspath, 
-0000e7f0: 666f 6c64 6572 5f72 656c 7061 7468 2920  folder_relpath) 
-0000e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e810: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000e820: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000e830: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
-0000e840: 696c 6520 696e 206f 732e 6c69 7374 6469  ile in os.listdi
-0000e850: 7228 666f 6c64 6572 5f61 6273 7061 7468  r(folder_abspath
-0000e860: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000e870: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0000e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e890: 2020 2020 2020 6669 6c65 5f6e 616d 652c        file_name,
-0000e8a0: 2066 696c 655f 6578 7420 203d 206f 732e   file_ext  = os.
-0000e8b0: 7061 7468 2e73 706c 6974 6578 7428 6669  path.splitext(fi
-0000e8c0: 6c65 290d 0a20 2020 2020 2020 2020 2020  le)..           
-0000e8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8f0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000e900: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000e910: 6620 6669 6c65 5f65 7874 2e73 7472 6970  f file_ext.strip
-0000e920: 2822 2e22 2920 696e 2073 6574 7469 6e67  (".") in setting
-0000e930: 732e 6465 6661 756c 745f 6669 6c65 7479  s.default_filety
-0000e940: 7065 733a 0d0a 2020 2020 2020 2020 2020  pes:..          
-0000e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e960: 2020 6966 206e 6f74 2066 6c61 6773 2e69    if not flags.i
-0000e970: 6d61 6765 733a 0d0a 2020 2020 2020 2020  mages:..        
-0000e980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e990: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-0000e9a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e9b0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e9d0: 2020 2020 6669 6c65 5f61 6273 7061 7468      file_abspath
-0000e9e0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-0000e9f0: 7265 7375 6c74 735f 6469 725f 6162 7370  results_dir_absp
-0000ea00: 6174 682c 2066 6f6c 6465 722c 2066 696c  ath, folder, fil
-0000ea10: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0000ea20: 2020 2020 2020 2020 2020 2020 6669 6c65              file
-0000ea30: 5f72 656c 7061 7468 203d 206f 732e 7061  _relpath = os.pa
-0000ea40: 7468 2e6a 6f69 6e28 7265 7375 6c74 735f  th.join(results_
-0000ea50: 6469 725f 7265 6c70 6174 682c 2066 6f6c  dir_relpath, fol
-0000ea60: 6465 722c 2066 696c 6529 0d0a 2020 2020  der, file)..    
-0000ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea80: 2020 2020 7a69 702e 7772 6974 6528 6669      zip.write(fi
-0000ea90: 6c65 5f61 6273 7061 7468 2c20 6669 6c65  le_abspath, file
-0000eaa0: 5f72 656c 7061 7468 2920 2020 0d0a 2020  _relpath)   ..  
-0000eab0: 2020 0d0a 2020 2020 6465 6620 6578 706f    ..    def expo
-0000eac0: 7274 5f74 7261 696e 696e 675f 6461 7461  rt_training_data
-0000ead0: 280d 0a20 2020 2020 2020 2020 2020 2073  (..            s
-0000eae0: 656c 662c 200d 0a20 2020 2020 2020 2020  elf, ..         
-0000eaf0: 2020 2074 6167 2c0d 0a20 2020 2020 2020     tag,..       
-0000eb00: 2020 2020 2066 7261 6d65 776f 726b 2c20       framework, 
-0000eb10: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0000eb20: 6c64 6572 2c20 0d0a 2020 2020 2020 2020  lder, ..        
-0000eb30: 2020 2020 616e 6e6f 7461 7469 6f6e 5f69      annotation_i
-0000eb40: 643d 4e6f 6e65 2c20 0d0a 2020 2020 2020  d=None, ..      
-0000eb50: 2020 2020 2020 6f76 6572 7772 6974 653d        overwrite=
-0000eb60: 4661 6c73 652c 200d 0a20 2020 2020 2020  False, ..       
-0000eb70: 2020 2020 2069 6d67 5f73 697a 653d 3232       img_size=22
-0000eb80: 342c 0d0a 2020 2020 2020 2020 2020 2020  4,..            
-0000eb90: 7061 7261 6d65 7465 7273 3d4e 6f6e 652c  parameters=None,
-0000eba0: 0d0a 2020 2020 2020 2020 2020 2020 2a2a  ..            **
-0000ebb0: 6b77 6172 6773 293a 0d0a 2020 2020 2020  kwargs):..      
-0000ebc0: 2020 2222 220d 0a20 2020 2020 2020 200d    """..        .
-0000ebd0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0000ebe0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0000ebf0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0000ec00: 2020 2074 6167 203a 2073 7472 0d0a 2020     tag : str..  
-0000ec10: 2020 2020 2020 2020 2020 5468 6520 5079            The Py
-0000ec20: 7065 2074 6167 2066 726f 6d20 7768 6963  pe tag from whic
-0000ec30: 6820 7472 6169 6e69 6e67 2064 6174 6120  h training data 
-0000ec40: 7368 6f75 6c64 2062 6520 6578 7472 6163  should be extrac
-0000ec50: 7465 642e 0d0a 2020 2020 2020 2020 6672  ted...        fr
-0000ec60: 616d 6577 6f72 6b20 3a20 207b 226d 6c2d  amework :  {"ml-
-0000ec70: 6d6f 7270 6822 7d20 7374 720d 0a20 2020  morph"} str..   
-0000ec80: 2020 2020 2020 2020 2046 6f72 2077 6869           For whi
-0000ec90: 6368 206d 6163 6869 6e65 206c 6561 726e  ch machine learn
-0000eca0: 696e 6720 6672 616d 776f 726b 2073 686f  ing framwork sho
-0000ecb0: 756c 6420 7472 6169 6e69 6e67 2064 6174  uld training dat
-0000ecc0: 6120 6265 2063 7265 6174 6564 2e0d 0a20  a be created... 
-0000ecd0: 2020 2020 2020 2020 2020 2043 7572 7265             Curre
-0000ece0: 6e74 6c79 2069 6e73 7472 7563 7469 6f6e  ntly instruction
-0000ecf0: 7320 666f 7220 7468 6520 666f 6c6c 6f77  s for the follow
-0000ed00: 696e 6720 6172 6368 6974 6563 7475 7265  ing architecture
-0000ed10: 7320 6172 6520 7375 7070 6f72 7465 643a  s are supported:
-0000ed20: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-0000ed30: 2020 2020 2020 2020 2020 2020 2d20 226d              - "m
-0000ed40: 6c2d 6d6f 7270 6822 202d 204d 6163 6869  l-morph" - Machi
-0000ed50: 6e65 2d6c 6561 726e 696e 6720 746f 6f6c  ne-learning tool
-0000ed60: 7320 666f 7220 6c61 6e64 6d61 726b 2d62  s for landmark-b
-0000ed70: 6173 6564 206d 6f72 7068 6f6d 6574 7269  ased morphometri
-0000ed80: 6373 200d 0a20 2020 2020 2020 2020 2020  cs ..           
-0000ed90: 2020 2068 7474 7073 3a2f 2f67 6974 6875     https://githu
-0000eda0: 622e 636f 6d2f 6167 706f 7274 6f2f 6d6c  b.com/agporto/ml
-0000edb0: 2d6d 6f72 7068 0d0a 2020 2020 2020 2020  -morph..        
-0000edc0: 2020 2020 2d20 226b 6572 6173 2d63 6e6e      - "keras-cnn
-0000edd0: 2d73 656d 616e 7469 6322 202d 2049 6d61  -semantic" - Ima
-0000ede0: 6765 7320 616e 6420 6d61 736b 7320 746f  ges and masks to
-0000edf0: 2062 6520 7573 6564 2066 6f72 2074 7261   be used for tra
-0000ee00: 696e 696e 6720 616e 0d0a 2020 2020 2020  ining an..      
-0000ee10: 2020 2020 2020 696d 6167 6520 7365 676d        image segm
-0000ee20: 656e 7461 7469 6f6e 206d 6f64 656c 2069  entation model i
-0000ee30: 6e20 4b65 7261 730d 0a20 2020 2020 2020  n Keras..       
-0000ee40: 2066 6f6c 6465 7220 3a20 7374 720d 0a20   folder : str.. 
-0000ee50: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
-0000ee60: 6f66 2074 6865 2066 6f6c 6465 7220 756e  of the folder un
-0000ee70: 6465 7220 2272 6f6f 742f 7472 6169 6e69  der "root/traini
-0000ee80: 6e67 5f64 6174 6122 2077 6865 7265 2074  ng_data" where t
-0000ee90: 6865 2066 6f72 6d61 7474 6564 200d 0a20  he formatted .. 
-0000eea0: 2020 2020 2020 2020 2020 2074 7261 696e             train
-0000eeb0: 696e 6720 6461 7461 2077 696c 6c20 6265  ing data will be
-0000eec0: 2073 746f 7265 6420 756e 6465 722e 0d0a   stored under...
-0000eed0: 2020 2020 2020 2020 616e 6e6f 7461 7469          annotati
-0000eee0: 6f6e 5f69 6420 3a20 7374 722c 206f 7074  on_id : str, opt
-0000eef0: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
-0000ef00: 2020 2073 656c 6563 7420 6120 7370 6563     select a spec
-0000ef10: 6966 6963 2061 6e6e 6f74 6174 696f 6e20  ific annotation 
-0000ef20: 6964 2e20 5468 6520 6465 6661 756c 7420  id. The default 
-0000ef30: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
-0000ef40: 2020 6f76 6572 7772 6974 6520 3a20 626f    overwrite : bo
-0000ef50: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 2020  ol, optional..  
-0000ef60: 2020 2020 2020 2020 2020 5368 6f75 6c64            Should
-0000ef70: 2061 6e20 6578 6973 7469 6e67 2074 7261   an existing tra
-0000ef80: 696e 696e 6720 6461 7461 2073 6574 2062  ining data set b
-0000ef90: 6520 6f76 6572 7772 6974 7465 6e2e 2054  e overwritten. T
-0000efa0: 6865 2064 6566 6175 6c74 2069 7320 4661  he default is Fa
-0000efb0: 6c73 652e 0d0a 0d0a 2020 2020 2020 2020  lse.....        
-0000efc0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-0000efd0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-0000efe0: 2020 4e6f 6e65 2e0d 0a0d 0a20 2020 2020    None.....     
-0000eff0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0000f000: 0d0a 2020 2020 2020 2020 2320 3d3d 3d3d  ..        # ====
-0000f010: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f030: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f040: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f050: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
-0000f060: 2020 2023 2073 6574 7570 0d0a 2020 2020     # setup..    
-0000f070: 2020 2020 0d0a 2020 2020 2020 2020 666c      ..        fl
-0000f080: 6167 7320 3d20 6d61 6b65 5f64 6174 6163  ags = make_datac
-0000f090: 6c61 7373 280d 0a20 2020 2020 2020 2020  lass(..         
-0000f0a0: 2020 2063 6c73 5f6e 616d 653d 2266 6c61     cls_name="fla
-0000f0b0: 6773 222c 2066 6965 6c64 733d 5b28 226f  gs", fields=[("o
-0000f0c0: 7665 7277 7269 7465 222c 2062 6f6f 6c2c  verwrite", bool,
-0000f0d0: 206f 7665 7277 7269 7465 295d 0d0a 2020   overwrite)]..  
-0000f0e0: 2020 2020 2020 290d 0a20 2020 200d 0a20        )..    .. 
-0000f0f0: 2020 2020 2020 2069 6620 616e 6e6f 7461         if annota
-0000f100: 7469 6f6e 5f69 642e 5f5f 636c 6173 735f  tion_id.__class_
-0000f110: 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20 224e  _.__name__ == "N
-0000f120: 6f6e 6554 7970 6522 3a0d 0a20 2020 2020  oneType":..     
-0000f130: 2020 2020 2020 2070 7269 6e74 2822 4e6f         print("No
-0000f140: 2061 6e6e 6f74 6174 696f 6e20 6964 2073   annotation id s
-0000f150: 6574 202d 2077 696c 6c20 7573 6520 6c61  et - will use la
-0000f160: 7374 206f 6e65 2069 6e20 616e 6e6f 7461  st one in annota
-0000f170: 7469 6f6e 7320 6669 6c65 2e22 290d 0a20  tions file.").. 
-0000f180: 2020 2020 2020 2020 2020 2074 696d 652e             time.
-0000f190: 736c 6565 7028 3229 0d0a 0d0a 2020 2020  sleep(2)....    
-0000f1a0: 2020 2020 7472 6169 6e69 6e67 5f64 6174      training_dat
-0000f1b0: 615f 7061 7468 203d 206f 732e 7061 7468  a_path = os.path
-0000f1c0: 2e6a 6f69 6e28 7365 6c66 2e72 6f6f 745f  .join(self.root_
-0000f1d0: 6469 722c 2022 7472 6169 6e69 6e67 5f64  dir, "training_d
-0000f1e0: 6174 6122 2c20 666f 6c64 6572 290d 0a20  ata", folder).. 
-0000f1f0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-0000f200: 6e6f 7420 6f73 2e70 6174 682e 6973 6469  not os.path.isdi
-0000f210: 7228 7472 6169 6e69 6e67 5f64 6174 615f  r(training_data_
-0000f220: 7061 7468 293a 0d0a 2020 2020 2020 2020  path):..        
-0000f230: 2020 2020 6f73 2e6d 616b 6564 6972 7328      os.makedirs(
-0000f240: 7472 6169 6e69 6e67 5f64 6174 615f 7061  training_data_pa
-0000f250: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
-0000f260: 2070 7269 6e74 2822 4372 6561 7465 6420   print("Created 
-0000f270: 2220 2b20 7472 6169 6e69 6e67 5f64 6174  " + training_dat
-0000f280: 615f 7061 7468 290d 0a20 2020 2020 2020  a_path)..       
-0000f290: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000f2a0: 2020 200d 0a20 2020 2020 2020 2070 6172     ..        par
-0000f2b0: 616d 6574 6572 735f 6465 6661 756c 7473  ameters_defaults
-0000f2c0: 203d 207b 0d0a 2020 2020 2020 2020 2020   = {..          
-0000f2d0: 2020 226d 6c2d 6d6f 7270 6822 3a20 7b0d    "ml-morph": {.
-0000f2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f2f0: 2022 6578 706f 7274 5f6d 6173 6b22 3a20   "export_mask": 
-0000f300: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
-0000f310: 2020 2020 2020 2020 2266 6c69 705f 7922          "flip_y"
-0000f320: 3a20 4661 6c73 652c 0d0a 2020 2020 2020  : False,..      
-0000f330: 2020 2020 2020 2020 2020 226d 6173 6b5f            "mask_
-0000f340: 6964 223a 204e 6f6e 652c 0d0a 2020 2020  id": None,..    
-0000f350: 2020 2020 2020 2020 2020 2020 2272 6573              "res
-0000f360: 697a 655f 6661 6374 6f72 223a 2031 2c0d  ize_factor": 1,.
-0000f370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f380: 207d 2c0d 0a20 2020 2020 2020 2020 2020   },..           
-0000f390: 2022 6b65 7261 732d 636e 6e2d 7365 6d61   "keras-cnn-sema
-0000f3a0: 6e74 6963 223a 207b 0d0a 2020 2020 2020  ntic": {..      
-0000f3b0: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
-0000f3c0: 2020 2020 2020 2020 207d 0d0a 0d0a 2020           }....  
-0000f3d0: 2020 2020 2020 6672 616d 6577 6f72 6b5f        framework_
-0000f3e0: 7061 7261 6d65 7465 7273 203d 2063 6f70  parameters = cop
-0000f3f0: 792e 6465 6570 636f 7079 2870 6172 616d  y.deepcopy(param
-0000f400: 6574 6572 735f 6465 6661 756c 7473 290d  eters_defaults).
-0000f410: 0a0d 0a0d 0a20 2020 2020 2020 2023 203d  .....        # =
-0000f420: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f430: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f440: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f450: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f460: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
-0000f470: 2020 2020 2020 2323 206d 6c2d 6d6f 7270        ## ml-morp
-0000f480: 680d 0a20 2020 2020 2020 200d 0a20 2020  h..        ..   
-0000f490: 2020 2020 2069 6620 6672 616d 6577 6f72       if framewor
-0000f4a0: 6b3d 3d22 6d6c 2d6d 6f72 7068 223a 0d0a  k=="ml-morph":..
-0000f4b0: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
-0000f4c0: 6e6f 7461 7469 6f6e 5f74 7970 6520 3d20  notation_type = 
-0000f4d0: 7365 7474 696e 6773 2e5f 6c61 6e64 6d61  settings._landma
-0000f4e0: 726b 5f74 7970 650d 0a20 2020 2020 2020  rk_type..       
-0000f4f0: 2020 2020 2064 665f 7375 6d6d 6172 7920       df_summary 
-0000f500: 3d20 7064 2e44 6174 6146 7261 6d65 2829  = pd.DataFrame()
-0000f510: 0d0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
-0000f520: 6c65 5f70 6174 685f 7361 7665 203d 206f  le_path_save = o
-0000f530: 732e 7061 7468 2e6a 6f69 6e28 7472 6169  s.path.join(trai
-0000f540: 6e69 6e67 5f64 6174 615f 7061 7468 2c20  ning_data_path, 
-0000f550: 226c 616e 646d 6172 6b73 5f6d 6c2d 6d6f  "landmarks_ml-mo
-0000f560: 7270 685f 2220 2b20 7461 6720 2b20 222e  rph_" + tag + ".
-0000f570: 6373 7622 290d 0a0d 0a20 2020 2020 2020  csv")....       
-0000f580: 2020 2020 2069 6620 6e6f 7420 7574 696c       if not util
-0000f590: 735f 6c6f 776c 6576 656c 2e5f 6f76 6572  s_lowlevel._over
-0000f5a0: 7772 6974 655f 6368 6563 6b5f 6669 6c65  write_check_file
-0000f5b0: 2866 696c 655f 7061 7468 5f73 6176 652c  (file_path_save,
-0000f5c0: 2066 6c61 6773 2e6f 7665 7277 7269 7465   flags.overwrite
-0000f5d0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000f5e0: 2020 2020 7265 7475 726e 0d0a 2020 2020      return..    
-0000f5f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000f600: 2020 2020 2020 6966 206e 6f74 2070 6172        if not par
-0000f610: 616d 6574 6572 732e 5f5f 636c 6173 735f  ameters.__class_
-0000f620: 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20 224e  _.__name__ == "N
-0000f630: 6f6e 6554 7970 6522 3a0d 0a20 2020 2020  oneType":..     
-0000f640: 2020 2020 2020 2020 2020 2066 7261 6d65             frame
-0000f650: 776f 726b 5f70 6172 616d 6574 6572 735b  work_parameters[
-0000f660: 226d 6c2d 6d6f 7270 6822 5d2e 7570 6461  "ml-morph"].upda
-0000f670: 7465 2870 6172 616d 6574 6572 735b 226d  te(parameters["m
-0000f680: 6c2d 6d6f 7270 6822 5d29 0d0a 2020 2020  l-morph"])..    
-0000f690: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0000f6a0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0000f6b0: 2020 2020 2020 2020 2020 2020 666c 6167              flag
-0000f6c0: 732e 6578 706f 7274 5f6d 6173 6b20 3d20  s.export_mask = 
-0000f6d0: 6672 616d 6577 6f72 6b5f 7061 7261 6d65  framework_parame
-0000f6e0: 7465 7273 5b22 6d6c 2d6d 6f72 7068 225d  ters["ml-morph"]
-0000f6f0: 5b22 6578 706f 7274 5f6d 6173 6b22 5d0d  ["export_mask"].
-0000f700: 0a20 2020 2020 2020 2020 2020 2066 6c61  .            fla
-0000f710: 6773 2e72 6573 697a 655f 6661 6374 6f72  gs.resize_factor
-0000f720: 203d 2066 7261 6d65 776f 726b 5f70 6172   = framework_par
-0000f730: 616d 6574 6572 735b 226d 6c2d 6d6f 7270  ameters["ml-morp
-0000f740: 6822 5d5b 2272 6573 697a 655f 6661 6374  h"]["resize_fact
-0000f750: 6f72 225d 0d0a 2020 2020 2020 2020 2020  or"]..          
-0000f760: 2020 666c 6167 732e 666c 6970 5f79 203d    flags.flip_y =
-0000f770: 2066 7261 6d65 776f 726b 5f70 6172 616d   framework_param
-0000f780: 6574 6572 735b 226d 6c2d 6d6f 7270 6822  eters["ml-morph"
-0000f790: 5d5b 2266 6c69 705f 7922 5d0d 0a0d 0a20  ]["flip_y"].... 
-0000f7a0: 2020 2020 2020 2020 2020 2069 6620 666c             if fl
-0000f7b0: 6167 732e 6578 706f 7274 5f6d 6173 6b3a  ags.export_mask:
-0000f7c0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000f7d0: 2020 2020 696d 675f 6469 7220 3d20 6f73      img_dir = os
-0000f7e0: 2e70 6174 682e 6a6f 696e 2874 7261 696e  .path.join(train
-0000f7f0: 696e 675f 6461 7461 5f70 6174 682c 2022  ing_data_path, "
-0000f800: 696d 6167 6573 2229 0d0a 2020 2020 2020  images")..      
-0000f810: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0000f820: 206f 732e 7061 7468 2e69 7364 6972 2869   os.path.isdir(i
-0000f830: 6d67 5f64 6972 293a 0d0a 2020 2020 2020  mg_dir):..      
-0000f840: 2020 2020 2020 2020 2020 2020 2020 6f73                os
-0000f850: 2e6d 616b 6564 6972 7328 696d 675f 6469  .makedirs(img_di
-0000f860: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
-0000f870: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0000f880: 7220 6964 7831 2c20 6469 7270 6174 6820  r idx1, dirpath 
-0000f890: 696e 2065 6e75 6d65 7261 7465 2873 656c  in enumerate(sel
-0000f8a0: 662e 6469 725f 7061 7468 732c 2031 293a  f.dir_paths, 1):
-0000f8b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f8c0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0000f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8e0: 2323 206c 6f61 6420 6461 7461 0d0a 2020  ## load data..  
-0000f8f0: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0000f900: 7472 6962 7574 6573 203d 2075 7469 6c73  tributes = utils
-0000f910: 5f6c 6f77 6c65 7665 6c2e 5f6c 6f61 645f  _lowlevel._load_
-0000f920: 7961 6d6c 286f 732e 7061 7468 2e6a 6f69  yaml(os.path.joi
-0000f930: 6e28 6469 7270 6174 682c 2022 6174 7472  n(dirpath, "attr
-0000f940: 6962 7574 6573 2e79 616d 6c22 2929 2020  ibutes.yaml"))  
-0000f950: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000f960: 2020 2020 2020 2020 2020 2061 6e6e 6f74             annot
-0000f970: 6174 696f 6e73 203d 2065 7870 6f72 742e  ations = export.
-0000f980: 6c6f 6164 5f61 6e6e 6f74 6174 696f 6e28  load_annotation(
-0000f990: 6f73 2e70 6174 682e 6a6f 696e 2864 6972  os.path.join(dir
-0000f9a0: 7061 7468 2c20 2261 6e6e 6f74 6174 696f  path, "annotatio
-0000f9b0: 6e73 5f22 202b 2074 6167 202b 2022 2e6a  ns_" + tag + ".j
-0000f9c0: 736f 6e22 2929 2020 2020 2020 200d 0a20  son"))       .. 
-0000f9d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000f9e0: 696c 656e 616d 6520 3d20 6174 7472 6962  ilename = attrib
-0000f9f0: 7574 6573 5b22 696d 6167 655f 6f72 6967  utes["image_orig
-0000fa00: 696e 616c 225d 5b22 6669 6c65 6e61 6d65  inal"]["filename
-0000fa10: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
-0000fa20: 2020 2020 696d 6167 655f 6865 6967 6874      image_height
-0000fa30: 203d 2061 7474 7269 6275 7465 735b 2269   = attributes["i
-0000fa40: 6d61 6765 5f70 6865 6e6f 7079 7065 225d  mage_phenopype"]
-0000fa50: 5b22 6865 6967 6874 225d 0d0a 2020 2020  ["height"]..    
-0000fa60: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0000fa70: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0000fa80: 696e 7428 2250 7265 7061 7269 6e67 2074  int("Preparing t
-0000fa90: 7261 696e 696e 6720 6461 7461 2066 6f72  raining data for
-0000faa0: 3a20 287b 7d2f 7b7d 2920 222e 666f 726d  : ({}/{}) ".form
-0000fab0: 6174 2869 6478 312c 206c 656e 2873 656c  at(idx1, len(sel
-0000fac0: 662e 6469 725f 7061 7468 7329 2920 2b20  f.dir_paths)) + 
-0000fad0: 6669 6c65 6e61 6d65 290d 0a20 2020 200d  filename)..    .
-0000fae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000faf0: 2023 2320 6368 6563 6b73 2061 6e64 2066   ## checks and f
-0000fb00: 6565 6462 6163 6b0d 0a20 2020 2020 2020  eedback..       
-0000fb10: 2020 2020 2020 2020 2069 6620 616e 6e6f           if anno
-0000fb20: 7461 7469 6f6e 732e 5f5f 636c 6173 735f  tations.__class_
-0000fb30: 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20 224e  _.__name__ == "N
-0000fb40: 6f6e 6554 7970 6522 3a20 0d0a 2020 2020  oneType": ..    
-0000fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb60: 7072 696e 7428 224e 6f20 616e 6e6f 7461  print("No annota
-0000fb70: 7469 6f6e 7320 666f 756e 6420 666f 7220  tions found for 
-0000fb80: 7b7d 222e 666f 726d 6174 2866 696c 656e  {}".format(filen
-0000fb90: 616d 6529 290d 0a20 2020 2020 2020 2020  ame))..         
-0000fba0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-0000fbb0: 6e75 650d 0a20 2020 2020 2020 2020 2020  nue..           
-0000fbc0: 2020 2020 2069 6620 6e6f 7420 616e 6e6f       if not anno
-0000fbd0: 7461 7469 6f6e 5f74 7970 6520 696e 2061  tation_type in a
-0000fbe0: 6e6e 6f74 6174 696f 6e73 3a0d 0a20 2020  nnotations:..   
-0000fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc00: 2070 7269 6e74 2822 4e6f 2061 6e6e 6f74   print("No annot
-0000fc10: 6174 696f 6e20 6f66 2074 7970 6520 7b7d  ation of type {}
-0000fc20: 2066 6f75 6e64 2066 6f72 207b 7d22 2e66   found for {}".f
-0000fc30: 6f72 6d61 7428 616e 6e6f 7461 7469 6f6e  ormat(annotation
-0000fc40: 5f74 7970 652c 2066 696c 656e 616d 6529  _type, filename)
-0000fc50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000fc60: 2020 2020 2020 2063 6f6e 7469 6e75 650d         continue.
-0000fc70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fc80: 2069 6620 616e 6e6f 7461 7469 6f6e 5f69   if annotation_i
-0000fc90: 642e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  d.__class__.__na
-0000fca0: 6d65 5f5f 203d 3d20 224e 6f6e 6554 7970  me__ == "NoneTyp
-0000fcb0: 6522 3a0d 0a20 2020 2020 2020 2020 2020  e":..           
-0000fcc0: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
-0000fcd0: 696f 6e5f 6964 203d 206d 6178 286c 6973  ion_id = max(lis
-0000fce0: 7428 616e 6e6f 7461 7469 6f6e 735b 616e  t(annotations[an
-0000fcf0: 6e6f 7461 7469 6f6e 5f74 7970 655d 2e6b  notation_type].k
-0000fd00: 6579 7328 2929 290d 0a20 2020 2020 2020  eys()))..       
-0000fd10: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-0000fd20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000fd30: 2320 6c6f 6164 206c 616e 646d 6172 6b73  # load landmarks
-0000fd40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000fd50: 2020 6461 7461 203d 2061 6e6e 6f74 6174    data = annotat
-0000fd60: 696f 6e73 5b61 6e6e 6f74 6174 696f 6e5f  ions[annotation_
-0000fd70: 7479 7065 5d5b 616e 6e6f 7461 7469 6f6e  type][annotation
-0000fd80: 5f69 645d 5b22 6461 7461 225d 5b61 6e6e  _id]["data"][ann
-0000fd90: 6f74 6174 696f 6e5f 7479 7065 5d0d 0a20  otation_type].. 
-0000fda0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0000fdb0: 6d5f 7475 706c 655f 6c69 7374 203d 206c  m_tuple_list = l
-0000fdc0: 6973 7428 7a69 7028 2a64 6174 6129 290d  ist(zip(*data)).
-0000fdd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fde0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000fdf0: 2020 2023 2320 6c6f 6164 2069 6d61 6765     ## load image
-0000fe00: 2069 6620 6d61 736b 696e 6720 6f72 2072   if masking or r
-0000fe10: 6573 697a 696e 670d 0a20 2020 2020 2020  esizing..       
-0000fe20: 2020 2020 2020 2020 2069 6620 666c 6167           if flag
-0000fe30: 732e 6578 706f 7274 5f6d 6173 6b20 6f72  s.export_mask or
-0000fe40: 2066 6c61 6773 2e72 6573 697a 655f 6661   flags.resize_fa
-0000fe50: 6374 6f72 2021 3d20 313a 0d0a 2020 2020  ctor != 1:..    
-0000fe60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fe70: 696d 6167 6520 3d20 7574 696c 732e 6c6f  image = utils.lo
-0000fe80: 6164 5f69 6d61 6765 2864 6972 7061 7468  ad_image(dirpath
-0000fe90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000fea0: 2020 2020 2020 2069 6d61 6765 5f68 6569         image_hei
-0000feb0: 6768 742c 2069 6d61 6765 5f77 6964 7468  ght, image_width
-0000fec0: 203d 2069 6d61 6765 2e73 6861 7065 5b30   = image.shape[0
-0000fed0: 3a32 5d0d 0a0d 0a20 2020 2020 2020 2020  :2]....         
-0000fee0: 2020 2020 2020 2020 2020 2023 2320 7365             ## se
-0000fef0: 6c65 6374 206c 6173 7420 6d61 736b 2069  lect last mask i
-0000ff00: 6620 6e6f 2069 6420 6973 2067 6976 656e  f no id is given
-0000ff10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ff20: 2020 2020 2020 6966 2066 7261 6d65 776f        if framewo
-0000ff30: 726b 5f70 6172 616d 6574 6572 735b 226d  rk_parameters["m
-0000ff40: 6c2d 6d6f 7270 6822 5d5b 226d 6173 6b5f  l-morph"]["mask_
-0000ff50: 6964 225d 2e5f 5f63 6c61 7373 5f5f 2e5f  id"].__class__._
-0000ff60: 5f6e 616d 655f 5f20 3d3d 2022 4e6f 6e65  _name__ == "None
-0000ff70: 5479 7065 223a 0d0a 2020 2020 2020 2020  Type":..        
-0000ff80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ff90: 6d61 736b 5f69 6420 3d20 6d61 7828 6c69  mask_id = max(li
-0000ffa0: 7374 2861 6e6e 6f74 6174 696f 6e73 5b73  st(annotations[s
-0000ffb0: 6574 7469 6e67 732e 5f6d 6173 6b5f 7479  ettings._mask_ty
-0000ffc0: 7065 5d2e 6b65 7973 2829 2929 0d0a 2020  pe].keys()))..  
-0000ffd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ffe0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000fff0: 2020 2020 2020 2020 2020 2020 2323 2067              ## g
-00010000: 6574 2062 6f75 6e64 696e 6720 7265 6374  et bounding rect
-00010010: 616e 676c 6520 616e 6420 6372 6f70 2069  angle and crop i
-00010020: 6d61 6765 2074 6f20 6d61 736b 2063 6f6f  mage to mask coo
-00010030: 7264 730d 0a20 2020 2020 2020 2020 2020  rds..           
-00010040: 2020 2020 2020 2020 2069 6620 666c 6167           if flag
-00010050: 732e 6578 706f 7274 5f6d 6173 6b20 616e  s.export_mask an
-00010060: 6420 7365 7474 696e 6773 2e5f 6d61 736b  d settings._mask
-00010070: 5f74 7970 6520 696e 2061 6e6e 6f74 6174  _type in annotat
-00010080: 696f 6e73 3a0d 0a20 2020 2020 2020 2020  ions:..         
-00010090: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000100a0: 6f6f 7264 7320 3d20 616e 6e6f 7461 7469  oords = annotati
-000100b0: 6f6e 735b 7365 7474 696e 6773 2e5f 6d61  ons[settings._ma
-000100c0: 736b 5f74 7970 655d 5b6d 6173 6b5f 6964  sk_type][mask_id
-000100d0: 5d5b 2264 6174 6122 5d5b 7365 7474 696e  ]["data"][settin
-000100e0: 6773 2e5f 6d61 736b 5f74 7970 655d 5b30  gs._mask_type][0
-000100f0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00010100: 2020 2020 2020 2020 2020 2072 782c 2072             rx, r
-00010110: 792c 2072 772c 2072 6820 3d20 6376 322e  y, rw, rh = cv2.
-00010120: 626f 756e 6469 6e67 5265 6374 286e 702e  boundingRect(np.
-00010130: 6173 6172 7261 7928 636f 6f72 6473 2c20  asarray(coords, 
-00010140: 6474 7970 653d 2269 6e74 3332 2229 290d  dtype="int32")).
+0000e2e0: 2020 2020 2020 7465 7374 5f70 6174 7465        test_patte
+0000e2f0: 726e 203d 2066 696c 655f 6e61 6d65 5b2d  rn = file_name[-
+0000e300: 6c65 6e28 666c 6167 732e 7461 6729 3a6c  len(flags.tag):l
+0000e310: 656e 2866 696c 655f 6e61 6d65 295d 0d0a  en(file_name)]..
+0000e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e330: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000e340: 6f74 2066 6c61 6773 2e74 6167 203d 3d20  ot flags.tag == 
+0000e350: 7465 7374 5f70 6174 7465 726e 3a0d 0a20  test_pattern:.. 
+0000e360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e370: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000e380: 6f6e 7469 6e75 6520 2020 2020 2020 200d  ontinue        .
+0000e390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e3a0: 2020 2020 2020 2020 2069 6620 6669 6c65           if file
+0000e3b0: 5f65 7874 2e73 7472 6970 2822 2e22 2920  _ext.strip(".") 
+0000e3c0: 696e 2073 6574 7469 6e67 732e 6465 6661  in settings.defa
+0000e3d0: 756c 745f 6669 6c65 7479 7065 733a 0d0a  ult_filetypes:..
+0000e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e3f0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000e400: 6f74 2066 6c61 6773 2e69 6d61 6765 733a  ot flags.images:
+0000e410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e430: 2020 636f 6e74 696e 7565 0d0a 2020 2020    continue..    
+0000e440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e450: 2020 2020 6966 2066 696c 655f 6578 742e      if file_ext.
+0000e460: 7374 7269 7028 222e 2229 203d 3d20 2263  strip(".") == "c
+0000e470: 7376 2220 616e 6420 666c 6167 732e 6578  sv" and flags.ex
+0000e480: 706f 7274 7320 3d3d 2046 616c 7365 3a0d  ports == False:.
+0000e490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e4a0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0000e4b0: 7469 6e75 650d 0a20 2020 2020 2020 2020  tinue..         
+0000e4c0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+0000e4d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e4e0: 2020 2020 2066 696c 655f 6162 7370 6174       file_abspat
+0000e4f0: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
+0000e500: 2864 6174 615f 6469 725f 6162 7370 6174  (data_dir_abspat
+0000e510: 682c 2066 6f6c 6465 722c 2066 696c 6529  h, folder, file)
+0000e520: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e530: 2020 2020 2020 6669 6c65 5f72 656c 7061        file_relpa
+0000e540: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
+0000e550: 6e28 6461 7461 5f64 6972 5f72 656c 7061  n(data_dir_relpa
+0000e560: 7468 2c20 666f 6c64 6572 2c20 6669 6c65  th, folder, file
+0000e570: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000e580: 2020 2020 2020 207a 6970 2e77 7269 7465         zip.write
+0000e590: 2866 696c 655f 6162 7370 6174 682c 2066  (file_abspath, f
+0000e5a0: 696c 655f 7265 6c70 6174 6829 2020 2020  ile_relpath)    
+0000e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000e5d0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+0000e5e0: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+0000e5f0: 6c61 6773 2e6d 6f64 656c 733a 0d0a 2020  lags.models:..  
+0000e600: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+0000e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e620: 6d6f 6465 6c73 5f64 6972 5f61 6273 7061  models_dir_abspa
+0000e630: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
+0000e640: 6e28 7365 6c66 2e72 6f6f 745f 6469 722c  n(self.root_dir,
+0000e650: 2022 6d6f 6465 6c73 2229 2020 2020 2020   "models")      
+0000e660: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000e670: 2020 206d 6f64 656c 735f 6469 725f 7265     models_dir_re
+0000e680: 6c70 6174 6820 3d20 6f73 2e70 6174 682e  lpath = os.path.
+0000e690: 6a6f 696e 2872 6f6f 745f 6469 722c 2022  join(root_dir, "
+0000e6a0: 6d6f 6465 6c73 2229 200d 0a20 2020 2020  models") ..     
+0000e6b0: 2020 2020 2020 2020 2020 207a 6970 2e77             zip.w
+0000e6c0: 7269 7465 286d 6f64 656c 735f 6469 725f  rite(models_dir_
+0000e6d0: 6162 7370 6174 682c 206d 6f64 656c 735f  abspath, models_
+0000e6e0: 6469 725f 7265 6c70 6174 6829 2020 2020  dir_relpath)    
+0000e6f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e700: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000e710: 2020 2020 666f 7220 6669 6c65 2069 6e20      for file in 
+0000e720: 6f73 2e6c 6973 7464 6972 286d 6f64 656c  os.listdir(model
+0000e730: 735f 6469 725f 6162 7370 6174 6829 3a0d  s_dir_abspath):.
+0000e740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e750: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000e760: 2020 2020 2020 2020 2020 2066 696c 655f             file_
+0000e770: 6162 7370 6174 6820 3d20 6f73 2e70 6174  abspath = os.pat
+0000e780: 682e 6a6f 696e 286d 6f64 656c 735f 6469  h.join(models_di
+0000e790: 725f 6162 7370 6174 682c 2066 696c 6529  r_abspath, file)
+0000e7a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e7b0: 2020 2020 2020 6669 6c65 5f72 656c 7061        file_relpa
+0000e7c0: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
+0000e7d0: 6e28 6d6f 6465 6c73 5f64 6972 5f72 656c  n(models_dir_rel
+0000e7e0: 7061 7468 2c20 6669 6c65 290d 0a20 2020  path, file)..   
+0000e7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e800: 207a 6970 2e77 7269 7465 2866 696c 655f   zip.write(file_
+0000e810: 6162 7370 6174 682c 2066 696c 655f 7265  abspath, file_re
+0000e820: 6c70 6174 6829 2020 2020 2020 2020 2020  lpath)          
+0000e830: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0000e840: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000e850: 6966 2066 6c61 6773 2e72 6573 756c 7473  if flags.results
+0000e860: 3a0d 0a20 2020 2020 2020 2020 2020 0d0a  :..           ..
+0000e870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e880: 7265 7375 6c74 735f 6469 725f 6162 7370  results_dir_absp
+0000e890: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
+0000e8a0: 696e 2873 656c 662e 726f 6f74 5f64 6972  in(self.root_dir
+0000e8b0: 2c20 2272 6573 756c 7473 2229 2020 2020  , "results")    
+0000e8c0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000e8d0: 2020 2020 2072 6573 756c 7473 5f64 6972       results_dir
+0000e8e0: 5f72 656c 7061 7468 203d 206f 732e 7061  _relpath = os.pa
+0000e8f0: 7468 2e6a 6f69 6e28 726f 6f74 5f64 6972  th.join(root_dir
+0000e900: 2c20 2272 6573 756c 7473 2229 2020 2020  , "results")    
+0000e910: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000e920: 2020 2020 207a 6970 2e77 7269 7465 2872       zip.write(r
+0000e930: 6573 756c 7473 5f64 6972 5f61 6273 7061  esults_dir_abspa
+0000e940: 7468 2c20 7265 7375 6c74 735f 6469 725f  th, results_dir_
+0000e950: 7265 6c70 6174 6829 2020 2020 0d0a 2020  relpath)    ..  
+0000e960: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+0000e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e980: 2323 206c 6f6f 7020 7468 726f 7075 6768  ## loop thropugh
+0000e990: 2064 6174 6120 666f 6c64 6572 2020 2020   data folder    
+0000e9a0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000e9b0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0000e9c0: 2066 6f6c 6465 7220 696e 206f 732e 6c69   folder in os.li
+0000e9d0: 7374 6469 7228 7265 7375 6c74 735f 6469  stdir(results_di
+0000e9e0: 725f 6162 7370 6174 6829 3a0d 0a20 2020  r_abspath):..   
+0000e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea00: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000ea10: 2020 2020 2020 2020 2020 2066 6f6c 6465             folde
+0000ea20: 725f 6162 7370 6174 6820 3d20 6f73 2e70  r_abspath = os.p
+0000ea30: 6174 682e 6a6f 696e 2872 6573 756c 7473  ath.join(results
+0000ea40: 5f64 6972 5f61 6273 7061 7468 2c20 666f  _dir_abspath, fo
+0000ea50: 6c64 6572 290d 0a20 2020 2020 2020 2020  lder)..         
+0000ea60: 2020 2020 2020 2020 2020 2066 6f6c 6465             folde
+0000ea70: 725f 7265 6c70 6174 6820 3d20 6f73 2e70  r_relpath = os.p
+0000ea80: 6174 682e 6a6f 696e 2872 6573 756c 7473  ath.join(results
+0000ea90: 5f64 6972 5f72 656c 7061 7468 2c20 666f  _dir_relpath, fo
+0000eaa0: 6c64 6572 290d 0a20 2020 2020 2020 2020  lder)..         
+0000eab0: 2020 2020 2020 2020 2020 207a 6970 2e77             zip.w
+0000eac0: 7269 7465 2866 6f6c 6465 725f 6162 7370  rite(folder_absp
+0000ead0: 6174 682c 2066 6f6c 6465 725f 7265 6c70  ath, folder_relp
+0000eae0: 6174 6829 2020 2020 2020 2020 2020 2020  ath)            
+0000eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb00: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0000eb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb20: 666f 7220 6669 6c65 2069 6e20 6f73 2e6c  for file in os.l
+0000eb30: 6973 7464 6972 2866 6f6c 6465 725f 6162  istdir(folder_ab
+0000eb40: 7370 6174 6829 3a0d 0a20 2020 2020 2020  spath):..       
+0000eb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb60: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000eb70: 2020 2020 2020 2020 2020 2066 696c 655f             file_
+0000eb80: 6e61 6d65 2c20 6669 6c65 5f65 7874 2020  name, file_ext  
+0000eb90: 3d20 6f73 2e70 6174 682e 7370 6c69 7465  = os.path.splite
+0000eba0: 7874 2866 696c 6529 0d0a 2020 2020 2020  xt(file)..      
+0000ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ebd0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ebf0: 2020 2020 6966 2066 696c 655f 6578 742e      if file_ext.
+0000ec00: 7374 7269 7028 222e 2229 2069 6e20 7365  strip(".") in se
+0000ec10: 7474 696e 6773 2e64 6566 6175 6c74 5f66  ttings.default_f
+0000ec20: 696c 6574 7970 6573 3a0d 0a20 2020 2020  iletypes:..     
+0000ec30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec40: 2020 2020 2020 2069 6620 6e6f 7420 666c         if not fl
+0000ec50: 6167 732e 696d 6167 6573 3a0d 0a20 2020  ags.images:..   
+0000ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec70: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0000ec80: 7469 6e75 650d 0a20 2020 2020 2020 2020  tinue..         
+0000ec90: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+0000eca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ecb0: 2020 2020 2020 2020 2066 696c 655f 6162           file_ab
+0000ecc0: 7370 6174 6820 3d20 6f73 2e70 6174 682e  spath = os.path.
+0000ecd0: 6a6f 696e 2872 6573 756c 7473 5f64 6972  join(results_dir
+0000ece0: 5f61 6273 7061 7468 2c20 666f 6c64 6572  _abspath, folder
+0000ecf0: 2c20 6669 6c65 290d 0a20 2020 2020 2020  , file)..       
+0000ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed10: 2066 696c 655f 7265 6c70 6174 6820 3d20   file_relpath = 
+0000ed20: 6f73 2e70 6174 682e 6a6f 696e 2872 6573  os.path.join(res
+0000ed30: 756c 7473 5f64 6972 5f72 656c 7061 7468  ults_dir_relpath
+0000ed40: 2c20 666f 6c64 6572 2c20 6669 6c65 290d  , folder, file).
+0000ed50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ed60: 2020 2020 2020 2020 207a 6970 2e77 7269           zip.wri
+0000ed70: 7465 2866 696c 655f 6162 7370 6174 682c  te(file_abspath,
+0000ed80: 2066 696c 655f 7265 6c70 6174 6829 2020   file_relpath)  
+0000ed90: 200d 0a20 2020 200d 0a20 2020 2064 6566   ..    ..    def
+0000eda0: 2065 7870 6f72 745f 7472 6169 6e69 6e67   export_training
+0000edb0: 5f64 6174 6128 0d0a 2020 2020 2020 2020  _data(..        
+0000edc0: 2020 2020 7365 6c66 2c20 0d0a 2020 2020      self, ..    
+0000edd0: 2020 2020 2020 2020 7461 672c 0d0a 2020          tag,..  
+0000ede0: 2020 2020 2020 2020 2020 6672 616d 6577            framew
+0000edf0: 6f72 6b2c 200d 0a20 2020 2020 2020 2020  ork, ..         
+0000ee00: 2020 2066 6f6c 6465 722c 200d 0a20 2020     folder, ..   
+0000ee10: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
+0000ee20: 696f 6e5f 6964 3d4e 6f6e 652c 200d 0a20  ion_id=None, .. 
+0000ee30: 2020 2020 2020 2020 2020 206f 7665 7277             overw
+0000ee40: 7269 7465 3d46 616c 7365 2c20 0d0a 2020  rite=False, ..  
+0000ee50: 2020 2020 2020 2020 2020 696d 675f 7369            img_si
+0000ee60: 7a65 3d32 3234 2c0d 0a20 2020 2020 2020  ze=224,..       
+0000ee70: 2020 2020 2070 6172 616d 6574 6572 733d       parameters=
+0000ee80: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+0000ee90: 2020 202a 2a6b 7761 7267 7329 3a0d 0a20     **kwargs):.. 
+0000eea0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0000eeb0: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
+0000eec0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0000eed0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+0000eee0: 2020 2020 2020 2020 7461 6720 3a20 7374          tag : st
+0000eef0: 720d 0a20 2020 2020 2020 2020 2020 2054  r..            T
+0000ef00: 6865 2050 7970 6520 7461 6720 6672 6f6d  he Pype tag from
+0000ef10: 2077 6869 6368 2074 7261 696e 696e 6720   which training 
+0000ef20: 6461 7461 2073 686f 756c 6420 6265 2065  data should be e
+0000ef30: 7874 7261 6374 6564 2e0d 0a20 2020 2020  xtracted...     
+0000ef40: 2020 2066 7261 6d65 776f 726b 203a 2020     framework :  
+0000ef50: 7b22 6d6c 2d6d 6f72 7068 227d 2073 7472  {"ml-morph"} str
+0000ef60: 0d0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
+0000ef70: 7220 7768 6963 6820 6d61 6368 696e 6520  r which machine 
+0000ef80: 6c65 6172 6e69 6e67 2066 7261 6d77 6f72  learning framwor
+0000ef90: 6b20 7368 6f75 6c64 2074 7261 696e 696e  k should trainin
+0000efa0: 6720 6461 7461 2062 6520 6372 6561 7465  g data be create
+0000efb0: 642e 0d0a 2020 2020 2020 2020 2020 2020  d...            
+0000efc0: 4375 7272 656e 746c 7920 696e 7374 7275  Currently instru
+0000efd0: 6374 696f 6e73 2066 6f72 2074 6865 2066  ctions for the f
+0000efe0: 6f6c 6c6f 7769 6e67 2061 7263 6869 7465  ollowing archite
+0000eff0: 6374 7572 6573 2061 7265 2073 7570 706f  ctures are suppo
+0000f000: 7274 6564 3a0d 0a20 2020 2020 2020 2020  rted:..         
+0000f010: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000f020: 202d 2022 6d6c 2d6d 6f72 7068 2220 2d20   - "ml-morph" - 
+0000f030: 4d61 6368 696e 652d 6c65 6172 6e69 6e67  Machine-learning
+0000f040: 2074 6f6f 6c73 2066 6f72 206c 616e 646d   tools for landm
+0000f050: 6172 6b2d 6261 7365 6420 6d6f 7270 686f  ark-based morpho
+0000f060: 6d65 7472 6963 7320 0d0a 2020 2020 2020  metrics ..      
+0000f070: 2020 2020 2020 2020 6874 7470 733a 2f2f          https://
+0000f080: 6769 7468 7562 2e63 6f6d 2f61 6770 6f72  github.com/agpor
+0000f090: 746f 2f6d 6c2d 6d6f 7270 680d 0a20 2020  to/ml-morph..   
+0000f0a0: 2020 2020 2020 2020 202d 2022 6b65 7261           - "kera
+0000f0b0: 732d 636e 6e2d 7365 6d61 6e74 6963 2220  s-cnn-semantic" 
+0000f0c0: 2d20 496d 6167 6573 2061 6e64 206d 6173  - Images and mas
+0000f0d0: 6b73 2074 6f20 6265 2075 7365 6420 666f  ks to be used fo
+0000f0e0: 7220 7472 6169 6e69 6e67 2061 6e0d 0a20  r training an.. 
+0000f0f0: 2020 2020 2020 2020 2020 2020 2069 6d61               ima
+0000f100: 6765 2073 6567 6d65 6e74 6174 696f 6e20  ge segmentation 
+0000f110: 6d6f 6465 6c20 696e 204b 6572 6173 0d0a  model in Keras..
+0000f120: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0000f130: 2020 2020 2020 666f 6c64 6572 203a 2073        folder : s
+0000f140: 7472 0d0a 2020 2020 2020 2020 2020 2020  tr..            
+0000f150: 4e61 6d65 206f 6620 7468 6520 666f 6c64  Name of the fold
+0000f160: 6572 2075 6e64 6572 2022 726f 6f74 2f74  er under "root/t
+0000f170: 7261 696e 696e 675f 6461 7461 2220 7768  raining_data" wh
+0000f180: 6572 6520 7468 6520 666f 726d 6174 7465  ere the formatte
+0000f190: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
+0000f1a0: 7472 6169 6e69 6e67 2064 6174 6120 7769  training data wi
+0000f1b0: 6c6c 2062 6520 7374 6f72 6564 2075 6e64  ll be stored und
+0000f1c0: 6572 2e0d 0a20 2020 2020 2020 2061 6e6e  er...        ann
+0000f1d0: 6f74 6174 696f 6e5f 6964 203a 2073 7472  otation_id : str
+0000f1e0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+0000f1f0: 2020 2020 2020 2020 7365 6c65 6374 2061          select a
+0000f200: 2073 7065 6369 6669 6320 616e 6e6f 7461   specific annota
+0000f210: 7469 6f6e 2069 642e 2054 6865 2064 6566  tion id. The def
+0000f220: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
+0000f230: 2020 2020 2020 206f 7665 7277 7269 7465         overwrite
+0000f240: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+0000f250: 6c0d 0a20 2020 2020 2020 2020 2020 2053  l..            S
+0000f260: 686f 756c 6420 616e 2065 7869 7374 696e  hould an existin
+0000f270: 6720 7472 6169 6e69 6e67 2064 6174 6120  g training data 
+0000f280: 7365 7420 6265 206f 7665 7277 7269 7474  set be overwritt
+0000f290: 656e 2e20 5468 6520 6465 6661 756c 7420  en. The default 
+0000f2a0: 6973 2046 616c 7365 2e0d 0a0d 0a20 2020  is False.....   
+0000f2b0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+0000f2c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+0000f2d0: 2020 2020 2020 204e 6f6e 652e 0d0a 0d0a         None.....
+0000f2e0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0000f2f0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+0000f300: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+0000f310: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f320: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f330: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f340: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+0000f350: 2020 2020 2020 2020 2320 7365 7475 700d          # setup.
+0000f360: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0000f370: 2020 2066 6c61 6773 203d 206d 616b 655f     flags = make_
+0000f380: 6461 7461 636c 6173 7328 0d0a 2020 2020  dataclass(..    
+0000f390: 2020 2020 2020 2020 636c 735f 6e61 6d65          cls_name
+0000f3a0: 3d22 666c 6167 7322 2c20 6669 656c 6473  ="flags", fields
+0000f3b0: 3d5b 2822 6f76 6572 7772 6974 6522 2c20  =[("overwrite", 
+0000f3c0: 626f 6f6c 2c20 6f76 6572 7772 6974 6529  bool, overwrite)
+0000f3d0: 5d0d 0a20 2020 2020 2020 2029 0d0a 2020  ]..        )..  
+0000f3e0: 2020 0d0a 2020 2020 2020 2020 6966 2061    ..        if a
+0000f3f0: 6e6e 6f74 6174 696f 6e5f 6964 2e5f 5f63  nnotation_id.__c
+0000f400: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f20  lass__.__name__ 
+0000f410: 3d3d 2022 4e6f 6e65 5479 7065 223a 0d0a  == "NoneType":..
+0000f420: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0000f430: 7428 224e 6f20 616e 6e6f 7461 7469 6f6e  t("No annotation
+0000f440: 2069 6420 7365 7420 2d20 7769 6c6c 2075   id set - will u
+0000f450: 7365 206c 6173 7420 6f6e 6520 696e 2061  se last one in a
+0000f460: 6e6e 6f74 6174 696f 6e73 2066 696c 652e  nnotations file.
+0000f470: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0000f480: 7469 6d65 2e73 6c65 6570 2832 290d 0a0d  time.sleep(2)...
+0000f490: 0a20 2020 2020 2020 2074 7261 696e 696e  .        trainin
+0000f4a0: 675f 6461 7461 5f70 6174 6820 3d20 6f73  g_data_path = os
+0000f4b0: 2e70 6174 682e 6a6f 696e 2873 656c 662e  .path.join(self.
+0000f4c0: 726f 6f74 5f64 6972 2c20 2274 7261 696e  root_dir, "train
+0000f4d0: 696e 675f 6461 7461 222c 2066 6f6c 6465  ing_data", folde
+0000f4e0: 7229 0d0a 2020 2020 0d0a 2020 2020 2020  r)..    ..      
+0000f4f0: 2020 6966 206e 6f74 206f 732e 7061 7468    if not os.path
+0000f500: 2e69 7364 6972 2874 7261 696e 696e 675f  .isdir(training_
+0000f510: 6461 7461 5f70 6174 6829 3a0d 0a20 2020  data_path):..   
+0000f520: 2020 2020 2020 2020 206f 732e 6d61 6b65           os.make
+0000f530: 6469 7273 2874 7261 696e 696e 675f 6461  dirs(training_da
+0000f540: 7461 5f70 6174 6829 0d0a 2020 2020 2020  ta_path)..      
+0000f550: 2020 2020 2020 7072 696e 7428 2243 7265        print("Cre
+0000f560: 6174 6564 2022 202b 2074 7261 696e 696e  ated " + trainin
+0000f570: 675f 6461 7461 5f70 6174 6829 0d0a 2020  g_data_path)..  
+0000f580: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000f590: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000f5a0: 2020 7061 7261 6d65 7465 7273 5f64 6566    parameters_def
+0000f5b0: 6175 6c74 7320 3d20 7b0d 0a20 2020 2020  aults = {..     
+0000f5c0: 2020 2020 2020 2022 6d6c 2d6d 6f72 7068         "ml-morph
+0000f5d0: 223a 207b 0d0a 2020 2020 2020 2020 2020  ": {..          
+0000f5e0: 2020 2020 2020 2265 7870 6f72 745f 6d61        "export_ma
+0000f5f0: 736b 223a 2046 616c 7365 2c0d 0a20 2020  sk": False,..   
+0000f600: 2020 2020 2020 2020 2020 2020 2022 666c               "fl
+0000f610: 6970 5f79 223a 2046 616c 7365 2c0d 0a20  ip_y": False,.. 
+0000f620: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000f630: 6d61 736b 5f69 6422 3a20 4e6f 6e65 2c0d  mask_id": None,.
+0000f640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f650: 2022 7265 7369 7a65 5f66 6163 746f 7222   "resize_factor"
+0000f660: 3a20 312c 0d0a 2020 2020 2020 2020 2020  : 1,..          
+0000f670: 2020 2020 2020 7d2c 0d0a 2020 2020 2020        },..      
+0000f680: 2020 2020 2020 226b 6572 6173 2d63 6e6e        "keras-cnn
+0000f690: 2d73 656d 616e 7469 6322 3a20 7b0d 0a20  -semantic": {.. 
+0000f6a0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0000f6b0: 0d0a 2020 2020 2020 2020 2020 2020 7d0d  ..            }.
+0000f6c0: 0a0d 0a20 2020 2020 2020 2066 7261 6d65  ...        frame
+0000f6d0: 776f 726b 5f70 6172 616d 6574 6572 7320  work_parameters 
+0000f6e0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+0000f6f0: 7061 7261 6d65 7465 7273 5f64 6566 6175  parameters_defau
+0000f700: 6c74 7329 0d0a 0d0a 0d0a 2020 2020 2020  lts)......      
+0000f710: 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    # ============
+0000f720: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f730: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f740: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f750: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f760: 3d0d 0a20 2020 2020 2020 2023 2320 6d6c  =..        ## ml
+0000f770: 2d6d 6f72 7068 0d0a 2020 2020 2020 2020  -morph..        
+0000f780: 0d0a 2020 2020 2020 2020 6966 2066 7261  ..        if fra
+0000f790: 6d65 776f 726b 3d3d 226d 6c2d 6d6f 7270  mework=="ml-morp
+0000f7a0: 6822 3a0d 0a0d 0a20 2020 2020 2020 2020  h":....         
+0000f7b0: 2020 2061 6e6e 6f74 6174 696f 6e5f 7479     annotation_ty
+0000f7c0: 7065 203d 2073 6574 7469 6e67 732e 5f6c  pe = settings._l
+0000f7d0: 616e 646d 6172 6b5f 7479 7065 0d0a 2020  andmark_type..  
+0000f7e0: 2020 2020 2020 2020 2020 6466 5f73 756d            df_sum
+0000f7f0: 6d61 7279 203d 2070 642e 4461 7461 4672  mary = pd.DataFr
+0000f800: 616d 6528 290d 0a20 2020 2020 2020 2020  ame()..         
+0000f810: 2020 2066 696c 655f 7061 7468 5f73 6176     file_path_sav
+0000f820: 6520 3d20 6f73 2e70 6174 682e 6a6f 696e  e = os.path.join
+0000f830: 2874 7261 696e 696e 675f 6461 7461 5f70  (training_data_p
+0000f840: 6174 682c 2022 6c61 6e64 6d61 726b 735f  ath, "landmarks_
+0000f850: 6d6c 2d6d 6f72 7068 5f22 202b 2074 6167  ml-morph_" + tag
+0000f860: 202b 2022 2e63 7376 2229 0d0a 0d0a 2020   + ".csv")....  
+0000f870: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0000f880: 2075 7469 6c73 5f6c 6f77 6c65 7665 6c2e   utils_lowlevel.
+0000f890: 5f6f 7665 7277 7269 7465 5f63 6865 636b  _overwrite_check
+0000f8a0: 5f66 696c 6528 6669 6c65 5f70 6174 685f  _file(file_path_
+0000f8b0: 7361 7665 2c20 666c 6167 732e 6f76 6572  save, flags.over
+0000f8c0: 7772 6974 6529 3a0d 0a20 2020 2020 2020  write):..       
+0000f8d0: 2020 2020 2020 2020 2072 6574 7572 6e0d           return.
+0000f8e0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0000f8f0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0000f900: 7420 7061 7261 6d65 7465 7273 2e5f 5f63  t parameters.__c
+0000f910: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f20  lass__.__name__ 
+0000f920: 3d3d 2022 4e6f 6e65 5479 7065 223a 0d0a  == "NoneType":..
+0000f930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f940: 6672 616d 6577 6f72 6b5f 7061 7261 6d65  framework_parame
+0000f950: 7465 7273 5b22 6d6c 2d6d 6f72 7068 225d  ters["ml-morph"]
+0000f960: 2e75 7064 6174 6528 7061 7261 6d65 7465  .update(paramete
+0000f970: 7273 5b22 6d6c 2d6d 6f72 7068 225d 290d  rs["ml-morph"]).
+0000f980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f990: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000f9a0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000f9b0: 2066 6c61 6773 2e65 7870 6f72 745f 6d61   flags.export_ma
+0000f9c0: 736b 203d 2066 7261 6d65 776f 726b 5f70  sk = framework_p
+0000f9d0: 6172 616d 6574 6572 735b 226d 6c2d 6d6f  arameters["ml-mo
+0000f9e0: 7270 6822 5d5b 2265 7870 6f72 745f 6d61  rph"]["export_ma
+0000f9f0: 736b 225d 0d0a 2020 2020 2020 2020 2020  sk"]..          
+0000fa00: 2020 666c 6167 732e 7265 7369 7a65 5f66    flags.resize_f
+0000fa10: 6163 746f 7220 3d20 6672 616d 6577 6f72  actor = framewor
+0000fa20: 6b5f 7061 7261 6d65 7465 7273 5b22 6d6c  k_parameters["ml
+0000fa30: 2d6d 6f72 7068 225d 5b22 7265 7369 7a65  -morph"]["resize
+0000fa40: 5f66 6163 746f 7222 5d0d 0a20 2020 2020  _factor"]..     
+0000fa50: 2020 2020 2020 2066 6c61 6773 2e66 6c69         flags.fli
+0000fa60: 705f 7920 3d20 6672 616d 6577 6f72 6b5f  p_y = framework_
+0000fa70: 7061 7261 6d65 7465 7273 5b22 6d6c 2d6d  parameters["ml-m
+0000fa80: 6f72 7068 225d 5b22 666c 6970 5f79 225d  orph"]["flip_y"]
+0000fa90: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0000faa0: 6966 2066 6c61 6773 2e65 7870 6f72 745f  if flags.export_
+0000fab0: 6d61 736b 3a20 200d 0a20 2020 2020 2020  mask:  ..       
+0000fac0: 2020 2020 2020 2020 2069 6d67 5f64 6972           img_dir
+0000fad0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
+0000fae0: 7472 6169 6e69 6e67 5f64 6174 615f 7061  training_data_pa
+0000faf0: 7468 2c20 2269 6d61 6765 7322 290d 0a20  th, "images").. 
+0000fb00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000fb10: 6620 6e6f 7420 6f73 2e70 6174 682e 6973  f not os.path.is
+0000fb20: 6469 7228 696d 675f 6469 7229 3a0d 0a20  dir(img_dir):.. 
+0000fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb40: 2020 206f 732e 6d61 6b65 6469 7273 2869     os.makedirs(i
+0000fb50: 6d67 5f64 6972 290d 0a20 2020 2020 2020  mg_dir)..       
+0000fb60: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000fb70: 2020 2066 6f72 2069 6478 312c 2064 6972     for idx1, dir
+0000fb80: 7061 7468 2069 6e20 656e 756d 6572 6174  path in enumerat
+0000fb90: 6528 7365 6c66 2e64 6972 5f70 6174 6873  e(self.dir_paths
+0000fba0: 2c20 3129 3a0d 0a20 2020 2020 2020 2020  , 1):..         
+0000fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fbc0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000fbd0: 2020 2020 2023 2320 6c6f 6164 2064 6174       ## load dat
+0000fbe0: 610d 0a20 2020 2020 2020 2020 2020 2020  a..             
+0000fbf0: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
+0000fc00: 7574 696c 735f 6c6f 776c 6576 656c 2e5f  utils_lowlevel._
+0000fc10: 6c6f 6164 5f79 616d 6c28 6f73 2e70 6174  load_yaml(os.pat
+0000fc20: 682e 6a6f 696e 2864 6972 7061 7468 2c20  h.join(dirpath, 
+0000fc30: 2261 7474 7269 6275 7465 732e 7961 6d6c  "attributes.yaml
+0000fc40: 2229 2920 2020 2020 2020 2020 2020 0d0a  "))           ..
+0000fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc60: 616e 6e6f 7461 7469 6f6e 7320 3d20 6578  annotations = ex
+0000fc70: 706f 7274 2e6c 6f61 645f 616e 6e6f 7461  port.load_annota
+0000fc80: 7469 6f6e 286f 732e 7061 7468 2e6a 6f69  tion(os.path.joi
+0000fc90: 6e28 6469 7270 6174 682c 2022 616e 6e6f  n(dirpath, "anno
+0000fca0: 7461 7469 6f6e 735f 2220 2b20 7461 6720  tations_" + tag 
+0000fcb0: 2b20 222e 6a73 6f6e 2229 2920 2020 2020  + ".json"))     
+0000fcc0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000fcd0: 2020 2020 6669 6c65 6e61 6d65 203d 2061      filename = a
+0000fce0: 7474 7269 6275 7465 735b 2269 6d61 6765  ttributes["image
+0000fcf0: 5f6f 7269 6769 6e61 6c22 5d5b 2266 696c  _original"]["fil
+0000fd00: 656e 616d 6522 5d0d 0a20 2020 2020 2020  ename"]..       
+0000fd10: 2020 2020 2020 2020 2069 6d61 6765 5f68           image_h
+0000fd20: 6569 6768 7420 3d20 6174 7472 6962 7574  eight = attribut
+0000fd30: 6573 5b22 696d 6167 655f 7068 656e 6f70  es["image_phenop
+0000fd40: 7970 6522 5d5b 2268 6569 6768 7422 5d0d  ype"]["height"].
+0000fd50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fd60: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000fd70: 2020 2070 7269 6e74 2822 5072 6570 6172     print("Prepar
+0000fd80: 696e 6720 7472 6169 6e69 6e67 2064 6174  ing training dat
+0000fd90: 6120 666f 723a 2028 7b7d 2f7b 7d29 2022  a for: ({}/{}) "
+0000fda0: 2e66 6f72 6d61 7428 6964 7831 2c20 6c65  .format(idx1, le
+0000fdb0: 6e28 7365 6c66 2e64 6972 5f70 6174 6873  n(self.dir_paths
+0000fdc0: 2929 202b 2066 696c 656e 616d 6529 0d0a  )) + filename)..
+0000fdd0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000fde0: 2020 2020 2020 2323 2063 6865 636b 7320        ## checks 
+0000fdf0: 616e 6420 6665 6564 6261 636b 0d0a 2020  and feedback..  
+0000fe00: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000fe10: 2061 6e6e 6f74 6174 696f 6e73 2e5f 5f63   annotations.__c
+0000fe20: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f20  lass__.__name__ 
+0000fe30: 3d3d 2022 4e6f 6e65 5479 7065 223a 200d  == "NoneType": .
+0000fe40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fe50: 2020 2020 2070 7269 6e74 2822 4e6f 2061       print("No a
+0000fe60: 6e6e 6f74 6174 696f 6e73 2066 6f75 6e64  nnotations found
+0000fe70: 2066 6f72 207b 7d22 2e66 6f72 6d61 7428   for {}".format(
+0000fe80: 6669 6c65 6e61 6d65 2929 0d0a 2020 2020  filename))..    
+0000fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fea0: 636f 6e74 696e 7565 0d0a 2020 2020 2020  continue..      
+0000feb0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0000fec0: 2061 6e6e 6f74 6174 696f 6e5f 7479 7065   annotation_type
+0000fed0: 2069 6e20 616e 6e6f 7461 7469 6f6e 733a   in annotations:
+0000fee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000fef0: 2020 2020 2020 7072 696e 7428 224e 6f20        print("No 
+0000ff00: 616e 6e6f 7461 7469 6f6e 206f 6620 7479  annotation of ty
+0000ff10: 7065 207b 7d20 666f 756e 6420 666f 7220  pe {} found for 
+0000ff20: 7b7d 222e 666f 726d 6174 2861 6e6e 6f74  {}".format(annot
+0000ff30: 6174 696f 6e5f 7479 7065 2c20 6669 6c65  ation_type, file
+0000ff40: 6e61 6d65 2929 0d0a 2020 2020 2020 2020  name))..        
+0000ff50: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0000ff60: 696e 7565 0d0a 2020 2020 2020 2020 2020  inue..          
+0000ff70: 2020 2020 2020 6966 2061 6e6e 6f74 6174        if annotat
+0000ff80: 696f 6e5f 6964 2e5f 5f63 6c61 7373 5f5f  ion_id.__class__
+0000ff90: 2e5f 5f6e 616d 655f 5f20 3d3d 2022 4e6f  .__name__ == "No
+0000ffa0: 6e65 5479 7065 223a 0d0a 2020 2020 2020  neType":..      
+0000ffb0: 2020 2020 2020 2020 2020 2020 2020 616e                an
+0000ffc0: 6e6f 7461 7469 6f6e 5f69 6420 3d20 6d61  notation_id = ma
+0000ffd0: 7828 6c69 7374 2861 6e6e 6f74 6174 696f  x(list(annotatio
+0000ffe0: 6e73 5b61 6e6e 6f74 6174 696f 6e5f 7479  ns[annotation_ty
+0000fff0: 7065 5d2e 6b65 7973 2829 2929 0d0a 2020  pe].keys()))..  
+00010000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010010: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00010020: 2020 2020 2323 206c 6f61 6420 6c61 6e64      ## load land
+00010030: 6d61 726b 730d 0a20 2020 2020 2020 2020  marks..         
+00010040: 2020 2020 2020 2064 6174 6120 3d20 616e         data = an
+00010050: 6e6f 7461 7469 6f6e 735b 616e 6e6f 7461  notations[annota
+00010060: 7469 6f6e 5f74 7970 655d 5b61 6e6e 6f74  tion_type][annot
+00010070: 6174 696f 6e5f 6964 5d5b 2264 6174 6122  ation_id]["data"
+00010080: 5d5b 616e 6e6f 7461 7469 6f6e 5f74 7970  ][annotation_typ
+00010090: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
+000100a0: 2020 2020 6c6d 5f74 7570 6c65 5f6c 6973      lm_tuple_lis
+000100b0: 7420 3d20 6c69 7374 287a 6970 282a 6461  t = list(zip(*da
+000100c0: 7461 2929 0d0a 2020 2020 2020 2020 2020  ta))..          
+000100d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000100e0: 2020 2020 2020 2020 2323 206c 6f61 6420          ## load 
+000100f0: 696d 6167 6520 6966 206d 6173 6b69 6e67  image if masking
+00010100: 206f 7220 7265 7369 7a69 6e67 0d0a 2020   or resizing..  
+00010110: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00010120: 2066 6c61 6773 2e65 7870 6f72 745f 6d61   flags.export_ma
+00010130: 736b 206f 7220 666c 6167 732e 7265 7369  sk or flags.resi
+00010140: 7a65 5f66 6163 746f 7220 213d 2031 3a0d  ze_factor != 1:.
 00010150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010160: 2020 2020 2020 2020 2069 6d61 6765 203d           image =
-00010170: 2069 6d61 6765 5b0d 0a20 2020 2020 2020   image[..       
-00010180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010190: 2020 2020 206d 6178 2872 792c 3029 203a       max(ry,0) :
-000101a0: 206d 696e 2872 7920 2b20 7268 2c20 696d   min(ry + rh, im
-000101b0: 6167 655f 6865 6967 6874 292c 206d 6178  age_height), max
-000101c0: 2872 782c 3129 203a 206d 696e 2872 7820  (rx,1) : min(rx 
-000101d0: 2b20 7277 2c20 696d 6167 655f 7769 6474  + rw, image_widt
-000101e0: 6829 5d0d 0a20 2020 2020 2020 2020 2020  h)]..           
-000101f0: 2020 2020 2020 2020 2020 2020 2069 6d61               ima
-00010200: 6765 5f68 6569 6768 7420 3d20 696d 6167  ge_height = imag
-00010210: 652e 7368 6170 655b 305d 0d0a 0d0a 2020  e.shape[0]....  
-00010220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010230: 2020 2020 2020 2323 2073 7562 7472 6163        ## subtrac
-00010240: 7420 746f 7020 6c65 6674 2063 6f6f 7264  t top left coord
-00010250: 2066 726f 6d20 626f 756e 6469 6e67 2062   from bounding b
-00010260: 6f78 2066 726f 6d20 616c 6c20 6c61 6e64  ox from all land
-00010270: 6d61 726b 730d 0a20 2020 2020 2020 2020  marks..         
-00010280: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00010290: 6d5f 7475 706c 655f 6c69 7374 5b30 5d20  m_tuple_list[0] 
-000102a0: 3d20 7475 706c 6528 6320 2d20 7278 2066  = tuple(c - rx f
-000102b0: 6f72 2063 2069 6e20 6c6d 5f74 7570 6c65  or c in lm_tuple
-000102c0: 5f6c 6973 745b 305d 290d 0a20 2020 2020  _list[0])..     
-000102d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000102e0: 2020 206c 6d5f 7475 706c 655f 6c69 7374     lm_tuple_list
-000102f0: 5b31 5d20 3d20 7475 706c 6528 6320 2d20  [1] = tuple(c - 
-00010300: 7279 2066 6f72 2063 2069 6e20 6c6d 5f74  ry for c in lm_t
-00010310: 7570 6c65 5f6c 6973 745b 315d 290d 0a20  uple_list[1]).. 
-00010320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010330: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00010340: 2020 2020 2020 2020 2020 2020 2023 2320               ## 
-00010350: 7265 7369 7a65 2069 6d61 6765 206f 7220  resize image or 
-00010360: 6372 6f70 7065 6420 696d 6167 650d 0a20  cropped image.. 
-00010370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010380: 2020 2069 6620 666c 6167 732e 7265 7369     if flags.resi
-00010390: 7a65 5f66 6163 746f 7220 213d 2031 3a0d  ze_factor != 1:.
-000103a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000103b0: 2020 2020 2020 2020 2069 6d61 6765 203d           image =
-000103c0: 2075 7469 6c73 5f6c 6f77 6c65 7665 6c2e   utils_lowlevel.
-000103d0: 5f72 6573 697a 655f 696d 6167 6528 696d  _resize_image(im
-000103e0: 6167 652c 2066 6163 746f 723d 666c 6167  age, factor=flag
-000103f0: 732e 7265 7369 7a65 5f66 6163 746f 722c  s.resize_factor,
-00010400: 2069 6e74 6572 706f 6c61 7469 6f6e 3d22   interpolation="
-00010410: 6375 6269 6322 290d 0a20 2020 2020 2020  cubic")..       
-00010420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010430: 2069 6d61 6765 5f68 6569 6768 7420 3d20   image_height = 
-00010440: 696e 7428 696d 6167 655f 6865 6967 6874  int(image_height
-00010450: 202a 2066 6c61 6773 2e72 6573 697a 655f   * flags.resize_
-00010460: 6661 6374 6f72 290d 0a20 2020 2020 2020  factor)..       
+00010160: 2020 2020 2069 6d61 6765 203d 2075 7469       image = uti
+00010170: 6c73 2e6c 6f61 645f 696d 6167 6528 6469  ls.load_image(di
+00010180: 7270 6174 6829 0d0a 2020 2020 2020 2020  rpath)..        
+00010190: 2020 2020 2020 2020 2020 2020 696d 6167              imag
+000101a0: 655f 6865 6967 6874 2c20 696d 6167 655f  e_height, image_
+000101b0: 7769 6474 6820 3d20 696d 6167 652e 7368  width = image.sh
+000101c0: 6170 655b 303a 325d 0d0a 0d0a 2020 2020  ape[0:2]....    
+000101d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000101e0: 2323 2073 656c 6563 7420 6c61 7374 206d  ## select last m
+000101f0: 6173 6b20 6966 206e 6f20 6964 2069 7320  ask if no id is 
+00010200: 6769 7665 6e0d 0a20 2020 2020 2020 2020  given..         
+00010210: 2020 2020 2020 2020 2020 2069 6620 6672             if fr
+00010220: 616d 6577 6f72 6b5f 7061 7261 6d65 7465  amework_paramete
+00010230: 7273 5b22 6d6c 2d6d 6f72 7068 225d 5b22  rs["ml-morph"]["
+00010240: 6d61 736b 5f69 6422 5d2e 5f5f 636c 6173  mask_id"].__clas
+00010250: 735f 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20  s__.__name__ == 
+00010260: 224e 6f6e 6554 7970 6522 3a0d 0a20 2020  "NoneType":..   
+00010270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010280: 2020 2020 206d 6173 6b5f 6964 203d 206d       mask_id = m
+00010290: 6178 286c 6973 7428 616e 6e6f 7461 7469  ax(list(annotati
+000102a0: 6f6e 735b 7365 7474 696e 6773 2e5f 6d61  ons[settings._ma
+000102b0: 736b 5f74 7970 655d 2e6b 6579 7328 2929  sk_type].keys())
+000102c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000102d0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+000102e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000102f0: 2023 2320 6765 7420 626f 756e 6469 6e67   ## get bounding
+00010300: 2072 6563 7461 6e67 6c65 2061 6e64 2063   rectangle and c
+00010310: 726f 7020 696d 6167 6520 746f 206d 6173  rop image to mas
+00010320: 6b20 636f 6f72 6473 0d0a 2020 2020 2020  k coords..      
+00010330: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00010340: 2066 6c61 6773 2e65 7870 6f72 745f 6d61   flags.export_ma
+00010350: 736b 2061 6e64 2073 6574 7469 6e67 732e  sk and settings.
+00010360: 5f6d 6173 6b5f 7479 7065 2069 6e20 616e  _mask_type in an
+00010370: 6e6f 7461 7469 6f6e 733a 0d0a 2020 2020  notations:..    
+00010380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010390: 2020 2020 636f 6f72 6473 203d 2061 6e6e      coords = ann
+000103a0: 6f74 6174 696f 6e73 5b73 6574 7469 6e67  otations[setting
+000103b0: 732e 5f6d 6173 6b5f 7479 7065 5d5b 6d61  s._mask_type][ma
+000103c0: 736b 5f69 645d 5b22 6461 7461 225d 5b73  sk_id]["data"][s
+000103d0: 6574 7469 6e67 732e 5f6d 6173 6b5f 7479  ettings._mask_ty
+000103e0: 7065 5d5b 305d 0d0a 2020 2020 2020 2020  pe][0]..        
+000103f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010400: 7278 2c20 7279 2c20 7277 2c20 7268 203d  rx, ry, rw, rh =
+00010410: 2063 7632 2e62 6f75 6e64 696e 6752 6563   cv2.boundingRec
+00010420: 7428 6e70 2e61 7361 7272 6179 2863 6f6f  t(np.asarray(coo
+00010430: 7264 732c 2064 7479 7065 3d22 696e 7433  rds, dtype="int3
+00010440: 3222 2929 0d0a 2020 2020 2020 2020 2020  2"))..          
+00010450: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00010460: 6167 6520 3d20 696d 6167 655b 0d0a 2020  age = image[..  
 00010470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010480: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00010490: 2020 2020 2020 2020 2020 2023 2320 6d75             ## mu
-000104a0: 6c74 6970 6c79 2061 6c6c 206c 616e 646d  ltiply all landm
-000104b0: 6172 6b73 2077 6974 6820 7265 7369 7a65  arks with resize
-000104c0: 2066 6163 746f 720d 0a20 2020 2020 2020   factor..       
-000104d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104e0: 206c 6d5f 7475 706c 655f 6c69 7374 5b30   lm_tuple_list[0
-000104f0: 5d20 3d20 7475 706c 6528 696e 7428 6320  ] = tuple(int(c 
-00010500: 2a20 666c 6167 732e 7265 7369 7a65 5f66  * flags.resize_f
-00010510: 6163 746f 7229 2066 6f72 2063 2069 6e20  actor) for c in 
-00010520: 6c6d 5f74 7570 6c65 5f6c 6973 745b 305d  lm_tuple_list[0]
-00010530: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00010540: 2020 2020 2020 2020 2020 206c 6d5f 7475             lm_tu
-00010550: 706c 655f 6c69 7374 5b31 5d20 3d20 7475  ple_list[1] = tu
-00010560: 706c 6528 696e 7428 6320 2a20 666c 6167  ple(int(c * flag
-00010570: 732e 7265 7369 7a65 5f66 6163 746f 7229  s.resize_factor)
-00010580: 2066 6f72 2063 2069 6e20 6c6d 5f74 7570   for c in lm_tup
-00010590: 6c65 5f6c 6973 745b 315d 290d 0a20 2020  le_list[1])..   
-000105a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000105c0: 2020 2020 2020 2023 2320 7361 7665 2072         ## save r
-000105d0: 6573 697a 6564 2069 6d61 6765 206f 7220  esized image or 
-000105e0: 6372 6f70 7065 6420 696d 6167 650d 0a20  cropped image.. 
-000105f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010600: 2020 2075 7469 6c73 2e73 6176 655f 696d     utils.save_im
-00010610: 6167 6528 696d 6167 652c 2064 6972 5f70  age(image, dir_p
-00010620: 6174 683d 696d 675f 6469 722c 2066 696c  ath=img_dir, fil
-00010630: 655f 6e61 6d65 3d66 696c 656e 616d 652c  e_name=filename,
-00010640: 206f 7665 7277 7269 7465 3d6f 7665 7277   overwrite=overw
-00010650: 7269 7465 290d 0a20 2020 2020 2020 2020  rite)..         
-00010660: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00010670: 2020 2020 2020 2020 2020 2020 2023 2320               ## 
-00010680: 6164 6420 746f 2064 6174 6166 7261 6d65  add to dataframe
-00010690: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000106a0: 2020 636f 6f72 645f 726f 772c 2063 6f6c    coord_row, col
-000106b0: 6e61 6d65 7320 3d20 6c69 7374 2829 2c20  names = list(), 
-000106c0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-000106d0: 2020 2020 2020 2020 636f 6c6e 616d 6573          colnames
-000106e0: 2e61 7070 656e 6428 2269 6422 290d 0a20  .append("id").. 
-000106f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00010700: 6f72 2020 6964 7832 2c20 2878 5f63 6f6f  or  idx2, (x_coo
-00010710: 7264 2c20 795f 636f 6f72 6429 2069 6e20  rd, y_coord) in 
-00010720: 656e 756d 6572 6174 6528 7a69 7028 6c6d  enumerate(zip(lm
-00010730: 5f74 7570 6c65 5f6c 6973 745b 305d 2c20  _tuple_list[0], 
-00010740: 6c6d 5f74 7570 6c65 5f6c 6973 745b 315d  lm_tuple_list[1]
-00010750: 292c 3129 3a0d 0a20 2020 2020 2020 2020  ),1):..         
-00010760: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
-00010770: 5f72 6f77 2e61 7070 656e 6428 785f 636f  _row.append(x_co
-00010780: 6f72 6429 0d0a 2020 2020 2020 2020 2020  ord)..          
-00010790: 2020 2020 2020 2020 2020 6966 2066 6c61            if fla
-000107a0: 6773 2e66 6c69 705f 793a 0d0a 2020 2020  gs.flip_y:..    
-000107b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107c0: 2020 2020 636f 6f72 645f 726f 772e 6170      coord_row.ap
-000107d0: 7065 6e64 2869 6e74 2828 795f 636f 6f72  pend(int((y_coor
-000107e0: 6420 2d20 696d 6167 655f 6865 6967 6874  d - image_height
-000107f0: 2920 2a20 2d31 2929 0d0a 2020 2020 2020  ) * -1))..      
-00010800: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00010810: 7365 3a20 0d0a 2020 2020 2020 2020 2020  se: ..          
-00010820: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00010830: 6f72 645f 726f 772e 6170 7065 6e64 2879  ord_row.append(y
-00010840: 5f63 6f6f 7264 290d 0a20 2020 2020 2020  _coord)..       
-00010850: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00010860: 6e61 6d65 732e 6170 7065 6e64 2822 5822  names.append("X"
-00010870: 202b 2073 7472 2869 6478 3229 290d 0a20   + str(idx2)).. 
-00010880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010890: 2020 2063 6f6c 6e61 6d65 732e 6170 7065     colnames.appe
-000108a0: 6e64 2822 5922 202b 2073 7472 2869 6478  nd("Y" + str(idx
-000108b0: 3229 290d 0a20 2020 2020 2020 2020 2020  2))..           
-000108c0: 2020 2020 2064 6620 3d20 7064 2e44 6174       df = pd.Dat
-000108d0: 6146 7261 6d65 285b 6669 6c65 6e61 6d65  aFrame([filename
-000108e0: 5d20 2b20 636f 6f72 645f 726f 7729 2e74  ] + coord_row).t
-000108f0: 7261 6e73 706f 7365 2829 0d0a 2020 2020  ranspose()..    
-00010900: 2020 2020 2020 2020 2020 2020 6466 5f73              df_s
-00010910: 756d 6d61 7279 203d 2070 642e 636f 6e63  ummary = pd.conc
-00010920: 6174 285b 6466 5f73 756d 6d61 7279 2c20  at([df_summary, 
-00010930: 6466 5d29 0d0a 2020 2020 2020 2020 2020  df])..          
-00010940: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00010950: 2020 2020 2323 2073 6176 6520 6461 7461      ## save data
-00010960: 6672 616d 650d 0a20 2020 2020 2020 2020  frame..         
-00010970: 2020 2064 665f 7375 6d6d 6172 792e 7365     df_summary.se
-00010980: 745f 6178 6973 2863 6f6c 6e61 6d65 732c  t_axis(colnames,
-00010990: 2061 7869 733d 312c 2069 6e70 6c61 6365   axis=1, inplace
-000109a0: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-000109b0: 2020 2020 6466 5f73 756d 6d61 7279 2e74      df_summary.t
-000109c0: 6f5f 6373 7628 6669 6c65 5f70 6174 685f  o_csv(file_path_
-000109d0: 7361 7665 2c20 696e 6465 783d 4661 6c73  save, index=Fals
-000109e0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-000109f0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00010a00: 2020 2020 2020 2020 2320 3d3d 3d3d 3d3d          # ======
-00010a10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00010a20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00010a30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00010a40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00010a50: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020 2020  =======..       
-00010a60: 2023 2320 6b65 7261 732d 636e 6e2d 7365   ## keras-cnn-se
-00010a70: 6d61 6e74 6963 0d0a 2020 2020 2020 2020  mantic..        
-00010a80: 0d0a 2020 2020 2020 2020 6966 2066 7261  ..        if fra
-00010a90: 6d65 776f 726b 3d3d 226b 6572 6173 2d63  mework=="keras-c
-00010aa0: 6e6e 2d73 656d 616e 7469 6322 3a0d 0a20  nn-semantic":.. 
-00010ab0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00010ac0: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
-00010ad0: 696f 6e5f 7479 7065 203d 206b 7761 7267  ion_type = kwarg
-00010ae0: 732e 6765 7428 2261 6e6e 6f74 6174 696f  s.get("annotatio
-00010af0: 6e5f 7479 7065 222c 2022 6d61 736b 2229  n_type", "mask")
-00010b00: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00010b10: 2020 2020 2020 2020 2020 2020 696d 675f              img_
-00010b20: 6469 7220 3d20 6f73 2e70 6174 682e 6a6f  dir = os.path.jo
-00010b30: 696e 2874 7261 696e 696e 675f 6461 7461  in(training_data
-00010b40: 5f70 6174 682c 2022 696d 6167 6573 222c  _path, "images",
-00010b50: 2022 616c 6c22 290d 0a20 2020 2020 2020   "all")..       
-00010b60: 2020 2020 206d 6173 6b5f 6469 7220 3d20       mask_dir = 
-00010b70: 6f73 2e70 6174 682e 6a6f 696e 2874 7261  os.path.join(tra
-00010b80: 696e 696e 675f 6461 7461 5f70 6174 682c  ining_data_path,
-00010b90: 2022 6d61 736b 7322 2c20 2261 6c6c 2229   "masks", "all")
-00010ba0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00010bb0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00010bc0: 6f74 206f 732e 7061 7468 2e69 7364 6972  ot os.path.isdir
-00010bd0: 2869 6d67 5f64 6972 293a 0d0a 2020 2020  (img_dir):..    
-00010be0: 2020 2020 2020 2020 2020 2020 6f73 2e6d              os.m
-00010bf0: 616b 6564 6972 7328 696d 675f 6469 7229  akedirs(img_dir)
-00010c00: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00010c10: 206e 6f74 206f 732e 7061 7468 2e69 7364   not os.path.isd
-00010c20: 6972 286d 6173 6b5f 6469 7229 3a0d 0a20  ir(mask_dir):.. 
-00010c30: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00010c40: 732e 6d61 6b65 6469 7273 286d 6173 6b5f  s.makedirs(mask_
-00010c50: 6469 7229 2020 0d0a 0d0a 2020 2020 2020  dir)  ....      
-00010c60: 2020 2020 2020 666f 7220 6964 782c 2064        for idx, d
-00010c70: 6972 7061 7468 2069 6e20 656e 756d 6572  irpath in enumer
-00010c80: 6174 6528 7365 6c66 2e64 6972 5f70 6174  ate(self.dir_pat
-00010c90: 6873 2c20 3129 3a0d 0a20 2020 2020 2020  hs, 1):..       
-00010ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010cb0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00010cc0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-00010cd0: 7320 3d20 7574 696c 735f 6c6f 776c 6576  s = utils_lowlev
-00010ce0: 656c 2e5f 6c6f 6164 5f79 616d 6c28 6f73  el._load_yaml(os
-00010cf0: 2e70 6174 682e 6a6f 696e 2864 6972 7061  .path.join(dirpa
-00010d00: 7468 2c20 2261 7474 7269 6275 7465 732e  th, "attributes.
-00010d10: 7961 6d6c 2229 2920 2020 2020 2020 2020  yaml"))         
-00010d20: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00010d30: 2020 2020 616e 6e6f 7461 7469 6f6e 7320      annotations 
-00010d40: 3d20 6578 706f 7274 2e6c 6f61 645f 616e  = export.load_an
-00010d50: 6e6f 7461 7469 6f6e 286f 732e 7061 7468  notation(os.path
-00010d60: 2e6a 6f69 6e28 6469 7270 6174 682c 2022  .join(dirpath, "
-00010d70: 616e 6e6f 7461 7469 6f6e 735f 2220 2b20  annotations_" + 
-00010d80: 7461 6720 2b20 222e 6a73 6f6e 2229 2920  tag + ".json")) 
-00010d90: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00010da0: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-00010db0: 203d 2061 7474 7269 6275 7465 735b 2269   = attributes["i
-00010dc0: 6d61 6765 5f6f 7269 6769 6e61 6c22 5d5b  mage_original"][
-00010dd0: 2266 696c 656e 616d 6522 5d20 2020 2020  "filename"]     
-00010de0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00010df0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00010e00: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00010e10: 696e 7428 2250 7265 7061 7269 6e67 2074  int("Preparing t
-00010e20: 7261 696e 696e 6720 6461 7461 2066 6f72  raining data for
-00010e30: 3a20 287b 7d2f 7b7d 2920 222e 666f 726d  : ({}/{}) ".form
-00010e40: 6174 2869 6478 2c20 6c65 6e28 7365 6c66  at(idx, len(self
-00010e50: 2e64 6972 5f70 6174 6873 2929 202b 2066  .dir_paths)) + f
-00010e60: 696c 656e 616d 6529 0d0a 0d0a 2020 2020  ilename)....    
-00010e70: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-00010e80: 6520 3d20 2861 7474 7269 6275 7465 735b  e = (attributes[
-00010e90: 2269 6d61 6765 5f6f 7269 6769 6e61 6c22  "image_original"
-00010ea0: 5d5b 2277 6964 7468 225d 2c20 6174 7472  ]["width"], attr
-00010eb0: 6962 7574 6573 5b22 696d 6167 655f 6f72  ibutes["image_or
-00010ec0: 6967 696e 616c 225d 5b22 6865 6967 6874  iginal"]["height
-00010ed0: 225d 2c20 3329 0d0a 2020 2020 2020 2020  "], 3)..        
-00010ee0: 2020 2020 2020 2020 6d61 736b 203d 206e          mask = n
-00010ef0: 702e 7a65 726f 7328 7368 6170 652c 2064  p.zeros(shape, d
-00010f00: 7479 7065 3d22 7569 6e74 3822 290d 0a20  type="uint8").. 
-00010f10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00010f20: 6620 6e6f 7420 616e 6e6f 7461 7469 6f6e  f not annotation
-00010f30: 5f74 7970 6520 696e 2061 6e6e 6f74 6174  _type in annotat
-00010f40: 696f 6e73 3a0d 0a20 2020 2020 2020 2020  ions:..         
-00010f50: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00010f60: 2822 4e6f 2061 6e6e 6f74 6174 696f 6e20  ("No annotation 
-00010f70: 6f66 2074 7970 6520 7b7d 2066 6f75 6e64  of type {} found
-00010f80: 2069 6e20 6461 7461 7365 7420 2d20 6162   in dataset - ab
-00010f90: 6f72 7469 6e67 222e 666f 726d 6174 2861  orting".format(a
-00010fa0: 6e6e 6f74 6174 696f 6e5f 7479 7065 2929  nnotation_type))
-00010fb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010fc0: 2020 2020 2020 7265 7475 726e 0d0a 2020        return..  
-00010fd0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010fe0: 2061 6e6e 6f74 6174 696f 6e5f 6964 2e5f   annotation_id._
-00010ff0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-00011000: 5f20 3d3d 2022 4e6f 6e65 5479 7065 223a  _ == "NoneType":
-00011010: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011020: 2020 2020 2020 616e 6e6f 7461 7469 6f6e        annotation
-00011030: 5f69 6420 3d20 6d61 7828 6c69 7374 2861  _id = max(list(a
-00011040: 6e6e 6f74 6174 696f 6e73 5b61 6e6e 6f74  nnotations[annot
-00011050: 6174 696f 6e5f 7479 7065 5d2e 6b65 7973  ation_type].keys
-00011060: 2829 2929 0d0a 2020 2020 2020 2020 2020  ()))..          
-00011070: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00011080: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-00011090: 203d 2076 6973 7561 6c69 7a61 7469 6f6e   = visualization
-000110a0: 2e64 7261 775f 636f 6e74 6f75 7228 696d  .draw_contour(im
-000110b0: 6167 653d 6d61 736b 2c20 616e 6e6f 7461  age=mask, annota
-000110c0: 7469 6f6e 733d 616e 6e6f 7461 7469 6f6e  tions=annotation
-000110d0: 732c 2063 6f6e 746f 7572 5f69 643d 616e  s, contour_id=an
-000110e0: 6e6f 7461 7469 6f6e 5f69 642c 206c 696e  notation_id, lin
-000110f0: 655f 7769 6474 683d 302c 206c 696e 655f  e_width=0, line_
-00011100: 636f 6c6f 7572 3d31 2c20 6669 6c6c 3d31  colour=1, fill=1
-00011110: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00011120: 2020 206d 6173 6b5f 7265 7369 7a65 6420     mask_resized 
-00011130: 3d20 6376 322e 7265 7369 7a65 286d 6173  = cv2.resize(mas
-00011140: 6b2c 2028 696d 675f 7369 7a65 2c20 696d  k, (img_size, im
-00011150: 675f 7369 7a65 2929 0d0a 2020 2020 2020  g_size))..      
-00011160: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00011170: 2020 2020 2020 2020 2020 2020 696d 6167              imag
-00011180: 6520 3d20 7574 696c 732e 6c6f 6164 5f69  e = utils.load_i
-00011190: 6d61 6765 2864 6972 7061 7468 290d 0a20  mage(dirpath).. 
-000111a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000111b0: 6d61 6765 5f72 6573 697a 6564 203d 2063  mage_resized = c
-000111c0: 7632 2e72 6573 697a 6528 696d 6167 652c  v2.resize(image,
-000111d0: 2028 696d 675f 7369 7a65 2c20 696d 675f   (img_size, img_
-000111e0: 7369 7a65 2929 0d0a 2020 2020 2020 2020  size))..        
-000111f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00011200: 2020 2020 2020 2020 2020 7574 696c 732e            utils.
-00011210: 7361 7665 5f69 6d61 6765 2869 6d61 6765  save_image(image
-00011220: 5f72 6573 697a 6564 2c20 6469 725f 7061  _resized, dir_pa
-00011230: 7468 3d69 6d67 5f64 6972 2c20 6669 6c65  th=img_dir, file
-00011240: 5f6e 616d 653d 6669 6c65 6e61 6d65 2c20  _name=filename, 
-00011250: 6578 743d 2270 6e67 2229 0d0a 2020 2020  ext="png")..    
-00011260: 2020 2020 2020 2020 2020 2020 7574 696c              util
-00011270: 732e 7361 7665 5f69 6d61 6765 286d 6173  s.save_image(mas
-00011280: 6b5f 7265 7369 7a65 642c 2064 6972 5f70  k_resized, dir_p
-00011290: 6174 683d 6d61 736b 5f64 6972 2c20 6669  ath=mask_dir, fi
-000112a0: 6c65 5f6e 616d 653d 6669 6c65 6e61 6d65  le_name=filename
-000112b0: 2c20 6578 743d 2270 6e67 2229 0d0a 0d0a  , ext="png")....
-000112c0: 2020 2020 2020 2020 2020 2020 0d0a 0d0a              ....
-000112d0: 636c 6173 7320 5079 7065 286f 626a 6563  class Pype(objec
-000112e0: 7429 3a0d 0a20 2020 2022 2222 0d0a 2020  t):..    """..  
-000112f0: 2020 5468 6520 7079 7065 2069 7320 7068    The pype is ph
-00011300: 656e 6f70 7970 65e2 8099 7320 636f 7265  enopype...s core
-00011310: 206d 6574 686f 6420 7468 6174 2061 6c6c   method that all
-00011320: 6f77 7320 7275 6e6e 696e 6720 616c 6c20  ows running all 
-00011330: 6675 6e63 7469 6f6e 7320 0d0a 2020 2020  functions ..    
-00011340: 7468 6174 2061 7265 2061 7661 696c 6162  that are availab
-00011350: 6c65 2069 6e20 7468 6520 7072 6f67 7261  le in the progra
-00011360: 6de2 8099 7320 6c69 6272 6172 7920 696e  m...s library in
-00011370: 2073 6571 7565 6e63 652e 2055 7365 7273   sequence. Users
-00011380: 2063 616e 2065 7865 6375 7465 200d 0a20   can execute .. 
-00011390: 2020 2074 6865 2070 7970 6520 6d65 7468     the pype meth
-000113a0: 6f64 206f 6e20 6120 6669 6c65 5f70 6174  od on a file_pat
-000113b0: 682c 2061 6e20 6172 7261 792c 206f 7220  h, an array, or 
-000113c0: 6120 7068 656e 6f70 7970 6520 6469 7265  a phenopype dire
-000113d0: 6374 6f72 792c 2077 6869 6368 200d 0a20  ctory, which .. 
-000113e0: 2020 2061 6c77 6179 7320 7769 6c6c 2074     always will t
-000113f0: 7269 6767 6572 2074 6872 6565 2061 6374  rigger three act
-00011400: 696f 6e73 3a0d 0a0d 0a20 2020 2031 2e20  ions:....    1. 
-00011410: 6f70 656e 2074 6865 2063 6f6e 7461 696e  open the contain
-00011420: 6564 2079 616d 6c20 636f 6e66 6967 7572  ed yaml configur
-00011430: 6174 696f 6e20 7769 7468 2074 6865 2064  ation with the d
-00011440: 6566 6175 6c74 204f 5320 7465 7874 2065  efault OS text e
-00011450: 6469 746f 720d 0a20 2020 2032 2e20 7061  ditor..    2. pa
-00011460: 7273 6520 7468 6520 636f 6e74 6169 6e65  rse the containe
-00011470: 6420 6675 6e63 7469 6f6e 7320 616e 6420  d functions and 
-00011480: 6578 6563 7574 6520 7468 656d 2069 6e20  execute them in 
-00011490: 7468 6520 7365 7175 656e 6365 2028 6578  the sequence (ex
-000114a0: 6365 7074 696f 6e73 0d0a 2020 2020 2020  ceptions..      
-000114b0: 2077 696c 6c20 6265 2070 6173 7365 642c   will be passed,
-000114c0: 2062 7574 2072 6574 7572 6e65 6420 666f   but returned fo
-000114d0: 7220 6469 6167 6e6f 7374 6963 7329 0d0a  r diagnostics)..
-000114e0: 2020 2020 332e 206f 7065 6e20 6120 5079      3. open a Py
-000114f0: 7468 6f6e 2d77 696e 646f 7720 7368 6f77  thon-window show
-00011500: 696e 6720 7468 6520 7072 6f63 6573 7365  ing the processe
-00011510: 6420 696d 6167 652e 0d0a 2020 2020 0d0a  d image...    ..
-00011520: 2020 2020 4166 7465 7220 6f6e 6520 6974      After one it
-00011530: 6572 6174 696f 6e20 6f66 2074 6865 7365  eration of these
-00011540: 2073 7465 7073 2c20 7573 6572 7320 6361   steps, users ca
-00011550: 6e20 6576 616c 7561 7465 2074 6865 2072  n evaluate the r
-00011560: 6573 756c 7473 2061 6e64 2064 6563 6964  esults and decid
-00011570: 650d 0a20 2020 2074 6f20 6d6f 6469 6679  e..    to modify
-00011580: 2074 6865 206f 7065 6e65 6420 636f 6e66   the opened conf
-00011590: 6967 7572 6174 696f 6e20 6669 6c65 2028  iguration file (
-000115a0: 652e 672e 2065 6974 6865 7220 6368 616e  e.g. either chan
-000115b0: 6765 2066 756e 6374 696f 6e20 7061 7261  ge function para
-000115c0: 6d65 7465 7273 206f 7220 0d0a 2020 2020  meters or ..    
-000115d0: 6164 6420 6e65 7720 6675 6e63 7469 6f6e  add new function
-000115e0: 7329 2c20 616e 6420 7275 6e20 7468 6520  s), and run the 
-000115f0: 7079 7065 2061 6761 696e 2c20 6f72 2074  pype again, or t
-00011600: 6f20 7465 726d 696e 6174 6520 7468 6520  o terminate the 
-00011610: 7079 7065 2061 6e64 200d 0a20 2020 2073  pype and ..    s
-00011620: 6176 6520 616c 6c20 7265 7375 6c74 732e  ave all results.
-00011630: 2054 6865 2070 726f 6365 7373 6564 2069   The processed i
-00011640: 6d61 6765 2c20 616e 7920 6578 7472 6163  mage, any extrac
-00011650: 7465 6420 7068 656e 6f74 7970 6963 2069  ted phenotypic i
-00011660: 6e66 6f72 6d61 7469 6f6e 2c20 0d0a 2020  nformation, ..  
-00011670: 2020 6173 2077 656c 6c20 6173 2074 6865    as well as the
-00011680: 206d 6f64 6966 6965 6420 636f 6e66 6967   modified config
-00011690: 2d66 696c 6520 6973 2073 746f 7265 6420  -file is stored 
-000116a0: 696e 7369 6465 2074 6865 2069 6d61 6765  inside the image
-000116b0: 2064 6972 6563 746f 7279 2c20 6f72 0d0a   directory, or..
-000116c0: 2020 2020 6120 7573 6572 2d73 7065 6369      a user-speci
-000116d0: 6669 6564 2064 6972 6563 746f 7279 2e20  fied directory. 
-000116e0: 4279 2070 726f 7669 6469 6e67 2075 6e69  By providing uni
-000116f0: 7175 6520 6e61 6d65 732c 2075 7365 7273  que names, users
-00011700: 2063 616e 2073 746f 7265 2064 6966 6665   can store diffe
-00011710: 7265 6e74 0d0a 2020 2020 7079 7065 2063  rent..    pype c
-00011720: 6f6e 6669 6775 7261 7469 6f6e 7320 616e  onfigurations an
-00011730: 6420 7468 6520 6173 736f 6369 6174 6564  d the associated
-00011740: 2072 6573 756c 7473 2073 6964 6520 6279   results side by
-00011750: 2073 6964 652e 200d 0a20 2020 200d 0a20   side. ..    .. 
-00011760: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00011770: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d     ----------...
-00011780: 0a20 2020 2069 6d61 6765 3a20 6172 7261  .    image: arra
-00011790: 7920 6f72 2073 7472 200d 0a20 2020 2020  y or str ..     
-000117a0: 2020 2063 616e 2062 6520 6569 7468 6572     can be either
-000117b0: 2061 206e 756d 7079 2061 7272 6179 206f   a numpy array o
-000117c0: 7220 6120 7374 7269 6e67 2074 6861 7420  r a string that 
-000117d0: 7072 6f76 6964 6573 2074 6865 2070 6174  provides the pat
-000117e0: 6820 746f 200d 0a20 2020 2020 2020 2073  h to ..        s
-000117f0: 6f75 7263 6520 696d 6167 6520 6669 6c65  ource image file
-00011800: 206f 7220 7061 7468 2074 6f20 6120 7661   or path to a va
-00011810: 6c69 6420 7068 656e 6f70 7970 6520 6469  lid phenopype di
-00011820: 7265 6374 6f72 790d 0a20 2020 206e 616d  rectory..    nam
-00011830: 653a 2073 7472 0d0a 2020 2020 2020 2020  e: str..        
-00011840: 6e61 6d65 206f 6620 7079 7065 2d63 6f6e  name of pype-con
-00011850: 6669 6720 2d20 7769 6c6c 2062 6520 6170  fig - will be ap
-00011860: 7065 6e64 6564 2074 6f20 616c 6c20 7265  pended to all re
-00011870: 7375 6c74 7320 6669 6c65 730d 0a20 2020  sults files..   
-00011880: 2063 6f6e 6669 675f 7465 6d70 6c61 7465   config_template
-00011890: 3a20 7374 722c 206f 7074 696f 6e61 6c0d  : str, optional.
-000118a0: 0a20 2020 2020 2020 2063 686f 7365 2066  .        chose f
-000118b0: 726f 6d20 6c69 7374 206f 6620 7072 6f76  rom list of prov
-000118c0: 6964 6564 2074 656d 706c 6174 6573 2020  ided templates  
-000118d0: 0d0a 2020 2020 2020 2020 2865 2e67 2e20  ..        (e.g. 
-000118e0: 6578 312c 2065 7832 2c20 2e2e 2e29 0d0a  ex1, ex2, ...)..
-000118f0: 2020 2020 636f 6e66 6967 5f70 6174 683a      config_path:
-00011900: 2073 7472 2c20 6f70 7469 6f6e 616c 0d0a   str, optional..
-00011910: 2020 2020 2020 2020 6375 7374 6f6d 2070          custom p
-00011920: 6174 6820 746f 2061 2070 7970 6520 7465  ath to a pype te
-00011930: 6d70 6c61 7465 2028 6e65 6564 7320 746f  mplate (needs to
-00011940: 2061 6468 6572 6520 7961 6d6c 2073 796e   adhere yaml syn
-00011950: 7461 7820 616e 6420 0d0a 2020 2020 2020  tax and ..      
-00011960: 2020 7068 656e 6f70 7970 6520 7374 7275    phenopype stru
-00011970: 6374 7572 6529 0d0a 2020 2020 6465 6c61  cture)..    dela
-00011980: 793a 2069 6e74 2c20 6f70 7469 6f6e 616c  y: int, optional
-00011990: 0d0a 2020 2020 2020 2020 7469 6d65 2069  ..        time i
-000119a0: 6e20 6d73 2074 6f20 6164 6420 6265 7477  n ms to add betw
-000119b0: 6565 6e20 7265 6c6f 6164 2061 7474 656d  een reload attem
-000119c0: 7073 206f 6620 7961 6d6c 206d 6f6e 6974  ps of yaml monit
-000119d0: 6f72 2e20 696e 6372 6561 7365 2074 6869  or. increase thi
-000119e0: 7320 0d0a 2020 2020 2020 2020 7661 6c75  s ..        valu
-000119f0: 6520 6966 2073 6176 6564 2063 6861 6e67  e if saved chang
-00011a00: 6573 2069 6e20 636f 6e66 6967 2066 696c  es in config fil
-00011a10: 6520 6172 6520 6e6f 7420 7061 7273 6564  e are not parsed
-00011a20: 2069 6e20 7468 6520 6669 7273 7420 6174   in the first at
-00011a30: 7465 6d70 742e 0d0a 2020 2020 6469 725f  tempt...    dir_
-00011a40: 7061 7468 3a20 7374 722c 206f 7074 696f  path: str, optio
-00011a50: 6e61 6c0d 0a20 2020 2020 2020 2070 6174  nal..        pat
-00011a60: 6820 746f 2061 6e20 6578 6973 7469 6e67  h to an existing
-00011a70: 2064 6972 6563 746f 7279 2077 6865 7265   directory where
-00011a80: 2061 6c6c 206f 7574 7075 7420 7368 6f75   all output shou
-00011a90: 6c64 2062 6520 7374 6f72 6564 0d0a 2020  ld be stored..  
-00011aa0: 2020 736b 6970 3a20 626f 6f6c 2c20 6f70    skip: bool, op
-00011ab0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-00011ac0: 736b 6970 2064 6972 6563 746f 7269 6573  skip directories
-00011ad0: 2074 6861 7420 616c 7265 6164 7920 6861   that already ha
-00011ae0: 7665 2022 6e61 6d65 2220 6173 2061 2073  ve "name" as a s
-00011af0: 7566 6669 7820 696e 2074 6865 2066 696c  uffix in the fil
-00011b00: 656e 616d 650d 0a20 2020 2066 6565 6462  ename..    feedb
-00011b10: 6163 6b3a 2062 6f6f 6c2c 206f 7074 696f  ack: bool, optio
-00011b20: 6e61 6c0d 0a20 2020 2020 2020 2064 6f6e  nal..        don
-00011b30: 2774 206f 7065 6e20 7465 7874 2065 6469  't open text edi
-00011b40: 746f 7220 6f72 2077 696e 646f 772c 206a  tor or window, j
-00011b50: 7573 7420 6170 706c 7920 6675 6e63 7469  ust apply functi
-00011b60: 6f6e 7320 616e 6420 7465 726d 696e 6174  ons and terminat
-00011b70: 650d 0a20 2020 206d 6178 5f64 696d 3a20  e..    max_dim: 
-00011b80: 696e 742c 206f 7074 696f 6e61 6c0d 0a20  int, optional.. 
-00011b90: 2020 2020 2020 206d 6178 696d 756d 2064         maximum d
-00011ba0: 696d 656e 7369 6f6e 2074 6861 7420 7769  imension that wi
-00011bb0: 6e64 6f77 2063 616e 2068 6176 6520 0d0a  ndow can have ..
-00011bc0: 2020 2020 6b77 6172 6773 3a20 0d0a 2020      kwargs: ..  
-00011bd0: 2020 2020 2020 6465 7665 6c6f 7065 7220        developer 
-00011be0: 6f70 7469 6f6e 730d 0a20 2020 2022 2222  options..    """
-00011bf0: 0d0a 0d0a 2020 2020 6465 6620 5f5f 696e  ....    def __in
-00011c00: 6974 5f5f 280d 0a20 2020 2020 2020 2073  it__(..        s
-00011c10: 656c 662c 0d0a 2020 2020 2020 2020 696d  elf,..        im
-00011c20: 6167 655f 7061 7468 2c0d 0a20 2020 2020  age_path,..     
-00011c30: 2020 2074 6167 2c0d 0a20 2020 2020 2020     tag,..       
-00011c40: 2063 6f6e 6669 675f 7061 7468 3d4e 6f6e   config_path=Non
-00011c50: 652c 0d0a 2020 2020 2020 2020 736b 6970  e,..        skip
-00011c60: 3d46 616c 7365 2c0d 0a20 2020 2020 2020  =False,..       
-00011c70: 2061 7574 6f6c 6f61 643d 5472 7565 2c0d   autoload=True,.
-00011c80: 0a20 2020 2020 2020 2061 7574 6f73 6176  .        autosav
-00011c90: 653d 5472 7565 2c0d 0a20 2020 2020 2020  e=True,..       
-00011ca0: 2061 7574 6f73 686f 773d 5472 7565 2c0d   autoshow=True,.
-00011cb0: 0a20 2020 2020 2020 2066 6978 5f6e 616d  .        fix_nam
-00011cc0: 6573 3d54 7275 652c 0d0a 2020 2020 2020  es=True,..      
-00011cd0: 2020 6665 6564 6261 636b 3d54 7275 652c    feedback=True,
-00011ce0: 0d0a 2020 2020 2020 2020 6465 6275 673d  ..        debug=
-00011cf0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
-00011d00: 6c6f 6164 5f63 6f6e 746f 7572 733d 4661  load_contours=Fa
-00011d10: 6c73 652c 0d0a 2020 2020 2020 2020 2a2a  lse,..        **
-00011d20: 6b77 6172 6773 0d0a 2020 2020 293a 0d0a  kwargs..    ):..
-00011d30: 0d0a 2020 2020 2020 2020 2320 3d3d 3d3d  ..        # ====
-00011d40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011d50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011d60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011d70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011d80: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
-00011d90: 2020 2023 2043 4845 434b 5320 2620 494e     # CHECKS & IN
-00011da0: 4954 0d0a 2020 2020 2020 2020 2320 3d3d  IT..        # ==
-00011db0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011dc0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011dd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011de0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00011df0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d 0a20  ===========.... 
-00011e00: 2020 2020 2020 2023 2320 6b77 6172 6773         ## kwargs
-00011e10: 0d0a 2020 2020 2020 2020 676c 6f62 616c  ..        global
-00011e20: 2077 696e 646f 775f 6d61 785f 6469 6d0d   window_max_dim.
-00011e30: 0a20 2020 2020 2020 2077 696e 646f 775f  .        window_
-00011e40: 6d61 785f 6469 6d20 3d20 6b77 6172 6773  max_dim = kwargs
-00011e50: 2e67 6574 2822 7769 6e64 6f77 5f6d 6178  .get("window_max
-00011e60: 5f64 696d 2229 0d0a 2020 2020 2020 2020  _dim")..        
-00011e70: 6465 6c61 7920 3d20 6b77 6172 6773 2e67  delay = kwargs.g
-00011e80: 6574 2822 6465 6c61 7922 2c20 3530 3029  et("delay", 500)
-00011e90: 0d0a 2020 2020 2020 2020 736c 6565 7020  ..        sleep 
-00011ea0: 3d20 6b77 6172 6773 2e67 6574 2822 736c  = kwargs.get("sl
-00011eb0: 6565 7022 2c20 302e 3229 0d0a 0d0a 2020  eep", 0.2)....  
-00011ec0: 2020 2020 2020 2323 2066 6c61 6773 0d0a        ## flags..
-00011ed0: 2020 2020 2020 2020 7365 6c66 2e66 6c61          self.fla
-00011ee0: 6773 203d 206d 616b 655f 6461 7461 636c  gs = make_datacl
-00011ef0: 6173 7328 0d0a 2020 2020 2020 2020 2020  ass(..          
-00011f00: 2020 636c 735f 6e61 6d65 3d22 666c 6167    cls_name="flag
-00011f10: 7322 2c0d 0a20 2020 2020 2020 2020 2020  s",..           
-00011f20: 2066 6965 6c64 733d 5b0d 0a20 2020 2020   fields=[..     
-00011f30: 2020 2020 2020 2020 2020 2028 2264 6562             ("deb
-00011f40: 7567 222c 2062 6f6f 6c2c 2064 6562 7567  ug", bool, debug
-00011f50: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00011f60: 2020 2020 2822 6175 746f 6c6f 6164 222c      ("autoload",
-00011f70: 2062 6f6f 6c2c 2061 7574 6f6c 6f61 6429   bool, autoload)
-00011f80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00011f90: 2020 2028 2261 7574 6f73 6176 6522 2c20     ("autosave", 
-00011fa0: 626f 6f6c 2c20 6175 746f 7361 7665 292c  bool, autosave),
-00011fb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011fc0: 2020 2822 6175 746f 7368 6f77 222c 2062    ("autoshow", b
-00011fd0: 6f6f 6c2c 2061 7574 6f73 686f 7729 2c0d  ool, autoshow),.
-00011fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011ff0: 2028 2266 6565 6462 6163 6b22 2c20 626f   ("feedback", bo
-00012000: 6f6c 2c20 6665 6564 6261 636b 292c 0d0a  ol, feedback),..
-00012010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012020: 2822 6669 785f 6e61 6d65 7322 2c20 626f  ("fix_names", bo
-00012030: 6f6c 2c20 6669 785f 6e61 6d65 7329 2c0d  ol, fix_names),.
-00012040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012050: 2028 2273 6b69 7022 2c20 626f 6f6c 2c20   ("skip", bool, 
-00012060: 736b 6970 292c 0d0a 2020 2020 2020 2020  skip),..        
-00012070: 2020 2020 2020 2020 2822 7465 726d 696e          ("termin
-00012080: 6174 6522 2c20 626f 6f6c 2c20 4661 6c73  ate", bool, Fals
-00012090: 6529 2c0d 0a20 2020 2020 2020 2020 2020  e),..           
-000120a0: 2020 2020 2028 2264 7279 5f72 756e 222c       ("dry_run",
-000120b0: 2062 6f6f 6c2c 206b 7761 7267 732e 6765   bool, kwargs.ge
-000120c0: 7428 2264 7279 5f72 756e 222c 2046 616c  t("dry_run", Fal
-000120d0: 7365 2929 2c0d 0a20 2020 2020 2020 2020  se)),..         
-000120e0: 2020 205d 2c0d 0a20 2020 2020 2020 2029     ],..        )
-000120f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00012100: 2020 2020 2323 2064 6f6e 2774 2061 7574      ## don't aut
-00012110: 6f73 686f 7720 6966 2066 6565 6462 6163  oshow if feedbac
-00012120: 6b20 6973 206f 6666 0d0a 2020 2020 2020  k is off..      
-00012130: 2020 6966 206e 6f74 2073 656c 662e 666c    if not self.fl
-00012140: 6167 732e 6665 6564 6261 636b 3a0d 0a20  ags.feedback:.. 
-00012150: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012160: 666c 6167 732e 6175 746f 7368 6f77 203d  flags.autoshow =
-00012170: 2046 616c 7365 0d0a 2020 2020 2020 2020   False..        
-00012180: 0d0a 2020 2020 2020 2020 6966 2069 6d61  ..        if ima
-00012190: 6765 5f70 6174 682e 5f5f 636c 6173 735f  ge_path.__class_
-000121a0: 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20 2273  _.__name__ == "s
-000121b0: 7472 223a 0d0a 2020 2020 2020 2020 2020  tr":..          
-000121c0: 2020 696d 6167 655f 7061 7468 203d 206f    image_path = o
-000121d0: 732e 7061 7468 2e61 6273 7061 7468 2869  s.path.abspath(i
-000121e0: 6d61 6765 5f70 6174 6829 0d0a 0d0a 2020  mage_path)....  
-000121f0: 2020 2020 2020 2323 2063 6865 636b 206e        ## check n
-00012200: 616d 652c 206c 6f61 6420 636f 6e74 6169  ame, load contai
-00012210: 6e65 7220 616e 6420 636f 6e66 6967 0d0a  ner and config..
-00012220: 2020 2020 2020 2020 7574 696c 735f 6c6f          utils_lo
-00012230: 776c 6576 656c 2e5f 6368 6563 6b5f 7079  wlevel._check_py
-00012240: 7065 5f74 6167 2874 6167 290d 0a20 2020  pe_tag(tag)..   
-00012250: 2020 2020 2073 656c 662e 5f6c 6f61 645f       self._load_
-00012260: 636f 6e74 6169 6e65 7228 696d 6167 655f  container(image_
-00012270: 7061 7468 3d69 6d61 6765 5f70 6174 682c  path=image_path,
-00012280: 2074 6167 3d74 6167 290d 0a20 2020 2020   tag=tag)..     
-00012290: 2020 2073 656c 662e 5f6c 6f61 645f 7079     self._load_py
-000122a0: 7065 5f63 6f6e 6669 6728 696d 6167 655f  pe_config(image_
-000122b0: 7061 7468 3d69 6d61 6765 5f70 6174 682c  path=image_path,
-000122c0: 2074 6167 3d74 6167 2c20 636f 6e66 6967   tag=tag, config
-000122d0: 5f70 6174 683d 636f 6e66 6967 5f70 6174  _path=config_pat
-000122e0: 6829 0d0a 0d0a 2020 2020 2020 2020 2320  h)....        # 
-000122f0: 6368 6563 6b20 7665 7273 696f 6e2c 206c  check version, l
-00012300: 6f61 6420 636f 6e74 6169 6e65 7220 616e  oad container an
-00012310: 6420 636f 6e66 6967 0d0a 2020 2020 2020  d config..      
-00012320: 2020 6966 2073 656c 662e 666c 6167 732e    if self.flags.
-00012330: 6472 795f 7275 6e3a 0d0a 2020 2020 2020  dry_run:..      
-00012340: 2020 2020 2020 7365 6c66 2e5f 6c6f 6164        self._load
-00012350: 5f70 7970 655f 636f 6e66 6967 2869 6d61  _pype_config(ima
-00012360: 6765 5f70 6174 682c 2074 6167 2c20 636f  ge_path, tag, co
-00012370: 6e66 6967 5f70 6174 6829 0d0a 2020 2020  nfig_path)..    
-00012380: 2020 2020 2020 2020 7365 6c66 2e5f 6974          self._it
-00012390: 6572 6174 6528 636f 6e66 6967 3d73 656c  erate(config=sel
-000123a0: 662e 636f 6e66 6967 2c20 616e 6e6f 7461  f.config, annota
-000123b0: 7469 6f6e 733d 636f 7079 2e64 6565 7063  tions=copy.deepc
-000123c0: 6f70 7928 7365 7474 696e 6773 2e5f 616e  opy(settings._an
-000123d0: 6e6f 7461 7469 6f6e 5f74 7970 6573 292c  notation_types),
-000123e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000123f0: 2020 2020 2020 2020 6578 6563 7574 653d          execute=
-00012400: 4661 6c73 652c 2061 7574 6f73 686f 773d  False, autoshow=
-00012410: 4661 6c73 652c 2066 6565 6462 6163 6b3d  False, feedback=
-00012420: 5472 7565 290d 0a20 2020 2020 2020 2020  True)..         
-00012430: 2020 2072 6574 7572 6e0d 0a0d 0a20 2020     return....   
-00012440: 2020 2020 2023 2320 6368 6563 6b20 7768       ## check wh
-00012450: 6574 6865 7220 6469 7265 6374 6f72 7920  ether directory 
-00012460: 6973 2073 6b69 7070 6564 0d0a 2020 2020  is skipped..    
-00012470: 2020 2020 6966 2073 656c 662e 666c 6167      if self.flag
-00012480: 732e 736b 6970 3a0d 0a20 2020 2020 2020  s.skip:..       
-00012490: 2020 2020 2069 6620 7365 6c66 2e5f 6368       if self._ch
-000124a0: 6563 6b5f 6469 7265 6374 6f72 795f 736b  eck_directory_sk
-000124b0: 6970 280d 0a20 2020 2020 2020 2020 2020  ip(..           
-000124c0: 2020 2020 2074 6167 3d74 6167 2c20 736b       tag=tag, sk
-000124d0: 6970 5f70 6174 7465 726e 3d73 6b69 702c  ip_pattern=skip,
-000124e0: 2064 6972 5f70 6174 683d 7365 6c66 2e63   dir_path=self.c
-000124f0: 6f6e 7461 696e 6572 2e64 6972 5f70 6174  ontainer.dir_pat
-00012500: 680d 0a20 2020 2020 2020 2020 2020 2029  h..            )
-00012510: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00012520: 2020 2072 6574 7572 6e0d 0a0d 0a20 2020     return....   
-00012530: 2020 2020 2023 2320 6c6f 6164 2065 7869       ## load exi
-00012540: 7374 696e 6720 616e 6e6f 7461 7469 6f6e  sting annotation
-00012550: 7320 7468 726f 7567 6820 636f 6e74 6169  s through contai
-00012560: 6e65 720d 0a20 2020 2020 2020 2069 6620  ner..        if 
-00012570: 7365 6c66 2e66 6c61 6773 2e61 7574 6f6c  self.flags.autol
-00012580: 6f61 643a 0d0a 2020 2020 2020 2020 2020  oad:..          
-00012590: 2020 7365 6c66 2e63 6f6e 7461 696e 6572    self.container
-000125a0: 2e6c 6f61 6428 636f 6e74 6f75 7273 3d6c  .load(contours=l
-000125b0: 6f61 645f 636f 6e74 6f75 7273 290d 0a0d  oad_contours)...
-000125c0: 0a20 2020 2020 2020 2023 2320 6368 6563  .        ## chec
-000125d0: 6b20 7079 7065 2063 6f6e 6669 6720 666f  k pype config fo
-000125e0: 7220 616e 6e6f 7461 7469 6f6e 730d 0a20  r annotations.. 
-000125f0: 2020 2020 2020 2073 656c 662e 5f69 7465         self._ite
-00012600: 7261 7465 280d 0a20 2020 2020 2020 2020  rate(..         
-00012610: 2020 2063 6f6e 6669 673d 7365 6c66 2e63     config=self.c
-00012620: 6f6e 6669 672c 0d0a 2020 2020 2020 2020  onfig,..        
-00012630: 2020 2020 616e 6e6f 7461 7469 6f6e 733d      annotations=
-00012640: 7365 6c66 2e63 6f6e 7461 696e 6572 2e61  self.container.a
-00012650: 6e6e 6f74 6174 696f 6e73 2c0d 0a20 2020  nnotations,..   
-00012660: 2020 2020 2020 2020 2065 7865 6375 7465           execute
-00012670: 3d46 616c 7365 2c0d 0a20 2020 2020 2020  =False,..       
-00012680: 2020 2020 2061 7574 6f73 686f 773d 4661       autoshow=Fa
-00012690: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-000126a0: 2020 6665 6564 6261 636b 3d46 616c 7365    feedback=False
-000126b0: 2c0d 0a20 2020 2020 2020 2029 0d0a 2020  ,..        )..  
-000126c0: 2020 2020 2020 7469 6d65 2e73 6c65 6570        time.sleep
-000126d0: 2873 6c65 6570 290d 0a0d 0a20 2020 2020  (sleep)....     
-000126e0: 2020 2023 2320 6669 6e61 6c20 6368 6563     ## final chec
-000126f0: 6b20 6265 666f 7265 2073 7461 7274 696e  k before startin
-00012700: 6720 7079 7065 0d0a 2020 2020 2020 2020  g pype..        
-00012710: 7365 6c66 2e5f 6368 6563 6b5f 6669 6e61  self._check_fina
-00012720: 6c28 290d 0a0d 0a20 2020 2020 2020 2023  l()....        #
-00012730: 206f 7065 6e20 636f 6e66 6967 2066 696c   open config fil
-00012740: 6520 7769 7468 2073 7973 7465 6d20 7669  e with system vi
-00012750: 6577 6572 0d0a 2020 2020 2020 2020 6966  ewer..        if
-00012760: 2073 656c 662e 666c 6167 732e 6665 6564   self.flags.feed
-00012770: 6261 636b 2061 6e64 2073 656c 662e 666c  back and self.fl
-00012780: 6167 732e 6175 746f 7368 6f77 3a0d 0a20  ags.autoshow:.. 
-00012790: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000127a0: 5f73 7461 7274 5f66 696c 655f 6d6f 6e69  _start_file_moni
-000127b0: 746f 7228 6465 6c61 793d 6465 6c61 7929  tor(delay=delay)
-000127c0: 0d0a 0d0a 2020 2020 2020 2020 2323 2073  ....        ## s
-000127d0: 7461 7274 206c 6f67 0d0a 2020 2020 2020  tart log..      
-000127e0: 2020 7365 6c66 2e6c 6f67 203d 205b 5d0d    self.log = [].
-000127f0: 0a0d 0a20 2020 2020 2020 2023 203d 3d3d  ...        # ===
-00012800: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012810: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012820: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012830: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012840: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
-00012850: 2020 2020 2320 5059 5045 204c 4f4f 500d      # PYPE LOOP.
-00012860: 0a20 2020 2020 2020 2023 203d 3d3d 3d3d  .        # =====
-00012870: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012880: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012890: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000128a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000128b0: 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a 2020 2020  ========....    
-000128c0: 2020 2020 2323 2072 756e 2070 7970 650d      ## run pype.
-000128d0: 0a20 2020 2020 2020 2077 6869 6c65 2054  .        while T
-000128e0: 7275 653a 0d0a 0d0a 2020 2020 2020 2020  rue:....        
-000128f0: 2020 2020 2323 2070 7970 6520 7265 7374      ## pype rest
-00012900: 6172 7420 666c 6167 0d0a 2020 2020 2020  art flag..      
-00012910: 2020 2020 2020 5f63 6f6e 6669 672e 7079        _config.py
-00012920: 7065 5f72 6573 7461 7274 203d 2046 616c  pe_restart = Fal
-00012930: 7365 0d0a 0d0a 2020 2020 2020 2020 2020  se....          
-00012940: 2020 2323 2072 6566 7265 7368 2063 6f6e    ## refresh con
-00012950: 6669 670d 0a20 2020 2020 2020 2020 2020  fig..           
-00012960: 2069 6620 7365 6c66 2e66 6c61 6773 2e66   if self.flags.f
-00012970: 6565 6462 6163 6b20 616e 6420 7365 6c66  eedback and self
-00012980: 2e66 6c61 6773 2e61 7574 6f73 686f 773a  .flags.autoshow:
-00012990: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000129a0: 2020 2020 2323 2074 6f20 7374 6f70 2069      ## to stop i
-000129b0: 6e66 696e 6974 6520 6c6f 6f70 2077 6974  nfinite loop wit
-000129c0: 686f 7574 206f 7065 6e69 6e67 206e 6577  hout opening new
-000129d0: 2077 696e 646f 770d 0a20 2020 2020 2020   window..       
-000129e0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-000129f0: 7365 6c66 2e59 464d 2e63 6f6e 7465 6e74  self.YFM.content
-00012a00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00012a10: 2020 2020 2020 2070 7269 6e74 2822 2d20         print("- 
-00012a20: 5354 494c 4c20 5550 4441 5449 4e47 2043  STILL UPDATING C
-00012a30: 4f4e 4649 4720 286e 6f20 636f 6e74 656e  ONFIG (no conten
-00012a40: 7429 2229 0d0a 2020 2020 2020 2020 2020  t)")..          
-00012a50: 2020 2020 2020 2020 2020 6376 322e 6465            cv2.de
-00012a60: 7374 726f 7957 696e 646f 7728 2270 6865  stroyWindow("phe
-00012a70: 6e6f 7079 7065 2229 0d0a 2020 2020 2020  nopype")..      
-00012a80: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-00012a90: 6d65 2e73 6c65 6570 2831 290d 0a20 2020  me.sleep(1)..   
-00012aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ab0: 2073 656c 662e 5946 4d2e 5f73 746f 7028   self.YFM._stop(
-00012ac0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00012ad0: 2020 2020 2020 2073 656c 662e 5f73 7461         self._sta
-00012ae0: 7274 5f66 696c 655f 6d6f 6e69 746f 7228  rt_file_monitor(
-00012af0: 6465 6c61 793d 6465 6c61 7929 0d0a 2020  delay=delay)..  
-00012b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b10: 2020 636f 6e74 696e 7565 0d0a 0d0a 2020    continue....  
-00012b20: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00012b30: 6c66 2e63 6f6e 6669 6720 3d20 636f 7079  lf.config = copy
-00012b40: 2e64 6565 7063 6f70 7928 7365 6c66 2e59  .deepcopy(self.Y
-00012b50: 464d 2e63 6f6e 7465 6e74 290d 0a0d 0a20  FM.content).... 
-00012b60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00012b70: 6620 6e6f 7420 7365 6c66 2e63 6f6e 6669  f not self.confi
-00012b80: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
-00012b90: 2020 2020 2020 2020 7072 696e 7428 222d          print("-
-00012ba0: 2053 5449 4c4c 2055 5044 4154 494e 4720   STILL UPDATING 
-00012bb0: 434f 4e46 4947 2028 6e6f 2063 6f6e 6669  CONFIG (no confi
-00012bc0: 6729 2229 0d0a 2020 2020 2020 2020 2020  g)")..          
-00012bd0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00012be0: 7565 0d0a 0d0a 2020 2020 2020 2020 2020  ue....          
-00012bf0: 2020 2323 2072 756e 2070 7970 6520 636f    ## run pype co
-00012c00: 6e66 6967 2069 6e20 7365 7175 656e 6365  nfig in sequence
-00012c10: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00012c20: 6c66 2e5f 6974 6572 6174 6528 0d0a 2020  lf._iterate(..  
-00012c30: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00012c40: 6e66 6967 3d73 656c 662e 636f 6e66 6967  nfig=self.config
-00012c50: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00012c60: 2020 2061 6e6e 6f74 6174 696f 6e73 3d73     annotations=s
-00012c70: 656c 662e 636f 6e74 6169 6e65 722e 616e  elf.container.an
-00012c80: 6e6f 7461 7469 6f6e 732c 0d0a 2020 2020  notations,..    
-00012c90: 2020 2020 2020 2020 2020 2020 6665 6564              feed
-00012ca0: 6261 636b 3d73 656c 662e 666c 6167 732e  back=self.flags.
-00012cb0: 6665 6564 6261 636b 2c0d 0a20 2020 2020  feedback,..     
-00012cc0: 2020 2020 2020 2020 2020 2061 7574 6f73             autos
-00012cd0: 686f 773d 7365 6c66 2e66 6c61 6773 2e61  how=self.flags.a
-00012ce0: 7574 6f73 686f 772c 0d0a 2020 2020 2020  utoshow,..      
-00012cf0: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-00012d00: 2020 2020 2020 2023 2320 7465 726d 696e         ## termin
-00012d10: 6174 6520 2620 636c 6561 6e75 700d 0a20  ate & cleanup.. 
-00012d20: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00012d30: 6c66 2e66 6c61 6773 2e66 6565 6462 6163  lf.flags.feedbac
-00012d40: 6b3a 0d0a 2020 2020 2020 2020 2020 2020  k:..            
-00012d50: 2020 2020 6966 2073 656c 662e 666c 6167      if self.flag
-00012d60: 732e 7465 726d 696e 6174 653a 0d0a 2020  s.terminate:..  
-00012d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d80: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00012d90: 2020 2020 2020 2020 2323 2073 746f 7065          ## stope
-00012da0: 2066 696c 6520 6d6f 6e69 746f 7269 6e67   file monitoring
-00012db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012dc0: 2020 2020 2020 6966 2068 6173 6174 7472        if hasattr
-00012dd0: 2873 656c 662c 2022 5946 4d22 293a 0d0a  (self, "YFM"):..
-00012de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012df0: 2020 2020 2020 2020 7365 6c66 2e59 464d          self.YFM
-00012e00: 2e5f 7374 6f70 2829 0d0a 2020 2020 2020  ._stop()..      
-00012e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e20: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00012e30: 2020 2020 2020 2020 2323 2072 6573 6574          ## reset
-00012e40: 207a 6f6f 6d20 7365 7474 696e 6773 0d0a   zoom settings..
-00012e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e60: 2020 2020 5f63 6f6e 6669 672e 6775 695f      _config.gui_
-00012e70: 7a6f 6f6d 5f63 6f6e 6669 6720 3d20 4e6f  zoom_config = No
-00012e80: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
-00012e90: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00012ea0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00012eb0: 2061 6464 2074 696d 6573 7461 6d70 0d0a   add timestamp..
-00012ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ed0: 2020 2020 7365 6c66 2e63 6f6e 6669 675b      self.config[
-00012ee0: 2263 6f6e 6669 675f 696e 666f 225d 5b22  "config_info"]["
-00012ef0: 6461 7465 5f6c 6173 745f 6d6f 6469 6669  date_last_modifi
-00012f00: 6564 225d 203d 2064 6174 6574 696d 652e  ed"] = datetime.
-00012f10: 746f 6461 7928 292e 7374 7266 7469 6d65  today().strftime
-00012f20: 2873 6574 7469 6e67 732e 7374 7266 7469  (settings.strfti
-00012f30: 6d65 5f66 6f72 6d61 7429 0d0a 2020 2020  me_format)..    
-00012f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f50: 7574 696c 735f 6c6f 776c 6576 656c 2e5f  utils_lowlevel._
-00012f60: 7361 7665 5f79 616d 6c28 7365 6c66 2e63  save_yaml(self.c
-00012f70: 6f6e 6669 672c 2073 656c 662e 636f 6e66  onfig, self.conf
-00012f80: 6967 5f70 6174 6829 0d0a 2020 2020 2020  ig_path)..      
-00012f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fa0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00012fb0: 2020 2020 2020 2020 2323 2066 6565 6462          ## feedb
-00012fc0: 6163 6b0d 0a20 2020 2020 2020 2020 2020  ack..           
-00012fd0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00012fe0: 5c6e 5c6e 5445 524d 494e 4154 4522 290d  \n\nTERMINATE").
-00012ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013000: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00013010: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00013020: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00013030: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00013040: 2020 2020 2062 7265 616b 0d0a 0d0a 2020       break....  
-00013050: 2020 2020 2020 6966 2073 656c 662e 666c        if self.fl
-00013060: 6167 732e 6175 746f 7361 7665 2061 6e64  ags.autosave and
-00013070: 2073 656c 662e 666c 6167 732e 7465 726d   self.flags.term
-00013080: 696e 6174 653a 0d0a 2020 2020 2020 2020  inate:..        
-00013090: 2020 2020 6966 2022 6578 706f 7274 2220      if "export" 
-000130a0: 6e6f 7420 696e 2073 656c 662e 636f 6e66  not in self.conf
-000130b0: 6967 5f70 6172 7365 645f 666c 6174 7465  ig_parsed_flatte
-000130c0: 6e65 643a 0d0a 2020 2020 2020 2020 2020  ned:..          
-000130d0: 2020 2020 2020 6578 706f 7274 5f6c 6973        export_lis
-000130e0: 7420 3d20 5b5d 0d0a 2020 2020 2020 2020  t = []..        
-000130f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00013100: 2020 2020 2020 2020 2020 2065 7870 6f72             expor
-00013110: 745f 6c69 7374 203d 2073 656c 662e 636f  t_list = self.co
-00013120: 6e66 6967 5f70 6172 7365 645f 666c 6174  nfig_parsed_flat
-00013130: 7465 6e65 645b 2265 7870 6f72 7422 5d0d  tened["export"].
-00013140: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00013150: 662e 636f 6e74 6169 6e65 722e 7361 7665  f.container.save
-00013160: 2865 7870 6f72 745f 6c69 7374 3d65 7870  (export_list=exp
-00013170: 6f72 745f 6c69 7374 290d 0a0d 0a20 2020  ort_list)....   
-00013180: 2064 6566 205f 6c6f 6164 5f63 6f6e 7461   def _load_conta
-00013190: 696e 6572 2873 656c 662c 2069 6d61 6765  iner(self, image
-000131a0: 5f70 6174 682c 2074 6167 293a 0d0a 2020  _path, tag):..  
-000131b0: 2020 2020 2020 6966 2069 6d61 6765 5f70        if image_p
-000131c0: 6174 682e 5f5f 636c 6173 735f 5f2e 5f5f  ath.__class__.__
-000131d0: 6e61 6d65 5f5f 203d 3d20 2273 7472 223a  name__ == "str":
-000131e0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000131f0: 206f 732e 7061 7468 2e69 7366 696c 6528   os.path.isfile(
-00013200: 696d 6167 655f 7061 7468 293a 0d0a 2020  image_path):..  
-00013210: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00013220: 6167 6520 3d20 7574 696c 732e 6c6f 6164  age = utils.load
-00013230: 5f69 6d61 6765 2869 6d61 6765 5f70 6174  _image(image_pat
-00013240: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-00013250: 2020 2020 6469 725f 7061 7468 203d 206f      dir_path = o
-00013260: 732e 7061 7468 2e64 6972 6e61 6d65 2869  s.path.dirname(i
-00013270: 6d61 6765 5f70 6174 6829 0d0a 2020 2020  mage_path)..    
-00013280: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00013290: 2e63 6f6e 7461 696e 6572 203d 2075 7469  .container = uti
-000132a0: 6c73 2e43 6f6e 7461 696e 6572 280d 0a20  ls.Container(.. 
+00010480: 2020 2020 2020 2020 2020 6d61 7828 7279            max(ry
+00010490: 2c30 2920 3a20 6d69 6e28 7279 202b 2072  ,0) : min(ry + r
+000104a0: 682c 2069 6d61 6765 5f68 6569 6768 7429  h, image_height)
+000104b0: 2c20 6d61 7828 7278 2c31 2920 3a20 6d69  , max(rx,1) : mi
+000104c0: 6e28 7278 202b 2072 772c 2069 6d61 6765  n(rx + rw, image
+000104d0: 5f77 6964 7468 295d 0d0a 2020 2020 2020  _width)]..      
+000104e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104f0: 2020 696d 6167 655f 6865 6967 6874 203d    image_height =
+00010500: 2069 6d61 6765 2e73 6861 7065 5b30 5d0d   image.shape[0].
+00010510: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00010520: 2020 2020 2020 2020 2020 2023 2320 7375             ## su
+00010530: 6274 7261 6374 2074 6f70 206c 6566 7420  btract top left 
+00010540: 636f 6f72 6420 6672 6f6d 2062 6f75 6e64  coord from bound
+00010550: 696e 6720 626f 7820 6672 6f6d 2061 6c6c  ing box from all
+00010560: 206c 616e 646d 6172 6b73 0d0a 2020 2020   landmarks..    
+00010570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010580: 2020 2020 6c6d 5f74 7570 6c65 5f6c 6973      lm_tuple_lis
+00010590: 745b 305d 203d 2074 7570 6c65 2863 202d  t[0] = tuple(c -
+000105a0: 2072 7820 666f 7220 6320 696e 206c 6d5f   rx for c in lm_
+000105b0: 7475 706c 655f 6c69 7374 5b30 5d29 0d0a  tuple_list[0])..
+000105c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000105d0: 2020 2020 2020 2020 6c6d 5f74 7570 6c65          lm_tuple
+000105e0: 5f6c 6973 745b 315d 203d 2074 7570 6c65  _list[1] = tuple
+000105f0: 2863 202d 2072 7920 666f 7220 6320 696e  (c - ry for c in
+00010600: 206c 6d5f 7475 706c 655f 6c69 7374 5b31   lm_tuple_list[1
+00010610: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00010620: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00010630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010640: 2020 2323 2072 6573 697a 6520 696d 6167    ## resize imag
+00010650: 6520 6f72 2063 726f 7070 6564 2069 6d61  e or cropped ima
+00010660: 6765 0d0a 2020 2020 2020 2020 2020 2020  ge..            
+00010670: 2020 2020 2020 2020 6966 2066 6c61 6773          if flags
+00010680: 2e72 6573 697a 655f 6661 6374 6f72 2021  .resize_factor !
+00010690: 3d20 313a 0d0a 2020 2020 2020 2020 2020  = 1:..          
+000106a0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+000106b0: 6167 6520 3d20 7574 696c 735f 6c6f 776c  age = utils_lowl
+000106c0: 6576 656c 2e5f 7265 7369 7a65 5f69 6d61  evel._resize_ima
+000106d0: 6765 2869 6d61 6765 2c20 6661 6374 6f72  ge(image, factor
+000106e0: 3d66 6c61 6773 2e72 6573 697a 655f 6661  =flags.resize_fa
+000106f0: 6374 6f72 2c20 696e 7465 7270 6f6c 6174  ctor, interpolat
+00010700: 696f 6e3d 2263 7562 6963 2229 0d0a 2020  ion="cubic")..  
+00010710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010720: 2020 2020 2020 696d 6167 655f 6865 6967        image_heig
+00010730: 6874 203d 2069 6e74 2869 6d61 6765 5f68  ht = int(image_h
+00010740: 6569 6768 7420 2a20 666c 6167 732e 7265  eight * flags.re
+00010750: 7369 7a65 5f66 6163 746f 7229 0d0a 2020  size_factor)..  
+00010760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010770: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00010780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010790: 2323 206d 756c 7469 706c 7920 616c 6c20  ## multiply all 
+000107a0: 6c61 6e64 6d61 726b 7320 7769 7468 2072  landmarks with r
+000107b0: 6573 697a 6520 6661 6374 6f72 0d0a 2020  esize factor..  
+000107c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000107d0: 2020 2020 2020 6c6d 5f74 7570 6c65 5f6c        lm_tuple_l
+000107e0: 6973 745b 305d 203d 2074 7570 6c65 2869  ist[0] = tuple(i
+000107f0: 6e74 2863 202a 2066 6c61 6773 2e72 6573  nt(c * flags.res
+00010800: 697a 655f 6661 6374 6f72 2920 666f 7220  ize_factor) for 
+00010810: 6320 696e 206c 6d5f 7475 706c 655f 6c69  c in lm_tuple_li
+00010820: 7374 5b30 5d29 0d0a 2020 2020 2020 2020  st[0])..        
+00010830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010840: 6c6d 5f74 7570 6c65 5f6c 6973 745b 315d  lm_tuple_list[1]
+00010850: 203d 2074 7570 6c65 2869 6e74 2863 202a   = tuple(int(c *
+00010860: 2066 6c61 6773 2e72 6573 697a 655f 6661   flags.resize_fa
+00010870: 6374 6f72 2920 666f 7220 6320 696e 206c  ctor) for c in l
+00010880: 6d5f 7475 706c 655f 6c69 7374 5b31 5d29  m_tuple_list[1])
+00010890: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000108a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000108b0: 2020 2020 2020 2020 2020 2020 2323 2073              ## s
+000108c0: 6176 6520 7265 7369 7a65 6420 696d 6167  ave resized imag
+000108d0: 6520 6f72 2063 726f 7070 6564 2069 6d61  e or cropped ima
+000108e0: 6765 0d0a 2020 2020 2020 2020 2020 2020  ge..            
+000108f0: 2020 2020 2020 2020 7574 696c 732e 7361          utils.sa
+00010900: 7665 5f69 6d61 6765 2869 6d61 6765 2c20  ve_image(image, 
+00010910: 6469 725f 7061 7468 3d69 6d67 5f64 6972  dir_path=img_dir
+00010920: 2c20 6669 6c65 5f6e 616d 653d 6669 6c65  , file_name=file
+00010930: 6e61 6d65 2c20 6f76 6572 7772 6974 653d  name, overwrite=
+00010940: 6f76 6572 7772 6974 6529 0d0a 2020 2020  overwrite)..    
+00010950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010970: 2020 2323 2061 6464 2074 6f20 6461 7461    ## add to data
+00010980: 6672 616d 650d 0a20 2020 2020 2020 2020  frame..         
+00010990: 2020 2020 2020 2063 6f6f 7264 5f72 6f77         coord_row
+000109a0: 2c20 636f 6c6e 616d 6573 203d 206c 6973  , colnames = lis
+000109b0: 7428 292c 206c 6973 7428 290d 0a20 2020  t(), list()..   
+000109c0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+000109d0: 6e61 6d65 732e 6170 7065 6e64 2822 6964  names.append("id
+000109e0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+000109f0: 2020 2020 666f 7220 2069 6478 322c 2028      for  idx2, (
+00010a00: 785f 636f 6f72 642c 2079 5f63 6f6f 7264  x_coord, y_coord
+00010a10: 2920 696e 2065 6e75 6d65 7261 7465 287a  ) in enumerate(z
+00010a20: 6970 286c 6d5f 7475 706c 655f 6c69 7374  ip(lm_tuple_list
+00010a30: 5b30 5d2c 206c 6d5f 7475 706c 655f 6c69  [0], lm_tuple_li
+00010a40: 7374 5b31 5d29 2c31 293a 0d0a 2020 2020  st[1]),1):..    
+00010a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a60: 636f 6f72 645f 726f 772e 6170 7065 6e64  coord_row.append
+00010a70: 2878 5f63 6f6f 7264 290d 0a20 2020 2020  (x_coord)..     
+00010a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00010a90: 6620 666c 6167 732e 666c 6970 5f79 3a0d  f flags.flip_y:.
+00010aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010ab0: 2020 2020 2020 2020 2063 6f6f 7264 5f72           coord_r
+00010ac0: 6f77 2e61 7070 656e 6428 696e 7428 2879  ow.append(int((y
+00010ad0: 5f63 6f6f 7264 202d 2069 6d61 6765 5f68  _coord - image_h
+00010ae0: 6569 6768 7429 202a 202d 3129 290d 0a20  eight) * -1)).. 
+00010af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b00: 2020 2065 6c73 653a 200d 0a20 2020 2020     else: ..     
+00010b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b20: 2020 2063 6f6f 7264 5f72 6f77 2e61 7070     coord_row.app
+00010b30: 656e 6428 795f 636f 6f72 6429 0d0a 2020  end(y_coord)..  
+00010b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b50: 2020 636f 6c6e 616d 6573 2e61 7070 656e    colnames.appen
+00010b60: 6428 2258 2220 2b20 7374 7228 6964 7832  d("X" + str(idx2
+00010b70: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00010b80: 2020 2020 2020 2020 636f 6c6e 616d 6573          colnames
+00010b90: 2e61 7070 656e 6428 2259 2220 2b20 7374  .append("Y" + st
+00010ba0: 7228 6964 7832 2929 0d0a 2020 2020 2020  r(idx2))..      
+00010bb0: 2020 2020 2020 2020 2020 6466 203d 2070            df = p
+00010bc0: 642e 4461 7461 4672 616d 6528 5b66 696c  d.DataFrame([fil
+00010bd0: 656e 616d 655d 202b 2063 6f6f 7264 5f72  ename] + coord_r
+00010be0: 6f77 292e 7472 616e 7370 6f73 6528 290d  ow).transpose().
+00010bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010c00: 2064 665f 7375 6d6d 6172 7920 3d20 7064   df_summary = pd
+00010c10: 2e63 6f6e 6361 7428 5b64 665f 7375 6d6d  .concat([df_summ
+00010c20: 6172 792c 2064 665d 290d 0a20 2020 2020  ary, df])..     
+00010c30: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00010c40: 2020 2020 2020 2020 2023 2320 7361 7665           ## save
+00010c50: 2064 6174 6166 7261 6d65 0d0a 2020 2020   dataframe..    
+00010c60: 2020 2020 2020 2020 6466 5f73 756d 6d61          df_summa
+00010c70: 7279 2e73 6574 5f61 7869 7328 636f 6c6e  ry.set_axis(coln
+00010c80: 616d 6573 2c20 6178 6973 3d31 2c20 696e  ames, axis=1, in
+00010c90: 706c 6163 653d 5472 7565 290d 0a20 2020  place=True)..   
+00010ca0: 2020 2020 2020 2020 2064 665f 7375 6d6d           df_summ
+00010cb0: 6172 792e 746f 5f63 7376 2866 696c 655f  ary.to_csv(file_
+00010cc0: 7061 7468 5f73 6176 652c 2069 6e64 6578  path_save, index
+00010cd0: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+00010ce0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00010cf0: 2020 200d 0a20 2020 2020 2020 2023 203d     ..        # =
+00010d00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00010d10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00010d20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00010d30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00010d40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+00010d50: 2020 2020 2020 2323 206b 6572 6173 2d63        ## keras-c
+00010d60: 6e6e 2d73 656d 616e 7469 630d 0a20 2020  nn-semantic..   
+00010d70: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+00010d80: 6620 6672 616d 6577 6f72 6b3d 3d22 6b65  f framework=="ke
+00010d90: 7261 732d 636e 6e2d 7365 6d61 6e74 6963  ras-cnn-semantic
+00010da0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00010db0: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
+00010dc0: 6e6f 7461 7469 6f6e 5f74 7970 6520 3d20  notation_type = 
+00010dd0: 6b77 6172 6773 2e67 6574 2822 616e 6e6f  kwargs.get("anno
+00010de0: 7461 7469 6f6e 5f74 7970 6522 2c20 226d  tation_type", "m
+00010df0: 6173 6b22 290d 0a20 2020 2020 2020 2020  ask")..         
+00010e00: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00010e10: 2069 6d67 5f64 6972 203d 206f 732e 7061   img_dir = os.pa
+00010e20: 7468 2e6a 6f69 6e28 7472 6169 6e69 6e67  th.join(training
+00010e30: 5f64 6174 615f 7061 7468 2c20 2269 6d61  _data_path, "ima
+00010e40: 6765 7322 2c20 2261 6c6c 2229 0d0a 2020  ges", "all")..  
+00010e50: 2020 2020 2020 2020 2020 6d61 736b 5f64            mask_d
+00010e60: 6972 203d 206f 732e 7061 7468 2e6a 6f69  ir = os.path.joi
+00010e70: 6e28 7472 6169 6e69 6e67 5f64 6174 615f  n(training_data_
+00010e80: 7061 7468 2c20 226d 6173 6b73 222c 2022  path, "masks", "
+00010e90: 616c 6c22 290d 0a20 2020 2020 2020 2020  all")..         
+00010ea0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00010eb0: 2069 6620 6e6f 7420 6f73 2e70 6174 682e   if not os.path.
+00010ec0: 6973 6469 7228 696d 675f 6469 7229 3a0d  isdir(img_dir):.
+00010ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010ee0: 206f 732e 6d61 6b65 6469 7273 2869 6d67   os.makedirs(img
+00010ef0: 5f64 6972 290d 0a20 2020 2020 2020 2020  _dir)..         
+00010f00: 2020 2069 6620 6e6f 7420 6f73 2e70 6174     if not os.pat
+00010f10: 682e 6973 6469 7228 6d61 736b 5f64 6972  h.isdir(mask_dir
+00010f20: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00010f30: 2020 2020 6f73 2e6d 616b 6564 6972 7328      os.makedirs(
+00010f40: 6d61 736b 5f64 6972 2920 200d 0a0d 0a20  mask_dir)  .... 
+00010f50: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00010f60: 6478 2c20 6469 7270 6174 6820 696e 2065  dx, dirpath in e
+00010f70: 6e75 6d65 7261 7465 2873 656c 662e 6469  numerate(self.di
+00010f80: 725f 7061 7468 732c 2031 293a 0d0a 2020  r_paths, 1):..  
+00010f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010fa0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00010fb0: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+00010fc0: 6962 7574 6573 203d 2075 7469 6c73 5f6c  ibutes = utils_l
+00010fd0: 6f77 6c65 7665 6c2e 5f6c 6f61 645f 7961  owlevel._load_ya
+00010fe0: 6d6c 286f 732e 7061 7468 2e6a 6f69 6e28  ml(os.path.join(
+00010ff0: 6469 7270 6174 682c 2022 6174 7472 6962  dirpath, "attrib
+00011000: 7574 6573 2e79 616d 6c22 2929 2020 2020  utes.yaml"))    
+00011010: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00011020: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
+00011030: 696f 6e73 203d 2065 7870 6f72 742e 6c6f  ions = export.lo
+00011040: 6164 5f61 6e6e 6f74 6174 696f 6e28 6f73  ad_annotation(os
+00011050: 2e70 6174 682e 6a6f 696e 2864 6972 7061  .path.join(dirpa
+00011060: 7468 2c20 2261 6e6e 6f74 6174 696f 6e73  th, "annotations
+00011070: 5f22 202b 2074 6167 202b 2022 2e6a 736f  _" + tag + ".jso
+00011080: 6e22 2929 2020 2020 2020 200d 0a20 2020  n"))       ..   
+00011090: 2020 2020 2020 2020 2020 2020 2066 696c               fil
+000110a0: 656e 616d 6520 3d20 6174 7472 6962 7574  ename = attribut
+000110b0: 6573 5b22 696d 6167 655f 6f72 6967 696e  es["image_origin
+000110c0: 616c 225d 5b22 6669 6c65 6e61 6d65 225d  al"]["filename"]
+000110d0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+000110e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000110f0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00011100: 2020 2070 7269 6e74 2822 5072 6570 6172     print("Prepar
+00011110: 696e 6720 7472 6169 6e69 6e67 2064 6174  ing training dat
+00011120: 6120 666f 723a 2028 7b7d 2f7b 7d29 2022  a for: ({}/{}) "
+00011130: 2e66 6f72 6d61 7428 6964 782c 206c 656e  .format(idx, len
+00011140: 2873 656c 662e 6469 725f 7061 7468 7329  (self.dir_paths)
+00011150: 2920 2b20 6669 6c65 6e61 6d65 290d 0a0d  ) + filename)...
+00011160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011170: 2073 6861 7065 203d 2028 6174 7472 6962   shape = (attrib
+00011180: 7574 6573 5b22 696d 6167 655f 6f72 6967  utes["image_orig
+00011190: 696e 616c 225d 5b22 7769 6474 6822 5d2c  inal"]["width"],
+000111a0: 2061 7474 7269 6275 7465 735b 2269 6d61   attributes["ima
+000111b0: 6765 5f6f 7269 6769 6e61 6c22 5d5b 2268  ge_original"]["h
+000111c0: 6569 6768 7422 5d2c 2033 290d 0a20 2020  eight"], 3)..   
+000111d0: 2020 2020 2020 2020 2020 2020 206d 6173               mas
+000111e0: 6b20 3d20 6e70 2e7a 6572 6f73 2873 6861  k = np.zeros(sha
+000111f0: 7065 2c20 6474 7970 653d 2275 696e 7438  pe, dtype="uint8
+00011200: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00011210: 2020 2020 6966 206e 6f74 2061 6e6e 6f74      if not annot
+00011220: 6174 696f 6e5f 7479 7065 2069 6e20 616e  ation_type in an
+00011230: 6e6f 7461 7469 6f6e 733a 0d0a 2020 2020  notations:..    
+00011240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011250: 7072 696e 7428 224e 6f20 616e 6e6f 7461  print("No annota
+00011260: 7469 6f6e 206f 6620 7479 7065 207b 7d20  tion of type {} 
+00011270: 666f 756e 6420 696e 2064 6174 6173 6574  found in dataset
+00011280: 202d 2061 626f 7274 696e 6722 2e66 6f72   - aborting".for
+00011290: 6d61 7428 616e 6e6f 7461 7469 6f6e 5f74  mat(annotation_t
+000112a0: 7970 6529 290d 0a20 2020 2020 2020 2020  ype))..         
+000112b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000112c0: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+000112d0: 2020 2069 6620 616e 6e6f 7461 7469 6f6e     if annotation
+000112e0: 5f69 642e 5f5f 636c 6173 735f 5f2e 5f5f  _id.__class__.__
+000112f0: 6e61 6d65 5f5f 203d 3d20 224e 6f6e 6554  name__ == "NoneT
+00011300: 7970 6522 3a0d 0a20 2020 2020 2020 2020  ype":..         
+00011310: 2020 2020 2020 2020 2020 2061 6e6e 6f74             annot
+00011320: 6174 696f 6e5f 6964 203d 206d 6178 286c  ation_id = max(l
+00011330: 6973 7428 616e 6e6f 7461 7469 6f6e 735b  ist(annotations[
+00011340: 616e 6e6f 7461 7469 6f6e 5f74 7970 655d  annotation_type]
+00011350: 2e6b 6579 7328 2929 290d 0a20 2020 2020  .keys()))..     
+00011360: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00011370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011380: 206d 6173 6b20 3d20 7669 7375 616c 697a   mask = visualiz
+00011390: 6174 696f 6e2e 6472 6177 5f63 6f6e 746f  ation.draw_conto
+000113a0: 7572 2869 6d61 6765 3d6d 6173 6b2c 2061  ur(image=mask, a
+000113b0: 6e6e 6f74 6174 696f 6e73 3d61 6e6e 6f74  nnotations=annot
+000113c0: 6174 696f 6e73 2c20 636f 6e74 6f75 725f  ations, contour_
+000113d0: 6964 3d61 6e6e 6f74 6174 696f 6e5f 6964  id=annotation_id
+000113e0: 2c20 6c69 6e65 5f77 6964 7468 3d30 2c20  , line_width=0, 
+000113f0: 6c69 6e65 5f63 6f6c 6f75 723d 312c 2066  line_colour=1, f
+00011400: 696c 6c3d 3129 0d0a 2020 2020 2020 2020  ill=1)..        
+00011410: 2020 2020 2020 2020 6d61 736b 5f72 6573          mask_res
+00011420: 697a 6564 203d 2063 7632 2e72 6573 697a  ized = cv2.resiz
+00011430: 6528 6d61 736b 2c20 2869 6d67 5f73 697a  e(mask, (img_siz
+00011440: 652c 2069 6d67 5f73 697a 6529 290d 0a20  e, img_size)).. 
+00011450: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00011460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011470: 2069 6d61 6765 203d 2075 7469 6c73 2e6c   image = utils.l
+00011480: 6f61 645f 696d 6167 6528 6469 7270 6174  oad_image(dirpat
+00011490: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
+000114a0: 2020 2020 696d 6167 655f 7265 7369 7a65      image_resize
+000114b0: 6420 3d20 6376 322e 7265 7369 7a65 2869  d = cv2.resize(i
+000114c0: 6d61 6765 2c20 2869 6d67 5f73 697a 652c  mage, (img_size,
+000114d0: 2069 6d67 5f73 697a 6529 290d 0a20 2020   img_size))..   
+000114e0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+000114f0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00011500: 7469 6c73 2e73 6176 655f 696d 6167 6528  tils.save_image(
+00011510: 696d 6167 655f 7265 7369 7a65 642c 2064  image_resized, d
+00011520: 6972 5f70 6174 683d 696d 675f 6469 722c  ir_path=img_dir,
+00011530: 2066 696c 655f 6e61 6d65 3d66 696c 656e   file_name=filen
+00011540: 616d 652c 2065 7874 3d22 706e 6722 290d  ame, ext="png").
+00011550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011560: 2075 7469 6c73 2e73 6176 655f 696d 6167   utils.save_imag
+00011570: 6528 6d61 736b 5f72 6573 697a 6564 2c20  e(mask_resized, 
+00011580: 6469 725f 7061 7468 3d6d 6173 6b5f 6469  dir_path=mask_di
+00011590: 722c 2066 696c 655f 6e61 6d65 3d66 696c  r, file_name=fil
+000115a0: 656e 616d 652c 2065 7874 3d22 706e 6722  ename, ext="png"
+000115b0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+000115c0: 200d 0a0d 0a63 6c61 7373 2050 7970 6528   ....class Pype(
+000115d0: 6f62 6a65 6374 293a 0d0a 2020 2020 2222  object):..    ""
+000115e0: 220d 0a20 2020 2054 6865 2070 7970 6520  "..    The pype 
+000115f0: 6973 2070 6865 6e6f 7079 7065 e280 9973  is phenopype...s
+00011600: 2063 6f72 6520 6d65 7468 6f64 2074 6861   core method tha
+00011610: 7420 616c 6c6f 7773 2072 756e 6e69 6e67  t allows running
+00011620: 2061 6c6c 2066 756e 6374 696f 6e73 200d   all functions .
+00011630: 0a20 2020 2074 6861 7420 6172 6520 6176  .    that are av
+00011640: 6169 6c61 626c 6520 696e 2074 6865 2070  ailable in the p
+00011650: 726f 6772 616d e280 9973 206c 6962 7261  rogram...s libra
+00011660: 7279 2069 6e20 7365 7175 656e 6365 2e20  ry in sequence. 
+00011670: 5573 6572 7320 6361 6e20 6578 6563 7574  Users can execut
+00011680: 6520 0d0a 2020 2020 7468 6520 7079 7065  e ..    the pype
+00011690: 206d 6574 686f 6420 6f6e 2061 2066 696c   method on a fil
+000116a0: 655f 7061 7468 2c20 616e 2061 7272 6179  e_path, an array
+000116b0: 2c20 6f72 2061 2070 6865 6e6f 7079 7065  , or a phenopype
+000116c0: 2064 6972 6563 746f 7279 2c20 7768 6963   directory, whic
+000116d0: 6820 0d0a 2020 2020 616c 7761 7973 2077  h ..    always w
+000116e0: 696c 6c20 7472 6967 6765 7220 7468 7265  ill trigger thre
+000116f0: 6520 6163 7469 6f6e 733a 0d0a 0d0a 2020  e actions:....  
+00011700: 2020 312e 206f 7065 6e20 7468 6520 636f    1. open the co
+00011710: 6e74 6169 6e65 6420 7961 6d6c 2063 6f6e  ntained yaml con
+00011720: 6669 6775 7261 7469 6f6e 2077 6974 6820  figuration with 
+00011730: 7468 6520 6465 6661 756c 7420 4f53 2074  the default OS t
+00011740: 6578 7420 6564 6974 6f72 0d0a 2020 2020  ext editor..    
+00011750: 322e 2070 6172 7365 2074 6865 2063 6f6e  2. parse the con
+00011760: 7461 696e 6564 2066 756e 6374 696f 6e73  tained functions
+00011770: 2061 6e64 2065 7865 6375 7465 2074 6865   and execute the
+00011780: 6d20 696e 2074 6865 2073 6571 7565 6e63  m in the sequenc
+00011790: 6520 2865 7863 6570 7469 6f6e 730d 0a20  e (exceptions.. 
+000117a0: 2020 2020 2020 7769 6c6c 2062 6520 7061        will be pa
+000117b0: 7373 6564 2c20 6275 7420 7265 7475 726e  ssed, but return
+000117c0: 6564 2066 6f72 2064 6961 676e 6f73 7469  ed for diagnosti
+000117d0: 6373 290d 0a20 2020 2033 2e20 6f70 656e  cs)..    3. open
+000117e0: 2061 2050 7974 686f 6e2d 7769 6e64 6f77   a Python-window
+000117f0: 2073 686f 7769 6e67 2074 6865 2070 726f   showing the pro
+00011800: 6365 7373 6564 2069 6d61 6765 2e0d 0a20  cessed image... 
+00011810: 2020 200d 0a20 2020 2041 6674 6572 206f     ..    After o
+00011820: 6e65 2069 7465 7261 7469 6f6e 206f 6620  ne iteration of 
+00011830: 7468 6573 6520 7374 6570 732c 2075 7365  these steps, use
+00011840: 7273 2063 616e 2065 7661 6c75 6174 6520  rs can evaluate 
+00011850: 7468 6520 7265 7375 6c74 7320 616e 6420  the results and 
+00011860: 6465 6369 6465 0d0a 2020 2020 746f 206d  decide..    to m
+00011870: 6f64 6966 7920 7468 6520 6f70 656e 6564  odify the opened
+00011880: 2063 6f6e 6669 6775 7261 7469 6f6e 2066   configuration f
+00011890: 696c 6520 2865 2e67 2e20 6569 7468 6572  ile (e.g. either
+000118a0: 2063 6861 6e67 6520 6675 6e63 7469 6f6e   change function
+000118b0: 2070 6172 616d 6574 6572 7320 6f72 200d   parameters or .
+000118c0: 0a20 2020 2061 6464 206e 6577 2066 756e  .    add new fun
+000118d0: 6374 696f 6e73 292c 2061 6e64 2072 756e  ctions), and run
+000118e0: 2074 6865 2070 7970 6520 6167 6169 6e2c   the pype again,
+000118f0: 206f 7220 746f 2074 6572 6d69 6e61 7465   or to terminate
+00011900: 2074 6865 2070 7970 6520 616e 6420 0d0a   the pype and ..
+00011910: 2020 2020 7361 7665 2061 6c6c 2072 6573      save all res
+00011920: 756c 7473 2e20 5468 6520 7072 6f63 6573  ults. The proces
+00011930: 7365 6420 696d 6167 652c 2061 6e79 2065  sed image, any e
+00011940: 7874 7261 6374 6564 2070 6865 6e6f 7479  xtracted phenoty
+00011950: 7069 6320 696e 666f 726d 6174 696f 6e2c  pic information,
+00011960: 200d 0a20 2020 2061 7320 7765 6c6c 2061   ..    as well a
+00011970: 7320 7468 6520 6d6f 6469 6669 6564 2063  s the modified c
+00011980: 6f6e 6669 672d 6669 6c65 2069 7320 7374  onfig-file is st
+00011990: 6f72 6564 2069 6e73 6964 6520 7468 6520  ored inside the 
+000119a0: 696d 6167 6520 6469 7265 6374 6f72 792c  image directory,
+000119b0: 206f 720d 0a20 2020 2061 2075 7365 722d   or..    a user-
+000119c0: 7370 6563 6966 6965 6420 6469 7265 6374  specified direct
+000119d0: 6f72 792e 2042 7920 7072 6f76 6964 696e  ory. By providin
+000119e0: 6720 756e 6971 7565 206e 616d 6573 2c20  g unique names, 
+000119f0: 7573 6572 7320 6361 6e20 7374 6f72 6520  users can store 
+00011a00: 6469 6666 6572 656e 740d 0a20 2020 2070  different..    p
+00011a10: 7970 6520 636f 6e66 6967 7572 6174 696f  ype configuratio
+00011a20: 6e73 2061 6e64 2074 6865 2061 7373 6f63  ns and the assoc
+00011a30: 6961 7465 6420 7265 7375 6c74 7320 7369  iated results si
+00011a40: 6465 2062 7920 7369 6465 2e20 0d0a 2020  de by side. ..  
+00011a50: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
+00011a60: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
+00011a70: 2d2d 0d0a 0d0a 2020 2020 696d 6167 653a  --....    image:
+00011a80: 2061 7272 6179 206f 7220 7374 7220 0d0a   array or str ..
+00011a90: 2020 2020 2020 2020 6361 6e20 6265 2065          can be e
+00011aa0: 6974 6865 7220 6120 6e75 6d70 7920 6172  ither a numpy ar
+00011ab0: 7261 7920 6f72 2061 2073 7472 696e 6720  ray or a string 
+00011ac0: 7468 6174 2070 726f 7669 6465 7320 7468  that provides th
+00011ad0: 6520 7061 7468 2074 6f20 0d0a 2020 2020  e path to ..    
+00011ae0: 2020 2020 736f 7572 6365 2069 6d61 6765      source image
+00011af0: 2066 696c 6520 6f72 2070 6174 6820 746f   file or path to
+00011b00: 2061 2076 616c 6964 2070 6865 6e6f 7079   a valid phenopy
+00011b10: 7065 2064 6972 6563 746f 7279 0d0a 2020  pe directory..  
+00011b20: 2020 6e61 6d65 3a20 7374 720d 0a20 2020    name: str..   
+00011b30: 2020 2020 206e 616d 6520 6f66 2070 7970       name of pyp
+00011b40: 652d 636f 6e66 6967 202d 2077 696c 6c20  e-config - will 
+00011b50: 6265 2061 7070 656e 6465 6420 746f 2061  be appended to a
+00011b60: 6c6c 2072 6573 756c 7473 2066 696c 6573  ll results files
+00011b70: 0d0a 2020 2020 636f 6e66 6967 5f74 656d  ..    config_tem
+00011b80: 706c 6174 653a 2073 7472 2c20 6f70 7469  plate: str, opti
+00011b90: 6f6e 616c 0d0a 2020 2020 2020 2020 6368  onal..        ch
+00011ba0: 6f73 6520 6672 6f6d 206c 6973 7420 6f66  ose from list of
+00011bb0: 2070 726f 7669 6465 6420 7465 6d70 6c61   provided templa
+00011bc0: 7465 7320 200d 0a20 2020 2020 2020 2028  tes  ..        (
+00011bd0: 652e 672e 2065 7831 2c20 6578 322c 202e  e.g. ex1, ex2, .
+00011be0: 2e2e 290d 0a20 2020 2063 6f6e 6669 675f  ..)..    config_
+00011bf0: 7061 7468 3a20 7374 722c 206f 7074 696f  path: str, optio
+00011c00: 6e61 6c0d 0a20 2020 2020 2020 2063 7573  nal..        cus
+00011c10: 746f 6d20 7061 7468 2074 6f20 6120 7079  tom path to a py
+00011c20: 7065 2074 656d 706c 6174 6520 286e 6565  pe template (nee
+00011c30: 6473 2074 6f20 6164 6865 7265 2079 616d  ds to adhere yam
+00011c40: 6c20 7379 6e74 6178 2061 6e64 200d 0a20  l syntax and .. 
+00011c50: 2020 2020 2020 2070 6865 6e6f 7079 7065         phenopype
+00011c60: 2073 7472 7563 7475 7265 290d 0a20 2020   structure)..   
+00011c70: 2064 656c 6179 3a20 696e 742c 206f 7074   delay: int, opt
+00011c80: 696f 6e61 6c0d 0a20 2020 2020 2020 2074  ional..        t
+00011c90: 696d 6520 696e 206d 7320 746f 2061 6464  ime in ms to add
+00011ca0: 2062 6574 7765 656e 2072 656c 6f61 6420   between reload 
+00011cb0: 6174 7465 6d70 7320 6f66 2079 616d 6c20  attemps of yaml 
+00011cc0: 6d6f 6e69 746f 722e 2069 6e63 7265 6173  monitor. increas
+00011cd0: 6520 7468 6973 200d 0a20 2020 2020 2020  e this ..       
+00011ce0: 2076 616c 7565 2069 6620 7361 7665 6420   value if saved 
+00011cf0: 6368 616e 6765 7320 696e 2063 6f6e 6669  changes in confi
+00011d00: 6720 6669 6c65 2061 7265 206e 6f74 2070  g file are not p
+00011d10: 6172 7365 6420 696e 2074 6865 2066 6972  arsed in the fir
+00011d20: 7374 2061 7474 656d 7074 2e0d 0a20 2020  st attempt...   
+00011d30: 2064 6972 5f70 6174 683a 2073 7472 2c20   dir_path: str, 
+00011d40: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00011d50: 2020 7061 7468 2074 6f20 616e 2065 7869    path to an exi
+00011d60: 7374 696e 6720 6469 7265 6374 6f72 7920  sting directory 
+00011d70: 7768 6572 6520 616c 6c20 6f75 7470 7574  where all output
+00011d80: 2073 686f 756c 6420 6265 2073 746f 7265   should be store
+00011d90: 640d 0a20 2020 2073 6b69 703a 2062 6f6f  d..    skip: boo
+00011da0: 6c2c 206f 7074 696f 6e61 6c0d 0a20 2020  l, optional..   
+00011db0: 2020 2020 2073 6b69 7020 6469 7265 6374       skip direct
+00011dc0: 6f72 6965 7320 7468 6174 2061 6c72 6561  ories that alrea
+00011dd0: 6479 2068 6176 6520 226e 616d 6522 2061  dy have "name" a
+00011de0: 7320 6120 7375 6666 6978 2069 6e20 7468  s a suffix in th
+00011df0: 6520 6669 6c65 6e61 6d65 0d0a 2020 2020  e filename..    
+00011e00: 6665 6564 6261 636b 3a20 626f 6f6c 2c20  feedback: bool, 
+00011e10: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00011e20: 2020 646f 6e27 7420 6f70 656e 2074 6578    don't open tex
+00011e30: 7420 6564 6974 6f72 206f 7220 7769 6e64  t editor or wind
+00011e40: 6f77 2c20 6a75 7374 2061 7070 6c79 2066  ow, just apply f
+00011e50: 756e 6374 696f 6e73 2061 6e64 2074 6572  unctions and ter
+00011e60: 6d69 6e61 7465 0d0a 2020 2020 6d61 785f  minate..    max_
+00011e70: 6469 6d3a 2069 6e74 2c20 6f70 7469 6f6e  dim: int, option
+00011e80: 616c 0d0a 2020 2020 2020 2020 6d61 7869  al..        maxi
+00011e90: 6d75 6d20 6469 6d65 6e73 696f 6e20 7468  mum dimension th
+00011ea0: 6174 2077 696e 646f 7720 6361 6e20 6861  at window can ha
+00011eb0: 7665 200d 0a20 2020 206b 7761 7267 733a  ve ..    kwargs:
+00011ec0: 200d 0a20 2020 2020 2020 2064 6576 656c   ..        devel
+00011ed0: 6f70 6572 206f 7074 696f 6e73 0d0a 2020  oper options..  
+00011ee0: 2020 2222 220d 0a0d 0a20 2020 2064 6566    """....    def
+00011ef0: 205f 5f69 6e69 745f 5f28 0d0a 2020 2020   __init__(..    
+00011f00: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
+00011f10: 2020 2069 6d61 6765 5f70 6174 682c 0d0a     image_path,..
+00011f20: 2020 2020 2020 2020 7461 672c 0d0a 2020          tag,..  
+00011f30: 2020 2020 2020 636f 6e66 6967 5f70 6174        config_pat
+00011f40: 683d 4e6f 6e65 2c0d 0a20 2020 2020 2020  h=None,..       
+00011f50: 2073 6b69 703d 4661 6c73 652c 0d0a 2020   skip=False,..  
+00011f60: 2020 2020 2020 6175 746f 6c6f 6164 3d54        autoload=T
+00011f70: 7275 652c 0d0a 2020 2020 2020 2020 6175  rue,..        au
+00011f80: 746f 7361 7665 3d54 7275 652c 0d0a 2020  tosave=True,..  
+00011f90: 2020 2020 2020 6175 746f 7368 6f77 3d54        autoshow=T
+00011fa0: 7275 652c 0d0a 2020 2020 2020 2020 6669  rue,..        fi
+00011fb0: 785f 6e61 6d65 733d 5472 7565 2c0d 0a20  x_names=True,.. 
+00011fc0: 2020 2020 2020 2066 6565 6462 6163 6b3d         feedback=
+00011fd0: 5472 7565 2c0d 0a20 2020 2020 2020 206c  True,..        l
+00011fe0: 6f61 645f 636f 6e74 6f75 7273 3d46 616c  oad_contours=Fal
+00011ff0: 7365 2c0d 0a20 2020 2020 2020 207a 6f6f  se,..        zoo
+00012000: 6d5f 6d65 6d6f 7279 3d46 616c 7365 2c0d  m_memory=False,.
+00012010: 0a20 2020 2020 2020 2064 6562 7567 3d46  .        debug=F
+00012020: 616c 7365 2c0d 0a20 2020 2020 2020 202a  alse,..        *
+00012030: 2a6b 7761 7267 730d 0a20 2020 2029 3a0d  *kwargs..    ):.
+00012040: 0a0d 0a20 2020 2020 2020 2023 203d 3d3d  ...        # ===
+00012050: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012060: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012070: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012080: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012090: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
+000120a0: 2020 2020 2320 4348 4543 4b53 2026 2049      # CHECKS & I
+000120b0: 4e49 540d 0a20 2020 2020 2020 2023 203d  NIT..        # =
+000120c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000120d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000120e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000120f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012100: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a  ============....
+00012110: 2020 2020 2020 2020 2323 206b 7761 7267          ## kwarg
+00012120: 730d 0a20 2020 2020 2020 2067 6c6f 6261  s..        globa
+00012130: 6c20 7769 6e64 6f77 5f6d 6178 5f64 696d  l window_max_dim
+00012140: 0d0a 2020 2020 2020 2020 7769 6e64 6f77  ..        window
+00012150: 5f6d 6178 5f64 696d 203d 206b 7761 7267  _max_dim = kwarg
+00012160: 732e 6765 7428 2277 696e 646f 775f 6d61  s.get("window_ma
+00012170: 785f 6469 6d22 290d 0a20 2020 2020 2020  x_dim")..       
+00012180: 2064 656c 6179 203d 206b 7761 7267 732e   delay = kwargs.
+00012190: 6765 7428 2264 656c 6179 222c 2035 3030  get("delay", 500
+000121a0: 290d 0a20 2020 2020 2020 2073 6c65 6570  )..        sleep
+000121b0: 203d 206b 7761 7267 732e 6765 7428 2273   = kwargs.get("s
+000121c0: 6c65 6570 222c 2030 2e32 290d 0a0d 0a20  leep", 0.2).... 
+000121d0: 2020 2020 2020 2023 2320 666c 6167 730d         ## flags.
+000121e0: 0a20 2020 2020 2020 2073 656c 662e 666c  .        self.fl
+000121f0: 6167 7320 3d20 6d61 6b65 5f64 6174 6163  ags = make_datac
+00012200: 6c61 7373 280d 0a20 2020 2020 2020 2020  lass(..         
+00012210: 2020 2063 6c73 5f6e 616d 653d 2266 6c61     cls_name="fla
+00012220: 6773 222c 0d0a 2020 2020 2020 2020 2020  gs",..          
+00012230: 2020 6669 656c 6473 3d5b 0d0a 2020 2020    fields=[..    
+00012240: 2020 2020 2020 2020 2020 2020 2822 6465              ("de
+00012250: 6275 6722 2c20 626f 6f6c 2c20 6465 6275  bug", bool, debu
+00012260: 6729 2c0d 0a20 2020 2020 2020 2020 2020  g),..           
+00012270: 2020 2020 2028 2261 7574 6f6c 6f61 6422       ("autoload"
+00012280: 2c20 626f 6f6c 2c20 6175 746f 6c6f 6164  , bool, autoload
+00012290: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+000122a0: 2020 2020 2822 6175 746f 7361 7665 222c      ("autosave",
+000122b0: 2062 6f6f 6c2c 2061 7574 6f73 6176 6529   bool, autosave)
+000122c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000122d0: 2020 2028 2261 7574 6f73 686f 7722 2c20     ("autoshow", 
+000122e0: 626f 6f6c 2c20 6175 746f 7368 6f77 292c  bool, autoshow),
+000122f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012300: 2020 2822 6665 6564 6261 636b 222c 2062    ("feedback", b
+00012310: 6f6f 6c2c 2066 6565 6462 6163 6b29 2c0d  ool, feedback),.
+00012320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012330: 2028 2266 6978 5f6e 616d 6573 222c 2062   ("fix_names", b
+00012340: 6f6f 6c2c 2066 6978 5f6e 616d 6573 292c  ool, fix_names),
+00012350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012360: 2020 2822 736b 6970 222c 2062 6f6f 6c2c    ("skip", bool,
+00012370: 2073 6b69 7029 2c0d 0a20 2020 2020 2020   skip),..       
+00012380: 2020 2020 2020 2020 2028 227a 6f6f 6d5f           ("zoom_
+00012390: 6d65 6d6f 7279 222c 2062 6f6f 6c2c 207a  memory", bool, z
+000123a0: 6f6f 6d5f 6d65 6d6f 7279 292c 0d0a 2020  oom_memory),..  
+000123b0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+000123c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123d0: 2822 6472 795f 7275 6e22 2c20 626f 6f6c  ("dry_run", bool
+000123e0: 2c20 6b77 6172 6773 2e67 6574 2822 6472  , kwargs.get("dr
+000123f0: 795f 7275 6e22 2c20 4661 6c73 6529 292c  y_run", False)),
+00012400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012410: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00012420: 2020 2020 2822 7465 726d 696e 6174 6522      ("terminate"
+00012430: 2c20 626f 6f6c 2c20 4661 6c73 6529 2c0d  , bool, False),.
+00012440: 0a20 2020 2020 2020 2020 2020 205d 2c0d  .            ],.
+00012450: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
+00012460: 2020 2020 0d0a 2020 2020 2020 2020 2323      ..        ##
+00012470: 2064 6f6e 2774 2061 7574 6f73 686f 7720   don't autoshow 
+00012480: 6966 2066 6565 6462 6163 6b20 6973 206f  if feedback is o
+00012490: 6666 0d0a 2020 2020 2020 2020 6966 206e  ff..        if n
+000124a0: 6f74 2073 656c 662e 666c 6167 732e 6665  ot self.flags.fe
+000124b0: 6564 6261 636b 3a0d 0a20 2020 2020 2020  edback:..       
+000124c0: 2020 2020 2073 656c 662e 666c 6167 732e       self.flags.
+000124d0: 6175 746f 7368 6f77 203d 2046 616c 7365  autoshow = False
+000124e0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000124f0: 2020 2020 6966 2069 6d61 6765 5f70 6174      if image_pat
+00012500: 682e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  h.__class__.__na
+00012510: 6d65 5f5f 203d 3d20 2273 7472 223a 0d0a  me__ == "str":..
+00012520: 2020 2020 2020 2020 2020 2020 696d 6167              imag
+00012530: 655f 7061 7468 203d 206f 732e 7061 7468  e_path = os.path
+00012540: 2e61 6273 7061 7468 2869 6d61 6765 5f70  .abspath(image_p
+00012550: 6174 6829 0d0a 0d0a 2020 2020 2020 2020  ath)....        
+00012560: 2323 2063 6865 636b 206e 616d 652c 206c  ## check name, l
+00012570: 6f61 6420 636f 6e74 6169 6e65 7220 616e  oad container an
+00012580: 6420 636f 6e66 6967 0d0a 2020 2020 2020  d config..      
+00012590: 2020 7574 696c 735f 6c6f 776c 6576 656c    utils_lowlevel
+000125a0: 2e5f 6368 6563 6b5f 7079 7065 5f74 6167  ._check_pype_tag
+000125b0: 2874 6167 290d 0a20 2020 2020 2020 2073  (tag)..        s
+000125c0: 656c 662e 5f6c 6f61 645f 636f 6e74 6169  elf._load_contai
+000125d0: 6e65 7228 696d 6167 655f 7061 7468 3d69  ner(image_path=i
+000125e0: 6d61 6765 5f70 6174 682c 2074 6167 3d74  mage_path, tag=t
+000125f0: 6167 290d 0a20 2020 2020 2020 2073 656c  ag)..        sel
+00012600: 662e 5f6c 6f61 645f 7079 7065 5f63 6f6e  f._load_pype_con
+00012610: 6669 6728 696d 6167 655f 7061 7468 3d69  fig(image_path=i
+00012620: 6d61 6765 5f70 6174 682c 2074 6167 3d74  mage_path, tag=t
+00012630: 6167 2c20 636f 6e66 6967 5f70 6174 683d  ag, config_path=
+00012640: 636f 6e66 6967 5f70 6174 6829 0d0a 0d0a  config_path)....
+00012650: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
+00012660: 7665 7273 696f 6e2c 206c 6f61 6420 636f  version, load co
+00012670: 6e74 6169 6e65 7220 616e 6420 636f 6e66  ntainer and conf
+00012680: 6967 0d0a 2020 2020 2020 2020 6966 2073  ig..        if s
+00012690: 656c 662e 666c 6167 732e 6472 795f 7275  elf.flags.dry_ru
+000126a0: 6e3a 0d0a 2020 2020 2020 2020 2020 2020  n:..            
+000126b0: 7365 6c66 2e5f 6c6f 6164 5f70 7970 655f  self._load_pype_
+000126c0: 636f 6e66 6967 2869 6d61 6765 5f70 6174  config(image_pat
+000126d0: 682c 2074 6167 2c20 636f 6e66 6967 5f70  h, tag, config_p
+000126e0: 6174 6829 0d0a 2020 2020 2020 2020 2020  ath)..          
+000126f0: 2020 7365 6c66 2e5f 6974 6572 6174 6528    self._iterate(
+00012700: 636f 6e66 6967 3d73 656c 662e 636f 6e66  config=self.conf
+00012710: 6967 2c20 616e 6e6f 7461 7469 6f6e 733d  ig, annotations=
+00012720: 636f 7079 2e64 6565 7063 6f70 7928 7365  copy.deepcopy(se
+00012730: 7474 696e 6773 2e5f 616e 6e6f 7461 7469  ttings._annotati
+00012740: 6f6e 5f74 7970 6573 292c 0d0a 2020 2020  on_types),..    
+00012750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012760: 2020 6578 6563 7574 653d 4661 6c73 652c    execute=False,
+00012770: 2061 7574 6f73 686f 773d 4661 6c73 652c   autoshow=False,
+00012780: 2066 6565 6462 6163 6b3d 5472 7565 290d   feedback=True).
+00012790: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000127a0: 7572 6e0d 0a0d 0a20 2020 2020 2020 2023  urn....        #
+000127b0: 2320 6368 6563 6b20 7768 6574 6865 7220  # check whether 
+000127c0: 6469 7265 6374 6f72 7920 6973 2073 6b69  directory is ski
+000127d0: 7070 6564 0d0a 2020 2020 2020 2020 6966  pped..        if
+000127e0: 2073 656c 662e 666c 6167 732e 736b 6970   self.flags.skip
+000127f0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00012800: 6620 7365 6c66 2e5f 6368 6563 6b5f 6469  f self._check_di
+00012810: 7265 6374 6f72 795f 736b 6970 280d 0a20  rectory_skip(.. 
+00012820: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00012830: 6167 3d74 6167 2c20 736b 6970 5f70 6174  ag=tag, skip_pat
+00012840: 7465 726e 3d73 6b69 702c 2064 6972 5f70  tern=skip, dir_p
+00012850: 6174 683d 7365 6c66 2e63 6f6e 7461 696e  ath=self.contain
+00012860: 6572 2e64 6972 5f70 6174 680d 0a20 2020  er.dir_path..   
+00012870: 2020 2020 2020 2020 2029 3a0d 0a20 2020           ):..   
+00012880: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00012890: 7572 6e0d 0a0d 0a20 2020 2020 2020 2023  urn....        #
+000128a0: 2320 6c6f 6164 2065 7869 7374 696e 6720  # load existing 
+000128b0: 616e 6e6f 7461 7469 6f6e 7320 7468 726f  annotations thro
+000128c0: 7567 6820 636f 6e74 6169 6e65 720d 0a20  ugh container.. 
+000128d0: 2020 2020 2020 2069 6620 7365 6c66 2e66         if self.f
+000128e0: 6c61 6773 2e61 7574 6f6c 6f61 643a 0d0a  lags.autoload:..
+000128f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012900: 2e63 6f6e 7461 696e 6572 2e6c 6f61 6428  .container.load(
+00012910: 636f 6e74 6f75 7273 3d6c 6f61 645f 636f  contours=load_co
+00012920: 6e74 6f75 7273 290d 0a0d 0a20 2020 2020  ntours)....     
+00012930: 2020 2023 2320 6368 6563 6b20 7079 7065     ## check pype
+00012940: 2063 6f6e 6669 6720 666f 7220 616e 6e6f   config for anno
+00012950: 7461 7469 6f6e 730d 0a20 2020 2020 2020  tations..       
+00012960: 2073 656c 662e 5f69 7465 7261 7465 280d   self._iterate(.
+00012970: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00012980: 6669 673d 7365 6c66 2e63 6f6e 6669 672c  fig=self.config,
+00012990: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
+000129a0: 6e6f 7461 7469 6f6e 733d 7365 6c66 2e63  notations=self.c
+000129b0: 6f6e 7461 696e 6572 2e61 6e6e 6f74 6174  ontainer.annotat
+000129c0: 696f 6e73 2c0d 0a20 2020 2020 2020 2020  ions,..         
+000129d0: 2020 2065 7865 6375 7465 3d46 616c 7365     execute=False
+000129e0: 2c0d 0a20 2020 2020 2020 2020 2020 2061  ,..            a
+000129f0: 7574 6f73 686f 773d 4661 6c73 652c 0d0a  utoshow=False,..
+00012a00: 2020 2020 2020 2020 2020 2020 6665 6564              feed
+00012a10: 6261 636b 3d46 616c 7365 2c0d 0a20 2020  back=False,..   
+00012a20: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00012a30: 7469 6d65 2e73 6c65 6570 2873 6c65 6570  time.sleep(sleep
+00012a40: 290d 0a0d 0a20 2020 2020 2020 2023 2320  )....        ## 
+00012a50: 6669 6e61 6c20 6368 6563 6b20 6265 666f  final check befo
+00012a60: 7265 2073 7461 7274 696e 6720 7079 7065  re starting pype
+00012a70: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00012a80: 6368 6563 6b5f 6669 6e61 6c28 290d 0a0d  check_final()...
+00012a90: 0a20 2020 2020 2020 2023 206f 7065 6e20  .        # open 
+00012aa0: 636f 6e66 6967 2066 696c 6520 7769 7468  config file with
+00012ab0: 2073 7973 7465 6d20 7669 6577 6572 0d0a   system viewer..
+00012ac0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00012ad0: 666c 6167 732e 6665 6564 6261 636b 2061  flags.feedback a
+00012ae0: 6e64 2073 656c 662e 666c 6167 732e 6175  nd self.flags.au
+00012af0: 746f 7368 6f77 3a0d 0a20 2020 2020 2020  toshow:..       
+00012b00: 2020 2020 2073 656c 662e 5f73 7461 7274       self._start
+00012b10: 5f66 696c 655f 6d6f 6e69 746f 7228 6465  _file_monitor(de
+00012b20: 6c61 793d 6465 6c61 7929 0d0a 0d0a 2020  lay=delay)....  
+00012b30: 2020 2020 2020 2323 2073 7461 7274 206c        ## start l
+00012b40: 6f67 0d0a 2020 2020 2020 2020 7365 6c66  og..        self
+00012b50: 2e6c 6f67 203d 205b 5d0d 0a0d 0a20 2020  .log = []....   
+00012b60: 2020 2020 2023 2320 636c 6561 7220 6f6c       ## clear ol
+00012b70: 6420 7a6f 6f6d 206d 656d 6f72 790d 0a20  d zoom memory.. 
+00012b80: 2020 2020 2020 205f 636f 6e66 6967 2e67         _config.g
+00012b90: 7569 5f7a 6f6f 6d5f 636f 6e66 6967 203d  ui_zoom_config =
+00012ba0: 204e 6f6e 650d 0a0d 0a20 2020 2020 2020   None....       
+00012bb0: 2023 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   # =============
+00012bc0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012bd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012be0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012bf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012c00: 0d0a 2020 2020 2020 2020 2320 5059 5045  ..        # PYPE
+00012c10: 204c 4f4f 500d 0a20 2020 2020 2020 2023   LOOP..        #
+00012c20: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00012c30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012c40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012c50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012c60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+00012c70: 0d0a 2020 2020 2020 2020 2323 2072 756e  ..        ## run
+00012c80: 2070 7970 650d 0a20 2020 2020 2020 2077   pype..        w
+00012c90: 6869 6c65 2054 7275 653a 0d0a 0d0a 2020  hile True:....  
+00012ca0: 2020 2020 2020 2020 2020 2323 2070 7970            ## pyp
+00012cb0: 6520 7265 7374 6172 7420 666c 6167 0d0a  e restart flag..
+00012cc0: 2020 2020 2020 2020 2020 2020 5f63 6f6e              _con
+00012cd0: 6669 672e 7079 7065 5f72 6573 7461 7274  fig.pype_restart
+00012ce0: 203d 2046 616c 7365 0d0a 0d0a 2020 2020   = False....    
+00012cf0: 2020 2020 2020 2020 2323 2072 6566 7265          ## refre
+00012d00: 7368 2063 6f6e 6669 670d 0a20 2020 2020  sh config..     
+00012d10: 2020 2020 2020 2069 6620 7365 6c66 2e66         if self.f
+00012d20: 6c61 6773 2e66 6565 6462 6163 6b20 616e  lags.feedback an
+00012d30: 6420 7365 6c66 2e66 6c61 6773 2e61 7574  d self.flags.aut
+00012d40: 6f73 686f 773a 0d0a 0d0a 2020 2020 2020  oshow:....      
+00012d50: 2020 2020 2020 2020 2020 2323 2074 6f20            ## to 
+00012d60: 7374 6f70 2069 6e66 696e 6974 6520 6c6f  stop infinite lo
+00012d70: 6f70 2077 6974 686f 7574 206f 7065 6e69  op without openi
+00012d80: 6e67 206e 6577 2077 696e 646f 770d 0a20  ng new window.. 
+00012d90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00012da0: 6620 6e6f 7420 7365 6c66 2e59 464d 2e63  f not self.YFM.c
+00012db0: 6f6e 7465 6e74 3a0d 0a20 2020 2020 2020  ontent:..       
+00012dc0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00012dd0: 6e74 2822 2d20 5354 494c 4c20 5550 4441  nt("- STILL UPDA
+00012de0: 5449 4e47 2043 4f4e 4649 4720 286e 6f20  TING CONFIG (no 
+00012df0: 636f 6e74 656e 7429 2229 0d0a 2020 2020  content)")..    
+00012e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012e10: 6376 322e 6465 7374 726f 7957 696e 646f  cv2.destroyWindo
+00012e20: 7728 2270 6865 6e6f 7079 7065 2229 0d0a  w("phenopype")..
+00012e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012e40: 2020 2020 7469 6d65 2e73 6c65 6570 2831      time.sleep(1
+00012e50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00012e60: 2020 2020 2020 2073 656c 662e 5946 4d2e         self.YFM.
+00012e70: 5f73 746f 7028 290d 0a20 2020 2020 2020  _stop()..       
+00012e80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012e90: 662e 5f73 7461 7274 5f66 696c 655f 6d6f  f._start_file_mo
+00012ea0: 6e69 746f 7228 6465 6c61 793d 6465 6c61  nitor(delay=dela
+00012eb0: 7929 0d0a 2020 2020 2020 2020 2020 2020  y)..            
+00012ec0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+00012ed0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00012ee0: 2020 2020 7365 6c66 2e63 6f6e 6669 6720      self.config 
+00012ef0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00012f00: 7365 6c66 2e59 464d 2e63 6f6e 7465 6e74  self.YFM.content
+00012f10: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00012f20: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00012f30: 2e63 6f6e 6669 673a 0d0a 2020 2020 2020  .config:..      
+00012f40: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00012f50: 696e 7428 222d 2053 5449 4c4c 2055 5044  int("- STILL UPD
+00012f60: 4154 494e 4720 434f 4e46 4947 2028 6e6f  ATING CONFIG (no
+00012f70: 2063 6f6e 6669 6729 2229 0d0a 2020 2020   config)")..    
+00012f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f90: 636f 6e74 696e 7565 0d0a 0d0a 2020 2020  continue....    
+00012fa0: 2020 2020 2020 2020 2323 2072 756e 2070          ## run p
+00012fb0: 7970 6520 636f 6e66 6967 2069 6e20 7365  ype config in se
+00012fc0: 7175 656e 6365 0d0a 2020 2020 2020 2020  quence..        
+00012fd0: 2020 2020 7365 6c66 2e5f 6974 6572 6174      self._iterat
+00012fe0: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
+00012ff0: 2020 2020 636f 6e66 6967 3d73 656c 662e      config=self.
+00013000: 636f 6e66 6967 2c0d 0a20 2020 2020 2020  config,..       
+00013010: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
+00013020: 696f 6e73 3d73 656c 662e 636f 6e74 6169  ions=self.contai
+00013030: 6e65 722e 616e 6e6f 7461 7469 6f6e 732c  ner.annotations,
+00013040: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013050: 2020 6665 6564 6261 636b 3d73 656c 662e    feedback=self.
+00013060: 666c 6167 732e 6665 6564 6261 636b 2c0d  flags.feedback,.
+00013070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013080: 2061 7574 6f73 686f 773d 7365 6c66 2e66   autoshow=self.f
+00013090: 6c61 6773 2e61 7574 6f73 686f 772c 0d0a  lags.autoshow,..
+000130a0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
+000130b0: 0a20 2020 2020 2020 2020 2020 2023 2320  .            ## 
+000130c0: 7465 726d 696e 6174 6520 2620 636c 6561  terminate & clea
+000130d0: 6e75 700d 0a20 2020 2020 2020 2020 2020  nup..           
+000130e0: 2069 6620 7365 6c66 2e66 6c61 6773 2e66   if self.flags.f
+000130f0: 6565 6462 6163 6b3a 0d0a 2020 2020 2020  eedback:..      
+00013100: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00013110: 662e 666c 6167 732e 7465 726d 696e 6174  f.flags.terminat
+00013120: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00013130: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00013140: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00013150: 2073 746f 7065 2066 696c 6520 6d6f 6e69   stope file moni
+00013160: 746f 7269 6e67 0d0a 2020 2020 2020 2020  toring..        
+00013170: 2020 2020 2020 2020 2020 2020 6966 2068              if h
+00013180: 6173 6174 7472 2873 656c 662c 2022 5946  asattr(self, "YF
+00013190: 4d22 293a 0d0a 2020 2020 2020 2020 2020  M"):..          
+000131a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000131b0: 6c66 2e59 464d 2e5f 7374 6f70 2829 0d0a  lf.YFM._stop()..
+000131c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000131e0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+000131f0: 2072 6573 6574 207a 6f6f 6d20 7365 7474   reset zoom sett
+00013200: 696e 6773 0d0a 2020 2020 2020 2020 2020  ings..          
+00013210: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00013220: 2073 656c 662e 666c 6167 732e 7a6f 6f6d   self.flags.zoom
+00013230: 5f6d 656d 6f72 793a 0d0a 2020 2020 2020  _memory:..      
+00013240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013250: 2020 5f63 6f6e 6669 672e 6775 695f 7a6f    _config.gui_zo
+00013260: 6f6d 5f63 6f6e 6669 6720 3d20 4e6f 6e65  om_config = None
+00013270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013280: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00013290: 2020 2020 2020 2020 2020 2020 2323 2061              ## a
+000132a0: 6464 2074 696d 6573 7461 6d70 0d0a 2020  dd timestamp..  
 000132b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132c0: 2020 2069 6d61 6765 3d69 6d61 6765 2c0d     image=image,.
-000132d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000132e0: 2020 2020 2064 6972 5f70 6174 683d 6469       dir_path=di
-000132f0: 725f 7061 7468 2c0d 0a20 2020 2020 2020  r_path,..       
-00013300: 2020 2020 2020 2020 2020 2020 2074 6167               tag
-00013310: 3d74 6167 2c0d 0a20 2020 2020 2020 2020  =tag,..         
-00013320: 2020 2020 2020 2020 2020 2066 696c 655f             file_
-00013330: 7072 6566 6978 3d6f 732e 7061 7468 2e73  prefix=os.path.s
-00013340: 706c 6974 6578 7428 6f73 2e70 6174 682e  plitext(os.path.
-00013350: 6261 7365 6e61 6d65 2869 6d61 6765 5f70  basename(image_p
-00013360: 6174 6829 295b 305d 2c0d 0a20 2020 2020  ath))[0],..     
-00013370: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00013380: 696c 655f 7375 6666 6978 3d74 6167 2c0d  ile_suffix=tag,.
-00013390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000133a0: 2020 2020 2069 6d61 6765 5f6e 616d 653d       image_name=
-000133b0: 6f73 2e70 6174 682e 6261 7365 6e61 6d65  os.path.basename
-000133c0: 2869 6d61 6765 5f70 6174 6829 2c0d 0a20  (image_path),.. 
-000133d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000133e0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-000133f0: 6966 206f 732e 7061 7468 2e69 7364 6972  if os.path.isdir
-00013400: 2869 6d61 6765 5f70 6174 6829 3a0d 0a20  (image_path):.. 
-00013410: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00013420: 656c 662e 636f 6e74 6169 6e65 7220 3d20  elf.container = 
-00013430: 7574 696c 735f 6c6f 776c 6576 656c 2e5f  utils_lowlevel._
-00013440: 6c6f 6164 5f70 726f 6a65 6374 5f69 6d61  load_project_ima
-00013450: 6765 5f64 6972 6563 746f 7279 280d 0a20  ge_directory(.. 
-00013460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013470: 2020 2064 6972 5f70 6174 683d 696d 6167     dir_path=imag
-00013480: 655f 7061 7468 2c20 7461 673d 7461 672c  e_path, tag=tag,
-00013490: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000134a0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-000134b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000134c0: 2020 2020 2020 2020 7261 6973 6520 4669          raise Fi
-000134d0: 6c65 4e6f 7446 6f75 6e64 4572 726f 7228  leNotFoundError(
-000134e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000134f0: 2020 2020 2020 2743 6f75 6c64 206e 6f74        'Could not
-00013500: 2066 696e 6420 696d 6167 6520 6f72 2069   find image or i
-00013510: 6d61 6765 2064 6972 6563 746f 7279 3a20  mage directory: 
-00013520: 227b 7d22 272e 666f 726d 6174 280d 0a20  "{}"'.format(.. 
-00013530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013540: 2020 2020 2020 206f 732e 7061 7468 2e64         os.path.d
-00013550: 6972 6e61 6d65 2869 6d61 6765 5f70 6174  irname(image_pat
-00013560: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-00013570: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00013580: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00013590: 2020 2020 2020 656c 6966 2069 6d61 6765        elif image
-000135a0: 5f70 6174 682e 5f5f 636c 6173 735f 5f2e  _path.__class__.
-000135b0: 5f5f 6e61 6d65 5f5f 203d 3d20 2243 6f6e  __name__ == "Con
-000135c0: 7461 696e 6572 223a 0d0a 2020 2020 2020  tainer":..      
-000135d0: 2020 2020 2020 7365 6c66 2e63 6f6e 7461        self.conta
-000135e0: 696e 6572 203d 2063 6f70 792e 6465 6570  iner = copy.deep
-000135f0: 636f 7079 2869 6d61 6765 5f70 6174 6829  copy(image_path)
-00013600: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00013610: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00013620: 7365 2054 7970 6545 7272 6f72 2822 496e  se TypeError("In
-00013630: 7661 6c69 6420 696e 7075 7420 666f 7220  valid input for 
-00013640: 696d 6167 6520 7061 7468 2028 7374 7220  image path (str 
-00013650: 7265 7175 6972 6564 2922 290d 0a0d 0a20  required)").... 
-00013660: 2020 2064 6566 205f 6c6f 6164 5f70 7970     def _load_pyp
-00013670: 655f 636f 6e66 6967 2873 656c 662c 2069  e_config(self, i
-00013680: 6d61 6765 5f70 6174 682c 2074 6167 2c20  mage_path, tag, 
-00013690: 636f 6e66 6967 5f70 6174 6829 3a0d 0a0d  config_path):...
-000136a0: 0a20 2020 2020 2020 2069 6620 636f 6e66  .        if conf
-000136b0: 6967 5f70 6174 682e 5f5f 636c 6173 735f  ig_path.__class_
-000136c0: 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20 224e  _.__name__ == "N
-000136d0: 6f6e 6554 7970 6522 3a0d 0a20 2020 2020  oneType":..     
-000136e0: 2020 2020 2020 2069 6620 6f73 2e70 6174         if os.pat
-000136f0: 682e 6973 6669 6c65 2869 6d61 6765 5f70  h.isfile(image_p
-00013700: 6174 6829 3a0d 0a20 2020 2020 2020 2020  ath):..         
-00013710: 2020 2020 2020 2069 6d61 6765 5f6e 616d         image_nam
-00013720: 655f 7374 656d 203d 206f 732e 7061 7468  e_stem = os.path
-00013730: 2e73 706c 6974 6578 7428 6f73 2e70 6174  .splitext(os.pat
-00013740: 682e 6261 7365 6e61 6d65 2869 6d61 6765  h.basename(image
-00013750: 5f70 6174 6829 295b 305d 0d0a 2020 2020  _path))[0]..    
-00013760: 2020 2020 2020 2020 2020 2020 7072 6570              prep
-00013770: 656e 6420 3d20 696d 6167 655f 6e61 6d65  end = image_name
-00013780: 5f73 7465 6d20 2b20 225f 220d 0a20 2020  _stem + "_"..   
-00013790: 2020 2020 2020 2020 2065 6c69 6620 6f73           elif os
-000137a0: 2e70 6174 682e 6973 6469 7228 696d 6167  .path.isdir(imag
-000137b0: 655f 7061 7468 293a 0d0a 2020 2020 2020  e_path):..      
-000137c0: 2020 2020 2020 2020 2020 7072 6570 656e            prepen
-000137d0: 6420 3d20 2222 0d0a 0d0a 2020 2020 2020  d = ""....      
-000137e0: 2020 2020 2020 2323 2067 656e 6572 6174        ## generat
-000137f0: 6520 636f 6e66 6967 2070 6174 6820 6672  e config path fr
-00013800: 6f6d 2069 6d61 6765 2066 696c 6520 6f72  om image file or
-00013810: 2064 6972 6563 746f 7279 2028 7072 6f6a   directory (proj
-00013820: 6563 7429 0d0a 2020 2020 2020 2020 2020  ect)..          
-00013830: 2020 636f 6e66 6967 5f6e 616d 6520 3d20    config_name = 
-00013840: 7072 6570 656e 6420 2b20 2270 7970 655f  prepend + "pype_
-00013850: 636f 6e66 6967 5f22 202b 2074 6167 202b  config_" + tag +
-00013860: 2022 2e79 616d 6c22 0d0a 2020 2020 2020   ".yaml"..      
-00013870: 2020 2020 2020 636f 6e66 6967 5f70 6174        config_pat
-00013880: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
-00013890: 2873 656c 662e 636f 6e74 6169 6e65 722e  (self.container.
-000138a0: 6469 725f 7061 7468 2c20 636f 6e66 6967  dir_path, config
-000138b0: 5f6e 616d 6529 0d0a 0d0a 2020 2020 2020  _name)....      
-000138c0: 2020 2323 206c 6f61 6420 636f 6e66 6967    ## load config
-000138d0: 2066 726f 6d20 636f 6e66 6967 2070 6174   from config pat
-000138e0: 680d 0a20 2020 2020 2020 2065 6c69 6620  h..        elif 
-000138f0: 636f 6e66 6967 5f70 6174 682e 5f5f 636c  config_path.__cl
-00013900: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 203d  ass__.__name__ =
-00013910: 3d20 2273 7472 223a 0d0a 2020 2020 2020  = "str":..      
-00013920: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
-00013930: 2e69 7366 696c 6528 636f 6e66 6967 5f70  .isfile(config_p
-00013940: 6174 6829 3a0d 0a20 2020 2020 2020 2020  ath):..         
-00013950: 2020 2020 2020 2070 6173 730d 0a20 2020         pass..   
-00013960: 2020 2020 2020 2020 2023 2065 6c73 653a           # else:
-00013970: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00013980: 2020 2020 7261 6973 6520 4669 6c65 4e6f      raise FileNo
-00013990: 7446 6f75 6e64 4572 726f 7228 0d0a 2020  tFoundError(..  
-000139a0: 2020 2020 2020 2020 2020 2320 2020 2020            #     
-000139b0: 2020 2020 2243 6f75 6c64 206e 6f74 2072      "Could not r
-000139c0: 6561 6420 636f 6e66 6967 2066 696c 6520  ead config file 
-000139d0: 6672 6f6d 2073 7065 6369 6669 6564 2063  from specified c
-000139e0: 6f6e 6669 675f 7061 7468 3a20 5c22 7b7d  onfig_path: \"{}
-000139f0: 5c22 222e 666f 726d 6174 2863 6f6e 6669  \"".format(confi
-00013a00: 675f 7061 7468 2929 0d0a 0d0a 2020 2020  g_path))....    
-00013a10: 2020 2020 6966 206f 732e 7061 7468 2e69      if os.path.i
-00013a20: 7366 696c 6528 636f 6e66 6967 5f70 6174  sfile(config_pat
-00013a30: 6829 3a0d 0a20 2020 2020 2020 2020 2020  h):..           
-00013a40: 2073 656c 662e 636f 6e66 6967 203d 2075   self.config = u
-00013a50: 7469 6c73 5f6c 6f77 6c65 7665 6c2e 5f6c  tils_lowlevel._l
-00013a60: 6f61 645f 7961 6d6c 2863 6f6e 6669 675f  oad_yaml(config_
-00013a70: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
-00013a80: 2020 2073 656c 662e 636f 6e66 6967 5f70     self.config_p
-00013a90: 6174 6820 3d20 636f 6e66 6967 5f70 6174  ath = config_pat
-00013aa0: 680d 0a0d 0a20 2020 2020 2020 2020 2020  h....           
-00013ab0: 2069 6620 2274 656d 706c 6174 655f 6c6f   if "template_lo
-00013ac0: 636b 6564 2220 696e 2073 656c 662e 636f  cked" in self.co
-00013ad0: 6e66 6967 3a0d 0a20 2020 2020 2020 2020  nfig:..         
-00013ae0: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
-00013af0: 6f6e 6669 675b 2274 656d 706c 6174 655f  onfig["template_
-00013b00: 6c6f 636b 6564 225d 203d 3d20 5472 7565  locked"] == True
-00013b10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00013b20: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
-00013b30: 7269 6275 7465 4572 726f 7228 0d0a 2020  ributeError(..  
-00013b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b50: 2020 2020 2020 2741 7474 656d 7074 696e        'Attemptin
-00013b60: 6720 746f 206c 6f61 6420 636f 6e66 6967  g to load config
-00013b70: 2066 726f 6d20 6c6f 636b 6564 2074 656d   from locked tem
-00013b80: 706c 6174 6520 2d20 6372 6561 7465 2063  plate - create c
-00013b90: 6f6e 6669 6720 6669 6c65 2075 7369 6e67  onfig file using
-00013ba0: 2022 6c6f 6164 5f74 656d 706c 6174 6522   "load_template"
-00013bb0: 2066 6972 7374 2e27 0d0a 2020 2020 2020   first.'..      
-00013bc0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00013bd0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00013be0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00013bf0: 6520 4669 6c65 4e6f 7446 6f75 6e64 4572  e FileNotFoundEr
-00013c00: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
-00013c10: 2020 2020 2020 2743 6f75 6c64 206e 6f74        'Could not
-00013c20: 2066 696e 6420 636f 6e66 6967 2066 696c   find config fil
-00013c30: 6520 227b 7d22 2069 6e20 696d 6167 6520  e "{}" in image 
-00013c40: 6469 7265 6374 6f72 793a 2022 7b7d 2227  directory: "{}"'
-00013c50: 2e66 6f72 6d61 7428 0d0a 2020 2020 2020  .format(..      
-00013c60: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00013c70: 6e66 6967 5f6e 616d 652c 206f 732e 7061  nfig_name, os.pa
-00013c80: 7468 2e64 6972 6e61 6d65 2869 6d61 6765  th.dirname(image
-00013c90: 5f70 6174 6829 0d0a 2020 2020 2020 2020  _path)..        
-00013ca0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00013cb0: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
-00013cc0: 6465 6620 5f73 7461 7274 5f66 696c 655f  def _start_file_
-00013cd0: 6d6f 6e69 746f 7228 7365 6c66 2c20 6465  monitor(self, de
-00013ce0: 6c61 7929 3a0d 0a0d 0a20 2020 2020 2020  lay):....       
-00013cf0: 2069 6620 706c 6174 666f 726d 2e73 7973   if platform.sys
-00013d00: 7465 6d28 2920 3d3d 2022 4461 7277 696e  tem() == "Darwin
-00013d10: 223a 2020 2320 6d61 634f 530d 0a20 2020  ":  # macOS..   
-00013d20: 2020 2020 2020 2020 2073 7562 7072 6f63           subproc
-00013d30: 6573 732e 6361 6c6c 2828 226f 7065 6e22  ess.call(("open"
-00013d40: 2c20 7365 6c66 2e63 6f6e 6669 675f 7061  , self.config_pa
-00013d50: 7468 2929 0d0a 2020 2020 2020 2020 656c  th))..        el
-00013d60: 6966 2070 6c61 7466 6f72 6d2e 7379 7374  if platform.syst
-00013d70: 656d 2829 203d 3d20 2257 696e 646f 7773  em() == "Windows
-00013d80: 223a 2020 2320 5769 6e64 6f77 730d 0a20  ":  # Windows.. 
-00013d90: 2020 2020 2020 2020 2020 206f 732e 7374             os.st
-00013da0: 6172 7466 696c 6528 6f73 2e70 6174 682e  artfile(os.path.
-00013db0: 6e6f 726d 7061 7468 2873 656c 662e 636f  normpath(self.co
-00013dc0: 6e66 6967 5f70 6174 6829 290d 0a20 2020  nfig_path))..   
-00013dd0: 2020 2020 2065 6c73 653a 2020 2320 6c69       else:  # li
-00013de0: 6e75 7820 7661 7269 616e 7473 0d0a 2020  nux variants..  
-00013df0: 2020 2020 2020 2020 2020 7375 6270 726f            subpro
-00013e00: 6365 7373 2e63 616c 6c28 2822 7864 672d  cess.call(("xdg-
-00013e10: 6f70 656e 222c 2073 656c 662e 636f 6e66  open", self.conf
-00013e20: 6967 5f70 6174 6829 290d 0a0d 0a20 2020  ig_path))....   
-00013e30: 2020 2020 2073 656c 662e 5946 4d20 3d20       self.YFM = 
-00013e40: 7574 696c 735f 6c6f 776c 6576 656c 2e5f  utils_lowlevel._
-00013e50: 5961 6d6c 4669 6c65 4d6f 6e69 746f 7228  YamlFileMonitor(
-00013e60: 7365 6c66 2e63 6f6e 6669 675f 7061 7468  self.config_path
-00013e70: 2c20 6465 6c61 7929 0d0a 0d0a 2020 2020  , delay)....    
-00013e80: 6465 6620 5f63 6865 636b 5f64 6972 6563  def _check_direc
-00013e90: 746f 7279 5f73 6b69 7028 7365 6c66 2c20  tory_skip(self, 
-00013ea0: 7461 672c 2073 6b69 705f 7061 7474 6572  tag, skip_patter
-00013eb0: 6e2c 2064 6972 5f70 6174 6829 3a0d 0a0d  n, dir_path):...
-00013ec0: 0a20 2020 2020 2020 2023 2320 736b 6970  .        ## skip
-00013ed0: 2064 6972 6563 746f 7269 6573 2074 6861   directories tha
-00013ee0: 7420 616c 7265 6164 7920 636f 6e74 6169  t already contai
-00013ef0: 6e20 7370 6563 6966 6965 6420 6669 6c65  n specified file
-00013f00: 730d 0a20 2020 2020 2020 2069 6620 736b  s..        if sk
-00013f10: 6970 5f70 6174 7465 726e 2e5f 5f63 6c61  ip_pattern.__cla
-00013f20: 7373 5f5f 2e5f 5f6e 616d 655f 5f20 3d3d  ss__.__name__ ==
-00013f30: 2022 7374 7222 3a0d 0a20 2020 2020 2020   "str":..       
-00013f40: 2020 2020 2073 6b69 705f 7061 7474 6572       skip_patter
-00013f50: 6e20 3d20 5b73 6b69 705f 7061 7474 6572  n = [skip_patter
-00013f60: 6e5d 0d0a 2020 2020 2020 2020 656c 6966  n]..        elif
-00013f70: 2073 6b69 705f 7061 7474 6572 6e2e 5f5f   skip_pattern.__
-00013f80: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-00013f90: 203d 3d20 2262 6f6f 6c22 3a0d 0a20 2020   == "bool":..   
-00013fa0: 2020 2020 2020 2020 2073 6b69 705f 7061           skip_pa
-00013fb0: 7474 6572 6e20 3d20 5b22 225d 0d0a 2020  ttern = [""]..  
-00013fc0: 2020 2020 2020 656c 6966 2073 6b69 705f        elif skip_
-00013fd0: 7061 7474 6572 6e2e 5f5f 636c 6173 735f  pattern.__class_
-00013fe0: 5f2e 5f5f 6e61 6d65 5f5f 2069 6e20 5b22  _.__name__ in ["
-00013ff0: 6c69 7374 222c 2022 436f 6d6d 656e 7465  list", "Commente
-00014000: 6453 6571 225d 3a0d 0a20 2020 2020 2020  dSeq"]:..       
-00014010: 2020 2020 2073 6b69 705f 7061 7474 6572       skip_patter
-00014020: 6e20 3d20 736b 6970 5f70 6174 7465 726e  n = skip_pattern
-00014030: 0d0a 0d0a 2020 2020 2020 2020 6669 6c65  ....        file
-00014040: 5f70 6174 7465 726e 203d 205b 5d0d 0a20  _pattern = [].. 
-00014050: 2020 2020 2020 2066 6f72 2070 6174 7465         for patte
-00014060: 726e 2069 6e20 736b 6970 5f70 6174 7465  rn in skip_patte
-00014070: 726e 3a0d 0a20 2020 2020 2020 2020 2020  rn:..           
-00014080: 2066 696c 655f 7061 7474 6572 6e2e 6170   file_pattern.ap
-00014090: 7065 6e64 2870 6174 7465 726e 202b 2022  pend(pattern + "
-000140a0: 5f22 202b 2074 6167 290d 0a0d 0a20 2020  _" + tag)....   
-000140b0: 2020 2020 2066 696c 6570 6174 6873 2c20       filepaths, 
-000140c0: 6475 706c 6963 6174 6573 203d 2075 7469  duplicates = uti
-000140d0: 6c73 5f6c 6f77 6c65 7665 6c2e 5f66 696c  ls_lowlevel._fil
-000140e0: 655f 7761 6c6b 6572 280d 0a20 2020 2020  e_walker(..     
-000140f0: 2020 2020 2020 2064 6972 5f70 6174 682c         dir_path,
-00014100: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-00014110: 636c 7564 653d 6669 6c65 5f70 6174 7465  clude=file_patte
-00014120: 726e 2c0d 0a20 2020 2020 2020 2020 2020  rn,..           
-00014130: 2069 6e63 6c75 6465 5f61 6c6c 3d46 616c   include_all=Fal
-00014140: 7365 2c0d 0a20 2020 2020 2020 2020 2020  se,..           
-00014150: 2065 7863 6c75 6465 3d5b 2270 7970 655f   exclude=["pype_
-00014160: 636f 6e66 6967 222c 2022 6174 7472 6962  config", "attrib
-00014170: 7574 6573 225d 2c0d 0a20 2020 2020 2020  utes"],..       
-00014180: 2020 2020 2070 7970 655f 6d6f 6465 3d54       pype_mode=T
-00014190: 7275 652c 0d0a 2020 2020 2020 2020 290d  rue,..        ).
-000141a0: 0a0d 0a20 2020 2020 2020 2069 6620 6c65  ...        if le
-000141b0: 6e28 6669 6c65 7061 7468 7329 203e 2030  n(filepaths) > 0
-000141c0: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
-000141d0: 696c 6573 203d 205b 5d0d 0a20 2020 2020  iles = []..     
-000141e0: 2020 2020 2020 2066 6f72 2066 696c 6520         for file 
-000141f0: 696e 2066 696c 6570 6174 6873 3a0d 0a20  in filepaths:.. 
-00014200: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00014210: 696c 6573 2e61 7070 656e 6428 6f73 2e70  iles.append(os.p
-00014220: 6174 682e 6261 7365 6e61 6d65 2866 696c  ath.basename(fil
-00014230: 6529 290d 0a20 2020 2020 2020 2020 2020  e))..           
-00014240: 2070 7269 6e74 2827 5c6e 466f 756e 6420   print('\nFound 
-00014250: 6578 6973 7469 6e67 2066 696c 6573 207b  existing files {
-00014260: 7d20 2d20 736b 6970 7065 645c 6e27 2e66  } - skipped\n'.f
-00014270: 6f72 6d61 7428 282a 6669 6c65 732c 2929  ormat((*files,))
-00014280: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00014290: 6574 7572 6e20 5472 7565 0d0a 2020 2020  eturn True..    
-000142a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-000142b0: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
-000142c0: 6c73 650d 0a0d 0a20 2020 2064 6566 205f  lse....    def _
-000142d0: 6368 6563 6b5f 6669 6e61 6c28 7365 6c66  check_final(self
-000142e0: 293a 0d0a 0d0a 2020 2020 2020 2020 2323  ):....        ##
-000142f0: 2063 6865 636b 2063 6f6d 706f 6e65 6e74   check component
-00014300: 7320 6265 666f 7265 2073 7461 7274 696e  s before startin
-00014310: 6720 7079 7065 2074 6f20 7365 6520 6966  g pype to see if
-00014320: 2073 6f6d 6574 6869 6e67 2077 656e 7420   something went 
-00014330: 7772 6f6e 670d 0a20 2020 2020 2020 2069  wrong..        i
-00014340: 6620 280d 0a20 2020 2020 2020 2020 2020  f (..           
-00014350: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
-00014360: 662e 636f 6e74 6169 6e65 722c 2022 696d  f.container, "im
-00014370: 6167 6522 290d 0a20 2020 2020 2020 2020  age")..         
-00014380: 2020 206f 7220 7365 6c66 2e63 6f6e 7461     or self.conta
-00014390: 696e 6572 2e69 6d61 6765 2e5f 5f63 6c61  iner.image.__cla
-000143a0: 7373 5f5f 2e5f 5f6e 616d 655f 5f20 3d3d  ss__.__name__ ==
-000143b0: 2022 4e6f 6e65 5479 7065 220d 0a20 2020   "NoneType"..   
-000143c0: 2020 2020 2029 3a0d 0a20 2020 2020 2020       ):..       
-000143d0: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
-000143e0: 6275 7465 4572 726f 7228 224e 6f20 696d  buteError("No im
-000143f0: 6167 6520 7761 7320 6c6f 6164 6564 2229  age was loaded")
-00014400: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00014410: 7475 726e 0d0a 2020 2020 2020 2020 6966  turn..        if
-00014420: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00014430: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
-00014440: 2e63 6f6e 7461 696e 6572 2c20 2264 6972  .container, "dir
-00014450: 5f70 6174 6822 290d 0a20 2020 2020 2020  _path")..       
-00014460: 2020 2020 206f 7220 7365 6c66 2e63 6f6e       or self.con
-00014470: 7461 696e 6572 2e64 6972 5f70 6174 682e  tainer.dir_path.
-00014480: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00014490: 5f5f 203d 3d20 224e 6f6e 6554 7970 6522  __ == "NoneType"
-000144a0: 0d0a 2020 2020 2020 2020 293a 0d0a 2020  ..        ):..  
-000144b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000144c0: 4174 7472 6962 7574 6545 7272 6f72 2822  AttributeError("
-000144d0: 436f 756c 6420 6e6f 7420 6465 7465 726d  Could not determ
-000144e0: 696e 6520 6469 725f 7061 7468 2074 6f20  ine dir_path to 
-000144f0: 7361 7665 206f 7574 7075 742e 2229 0d0a  save output.")..
-00014500: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00014510: 726e 0d0a 2020 2020 2020 2020 6966 206e  rn..        if n
-00014520: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
-00014530: 2022 636f 6e66 6967 2229 206f 7220 7365   "config") or se
-00014540: 6c66 2e63 6f6e 6669 672e 5f5f 636c 6173  lf.config.__clas
-00014550: 735f 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20  s__.__name__ == 
-00014560: 224e 6f6e 6554 7970 6522 3a0d 0a20 2020  "NoneType":..   
-00014570: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
-00014580: 7474 7269 6275 7465 4572 726f 7228 0d0a  ttributeError(..
-00014590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000145a0: 224e 6f20 636f 6e66 6967 2066 696c 6520  "No config file 
-000145b0: 7761 7320 7072 6f76 6964 6564 206f 7220  was provided or 
-000145c0: 6c6f 6164 696e 6720 636f 6e66 6967 2064  loading config d
-000145d0: 6964 206e 6f74 2073 7563 6365 6564 2e22  id not succeed."
-000145e0: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
-000145f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00014600: 7572 6e0d 0a0d 0a20 2020 2064 6566 205f  urn....    def _
-00014610: 6974 6572 6174 6528 0d0a 2020 2020 2020  iterate(..      
-00014620: 2020 7365 6c66 2c20 0d0a 2020 2020 2020    self, ..      
-00014630: 2020 636f 6e66 6967 2c20 0d0a 2020 2020    config, ..    
-00014640: 2020 2020 616e 6e6f 7461 7469 6f6e 732c      annotations,
-00014650: 200d 0a20 2020 2020 2020 2065 7865 6375   ..        execu
-00014660: 7465 3d54 7275 652c 200d 0a20 2020 2020  te=True, ..     
-00014670: 2020 2061 7574 6f73 686f 773d 5472 7565     autoshow=True
-00014680: 2c20 0d0a 2020 2020 2020 2020 6665 6564  , ..        feed
-00014690: 6261 636b 3d54 7275 652c 0d0a 2020 2020  back=True,..    
-000146a0: 293a 0d0a 0d0a 2020 2020 2020 2020 666c  ):....        fl
-000146b0: 6167 7320 3d20 6d61 6b65 5f64 6174 6163  ags = make_datac
-000146c0: 6c61 7373 280d 0a20 2020 2020 2020 2020  lass(..         
-000146d0: 2020 2063 6c73 5f6e 616d 653d 2266 6c61     cls_name="fla
-000146e0: 6773 222c 0d0a 2020 2020 2020 2020 2020  gs",..          
-000146f0: 2020 6669 656c 6473 3d5b 0d0a 2020 2020    fields=[..    
-00014700: 2020 2020 2020 2020 2020 2020 2822 6578              ("ex
-00014710: 6563 7574 6522 2c20 626f 6f6c 2c20 6578  ecute", bool, ex
-00014720: 6563 7574 6529 2c0d 0a20 2020 2020 2020  ecute),..       
-00014730: 2020 2020 2020 2020 2028 2261 7574 6f73           ("autos
-00014740: 686f 7722 2c20 626f 6f6c 2c20 6175 746f  how", bool, auto
-00014750: 7368 6f77 292c 0d0a 2020 2020 2020 2020  show),..        
-00014760: 2020 2020 2020 2020 2822 6665 6564 6261          ("feedba
-00014770: 636b 222c 2062 6f6f 6c2c 2066 6565 6462  ck", bool, feedb
-00014780: 6163 6b29 2c0d 0a20 2020 2020 2020 2020  ack),..         
-00014790: 2020 205d 2c0d 0a20 2020 2020 2020 2029     ],..        )
-000147a0: 0d0a 0d0a 2020 2020 2020 2020 2323 206e  ....        ## n
-000147b0: 6577 2069 7465 7261 7469 6f6e 0d0a 2020  ew iteration..  
-000147c0: 2020 2020 2020 6966 2066 6c61 6773 2e65        if flags.e
-000147d0: 7865 6375 7465 2061 6e64 206e 6f74 2073  xecute and not s
-000147e0: 656c 662e 666c 6167 732e 6472 795f 7275  elf.flags.dry_ru
-000147f0: 6e3a 0d0a 2020 2020 2020 2020 2020 2020  n:..            
-00014800: 7072 696e 7428 0d0a 2020 2020 2020 2020  print(..        
-00014810: 2020 2020 2020 2020 225c 6e5c 6e2d 2d2d          "\n\n---
-00014820: 2d2d 2d2d 2d2d 2d2d 2d2b 2b2b 206e 6577  ---------+++ new
-00014830: 2070 7970 6520 6974 6572 6174 696f 6e20   pype iteration 
-00014840: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00014850: 2020 202b 2064 6174 6574 696d 652e 746f     + datetime.to
-00014860: 6461 7928 292e 7374 7266 7469 6d65 2873  day().strftime(s
-00014870: 6574 7469 6e67 732e 7374 7266 7469 6d65  ettings.strftime
-00014880: 5f66 6f72 6d61 7429 0d0a 2020 2020 2020  _format)..      
-00014890: 2020 2020 2020 2020 2020 2b20 2220 2b2b            + " ++
-000148a0: 2b2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d5c  +--------------\
-000148b0: 6e5c 6e22 202b 0d0a 2020 2020 2020 2020  n\n" +..        
-000148c0: 2020 2020 2020 2020 223d 3d3e 2069 6d61          "==> ima
-000148d0: 6765 206e 616d 653a 2022 0d0a 2020 2020  ge name: "..    
-000148e0: 2020 2020 2020 2020 2020 2020 2b20 7374              + st
-000148f0: 7228 7365 6c66 2e63 6f6e 7461 696e 6572  r(self.container
-00014900: 2e69 6d61 6765 5f6e 616d 6529 0d0a 2020  .image_name)..  
-00014910: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
-00014920: 2020 2020 2020 2023 2072 6573 6574 2076         # reset v
-00014930: 616c 7565 730d 0a20 2020 2020 2020 2069  alues..        i
-00014940: 6620 6e6f 7420 7365 6c66 2e66 6c61 6773  f not self.flags
-00014950: 2e64 7279 5f72 756e 3a0d 0a20 2020 2020  .dry_run:..     
-00014960: 2020 2020 2020 2073 656c 662e 636f 6e74         self.cont
-00014970: 6169 6e65 722e 7265 7365 7428 290d 0a20  ainer.reset().. 
-00014980: 2020 2020 2020 2061 6e6e 6f74 6174 696f         annotatio
-00014990: 6e5f 636f 756e 7465 7220 3d20 6469 6374  n_counter = dict
-000149a0: 2e66 726f 6d6b 6579 7328 7365 7474 696e  .fromkeys(settin
-000149b0: 6773 2e5f 616e 6e6f 7461 7469 6f6e 5f74  gs._annotation_t
-000149c0: 7970 6573 2c20 2d31 290d 0a0d 0a20 2020  ypes, -1)....   
-000149d0: 2020 2020 2023 2320 6170 706c 7920 7079       ## apply py
-000149e0: 7065 3a20 6c6f 6f70 2074 6872 6f75 6768  pe: loop through
-000149f0: 2073 7465 7073 2061 6e64 2063 6f6e 7461   steps and conta
-00014a00: 696e 6564 206d 6574 686f 6473 0d0a 2020  ined methods..  
-00014a10: 2020 2020 2020 7374 6570 5f6c 6973 7420        step_list 
-00014a20: 3d20 7365 6c66 2e63 6f6e 6669 675b 2270  = self.config["p
-00014a30: 726f 6365 7373 696e 675f 7374 6570 7322  rocessing_steps"
-00014a40: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
-00014a50: 636f 6e66 6967 5f75 7064 6174 6564 203d  config_updated =
-00014a60: 2063 6f70 792e 6465 6570 636f 7079 2873   copy.deepcopy(s
-00014a70: 656c 662e 636f 6e66 6967 290d 0a20 2020  elf.config)..   
-00014a80: 2020 2020 2073 656c 662e 636f 6e66 6967       self.config
-00014a90: 5f70 6172 7365 645f 666c 6174 7465 6e65  _parsed_flattene
-00014aa0: 6420 3d20 7b7d 0d0a 2020 2020 2020 2020  d = {}..        
-00014ab0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00014ac0: 2020 666f 7220 7374 6570 5f69 6478 2c20    for step_idx, 
-00014ad0: 7374 6570 2069 6e20 656e 756d 6572 6174  step in enumerat
-00014ae0: 6528 7374 6570 5f6c 6973 7429 3a0d 0a0d  e(step_list):...
-00014af0: 0a20 2020 2020 2020 2020 2020 2023 203d  .            # =
-00014b00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014b10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014b20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014b30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014b40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
-00014b50: 2020 2020 2020 2020 2020 2320 5354 4550            # STEP
-00014b60: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00014b70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014b80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014b90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014ba0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014bb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d  =============...
-00014bc0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00014bd0: 7374 6570 2e5f 5f63 6c61 7373 5f5f 2e5f  step.__class__._
-00014be0: 5f6e 616d 655f 5f20 3d3d 2022 7374 7222  _name__ == "str"
-00014bf0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00014c00: 2020 2063 6f6e 7469 6e75 650d 0a0d 0a20     continue.... 
-00014c10: 2020 2020 2020 2020 2020 2023 2320 6765             ## ge
-00014c20: 7420 7374 6570 206e 616d 650d 0a20 2020  t step name..   
-00014c30: 2020 2020 2020 2020 2073 7465 705f 6e61           step_na
-00014c40: 6d65 203d 206c 6973 7428 6469 6374 2873  me = list(dict(s
-00014c50: 7465 7029 2e6b 6579 7328 2929 5b30 5d0d  tep).keys())[0].
-00014c60: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00014c70: 686f 645f 6c69 7374 203d 206c 6973 7428  hod_list = list(
-00014c80: 6469 6374 2873 7465 7029 2e76 616c 7565  dict(step).value
-00014c90: 7328 2929 5b30 5d0d 0a20 2020 2020 2020  s())[0]..       
-00014ca0: 2020 2020 2073 656c 662e 636f 6e66 6967       self.config
-00014cb0: 5f70 6172 7365 645f 666c 6174 7465 6e65  _parsed_flattene
-00014cc0: 645b 7374 6570 5f6e 616d 655d 203d 205b  d[step_name] = [
-00014cd0: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-00014ce0: 2069 6620 6d65 7468 6f64 5f6c 6973 742e   if method_list.
-00014cf0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00014d00: 5f5f 203d 3d20 224e 6f6e 6554 7970 6522  __ == "NoneType"
-00014d10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00014d20: 2020 2063 6f6e 7469 6e75 650d 0a0d 0a20     continue.... 
-00014d30: 2020 2020 2020 2020 2020 2023 203d 3d3d             # ===
-00014d40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014d50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014d60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014d70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014d80: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
-00014d90: 2020 2020 2020 2020 2320 696d 706c 656d          # implem
-00014da0: 656e 7420 6c6f 6767 696e 6720 6675 6e63  ent logging func
-00014db0: 7469 6f6e 2068 6572 650d 0a20 2020 2020  tion here..     
-00014dc0: 2020 2020 2020 2023 203d 3d3d 3d3d 3d3d         # =======
-00014dd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014de0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014df0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014e10: 3d3d 3d3d 3d3d 0d0a 2020 2020 2020 2020  ======..        
-00014e20: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-00014e30: 2020 2323 2070 7269 6e74 2063 7572 7265    ## print curre
-00014e40: 6e74 2073 7465 700d 0a20 2020 2020 2020  nt step..       
-00014e50: 2020 2020 2069 6620 666c 6167 732e 6578       if flags.ex
-00014e60: 6563 7574 6520 616e 6420 666c 6167 732e  ecute and flags.
-00014e70: 6665 6564 6261 636b 3a0d 0a20 2020 2020  feedback:..     
-00014e80: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00014e90: 2822 5c6e 2229 0d0a 2020 2020 2020 2020  ("\n")..        
-00014ea0: 2020 2020 2020 2020 7072 696e 7428 7374          print(st
-00014eb0: 6570 5f6e 616d 652e 7570 7065 7228 2929  ep_name.upper())
-00014ec0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00014ed0: 6966 2073 7465 705f 6e61 6d65 203d 3d20  if step_name == 
-00014ee0: 2276 6973 7561 6c69 7a61 7469 6f6e 2220  "visualization" 
-00014ef0: 616e 6420 666c 6167 732e 6578 6563 7574  and flags.execut
-00014f00: 653a 0d0a 0d0a 2020 2020 2020 2020 2020  e:....          
-00014f10: 2020 2020 2020 2323 2063 6865 636b 2069        ## check i
-00014f20: 6620 6361 6e76 6173 2069 7320 7365 6c65  f canvas is sele
-00014f30: 6374 6564 2c20 616e 6420 6f74 6865 7277  cted, and otherw
-00014f40: 6973 6520 6578 6563 7574 6520 7769 7468  ise execute with
-00014f50: 2064 6566 6175 6c74 2076 616c 7565 730d   default values.
-00014f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014f70: 2076 6973 5f6c 6973 7420 3d20 5b0d 0a20   vis_list = [.. 
-00014f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f90: 2020 206c 6973 7428 6469 6374 2869 292e     list(dict(i).
-00014fa0: 6b65 7973 2829 295b 305d 2069 6620 6e6f  keys())[0] if no
-00014fb0: 7420 6973 696e 7374 616e 6365 2869 2c20  t isinstance(i, 
-00014fc0: 7374 7229 2065 6c73 6520 690d 0a20 2020  str) else i..   
-00014fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014fe0: 2066 6f72 2069 2069 6e20 6d65 7468 6f64   for i in method
-00014ff0: 5f6c 6973 740d 0a20 2020 2020 2020 2020  _list..         
-00015000: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
-00015010: 2020 2020 2020 2020 2020 6966 2028 0d0a            if (..
-00015020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015030: 2020 2020 7365 6c66 2e63 6f6e 7461 696e      self.contain
-00015040: 6572 2e63 616e 7661 732e 5f5f 636c 6173  er.canvas.__clas
-00015050: 735f 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20  s__.__name__ == 
-00015060: 224e 6f6e 6554 7970 6522 0d0a 2020 2020  "NoneType"..    
-00015070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015080: 616e 6420 6e6f 7420 2273 656c 6563 745f  and not "select_
-00015090: 6361 6e76 6173 2220 696e 2076 6973 5f6c  canvas" in vis_l
-000150a0: 6973 740d 0a20 2020 2020 2020 2020 2020  ist..           
-000150b0: 2020 2020 2029 3a0d 0a20 2020 2020 2020       ):..       
-000150c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000150d0: 662e 636f 6e74 6169 6e65 722e 7275 6e28  f.container.run(
-000150e0: 2273 656c 6563 745f 6361 6e76 6173 2229  "select_canvas")
-000150f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015100: 2020 2020 2020 6966 2066 6c61 6773 2e66        if flags.f
-00015110: 6565 6462 6163 6b3a 0d0a 2020 2020 2020  eedback:..      
-00015120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015130: 2020 7072 696e 7428 2273 656c 6563 745f    print("select_
-00015140: 6361 6e76 6173 2028 6175 746f 7365 6c65  canvas (autosele
-00015150: 6374 2922 290d 0a20 2020 2020 2020 2020  ct)")..         
-00015160: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-00015170: 0a20 2020 2020 2020 2020 2020 2023 2320  .            ## 
-00015180: 6974 6572 6174 6520 7468 726f 7567 6820  iterate through 
-00015190: 7374 6570 206c 6973 740d 0a20 2020 2020  step list..     
-000151a0: 2020 2020 2020 2066 6f72 206d 6574 686f         for metho
-000151b0: 645f 6964 782c 206d 6574 686f 6420 696e  d_idx, method in
-000151c0: 2065 6e75 6d65 7261 7465 286d 6574 686f   enumerate(metho
-000151d0: 645f 6c69 7374 293a 0d0a 0d0a 2020 2020  d_list):....    
-000151e0: 2020 2020 2020 2020 2020 2020 2320 3d3d              # ==
+000132c0: 2020 7365 6c66 2e63 6f6e 6669 675b 2263    self.config["c
+000132d0: 6f6e 6669 675f 696e 666f 225d 5b22 6461  onfig_info"]["da
+000132e0: 7465 5f6c 6173 745f 6d6f 6469 6669 6564  te_last_modified
+000132f0: 225d 203d 2064 6174 6574 696d 652e 746f  "] = datetime.to
+00013300: 6461 7928 292e 7374 7266 7469 6d65 2873  day().strftime(s
+00013310: 6574 7469 6e67 732e 7374 7266 7469 6d65  ettings.strftime
+00013320: 5f66 6f72 6d61 7429 0d0a 2020 2020 2020  _format)..      
+00013330: 2020 2020 2020 2020 2020 2020 2020 7574                ut
+00013340: 696c 735f 6c6f 776c 6576 656c 2e5f 7361  ils_lowlevel._sa
+00013350: 7665 5f79 616d 6c28 7365 6c66 2e63 6f6e  ve_yaml(self.con
+00013360: 6669 672c 2073 656c 662e 636f 6e66 6967  fig, self.config
+00013370: 5f70 6174 6829 0d0a 2020 2020 2020 2020  _path)..        
+00013380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013390: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000133a0: 2020 2020 2020 2323 2066 6565 6462 6163        ## feedbac
+000133b0: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
+000133c0: 2020 2020 2020 2070 7269 6e74 2822 5c6e         print("\n
+000133d0: 5c6e 5445 524d 494e 4154 4522 290d 0a20  \nTERMINATE").. 
+000133e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000133f0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00013400: 2020 2020 2020 2020 2062 7265 616b 0d0a           break..
+00013410: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00013420: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00013430: 2020 2062 7265 616b 0d0a 0d0a 2020 2020     break....    
+00013440: 2020 2020 6966 2073 656c 662e 666c 6167      if self.flag
+00013450: 732e 6175 746f 7361 7665 2061 6e64 2073  s.autosave and s
+00013460: 656c 662e 666c 6167 732e 7465 726d 696e  elf.flags.termin
+00013470: 6174 653a 0d0a 2020 2020 2020 2020 2020  ate:..          
+00013480: 2020 6966 2022 6578 706f 7274 2220 6e6f    if "export" no
+00013490: 7420 696e 2073 656c 662e 636f 6e66 6967  t in self.config
+000134a0: 5f70 6172 7365 645f 666c 6174 7465 6e65  _parsed_flattene
+000134b0: 643a 0d0a 2020 2020 2020 2020 2020 2020  d:..            
+000134c0: 2020 2020 6578 706f 7274 5f6c 6973 7420      export_list 
+000134d0: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
+000134e0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000134f0: 2020 2020 2020 2020 2065 7870 6f72 745f           export_
+00013500: 6c69 7374 203d 2073 656c 662e 636f 6e66  list = self.conf
+00013510: 6967 5f70 6172 7365 645f 666c 6174 7465  ig_parsed_flatte
+00013520: 6e65 645b 2265 7870 6f72 7422 5d0d 0a20  ned["export"].. 
+00013530: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00013540: 636f 6e74 6169 6e65 722e 7361 7665 2865  container.save(e
+00013550: 7870 6f72 745f 6c69 7374 3d65 7870 6f72  xport_list=expor
+00013560: 745f 6c69 7374 290d 0a0d 0a20 2020 2064  t_list)....    d
+00013570: 6566 205f 6c6f 6164 5f63 6f6e 7461 696e  ef _load_contain
+00013580: 6572 2873 656c 662c 2069 6d61 6765 5f70  er(self, image_p
+00013590: 6174 682c 2074 6167 293a 0d0a 2020 2020  ath, tag):..    
+000135a0: 2020 2020 6966 2069 6d61 6765 5f70 6174      if image_pat
+000135b0: 682e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  h.__class__.__na
+000135c0: 6d65 5f5f 203d 3d20 2273 7472 223a 0d0a  me__ == "str":..
+000135d0: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+000135e0: 732e 7061 7468 2e69 7366 696c 6528 696d  s.path.isfile(im
+000135f0: 6167 655f 7061 7468 293a 0d0a 2020 2020  age_path):..    
+00013600: 2020 2020 2020 2020 2020 2020 696d 6167              imag
+00013610: 6520 3d20 7574 696c 732e 6c6f 6164 5f69  e = utils.load_i
+00013620: 6d61 6765 2869 6d61 6765 5f70 6174 6829  mage(image_path)
+00013630: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013640: 2020 6469 725f 7061 7468 203d 206f 732e    dir_path = os.
+00013650: 7061 7468 2e64 6972 6e61 6d65 2869 6d61  path.dirname(ima
+00013660: 6765 5f70 6174 6829 0d0a 2020 2020 2020  ge_path)..      
+00013670: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+00013680: 6f6e 7461 696e 6572 203d 2075 7469 6c73  ontainer = utils
+00013690: 2e43 6f6e 7461 696e 6572 280d 0a20 2020  .Container(..   
+000136a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136b0: 2069 6d61 6765 3d69 6d61 6765 2c0d 0a20   image=image,.. 
+000136c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136d0: 2020 2064 6972 5f70 6174 683d 6469 725f     dir_path=dir_
+000136e0: 7061 7468 2c0d 0a20 2020 2020 2020 2020  path,..         
+000136f0: 2020 2020 2020 2020 2020 2074 6167 3d74             tag=t
+00013700: 6167 2c0d 0a20 2020 2020 2020 2020 2020  ag,..           
+00013710: 2020 2020 2020 2020 2066 696c 655f 7072           file_pr
+00013720: 6566 6978 3d6f 732e 7061 7468 2e73 706c  efix=os.path.spl
+00013730: 6974 6578 7428 6f73 2e70 6174 682e 6261  itext(os.path.ba
+00013740: 7365 6e61 6d65 2869 6d61 6765 5f70 6174  sename(image_pat
+00013750: 6829 295b 305d 2c0d 0a20 2020 2020 2020  h))[0],..       
+00013760: 2020 2020 2020 2020 2020 2020 2066 696c               fil
+00013770: 655f 7375 6666 6978 3d74 6167 2c0d 0a20  e_suffix=tag,.. 
+00013780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013790: 2020 2069 6d61 6765 5f6e 616d 653d 6f73     image_name=os
+000137a0: 2e70 6174 682e 6261 7365 6e61 6d65 2869  .path.basename(i
+000137b0: 6d61 6765 5f70 6174 6829 2c0d 0a20 2020  mage_path),..   
+000137c0: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+000137d0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000137e0: 206f 732e 7061 7468 2e69 7364 6972 2869   os.path.isdir(i
+000137f0: 6d61 6765 5f70 6174 6829 3a0d 0a20 2020  mage_path):..   
+00013800: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00013810: 662e 636f 6e74 6169 6e65 7220 3d20 7574  f.container = ut
+00013820: 696c 735f 6c6f 776c 6576 656c 2e5f 6c6f  ils_lowlevel._lo
+00013830: 6164 5f70 726f 6a65 6374 5f69 6d61 6765  ad_project_image
+00013840: 5f64 6972 6563 746f 7279 280d 0a20 2020  _directory(..   
+00013850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013860: 2064 6972 5f70 6174 683d 696d 6167 655f   dir_path=image_
+00013870: 7061 7468 2c20 7461 673d 7461 672c 0d0a  path, tag=tag,..
+00013880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013890: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+000138a0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000138b0: 2020 2020 2020 7261 6973 6520 4669 6c65        raise File
+000138c0: 4e6f 7446 6f75 6e64 4572 726f 7228 0d0a  NotFoundError(..
+000138d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138e0: 2020 2020 2743 6f75 6c64 206e 6f74 2066      'Could not f
+000138f0: 696e 6420 696d 6167 6520 6f72 2069 6d61  ind image or ima
+00013900: 6765 2064 6972 6563 746f 7279 3a20 227b  ge directory: "{
+00013910: 7d22 272e 666f 726d 6174 280d 0a20 2020  }"'.format(..   
+00013920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013930: 2020 2020 206f 732e 7061 7468 2e64 6972       os.path.dir
+00013940: 6e61 6d65 2869 6d61 6765 5f70 6174 6829  name(image_path)
+00013950: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013960: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00013970: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+00013980: 2020 2020 656c 6966 2069 6d61 6765 5f70      elif image_p
+00013990: 6174 682e 5f5f 636c 6173 735f 5f2e 5f5f  ath.__class__.__
+000139a0: 6e61 6d65 5f5f 203d 3d20 2243 6f6e 7461  name__ == "Conta
+000139b0: 696e 6572 223a 0d0a 2020 2020 2020 2020  iner":..        
+000139c0: 2020 2020 7365 6c66 2e63 6f6e 7461 696e      self.contain
+000139d0: 6572 203d 2063 6f70 792e 6465 6570 636f  er = copy.deepco
+000139e0: 7079 2869 6d61 6765 5f70 6174 6829 0d0a  py(image_path)..
+000139f0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00013a00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00013a10: 2054 7970 6545 7272 6f72 2822 496e 7661   TypeError("Inva
+00013a20: 6c69 6420 696e 7075 7420 666f 7220 696d  lid input for im
+00013a30: 6167 6520 7061 7468 2028 7374 7220 7265  age path (str re
+00013a40: 7175 6972 6564 2922 290d 0a0d 0a20 2020  quired)")....   
+00013a50: 2064 6566 205f 6c6f 6164 5f70 7970 655f   def _load_pype_
+00013a60: 636f 6e66 6967 2873 656c 662c 2069 6d61  config(self, ima
+00013a70: 6765 5f70 6174 682c 2074 6167 2c20 636f  ge_path, tag, co
+00013a80: 6e66 6967 5f70 6174 6829 3a0d 0a0d 0a20  nfig_path):.... 
+00013a90: 2020 2020 2020 2069 6620 636f 6e66 6967         if config
+00013aa0: 5f70 6174 682e 5f5f 636c 6173 735f 5f2e  _path.__class__.
+00013ab0: 5f5f 6e61 6d65 5f5f 203d 3d20 224e 6f6e  __name__ == "Non
+00013ac0: 6554 7970 6522 3a0d 0a20 2020 2020 2020  eType":..       
+00013ad0: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
+00013ae0: 6973 6669 6c65 2869 6d61 6765 5f70 6174  isfile(image_pat
+00013af0: 6829 3a0d 0a20 2020 2020 2020 2020 2020  h):..           
+00013b00: 2020 2020 2069 6d61 6765 5f6e 616d 655f       image_name_
+00013b10: 7374 656d 203d 206f 732e 7061 7468 2e73  stem = os.path.s
+00013b20: 706c 6974 6578 7428 6f73 2e70 6174 682e  plitext(os.path.
+00013b30: 6261 7365 6e61 6d65 2869 6d61 6765 5f70  basename(image_p
+00013b40: 6174 6829 295b 305d 0d0a 2020 2020 2020  ath))[0]..      
+00013b50: 2020 2020 2020 2020 2020 7072 6570 656e            prepen
+00013b60: 6420 3d20 696d 6167 655f 6e61 6d65 5f73  d = image_name_s
+00013b70: 7465 6d20 2b20 225f 220d 0a20 2020 2020  tem + "_"..     
+00013b80: 2020 2020 2020 2065 6c69 6620 6f73 2e70         elif os.p
+00013b90: 6174 682e 6973 6469 7228 696d 6167 655f  ath.isdir(image_
+00013ba0: 7061 7468 293a 0d0a 2020 2020 2020 2020  path):..        
+00013bb0: 2020 2020 2020 2020 7072 6570 656e 6420          prepend 
+00013bc0: 3d20 2222 0d0a 0d0a 2020 2020 2020 2020  = ""....        
+00013bd0: 2020 2020 2323 2067 656e 6572 6174 6520      ## generate 
+00013be0: 636f 6e66 6967 2070 6174 6820 6672 6f6d  config path from
+00013bf0: 2069 6d61 6765 2066 696c 6520 6f72 2064   image file or d
+00013c00: 6972 6563 746f 7279 2028 7072 6f6a 6563  irectory (projec
+00013c10: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+00013c20: 636f 6e66 6967 5f6e 616d 6520 3d20 7072  config_name = pr
+00013c30: 6570 656e 6420 2b20 2270 7970 655f 636f  epend + "pype_co
+00013c40: 6e66 6967 5f22 202b 2074 6167 202b 2022  nfig_" + tag + "
+00013c50: 2e79 616d 6c22 0d0a 2020 2020 2020 2020  .yaml"..        
+00013c60: 2020 2020 636f 6e66 6967 5f70 6174 6820      config_path 
+00013c70: 3d20 6f73 2e70 6174 682e 6a6f 696e 2873  = os.path.join(s
+00013c80: 656c 662e 636f 6e74 6169 6e65 722e 6469  elf.container.di
+00013c90: 725f 7061 7468 2c20 636f 6e66 6967 5f6e  r_path, config_n
+00013ca0: 616d 6529 0d0a 0d0a 2020 2020 2020 2020  ame)....        
+00013cb0: 2323 206c 6f61 6420 636f 6e66 6967 2066  ## load config f
+00013cc0: 726f 6d20 636f 6e66 6967 2070 6174 680d  rom config path.
+00013cd0: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
+00013ce0: 6e66 6967 5f70 6174 682e 5f5f 636c 6173  nfig_path.__clas
+00013cf0: 735f 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20  s__.__name__ == 
+00013d00: 2273 7472 223a 0d0a 2020 2020 2020 2020  "str":..        
+00013d10: 2020 2020 6966 206f 732e 7061 7468 2e69      if os.path.i
+00013d20: 7366 696c 6528 636f 6e66 6967 5f70 6174  sfile(config_pat
+00013d30: 6829 3a0d 0a20 2020 2020 2020 2020 2020  h):..           
+00013d40: 2020 2020 2070 6173 730d 0a20 2020 2020       pass..     
+00013d50: 2020 2020 2020 2023 2065 6c73 653a 0d0a         # else:..
+00013d60: 2020 2020 2020 2020 2020 2020 2320 2020              #   
+00013d70: 2020 7261 6973 6520 4669 6c65 4e6f 7446    raise FileNotF
+00013d80: 6f75 6e64 4572 726f 7228 0d0a 2020 2020  oundError(..    
+00013d90: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+00013da0: 2020 2243 6f75 6c64 206e 6f74 2072 6561    "Could not rea
+00013db0: 6420 636f 6e66 6967 2066 696c 6520 6672  d config file fr
+00013dc0: 6f6d 2073 7065 6369 6669 6564 2063 6f6e  om specified con
+00013dd0: 6669 675f 7061 7468 3a20 5c22 7b7d 5c22  fig_path: \"{}\"
+00013de0: 222e 666f 726d 6174 2863 6f6e 6669 675f  ".format(config_
+00013df0: 7061 7468 2929 0d0a 0d0a 2020 2020 2020  path))....      
+00013e00: 2020 6966 206f 732e 7061 7468 2e69 7366    if os.path.isf
+00013e10: 696c 6528 636f 6e66 6967 5f70 6174 6829  ile(config_path)
+00013e20: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+00013e30: 656c 662e 636f 6e66 6967 203d 2075 7469  elf.config = uti
+00013e40: 6c73 5f6c 6f77 6c65 7665 6c2e 5f6c 6f61  ls_lowlevel._loa
+00013e50: 645f 7961 6d6c 2863 6f6e 6669 675f 7061  d_yaml(config_pa
+00013e60: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
+00013e70: 2073 656c 662e 636f 6e66 6967 5f70 6174   self.config_pat
+00013e80: 6820 3d20 636f 6e66 6967 5f70 6174 680d  h = config_path.
+00013e90: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+00013ea0: 6620 2274 656d 706c 6174 655f 6c6f 636b  f "template_lock
+00013eb0: 6564 2220 696e 2073 656c 662e 636f 6e66  ed" in self.conf
+00013ec0: 6967 3a0d 0a20 2020 2020 2020 2020 2020  ig:..           
+00013ed0: 2020 2020 2069 6620 7365 6c66 2e63 6f6e       if self.con
+00013ee0: 6669 675b 2274 656d 706c 6174 655f 6c6f  fig["template_lo
+00013ef0: 636b 6564 225d 203d 3d20 5472 7565 3a0d  cked"] == True:.
+00013f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013f10: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
+00013f20: 6275 7465 4572 726f 7228 0d0a 2020 2020  buteError(..    
+00013f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f40: 2020 2020 2741 7474 656d 7074 696e 6720      'Attempting 
+00013f50: 746f 206c 6f61 6420 636f 6e66 6967 2066  to load config f
+00013f60: 726f 6d20 6c6f 636b 6564 2074 656d 706c  rom locked templ
+00013f70: 6174 6520 2d20 6372 6561 7465 2063 6f6e  ate - create con
+00013f80: 6669 6720 6669 6c65 2075 7369 6e67 2022  fig file using "
+00013f90: 6c6f 6164 5f74 656d 706c 6174 6522 2066  load_template" f
+00013fa0: 6972 7374 2e27 0d0a 2020 2020 2020 2020  irst.'..        
+00013fb0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00013fc0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00013fd0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00013fe0: 4669 6c65 4e6f 7446 6f75 6e64 4572 726f  FileNotFoundErro
+00013ff0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00014000: 2020 2020 2743 6f75 6c64 206e 6f74 2066      'Could not f
+00014010: 696e 6420 636f 6e66 6967 2066 696c 6520  ind config file 
+00014020: 227b 7d22 2069 6e20 696d 6167 6520 6469  "{}" in image di
+00014030: 7265 6374 6f72 793a 2022 7b7d 2227 2e66  rectory: "{}"'.f
+00014040: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
+00014050: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
+00014060: 6967 5f6e 616d 652c 206f 732e 7061 7468  ig_name, os.path
+00014070: 2e64 6972 6e61 6d65 2869 6d61 6765 5f70  .dirname(image_p
+00014080: 6174 6829 0d0a 2020 2020 2020 2020 2020  ath)..          
+00014090: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000140a0: 2020 2020 2029 0d0a 0d0a 2020 2020 6465       )....    de
+000140b0: 6620 5f73 7461 7274 5f66 696c 655f 6d6f  f _start_file_mo
+000140c0: 6e69 746f 7228 7365 6c66 2c20 6465 6c61  nitor(self, dela
+000140d0: 7929 3a0d 0a0d 0a20 2020 2020 2020 2069  y):....        i
+000140e0: 6620 706c 6174 666f 726d 2e73 7973 7465  f platform.syste
+000140f0: 6d28 2920 3d3d 2022 4461 7277 696e 223a  m() == "Darwin":
+00014100: 2020 2320 6d61 634f 530d 0a20 2020 2020    # macOS..     
+00014110: 2020 2020 2020 2073 7562 7072 6f63 6573         subproces
+00014120: 732e 6361 6c6c 2828 226f 7065 6e22 2c20  s.call(("open", 
+00014130: 7365 6c66 2e63 6f6e 6669 675f 7061 7468  self.config_path
+00014140: 2929 0d0a 2020 2020 2020 2020 656c 6966  ))..        elif
+00014150: 2070 6c61 7466 6f72 6d2e 7379 7374 656d   platform.system
+00014160: 2829 203d 3d20 2257 696e 646f 7773 223a  () == "Windows":
+00014170: 2020 2320 5769 6e64 6f77 730d 0a20 2020    # Windows..   
+00014180: 2020 2020 2020 2020 206f 732e 7374 6172           os.star
+00014190: 7466 696c 6528 6f73 2e70 6174 682e 6e6f  tfile(os.path.no
+000141a0: 726d 7061 7468 2873 656c 662e 636f 6e66  rmpath(self.conf
+000141b0: 6967 5f70 6174 6829 290d 0a20 2020 2020  ig_path))..     
+000141c0: 2020 2065 6c73 653a 2020 2320 6c69 6e75     else:  # linu
+000141d0: 7820 7661 7269 616e 7473 0d0a 2020 2020  x variants..    
+000141e0: 2020 2020 2020 2020 7375 6270 726f 6365          subproce
+000141f0: 7373 2e63 616c 6c28 2822 7864 672d 6f70  ss.call(("xdg-op
+00014200: 656e 222c 2073 656c 662e 636f 6e66 6967  en", self.config
+00014210: 5f70 6174 6829 290d 0a0d 0a20 2020 2020  _path))....     
+00014220: 2020 2073 656c 662e 5946 4d20 3d20 7574     self.YFM = ut
+00014230: 696c 735f 6c6f 776c 6576 656c 2e5f 5961  ils_lowlevel._Ya
+00014240: 6d6c 4669 6c65 4d6f 6e69 746f 7228 7365  mlFileMonitor(se
+00014250: 6c66 2e63 6f6e 6669 675f 7061 7468 2c20  lf.config_path, 
+00014260: 6465 6c61 7929 0d0a 0d0a 2020 2020 6465  delay)....    de
+00014270: 6620 5f63 6865 636b 5f64 6972 6563 746f  f _check_directo
+00014280: 7279 5f73 6b69 7028 7365 6c66 2c20 7461  ry_skip(self, ta
+00014290: 672c 2073 6b69 705f 7061 7474 6572 6e2c  g, skip_pattern,
+000142a0: 2064 6972 5f70 6174 6829 3a0d 0a0d 0a20   dir_path):.... 
+000142b0: 2020 2020 2020 2023 2320 736b 6970 2064         ## skip d
+000142c0: 6972 6563 746f 7269 6573 2074 6861 7420  irectories that 
+000142d0: 616c 7265 6164 7920 636f 6e74 6169 6e20  already contain 
+000142e0: 7370 6563 6966 6965 6420 6669 6c65 730d  specified files.
+000142f0: 0a20 2020 2020 2020 2069 6620 736b 6970  .        if skip
+00014300: 5f70 6174 7465 726e 2e5f 5f63 6c61 7373  _pattern.__class
+00014310: 5f5f 2e5f 5f6e 616d 655f 5f20 3d3d 2022  __.__name__ == "
+00014320: 7374 7222 3a0d 0a20 2020 2020 2020 2020  str":..         
+00014330: 2020 2073 6b69 705f 7061 7474 6572 6e20     skip_pattern 
+00014340: 3d20 5b73 6b69 705f 7061 7474 6572 6e5d  = [skip_pattern]
+00014350: 0d0a 2020 2020 2020 2020 656c 6966 2073  ..        elif s
+00014360: 6b69 705f 7061 7474 6572 6e2e 5f5f 636c  kip_pattern.__cl
+00014370: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 203d  ass__.__name__ =
+00014380: 3d20 2262 6f6f 6c22 3a0d 0a20 2020 2020  = "bool":..     
+00014390: 2020 2020 2020 2073 6b69 705f 7061 7474         skip_patt
+000143a0: 6572 6e20 3d20 5b22 225d 0d0a 2020 2020  ern = [""]..    
+000143b0: 2020 2020 656c 6966 2073 6b69 705f 7061      elif skip_pa
+000143c0: 7474 6572 6e2e 5f5f 636c 6173 735f 5f2e  ttern.__class__.
+000143d0: 5f5f 6e61 6d65 5f5f 2069 6e20 5b22 6c69  __name__ in ["li
+000143e0: 7374 222c 2022 436f 6d6d 656e 7465 6453  st", "CommentedS
+000143f0: 6571 225d 3a0d 0a20 2020 2020 2020 2020  eq"]:..         
+00014400: 2020 2073 6b69 705f 7061 7474 6572 6e20     skip_pattern 
+00014410: 3d20 736b 6970 5f70 6174 7465 726e 0d0a  = skip_pattern..
+00014420: 0d0a 2020 2020 2020 2020 6669 6c65 5f70  ..        file_p
+00014430: 6174 7465 726e 203d 205b 5d0d 0a20 2020  attern = []..   
+00014440: 2020 2020 2066 6f72 2070 6174 7465 726e       for pattern
+00014450: 2069 6e20 736b 6970 5f70 6174 7465 726e   in skip_pattern
+00014460: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
+00014470: 696c 655f 7061 7474 6572 6e2e 6170 7065  ile_pattern.appe
+00014480: 6e64 2870 6174 7465 726e 202b 2022 5f22  nd(pattern + "_"
+00014490: 202b 2074 6167 290d 0a0d 0a20 2020 2020   + tag)....     
+000144a0: 2020 2066 696c 6570 6174 6873 2c20 6475     filepaths, du
+000144b0: 706c 6963 6174 6573 203d 2075 7469 6c73  plicates = utils
+000144c0: 5f6c 6f77 6c65 7665 6c2e 5f66 696c 655f  _lowlevel._file_
+000144d0: 7761 6c6b 6572 280d 0a20 2020 2020 2020  walker(..       
+000144e0: 2020 2020 2064 6972 5f70 6174 682c 0d0a       dir_path,..
+000144f0: 2020 2020 2020 2020 2020 2020 696e 636c              incl
+00014500: 7564 653d 6669 6c65 5f70 6174 7465 726e  ude=file_pattern
+00014510: 2c0d 0a20 2020 2020 2020 2020 2020 2069  ,..            i
+00014520: 6e63 6c75 6465 5f61 6c6c 3d46 616c 7365  nclude_all=False
+00014530: 2c0d 0a20 2020 2020 2020 2020 2020 2065  ,..            e
+00014540: 7863 6c75 6465 3d5b 2270 7970 655f 636f  xclude=["pype_co
+00014550: 6e66 6967 222c 2022 6174 7472 6962 7574  nfig", "attribut
+00014560: 6573 225d 2c0d 0a20 2020 2020 2020 2020  es"],..         
+00014570: 2020 2070 7970 655f 6d6f 6465 3d54 7275     pype_mode=Tru
+00014580: 652c 0d0a 2020 2020 2020 2020 290d 0a0d  e,..        )...
+00014590: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+000145a0: 6669 6c65 7061 7468 7329 203e 2030 3a0d  filepaths) > 0:.
+000145b0: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
+000145c0: 6573 203d 205b 5d0d 0a20 2020 2020 2020  es = []..       
+000145d0: 2020 2020 2066 6f72 2066 696c 6520 696e       for file in
+000145e0: 2066 696c 6570 6174 6873 3a0d 0a20 2020   filepaths:..   
+000145f0: 2020 2020 2020 2020 2020 2020 2066 696c               fil
+00014600: 6573 2e61 7070 656e 6428 6f73 2e70 6174  es.append(os.pat
+00014610: 682e 6261 7365 6e61 6d65 2866 696c 6529  h.basename(file)
+00014620: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+00014630: 7269 6e74 2827 5c6e 466f 756e 6420 6578  rint('\nFound ex
+00014640: 6973 7469 6e67 2066 696c 6573 207b 7d20  isting files {} 
+00014650: 2d20 736b 6970 7065 645c 6e27 2e66 6f72  - skipped\n'.for
+00014660: 6d61 7428 282a 6669 6c65 732c 2929 290d  mat((*files,))).
+00014670: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00014680: 7572 6e20 5472 7565 0d0a 2020 2020 2020  urn True..      
+00014690: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000146a0: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+000146b0: 650d 0a0d 0a20 2020 2064 6566 205f 6368  e....    def _ch
+000146c0: 6563 6b5f 6669 6e61 6c28 7365 6c66 293a  eck_final(self):
+000146d0: 0d0a 0d0a 2020 2020 2020 2020 2323 2063  ....        ## c
+000146e0: 6865 636b 2063 6f6d 706f 6e65 6e74 7320  heck components 
+000146f0: 6265 666f 7265 2073 7461 7274 696e 6720  before starting 
+00014700: 7079 7065 2074 6f20 7365 6520 6966 2073  pype to see if s
+00014710: 6f6d 6574 6869 6e67 2077 656e 7420 7772  omething went wr
+00014720: 6f6e 670d 0a20 2020 2020 2020 2069 6620  ong..        if 
+00014730: 280d 0a20 2020 2020 2020 2020 2020 206e  (..            n
+00014740: 6f74 2068 6173 6174 7472 2873 656c 662e  ot hasattr(self.
+00014750: 636f 6e74 6169 6e65 722c 2022 696d 6167  container, "imag
+00014760: 6522 290d 0a20 2020 2020 2020 2020 2020  e")..           
+00014770: 206f 7220 7365 6c66 2e63 6f6e 7461 696e   or self.contain
+00014780: 6572 2e69 6d61 6765 2e5f 5f63 6c61 7373  er.image.__class
+00014790: 5f5f 2e5f 5f6e 616d 655f 5f20 3d3d 2022  __.__name__ == "
+000147a0: 4e6f 6e65 5479 7065 220d 0a20 2020 2020  NoneType"..     
+000147b0: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
+000147c0: 2020 2072 6169 7365 2041 7474 7269 6275     raise Attribu
+000147d0: 7465 4572 726f 7228 224e 6f20 696d 6167  teError("No imag
+000147e0: 6520 7761 7320 6c6f 6164 6564 2229 0d0a  e was loaded")..
+000147f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00014800: 726e 0d0a 2020 2020 2020 2020 6966 2028  rn..        if (
+00014810: 0d0a 2020 2020 2020 2020 2020 2020 6e6f  ..            no
+00014820: 7420 6861 7361 7474 7228 7365 6c66 2e63  t hasattr(self.c
+00014830: 6f6e 7461 696e 6572 2c20 2264 6972 5f70  ontainer, "dir_p
+00014840: 6174 6822 290d 0a20 2020 2020 2020 2020  ath")..         
+00014850: 2020 206f 7220 7365 6c66 2e63 6f6e 7461     or self.conta
+00014860: 696e 6572 2e64 6972 5f70 6174 682e 5f5f  iner.dir_path.__
+00014870: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+00014880: 203d 3d20 224e 6f6e 6554 7970 6522 0d0a   == "NoneType"..
+00014890: 2020 2020 2020 2020 293a 0d0a 2020 2020          ):..    
+000148a0: 2020 2020 2020 2020 7261 6973 6520 4174          raise At
+000148b0: 7472 6962 7574 6545 7272 6f72 2822 436f  tributeError("Co
+000148c0: 756c 6420 6e6f 7420 6465 7465 726d 696e  uld not determin
+000148d0: 6520 6469 725f 7061 7468 2074 6f20 7361  e dir_path to sa
+000148e0: 7665 206f 7574 7075 742e 2229 0d0a 2020  ve output.")..  
+000148f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00014900: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00014910: 2068 6173 6174 7472 2873 656c 662c 2022   hasattr(self, "
+00014920: 636f 6e66 6967 2229 206f 7220 7365 6c66  config") or self
+00014930: 2e63 6f6e 6669 672e 5f5f 636c 6173 735f  .config.__class_
+00014940: 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20 224e  _.__name__ == "N
+00014950: 6f6e 6554 7970 6522 3a0d 0a20 2020 2020  oneType":..     
+00014960: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
+00014970: 7269 6275 7465 4572 726f 7228 0d0a 2020  ributeError(..  
+00014980: 2020 2020 2020 2020 2020 2020 2020 224e                "N
+00014990: 6f20 636f 6e66 6967 2066 696c 6520 7761  o config file wa
+000149a0: 7320 7072 6f76 6964 6564 206f 7220 6c6f  s provided or lo
+000149b0: 6164 696e 6720 636f 6e66 6967 2064 6964  ading config did
+000149c0: 206e 6f74 2073 7563 6365 6564 2e22 0d0a   not succeed."..
+000149d0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+000149e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000149f0: 6e0d 0a0d 0a20 2020 2064 6566 205f 6974  n....    def _it
+00014a00: 6572 6174 6528 0d0a 2020 2020 2020 2020  erate(..        
+00014a10: 7365 6c66 2c20 0d0a 2020 2020 2020 2020  self, ..        
+00014a20: 636f 6e66 6967 2c20 0d0a 2020 2020 2020  config, ..      
+00014a30: 2020 616e 6e6f 7461 7469 6f6e 732c 200d    annotations, .
+00014a40: 0a20 2020 2020 2020 2065 7865 6375 7465  .        execute
+00014a50: 3d54 7275 652c 200d 0a20 2020 2020 2020  =True, ..       
+00014a60: 2061 7574 6f73 686f 773d 5472 7565 2c20   autoshow=True, 
+00014a70: 0d0a 2020 2020 2020 2020 6665 6564 6261  ..        feedba
+00014a80: 636b 3d54 7275 652c 0d0a 2020 2020 293a  ck=True,..    ):
+00014a90: 0d0a 0d0a 2020 2020 2020 2020 666c 6167  ....        flag
+00014aa0: 7320 3d20 6d61 6b65 5f64 6174 6163 6c61  s = make_datacla
+00014ab0: 7373 280d 0a20 2020 2020 2020 2020 2020  ss(..           
+00014ac0: 2063 6c73 5f6e 616d 653d 2266 6c61 6773   cls_name="flags
+00014ad0: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
+00014ae0: 6669 656c 6473 3d5b 0d0a 2020 2020 2020  fields=[..      
+00014af0: 2020 2020 2020 2020 2020 2822 6578 6563            ("exec
+00014b00: 7574 6522 2c20 626f 6f6c 2c20 6578 6563  ute", bool, exec
+00014b10: 7574 6529 2c0d 0a20 2020 2020 2020 2020  ute),..         
+00014b20: 2020 2020 2020 2028 2261 7574 6f73 686f         ("autosho
+00014b30: 7722 2c20 626f 6f6c 2c20 6175 746f 7368  w", bool, autosh
+00014b40: 6f77 292c 0d0a 2020 2020 2020 2020 2020  ow),..          
+00014b50: 2020 2020 2020 2822 6665 6564 6261 636b        ("feedback
+00014b60: 222c 2062 6f6f 6c2c 2066 6565 6462 6163  ", bool, feedbac
+00014b70: 6b29 2c0d 0a20 2020 2020 2020 2020 2020  k),..           
+00014b80: 205d 2c0d 0a20 2020 2020 2020 2029 0d0a   ],..        )..
+00014b90: 0d0a 2020 2020 2020 2020 2323 206e 6577  ..        ## new
+00014ba0: 2069 7465 7261 7469 6f6e 0d0a 2020 2020   iteration..    
+00014bb0: 2020 2020 6966 2066 6c61 6773 2e65 7865      if flags.exe
+00014bc0: 6375 7465 2061 6e64 206e 6f74 2073 656c  cute and not sel
+00014bd0: 662e 666c 6167 732e 6472 795f 7275 6e3a  f.flags.dry_run:
+00014be0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00014bf0: 696e 7428 0d0a 2020 2020 2020 2020 2020  int(..          
+00014c00: 2020 2020 2020 225c 6e5c 6e2d 2d2d 2d2d        "\n\n-----
+00014c10: 2d2d 2d2d 2d2d 2d2b 2b2b 206e 6577 2070  -------+++ new p
+00014c20: 7970 6520 6974 6572 6174 696f 6e20 220d  ype iteration ".
+00014c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014c40: 202b 2064 6174 6574 696d 652e 746f 6461   + datetime.toda
+00014c50: 7928 292e 7374 7266 7469 6d65 2873 6574  y().strftime(set
+00014c60: 7469 6e67 732e 7374 7266 7469 6d65 5f66  tings.strftime_f
+00014c70: 6f72 6d61 7429 0d0a 2020 2020 2020 2020  ormat)..        
+00014c80: 2020 2020 2020 2020 2b20 2220 2b2b 2b2d          + " +++-
+00014c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d5c 6e5c  -------------\n\
+00014ca0: 6e22 202b 0d0a 2020 2020 2020 2020 2020  n" +..          
+00014cb0: 2020 2020 2020 223d 3d3e 2069 6d61 6765        "==> image
+00014cc0: 206e 616d 653a 2022 0d0a 2020 2020 2020   name: "..      
+00014cd0: 2020 2020 2020 2020 2020 2b20 7374 7228            + str(
+00014ce0: 7365 6c66 2e63 6f6e 7461 696e 6572 2e69  self.container.i
+00014cf0: 6d61 6765 5f6e 616d 6529 0d0a 2020 2020  mage_name)..    
+00014d00: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+00014d10: 2020 2020 2023 2072 6573 6574 2076 616c       # reset val
+00014d20: 7565 730d 0a20 2020 2020 2020 2069 6620  ues..        if 
+00014d30: 6e6f 7420 7365 6c66 2e66 6c61 6773 2e64  not self.flags.d
+00014d40: 7279 5f72 756e 3a0d 0a20 2020 2020 2020  ry_run:..       
+00014d50: 2020 2020 2073 656c 662e 636f 6e74 6169       self.contai
+00014d60: 6e65 722e 7265 7365 7428 290d 0a20 2020  ner.reset()..   
+00014d70: 2020 2020 2061 6e6e 6f74 6174 696f 6e5f       annotation_
+00014d80: 636f 756e 7465 7220 3d20 6469 6374 2e66  counter = dict.f
+00014d90: 726f 6d6b 6579 7328 7365 7474 696e 6773  romkeys(settings
+00014da0: 2e5f 616e 6e6f 7461 7469 6f6e 5f74 7970  ._annotation_typ
+00014db0: 6573 2c20 2d31 290d 0a0d 0a20 2020 2020  es, -1)....     
+00014dc0: 2020 2023 2320 6170 706c 7920 7079 7065     ## apply pype
+00014dd0: 3a20 6c6f 6f70 2074 6872 6f75 6768 2073  : loop through s
+00014de0: 7465 7073 2061 6e64 2063 6f6e 7461 696e  teps and contain
+00014df0: 6564 206d 6574 686f 6473 0d0a 2020 2020  ed methods..    
+00014e00: 2020 2020 7374 6570 5f6c 6973 7420 3d20      step_list = 
+00014e10: 7365 6c66 2e63 6f6e 6669 675b 2270 726f  self.config["pro
+00014e20: 6365 7373 696e 675f 7374 6570 7322 5d0d  cessing_steps"].
+00014e30: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+00014e40: 6e66 6967 5f75 7064 6174 6564 203d 2063  nfig_updated = c
+00014e50: 6f70 792e 6465 6570 636f 7079 2873 656c  opy.deepcopy(sel
+00014e60: 662e 636f 6e66 6967 290d 0a20 2020 2020  f.config)..     
+00014e70: 2020 2073 656c 662e 636f 6e66 6967 5f70     self.config_p
+00014e80: 6172 7365 645f 666c 6174 7465 6e65 6420  arsed_flattened 
+00014e90: 3d20 7b7d 0d0a 2020 2020 2020 2020 2020  = {}..          
+00014ea0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00014eb0: 666f 7220 7374 6570 5f69 6478 2c20 7374  for step_idx, st
+00014ec0: 6570 2069 6e20 656e 756d 6572 6174 6528  ep in enumerate(
+00014ed0: 7374 6570 5f6c 6973 7429 3a0d 0a0d 0a20  step_list):.... 
+00014ee0: 2020 2020 2020 2020 2020 2023 203d 3d3d             # ===
+00014ef0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014f00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014f10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014f20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014f30: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
+00014f40: 2020 2020 2020 2020 2320 5354 4550 0d0a          # STEP..
+00014f50: 2020 2020 2020 2020 2020 2020 2320 3d3d              # ==
+00014f60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014f70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014f80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014f90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014fa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d 0a20  ===========.... 
+00014fb0: 2020 2020 2020 2020 2020 2069 6620 7374             if st
+00014fc0: 6570 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  ep.__class__.__n
+00014fd0: 616d 655f 5f20 3d3d 2022 7374 7222 3a0d  ame__ == "str":.
+00014fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014ff0: 2063 6f6e 7469 6e75 650d 0a0d 0a20 2020   continue....   
+00015000: 2020 2020 2020 2020 2023 2320 6765 7420           ## get 
+00015010: 7374 6570 206e 616d 650d 0a20 2020 2020  step name..     
+00015020: 2020 2020 2020 2073 7465 705f 6e61 6d65         step_name
+00015030: 203d 206c 6973 7428 6469 6374 2873 7465   = list(dict(ste
+00015040: 7029 2e6b 6579 7328 2929 5b30 5d0d 0a20  p).keys())[0].. 
+00015050: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00015060: 645f 6c69 7374 203d 206c 6973 7428 6469  d_list = list(di
+00015070: 6374 2873 7465 7029 2e76 616c 7565 7328  ct(step).values(
+00015080: 2929 5b30 5d0d 0a20 2020 2020 2020 2020  ))[0]..         
+00015090: 2020 2073 656c 662e 636f 6e66 6967 5f70     self.config_p
+000150a0: 6172 7365 645f 666c 6174 7465 6e65 645b  arsed_flattened[
+000150b0: 7374 6570 5f6e 616d 655d 203d 205b 5d0d  step_name] = [].
+000150c0: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+000150d0: 6620 6d65 7468 6f64 5f6c 6973 742e 5f5f  f method_list.__
+000150e0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+000150f0: 203d 3d20 224e 6f6e 6554 7970 6522 3a0d   == "NoneType":.
+00015100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015110: 2063 6f6e 7469 6e75 650d 0a0d 0a20 2020   continue....   
+00015120: 2020 2020 2020 2020 2023 203d 3d3d 3d3d           # =====
+00015130: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015140: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015150: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015160: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015170: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 2020  ========..      
+00015180: 2020 2020 2020 2320 696d 706c 656d 656e        # implemen
+00015190: 7420 6c6f 6767 696e 6720 6675 6e63 7469  t logging functi
+000151a0: 6f6e 2068 6572 650d 0a20 2020 2020 2020  on here..       
+000151b0: 2020 2020 2023 203d 3d3d 3d3d 3d3d 3d3d       # =========
+000151c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000151d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000151e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 000151f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015200: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015210: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015220: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015230: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
-00015240: 2020 2020 2020 2020 2020 2020 2023 204d               # M
-00015250: 4554 484f 4420 2f20 4558 5452 4143 5449  ETHOD / EXTRACTI
-00015260: 4f4e 2041 4e44 2043 4845 434b 0d0a 2020  ON AND CHECK..  
-00015270: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00015280: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015290: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000152a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000152b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000152c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d  =============...
-000152d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000152e0: 2023 2320 666f 726d 6174 206d 6574 686f   ## format metho
-000152f0: 6420 6e61 6d65 2061 6e64 2061 7267 756d  d name and argum
-00015300: 656e 7473 0d0a 2020 2020 2020 2020 2020  ents..          
-00015310: 2020 2020 2020 6966 206d 6574 686f 642e        if method.
-00015320: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00015330: 5f5f 2069 6e20 5b22 6469 6374 222c 2022  __ in ["dict", "
-00015340: 6f72 6465 7265 6464 6963 7422 2c20 2243  ordereddict", "C
-00015350: 6f6d 6d65 6e74 6564 4d61 7022 5d3a 0d0a  ommentedMap"]:..
-00015360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015370: 2020 2020 6d65 7468 6f64 203d 2064 6963      method = dic
-00015380: 7428 6d65 7468 6f64 290d 0a20 2020 2020  t(method)..     
-00015390: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000153a0: 6574 686f 645f 6e61 6d65 203d 206c 6973  ethod_name = lis
-000153b0: 7428 6d65 7468 6f64 2e6b 6579 7328 2929  t(method.keys())
-000153c0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
-000153d0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-000153e0: 6c69 7374 286d 6574 686f 642e 7661 6c75  list(method.valu
-000153f0: 6573 2829 295b 305d 2e5f 5f63 6c61 7373  es())[0].__class
-00015400: 5f5f 2e5f 5f6e 616d 655f 5f20 3d3d 2022  __.__name__ == "
-00015410: 4e6f 6e65 5479 7065 223a 0d0a 2020 2020  NoneType":..    
-00015420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015430: 2020 2020 6d65 7468 6f64 5f61 7267 7320      method_args 
-00015440: 3d20 6469 6374 286c 6973 7428 6d65 7468  = dict(list(meth
-00015450: 6f64 2e76 616c 7565 7328 2929 5b30 5d29  od.values())[0])
-00015460: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015470: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00015480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015490: 2020 2020 206d 6574 686f 645f 6172 6773       method_args
-000154a0: 203d 207b 7d0d 0a20 2020 2020 2020 2020   = {}..         
-000154b0: 2020 2020 2020 2065 6c69 6620 6d65 7468         elif meth
-000154c0: 6f64 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  od.__class__.__n
-000154d0: 616d 655f 5f20 3d3d 2022 7374 7222 3a0d  ame__ == "str":.
-000154e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000154f0: 2020 2020 206d 6574 686f 645f 6e61 6d65       method_name
-00015500: 203d 206d 6574 686f 640d 0a20 2020 2020   = method..     
-00015510: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00015520: 6574 686f 645f 6172 6773 203d 207b 7d0d  ethod_args = {}.
-00015530: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00015540: 2020 2023 2320 6665 6564 6261 636b 0d0a     ## feedback..
-00015550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015560: 6966 2066 6c61 6773 2e65 7865 6375 7465  if flags.execute
-00015570: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00015580: 2020 2020 2020 2070 7269 6e74 286d 6574         print(met
-00015590: 686f 645f 6e61 6d65 290d 0a0d 0a20 2020  hod_name)....   
-000155a0: 2020 2020 2020 2020 2020 2020 2023 2320               ## 
-000155b0: 6368 6563 6b20 6966 206d 6574 686f 6420  check if method 
-000155c0: 6578 6973 7473 0d0a 2020 2020 2020 2020  exists..        
-000155d0: 2020 2020 2020 2020 6966 2068 6173 6174          if hasat
-000155e0: 7472 2865 7661 6c28 7374 6570 5f6e 616d  tr(eval(step_nam
-000155f0: 6529 2c20 6d65 7468 6f64 5f6e 616d 6529  e), method_name)
-00015600: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00015610: 2020 2020 2020 2073 656c 662e 636f 6e66         self.conf
-00015620: 6967 5f70 6172 7365 645f 666c 6174 7465  ig_parsed_flatte
-00015630: 6e65 645b 7374 6570 5f6e 616d 655d 2e61  ned[step_name].a
-00015640: 7070 656e 6428 6d65 7468 6f64 5f6e 616d  ppend(method_nam
-00015650: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00015660: 2020 2020 2020 2020 7061 7373 0d0a 2020          pass..  
-00015670: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00015680: 6966 2073 656c 662e 666c 6167 732e 6669  if self.flags.fi
-00015690: 785f 6e61 6d65 733a 0d0a 2020 2020 2020  x_names:..      
-000156a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000156b0: 206d 6574 686f 645f 6e61 6d65 2069 6e20   method_name in 
-000156c0: 7365 7474 696e 6773 2e5f 6c65 6761 6379  settings._legacy
-000156d0: 5f6e 616d 6573 5b73 7465 705f 6e61 6d65  _names[step_name
-000156e0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-000156f0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00015700: 6f64 5f6e 616d 655f 7570 6461 7465 6420  od_name_updated 
-00015710: 3d20 7365 7474 696e 6773 2e5f 6c65 6761  = settings._lega
-00015720: 6379 5f6e 616d 6573 5b73 7465 705f 6e61  cy_names[step_na
-00015730: 6d65 5d5b 0d0a 2020 2020 2020 2020 2020  me][..          
-00015740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015750: 2020 6d65 7468 6f64 5f6e 616d 650d 0a20    method_name.. 
-00015760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015770: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
-00015780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015790: 2020 7365 6c66 2e63 6f6e 6669 675f 7570    self.config_up
-000157a0: 6461 7465 645b 2270 726f 6365 7373 696e  dated["processin
-000157b0: 675f 7374 6570 7322 5d5b 7374 6570 5f69  g_steps"][step_i
-000157c0: 6478 5d5b 7374 6570 5f6e 616d 655d 5b0d  dx][step_name][.
-000157d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000157e0: 2020 2020 2020 2020 2020 2020 206d 6574               met
-000157f0: 686f 645f 6964 780d 0a20 2020 2020 2020  hod_idx..       
-00015800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015810: 205d 203d 207b 6d65 7468 6f64 5f6e 616d   ] = {method_nam
-00015820: 655f 7570 6461 7465 643a 206d 6574 686f  e_updated: metho
-00015830: 645f 6172 6773 7d0d 0a20 2020 2020 2020  d_args}..       
-00015840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015850: 206d 6574 686f 645f 6e61 6d65 203d 206d   method_name = m
-00015860: 6574 686f 645f 6e61 6d65 5f75 7064 6174  ethod_name_updat
-00015870: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
-00015880: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00015890: 7428 2253 7461 6765 3a20 6669 7865 6420  t("Stage: fixed 
-000158a0: 6d65 7468 6f64 206e 616d 6522 290d 0a20  method name").. 
-000158b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000158c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000158d0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000158e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000158f0: 2020 2020 2020 2020 2020 2270 6865 6e6f            "pheno
-00015900: 7079 7065 2e7b 7d20 6861 7320 6e6f 2066  pype.{} has no f
-00015910: 756e 6374 696f 6e20 6361 6c6c 6564 207b  unction called {
-00015920: 7d20 2d20 7769 6c6c 2061 7474 656d 7074  } - will attempt
-00015930: 2074 6f20 6c6f 6f6b 2066 6f72 2073 696d   to look for sim
-00015940: 696c 6172 6c79 206e 616d 6564 2066 756e  ilarly named fun
-00015950: 6374 696f 6e73 202d 2066 6978 2074 6865  ctions - fix the
-00015960: 2063 6f6e 6669 6720 6669 6c65 2122 2e66   config file!".f
-00015970: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
-00015980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015990: 2020 2020 7374 6570 5f6e 616d 652c 206d      step_name, m
-000159a0: 6574 686f 645f 6e61 6d65 0d0a 2020 2020  ethod_name..    
-000159b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159c0: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-000159d0: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
-000159e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159f0: 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  # ==============
-00015a00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015a10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015a20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015a30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-00015a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015a50: 2023 204d 4554 484f 4420 2f20 414e 4e4f   # METHOD / ANNO
-00015a60: 5441 5449 4f4e 0d0a 2020 2020 2020 2020  TATION..        
-00015a70: 2020 2020 2020 2020 2320 3d3d 3d3d 3d3d          # ======
-00015a80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015a90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015aa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015ab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015ac0: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020 2020  =======..       
-00015ad0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00015ae0: 2020 2020 2020 2020 2020 2069 6620 6d65             if me
-00015af0: 7468 6f64 5f6e 616d 6520 696e 206c 6973  thod_name in lis
-00015b00: 7428 7365 7474 696e 6773 2e5f 616e 6e6f  t(settings._anno
-00015b10: 7461 7469 6f6e 5f66 756e 6374 696f 6e73  tation_functions
-00015b20: 2e6b 6579 7328 2929 202b 205b 2263 6f6e  .keys()) + ["con
-00015b30: 7665 7274 5f61 6e6e 6f74 6174 696f 6e22  vert_annotation"
-00015b40: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-00015b50: 2020 2020 2020 2020 6966 2022 414e 4e4f          if "ANNO
-00015b60: 5441 5449 4f4e 2220 696e 206d 6574 686f  TATION" in metho
-00015b70: 645f 6172 6773 3a0d 0a20 2020 2020 2020  d_args:..       
-00015b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b90: 2061 6e6e 6f74 6174 696f 6e5f 6172 6773   annotation_args
-00015ba0: 203d 2064 6963 7428 6d65 7468 6f64 5f61   = dict(method_a
-00015bb0: 7267 735b 2241 4e4e 4f54 4154 494f 4e22  rgs["ANNOTATION"
-00015bc0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00015bd0: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-00015be0: 6d65 7468 6f64 5f61 7267 735b 2241 4e4e  method_args["ANN
-00015bf0: 4f54 4154 494f 4e22 5d0d 0a20 2020 2020  OTATION"]..     
-00015c00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00015c10: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00015c20: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00015c30: 6e6f 7461 7469 6f6e 5f61 7267 7320 3d20  notation_args = 
-00015c40: 7b7d 0d0a 2020 2020 2020 2020 2020 2020  {}..            
-00015c50: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00015c60: 6f64 5f61 7267 7320 3d20 6469 6374 286d  od_args = dict(m
-00015c70: 6574 686f 645f 6172 6773 290d 0a20 2020  ethod_args)..   
-00015c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c90: 2020 2020 2070 7269 6e74 2822 5374 6167       print("Stag
-00015ca0: 653a 2061 6464 2061 6e6e 6f74 6174 696f  e: add annotatio
-00015cb0: 6e20 636f 6e74 726f 6c20 6172 6773 2229  n control args")
-00015cc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015cd0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00015ce0: 2020 2020 2323 2061 6e6e 6f74 6174 696f      ## annotatio
-00015cf0: 6e20 7061 7261 6d73 0d0a 2020 2020 2020  n params..      
-00015d00: 2020 2020 2020 2020 2020 6966 206d 6574            if met
-00015d10: 686f 645f 6e61 6d65 2069 6e20 7365 7474  hod_name in sett
-00015d20: 696e 6773 2e5f 616e 6e6f 7461 7469 6f6e  ings._annotation
-00015d30: 5f66 756e 6374 696f 6e73 3a0d 0a0d 0a20  _functions:.... 
-00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d50: 2020 2061 6e6e 6f74 6174 696f 6e5f 636f     annotation_co
-00015d60: 756e 7465 725b 7365 7474 696e 6773 2e5f  unter[settings._
-00015d70: 616e 6e6f 7461 7469 6f6e 5f66 756e 6374  annotation_funct
-00015d80: 696f 6e73 5b6d 6574 686f 645f 6e61 6d65  ions[method_name
-00015d90: 5d5d 202b 3d20 310d 0a0d 0a20 2020 2020  ]] += 1....     
-00015da0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00015db0: 6620 6e6f 7420 2274 7970 6522 2069 6e20  f not "type" in 
-00015dc0: 616e 6e6f 7461 7469 6f6e 5f61 7267 733a  annotation_args:
-00015dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015de0: 2020 2020 2020 2020 2020 616e 6e6f 7461            annota
-00015df0: 7469 6f6e 5f61 7267 732e 7570 6461 7465  tion_args.update
-00015e00: 287b 2274 7970 6522 3a20 7365 7474 696e  ({"type": settin
-00015e10: 6773 2e5f 616e 6e6f 7461 7469 6f6e 5f66  gs._annotation_f
-00015e20: 756e 6374 696f 6e73 5b6d 6574 686f 645f  unctions[method_
-00015e30: 6e61 6d65 5d7d 290d 0a20 2020 2020 2020  name]})..       
-00015e40: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00015e50: 6e6f 7420 2269 6422 2069 6e20 616e 6e6f  not "id" in anno
-00015e60: 7461 7469 6f6e 5f61 7267 733a 0d0a 2020  tation_args:..  
-00015e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e80: 2020 2020 2020 616e 6e6f 7461 7469 6f6e        annotation
-00015e90: 5f61 7267 732e 7570 6461 7465 287b 2269  _args.update({"i
-00015ea0: 6422 3a20 7374 7269 6e67 2e61 7363 6969  d": string.ascii
-00015eb0: 5f6c 6f77 6572 6361 7365 5b61 6e6e 6f74  _lowercase[annot
-00015ec0: 6174 696f 6e5f 636f 756e 7465 725b 7365  ation_counter[se
-00015ed0: 7474 696e 6773 2e5f 616e 6e6f 7461 7469  ttings._annotati
-00015ee0: 6f6e 5f66 756e 6374 696f 6e73 5b6d 6574  on_functions[met
-00015ef0: 686f 645f 6e61 6d65 5d5d 5d7d 290d 0a20  hod_name]]]}).. 
-00015f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f10: 2020 2069 6620 6e6f 7420 2265 6469 7422     if not "edit"
-00015f20: 2069 6e20 616e 6e6f 7461 7469 6f6e 5f61   in annotation_a
-00015f30: 7267 733a 0d0a 2020 2020 2020 2020 2020  rgs:..          
-00015f40: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00015f50: 6e6f 7461 7469 6f6e 5f61 7267 732e 7570  notation_args.up
-00015f60: 6461 7465 287b 2265 6469 7422 3a20 226f  date({"edit": "o
-00015f70: 7665 7277 7269 7465 2220 6966 206d 6574  verwrite" if met
-00015f80: 686f 645f 6e61 6d65 2069 6e20 5b0d 0a20  hod_name in [.. 
-00015f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fb0: 2020 2022 636f 6e74 6f75 725f 746f 5f6d     "contour_to_m
-00015fc0: 6173 6b22 2c0d 0a20 2020 2020 2020 2020  ask",..         
-00015fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fe0: 2020 2020 2020 2020 2020 2022 6465 7465             "dete
-00015ff0: 6374 5f63 6f6e 746f 7572 222c 0d0a 2020  ct_contour",..  
-00016000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016020: 2020 2264 6574 6563 745f 6d61 736b 222c    "detect_mask",
+00015200: 3d3d 3d3d 0d0a 2020 2020 2020 2020 2020  ====..          
+00015210: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00015220: 2323 2070 7269 6e74 2063 7572 7265 6e74  ## print current
+00015230: 2073 7465 700d 0a20 2020 2020 2020 2020   step..         
+00015240: 2020 2069 6620 666c 6167 732e 6578 6563     if flags.exec
+00015250: 7574 6520 616e 6420 666c 6167 732e 6665  ute and flags.fe
+00015260: 6564 6261 636b 3a0d 0a20 2020 2020 2020  edback:..       
+00015270: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00015280: 5c6e 2229 0d0a 2020 2020 2020 2020 2020  \n")..          
+00015290: 2020 2020 2020 7072 696e 7428 7374 6570        print(step
+000152a0: 5f6e 616d 652e 7570 7065 7228 2929 0d0a  _name.upper())..
+000152b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000152c0: 2073 7465 705f 6e61 6d65 203d 3d20 2276   step_name == "v
+000152d0: 6973 7561 6c69 7a61 7469 6f6e 2220 616e  isualization" an
+000152e0: 6420 666c 6167 732e 6578 6563 7574 653a  d flags.execute:
+000152f0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00015300: 2020 2020 2323 2063 6865 636b 2069 6620      ## check if 
+00015310: 6361 6e76 6173 2069 7320 7365 6c65 6374  canvas is select
+00015320: 6564 2c20 616e 6420 6f74 6865 7277 6973  ed, and otherwis
+00015330: 6520 6578 6563 7574 6520 7769 7468 2064  e execute with d
+00015340: 6566 6175 6c74 2076 616c 7565 730d 0a20  efault values.. 
+00015350: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00015360: 6973 5f6c 6973 7420 3d20 5b0d 0a20 2020  is_list = [..   
+00015370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015380: 206c 6973 7428 6469 6374 2869 292e 6b65   list(dict(i).ke
+00015390: 7973 2829 295b 305d 2069 6620 6e6f 7420  ys())[0] if not 
+000153a0: 6973 696e 7374 616e 6365 2869 2c20 7374  isinstance(i, st
+000153b0: 7229 2065 6c73 6520 690d 0a20 2020 2020  r) else i..     
+000153c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000153d0: 6f72 2069 2069 6e20 6d65 7468 6f64 5f6c  or i in method_l
+000153e0: 6973 740d 0a20 2020 2020 2020 2020 2020  ist..           
+000153f0: 2020 2020 205d 0d0a 2020 2020 2020 2020       ]..        
+00015400: 2020 2020 2020 2020 6966 2028 0d0a 2020          if (..  
+00015410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015420: 2020 7365 6c66 2e63 6f6e 7461 696e 6572    self.container
+00015430: 2e63 616e 7661 732e 5f5f 636c 6173 735f  .canvas.__class_
+00015440: 5f2e 5f5f 6e61 6d65 5f5f 203d 3d20 224e  _.__name__ == "N
+00015450: 6f6e 6554 7970 6522 0d0a 2020 2020 2020  oneType"..      
+00015460: 2020 2020 2020 2020 2020 2020 2020 616e                an
+00015470: 6420 6e6f 7420 2273 656c 6563 745f 6361  d not "select_ca
+00015480: 6e76 6173 2220 696e 2076 6973 5f6c 6973  nvas" in vis_lis
+00015490: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
+000154a0: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
+000154b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000154c0: 636f 6e74 6169 6e65 722e 7275 6e28 2273  container.run("s
+000154d0: 656c 6563 745f 6361 6e76 6173 2229 0d0a  elect_canvas")..
+000154e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154f0: 2020 2020 6966 2066 6c61 6773 2e66 6565      if flags.fee
+00015500: 6462 6163 6b3a 0d0a 2020 2020 2020 2020  dback:..        
+00015510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015520: 7072 696e 7428 2273 656c 6563 745f 6361  print("select_ca
+00015530: 6e76 6173 2028 6175 746f 7365 6c65 6374  nvas (autoselect
+00015540: 2922 290d 0a20 2020 2020 2020 2020 2020  )")..           
+00015550: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00015560: 2020 2020 2020 2020 2020 2023 2320 6974             ## it
+00015570: 6572 6174 6520 7468 726f 7567 6820 7374  erate through st
+00015580: 6570 206c 6973 740d 0a20 2020 2020 2020  ep list..       
+00015590: 2020 2020 2066 6f72 206d 6574 686f 645f       for method_
+000155a0: 6964 782c 206d 6574 686f 6420 696e 2065  idx, method in e
+000155b0: 6e75 6d65 7261 7465 286d 6574 686f 645f  numerate(method_
+000155c0: 6c69 7374 293a 0d0a 0d0a 2020 2020 2020  list):....      
+000155d0: 2020 2020 2020 2020 2020 2320 3d3d 3d3d            # ====
+000155e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000155f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015600: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015610: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015620: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
+00015630: 2020 2020 2020 2020 2020 2023 204d 4554             # MET
+00015640: 484f 4420 2f20 4558 5452 4143 5449 4f4e  HOD / EXTRACTION
+00015650: 2041 4e44 2043 4845 434b 0d0a 2020 2020   AND CHECK..    
+00015660: 2020 2020 2020 2020 2020 2020 2320 3d3d              # ==
+00015670: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015680: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015690: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000156a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000156b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d 0a20  ===========.... 
+000156c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000156d0: 2320 666f 726d 6174 206d 6574 686f 6420  # format method 
+000156e0: 6e61 6d65 2061 6e64 2061 7267 756d 656e  name and argumen
+000156f0: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+00015700: 2020 2020 6966 206d 6574 686f 642e 5f5f      if method.__
+00015710: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+00015720: 2069 6e20 5b22 6469 6374 222c 2022 6f72   in ["dict", "or
+00015730: 6465 7265 6464 6963 7422 2c20 2243 6f6d  dereddict", "Com
+00015740: 6d65 6e74 6564 4d61 7022 5d3a 0d0a 2020  mentedMap"]:..  
+00015750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015760: 2020 6d65 7468 6f64 203d 2064 6963 7428    method = dict(
+00015770: 6d65 7468 6f64 290d 0a20 2020 2020 2020  method)..       
+00015780: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00015790: 686f 645f 6e61 6d65 203d 206c 6973 7428  hod_name = list(
+000157a0: 6d65 7468 6f64 2e6b 6579 7328 2929 5b30  method.keys())[0
+000157b0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000157c0: 2020 2020 2020 2069 6620 6e6f 7420 6c69         if not li
+000157d0: 7374 286d 6574 686f 642e 7661 6c75 6573  st(method.values
+000157e0: 2829 295b 305d 2e5f 5f63 6c61 7373 5f5f  ())[0].__class__
+000157f0: 2e5f 5f6e 616d 655f 5f20 3d3d 2022 4e6f  .__name__ == "No
+00015800: 6e65 5479 7065 223a 0d0a 2020 2020 2020  neType":..      
+00015810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015820: 2020 6d65 7468 6f64 5f61 7267 7320 3d20    method_args = 
+00015830: 6469 6374 286c 6973 7428 6d65 7468 6f64  dict(list(method
+00015840: 2e76 616c 7565 7328 2929 5b30 5d29 0d0a  .values())[0])..
+00015850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015860: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00015870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015880: 2020 206d 6574 686f 645f 6172 6773 203d     method_args =
+00015890: 207b 7d0d 0a20 2020 2020 2020 2020 2020   {}..           
+000158a0: 2020 2020 2065 6c69 6620 6d65 7468 6f64       elif method
+000158b0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
+000158c0: 655f 5f20 3d3d 2022 7374 7222 3a0d 0a20  e__ == "str":.. 
+000158d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000158e0: 2020 206d 6574 686f 645f 6e61 6d65 203d     method_name =
+000158f0: 206d 6574 686f 640d 0a20 2020 2020 2020   method..       
+00015900: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00015910: 686f 645f 6172 6773 203d 207b 7d0d 0a0d  hod_args = {}...
+00015920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015930: 2023 2320 6665 6564 6261 636b 0d0a 2020   ## feedback..  
+00015940: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00015950: 2066 6c61 6773 2e65 7865 6375 7465 3a0d   flags.execute:.
+00015960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015970: 2020 2020 2070 7269 6e74 286d 6574 686f       print(metho
+00015980: 645f 6e61 6d65 290d 0a0d 0a20 2020 2020  d_name)....     
+00015990: 2020 2020 2020 2020 2020 2023 2320 6368             ## ch
+000159a0: 6563 6b20 6966 206d 6574 686f 6420 6578  eck if method ex
+000159b0: 6973 7473 0d0a 2020 2020 2020 2020 2020  ists..          
+000159c0: 2020 2020 2020 6966 2068 6173 6174 7472        if hasattr
+000159d0: 2865 7661 6c28 7374 6570 5f6e 616d 6529  (eval(step_name)
+000159e0: 2c20 6d65 7468 6f64 5f6e 616d 6529 3a0d  , method_name):.
+000159f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015a00: 2020 2020 2073 656c 662e 636f 6e66 6967       self.config
+00015a10: 5f70 6172 7365 645f 666c 6174 7465 6e65  _parsed_flattene
+00015a20: 645b 7374 6570 5f6e 616d 655d 2e61 7070  d[step_name].app
+00015a30: 656e 6428 6d65 7468 6f64 5f6e 616d 6529  end(method_name)
+00015a40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015a50: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+00015a60: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00015a70: 2073 656c 662e 666c 6167 732e 6669 785f   self.flags.fix_
+00015a80: 6e61 6d65 733a 0d0a 2020 2020 2020 2020  names:..        
+00015a90: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00015aa0: 6574 686f 645f 6e61 6d65 2069 6e20 7365  ethod_name in se
+00015ab0: 7474 696e 6773 2e5f 6c65 6761 6379 5f6e  ttings._legacy_n
+00015ac0: 616d 6573 5b73 7465 705f 6e61 6d65 5d3a  ames[step_name]:
+00015ad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015ae0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00015af0: 5f6e 616d 655f 7570 6461 7465 6420 3d20  _name_updated = 
+00015b00: 7365 7474 696e 6773 2e5f 6c65 6761 6379  settings._legacy
+00015b10: 5f6e 616d 6573 5b73 7465 705f 6e61 6d65  _names[step_name
+00015b20: 5d5b 0d0a 2020 2020 2020 2020 2020 2020  ][..            
+00015b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b40: 6d65 7468 6f64 5f6e 616d 650d 0a20 2020  method_name..   
+00015b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b60: 2020 2020 205d 0d0a 2020 2020 2020 2020       ]..        
+00015b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b80: 7365 6c66 2e63 6f6e 6669 675f 7570 6461  self.config_upda
+00015b90: 7465 645b 2270 726f 6365 7373 696e 675f  ted["processing_
+00015ba0: 7374 6570 7322 5d5b 7374 6570 5f69 6478  steps"][step_idx
+00015bb0: 5d5b 7374 6570 5f6e 616d 655d 5b0d 0a20  ][step_name][.. 
+00015bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015bd0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00015be0: 645f 6964 780d 0a20 2020 2020 2020 2020  d_idx..         
+00015bf0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00015c00: 203d 207b 6d65 7468 6f64 5f6e 616d 655f   = {method_name_
+00015c10: 7570 6461 7465 643a 206d 6574 686f 645f  updated: method_
+00015c20: 6172 6773 7d0d 0a20 2020 2020 2020 2020  args}..         
+00015c30: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00015c40: 6574 686f 645f 6e61 6d65 203d 206d 6574  ethod_name = met
+00015c50: 686f 645f 6e61 6d65 5f75 7064 6174 6564  hod_name_updated
+00015c60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015c70: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00015c80: 2253 7461 6765 3a20 6669 7865 6420 6d65  "Stage: fixed me
+00015c90: 7468 6f64 206e 616d 6522 290d 0a20 2020  thod name")..   
+00015ca0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00015cb0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00015cc0: 2020 2020 2020 2020 7072 696e 7428 0d0a          print(..
+00015cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ce0: 2020 2020 2020 2020 2270 6865 6e6f 7079          "phenopy
+00015cf0: 7065 2e7b 7d20 6861 7320 6e6f 2066 756e  pe.{} has no fun
+00015d00: 6374 696f 6e20 6361 6c6c 6564 207b 7d20  ction called {} 
+00015d10: 2d20 7769 6c6c 2061 7474 656d 7074 2074  - will attempt t
+00015d20: 6f20 6c6f 6f6b 2066 6f72 2073 696d 696c  o look for simil
+00015d30: 6172 6c79 206e 616d 6564 2066 756e 6374  arly named funct
+00015d40: 696f 6e73 202d 2066 6978 2074 6865 2063  ions - fix the c
+00015d50: 6f6e 6669 6720 6669 6c65 2122 2e66 6f72  onfig file!".for
+00015d60: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
+00015d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d80: 2020 7374 6570 5f6e 616d 652c 206d 6574    step_name, met
+00015d90: 686f 645f 6e61 6d65 0d0a 2020 2020 2020  hod_name..      
+00015da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015db0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+00015dc0: 2020 2020 2020 2020 2029 0d0a 0d0a 2020           )....  
+00015dd0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00015de0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015df0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015e10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015e20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
+00015e30: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00015e40: 204d 4554 484f 4420 2f20 414e 4e4f 5441   METHOD / ANNOTA
+00015e50: 5449 4f4e 0d0a 2020 2020 2020 2020 2020  TION..          
+00015e60: 2020 2020 2020 2320 3d3d 3d3d 3d3d 3d3d        # ========
+00015e70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015e80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015e90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015ea0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015eb0: 3d3d 3d3d 3d0d 0a20 2020 2020 2020 2020  =====..         
+00015ec0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00015ed0: 2020 2020 2020 2020 2069 6620 6d65 7468           if meth
+00015ee0: 6f64 5f6e 616d 6520 696e 206c 6973 7428  od_name in list(
+00015ef0: 7365 7474 696e 6773 2e5f 616e 6e6f 7461  settings._annota
+00015f00: 7469 6f6e 5f66 756e 6374 696f 6e73 2e6b  tion_functions.k
+00015f10: 6579 7328 2929 202b 205b 2263 6f6e 7665  eys()) + ["conve
+00015f20: 7274 5f61 6e6e 6f74 6174 696f 6e22 5d3a  rt_annotation"]:
+00015f30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015f40: 2020 2020 2020 6966 2022 414e 4e4f 5441        if "ANNOTA
+00015f50: 5449 4f4e 2220 696e 206d 6574 686f 645f  TION" in method_
+00015f60: 6172 6773 3a0d 0a20 2020 2020 2020 2020  args:..         
+00015f70: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00015f80: 6e6e 6f74 6174 696f 6e5f 6172 6773 203d  nnotation_args =
+00015f90: 2064 6963 7428 6d65 7468 6f64 5f61 7267   dict(method_arg
+00015fa0: 735b 2241 4e4e 4f54 4154 494f 4e22 5d29  s["ANNOTATION"])
+00015fb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015fc0: 2020 2020 2020 2020 2020 6465 6c20 6d65            del me
+00015fd0: 7468 6f64 5f61 7267 735b 2241 4e4e 4f54  thod_args["ANNOT
+00015fe0: 4154 494f 4e22 5d0d 0a20 2020 2020 2020  ATION"]..       
+00015ff0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00016000: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00016010: 2020 2020 2020 2020 2020 2020 616e 6e6f              anno
+00016020: 7461 7469 6f6e 5f61 7267 7320 3d20 7b7d  tation_args = {}
 00016030: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016050: 2020 2020 2020 2263 6f6d 7075 7465 5f73        "compute_s
-00016060: 6861 7065 5f66 6561 7475 7265 7322 2c0d  hape_features",.
-00016070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016090: 2020 2020 2022 636f 6d70 7574 655f 7465       "compute_te
-000160a0: 7874 7572 655f 6665 6174 7572 6573 222c  xture_features",
-000160b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000160c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000160d0: 2020 2020 2020 2264 6574 6563 745f 736b        "detect_sk
-000160e0: 656c 6574 6f6e 222c 0d0a 2020 2020 2020  eleton",..      
-000160f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016100: 2020 2020 2020 2020 2020 5d20 656c 7365            ] else
-00016110: 2046 616c 7365 207d 290d 0a0d 0a0d 0a20   False })...... 
-00016120: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00016130: 6c69 6620 6d65 7468 6f64 5f6e 616d 6520  lif method_name 
-00016140: 696e 205b 2263 6f6e 7665 7274 5f61 6e6e  in ["convert_ann
-00016150: 6f74 6174 696f 6e22 5d3a 0d0a 2020 2020  otation"]:..    
-00016160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016170: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00016180: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00016190: 6e6f 7461 7469 6f6e 5f74 7970 6520 3d20  notation_type = 
-000161a0: 6d65 7468 6f64 5f61 7267 735b 2261 6e6e  method_args["ann
-000161b0: 6f74 6174 696f 6e5f 7479 7065 5f6e 6577  otation_type_new
-000161c0: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
-000161d0: 2020 2020 2020 2020 2020 2020 616e 6e6f              anno
-000161e0: 7461 7469 6f6e 5f69 6420 3d20 6d65 7468  tation_id = meth
-000161f0: 6f64 5f61 7267 735b 2261 6e6e 6f74 6174  od_args["annotat
-00016200: 696f 6e5f 6964 5f6e 6577 225d 0d0a 2020  ion_id_new"]..  
-00016210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016220: 2020 2020 2020 616e 6e6f 7461 7469 6f6e        annotation
-00016230: 5f61 7267 732e 7570 6461 7465 287b 2274  _args.update({"t
-00016240: 7970 6522 3a61 6e6e 6f74 6174 696f 6e5f  ype":annotation_
-00016250: 7479 7065 2c20 2269 6422 3a61 6e6e 6f74  type, "id":annot
-00016260: 6174 696f 6e5f 6964 2c20 2265 6469 7422  ation_id, "edit"
-00016270: 3a22 6f76 6572 7772 6974 6522 7d29 0d0a  :"overwrite"})..
-00016280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016290: 2020 2020 6578 6365 7074 204b 6579 4572      except KeyEr
-000162a0: 726f 723a 0d0a 2020 2020 2020 2020 2020  ror:..          
-000162b0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000162c0: 696e 7428 224d 6973 7369 6e67 2061 7267  int("Missing arg
-000162d0: 756d 656e 7473 2066 6f72 2061 6e6e 6f74  uments for annot
-000162e0: 6174 696f 6e20 636f 6e76 6572 7369 6f6e  ation conversion
-000162f0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00016300: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00016310: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00016320: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00016330: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
-00016340: 696f 6e5f 6172 6773 203d 207b 7d0d 0a0d  ion_args = {}...
-00016350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016360: 2023 2320 6372 6561 7465 2041 4e4e 4f54   ## create ANNOT
-00016370: 4154 494f 4e20 7374 7269 6e67 2061 6e64  ATION string and
-00016380: 2061 6464 2074 6f20 636f 6e66 6967 0d0a   add to config..
+00016040: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00016050: 5f61 7267 7320 3d20 6469 6374 286d 6574  _args = dict(met
+00016060: 686f 645f 6172 6773 290d 0a20 2020 2020  hod_args)..     
+00016070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016080: 2020 2070 7269 6e74 2822 5374 6167 653a     print("Stage:
+00016090: 2061 6464 2061 6e6e 6f74 6174 696f 6e20   add annotation 
+000160a0: 636f 6e74 726f 6c20 6172 6773 2229 0d0a  control args")..
+000160b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000160d0: 2020 2323 2061 6e6e 6f74 6174 696f 6e20    ## annotation 
+000160e0: 7061 7261 6d73 0d0a 2020 2020 2020 2020  params..        
+000160f0: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
+00016100: 645f 6e61 6d65 2069 6e20 7365 7474 696e  d_name in settin
+00016110: 6773 2e5f 616e 6e6f 7461 7469 6f6e 5f66  gs._annotation_f
+00016120: 756e 6374 696f 6e73 3a0d 0a0d 0a20 2020  unctions:....   
+00016130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016140: 2061 6e6e 6f74 6174 696f 6e5f 636f 756e   annotation_coun
+00016150: 7465 725b 7365 7474 696e 6773 2e5f 616e  ter[settings._an
+00016160: 6e6f 7461 7469 6f6e 5f66 756e 6374 696f  notation_functio
+00016170: 6e73 5b6d 6574 686f 645f 6e61 6d65 5d5d  ns[method_name]]
+00016180: 202b 3d20 310d 0a0d 0a20 2020 2020 2020   += 1....       
+00016190: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000161a0: 6e6f 7420 2274 7970 6522 2069 6e20 616e  not "type" in an
+000161b0: 6e6f 7461 7469 6f6e 5f61 7267 733a 0d0a  notation_args:..
+000161c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000161d0: 2020 2020 2020 2020 616e 6e6f 7461 7469          annotati
+000161e0: 6f6e 5f61 7267 732e 7570 6461 7465 287b  on_args.update({
+000161f0: 2274 7970 6522 3a20 7365 7474 696e 6773  "type": settings
+00016200: 2e5f 616e 6e6f 7461 7469 6f6e 5f66 756e  ._annotation_fun
+00016210: 6374 696f 6e73 5b6d 6574 686f 645f 6e61  ctions[method_na
+00016220: 6d65 5d7d 290d 0a20 2020 2020 2020 2020  me]})..         
+00016230: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00016240: 7420 2269 6422 2069 6e20 616e 6e6f 7461  t "id" in annota
+00016250: 7469 6f6e 5f61 7267 733a 0d0a 2020 2020  tion_args:..    
+00016260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016270: 2020 2020 616e 6e6f 7461 7469 6f6e 5f61      annotation_a
+00016280: 7267 732e 7570 6461 7465 287b 2269 6422  rgs.update({"id"
+00016290: 3a20 7374 7269 6e67 2e61 7363 6969 5f6c  : string.ascii_l
+000162a0: 6f77 6572 6361 7365 5b61 6e6e 6f74 6174  owercase[annotat
+000162b0: 696f 6e5f 636f 756e 7465 725b 7365 7474  ion_counter[sett
+000162c0: 696e 6773 2e5f 616e 6e6f 7461 7469 6f6e  ings._annotation
+000162d0: 5f66 756e 6374 696f 6e73 5b6d 6574 686f  _functions[metho
+000162e0: 645f 6e61 6d65 5d5d 5d7d 290d 0a20 2020  d_name]]]})..   
+000162f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016300: 2069 6620 6e6f 7420 2265 6469 7422 2069   if not "edit" i
+00016310: 6e20 616e 6e6f 7461 7469 6f6e 5f61 7267  n annotation_arg
+00016320: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00016330: 2020 2020 2020 2020 2020 2020 616e 6e6f              anno
+00016340: 7461 7469 6f6e 5f61 7267 732e 7570 6461  tation_args.upda
+00016350: 7465 287b 2265 6469 7422 3a20 226f 7665  te({"edit": "ove
+00016360: 7277 7269 7465 2220 6966 206d 6574 686f  rwrite" if metho
+00016370: 645f 6e61 6d65 2069 6e20 5b0d 0a20 2020  d_name in [..   
+00016380: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000163a0: 6966 2061 6e6e 6f74 6174 696f 6e5f 6172  if annotation_ar
-000163b0: 6773 3a0d 0a20 2020 2020 2020 2020 2020  gs:..           
-000163c0: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
-000163d0: 696f 6e5f 6172 6773 203d 2075 7469 6c73  ion_args = utils
-000163e0: 5f6c 6f77 6c65 7665 6c2e 5f79 616d 6c5f  _lowlevel._yaml_
-000163f0: 666c 6f77 5f73 7479 6c65 2861 6e6e 6f74  flow_style(annot
-00016400: 6174 696f 6e5f 6172 6773 290d 0a20 2020  ation_args)..   
-00016410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016420: 206d 6574 686f 645f 6172 6773 5f75 7064   method_args_upd
-00016430: 6174 6564 203d 207b 2241 4e4e 4f54 4154  ated = {"ANNOTAT
-00016440: 494f 4e22 3a20 616e 6e6f 7461 7469 6f6e  ION": annotation
-00016450: 5f61 7267 737d 0d0a 2020 2020 2020 2020  _args}..        
-00016460: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00016470: 6f64 5f61 7267 735f 7570 6461 7465 642e  od_args_updated.
-00016480: 7570 6461 7465 286d 6574 686f 645f 6172  update(method_ar
-00016490: 6773 290d 0a20 2020 2020 2020 2020 2020  gs)..           
-000164a0: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-000164b0: 6e66 6967 5f75 7064 6174 6564 5b22 7072  nfig_updated["pr
-000164c0: 6f63 6573 7369 6e67 5f73 7465 7073 225d  ocessing_steps"]
-000164d0: 5b73 7465 705f 6964 785d 5b73 7465 705f  [step_idx][step_
-000164e0: 6e61 6d65 5d5b 6d65 7468 6f64 5f69 6478  name][method_idx
-000164f0: 5d20 3d20 7b6d 6574 686f 645f 6e61 6d65  ] = {method_name
-00016500: 3a20 6d65 7468 6f64 5f61 7267 735f 7570  : method_args_up
-00016510: 6461 7465 647d 0d0a 0d0a 2020 2020 2020  dated}....      
-00016520: 2020 2020 2020 2020 2020 2320 3d3d 3d3d            # ====
-00016530: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016540: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016550: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016560: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016570: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
-00016580: 2020 2020 2020 2020 2020 2023 204d 4554             # MET
-00016590: 484f 4420 2f20 4558 4543 5554 450d 0a20  HOD / EXECUTE.. 
-000165a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000165b0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-000165c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000165d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000165e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000165f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-00016600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016610: 2020 2323 2072 756e 206d 6574 686f 6420    ## run method 
-00016620: 7769 7468 2065 7272 6f72 2068 616e 646c  with error handl
-00016630: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
-00016640: 2020 2020 2069 6620 666c 6167 732e 6578       if flags.ex
-00016650: 6563 7574 653a 0d0a 2020 2020 2020 2020  ecute:..        
-00016660: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00016670: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-00016680: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00016690: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000166a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166b0: 2020 2020 2020 2323 2065 6e73 7572 6520        ## ensure 
-000166c0: 6665 6564 6261 636b 2069 6e20 4755 4920  feedback in GUI 
-000166d0: 6973 2061 6374 6976 650d 0a20 2020 2020  is active..     
-000166e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166f0: 2020 206d 6574 686f 645f 6172 6773 5b22     method_args["
-00016700: 6665 6564 6261 636b 225d 203d 2066 6c61  feedback"] = fla
-00016710: 6773 2e66 6565 6462 6163 6b20 2020 2020  gs.feedback     
-00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016730: 2020 200d 0a0d 0a20 2020 2020 2020 2020     ....         
+000163a0: 2022 636f 6e74 6f75 725f 746f 5f6d 6173   "contour_to_mas
+000163b0: 6b22 2c0d 0a20 2020 2020 2020 2020 2020  k",..           
+000163c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000163d0: 2020 2020 2020 2020 2022 6465 7465 6374           "detect
+000163e0: 5f63 6f6e 746f 7572 222c 0d0a 2020 2020  _contour",..    
+000163f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016410: 2264 6574 6563 745f 6d61 736b 222c 0d0a  "detect_mask",..
+00016420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016440: 2020 2020 2263 6f6d 7075 7465 5f73 6861      "compute_sha
+00016450: 7065 5f66 6561 7475 7265 7322 2c0d 0a20  pe_features",.. 
+00016460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016480: 2020 2022 636f 6d70 7574 655f 7465 7874     "compute_text
+00016490: 7572 655f 6665 6174 7572 6573 222c 0d0a  ure_features",..
+000164a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000164b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000164c0: 2020 2020 2264 6574 6563 745f 736b 656c      "detect_skel
+000164d0: 6574 6f6e 222c 0d0a 2020 2020 2020 2020  eton",..        
+000164e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000164f0: 2020 2020 2020 2020 5d20 656c 7365 2046          ] else F
+00016500: 616c 7365 207d 290d 0a0d 0a0d 0a20 2020  alse })......   
+00016510: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00016520: 6620 6d65 7468 6f64 5f6e 616d 6520 696e  f method_name in
+00016530: 205b 2263 6f6e 7665 7274 5f61 6e6e 6f74   ["convert_annot
+00016540: 6174 696f 6e22 5d3a 0d0a 2020 2020 2020  ation"]:..      
+00016550: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00016560: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00016570: 2020 2020 2020 2020 2020 2020 616e 6e6f              anno
+00016580: 7461 7469 6f6e 5f74 7970 6520 3d20 6d65  tation_type = me
+00016590: 7468 6f64 5f61 7267 735b 2261 6e6e 6f74  thod_args["annot
+000165a0: 6174 696f 6e5f 7479 7065 5f6e 6577 225d  ation_type_new"]
+000165b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000165c0: 2020 2020 2020 2020 2020 616e 6e6f 7461            annota
+000165d0: 7469 6f6e 5f69 6420 3d20 6d65 7468 6f64  tion_id = method
+000165e0: 5f61 7267 735b 2261 6e6e 6f74 6174 696f  _args["annotatio
+000165f0: 6e5f 6964 5f6e 6577 225d 0d0a 2020 2020  n_id_new"]..    
+00016600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016610: 2020 2020 616e 6e6f 7461 7469 6f6e 5f61      annotation_a
+00016620: 7267 732e 7570 6461 7465 287b 2274 7970  rgs.update({"typ
+00016630: 6522 3a61 6e6e 6f74 6174 696f 6e5f 7479  e":annotation_ty
+00016640: 7065 2c20 2269 6422 3a61 6e6e 6f74 6174  pe, "id":annotat
+00016650: 696f 6e5f 6964 2c20 2265 6469 7422 3a22  ion_id, "edit":"
+00016660: 6f76 6572 7772 6974 6522 7d29 0d0a 2020  overwrite"})..  
+00016670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016680: 2020 6578 6365 7074 204b 6579 4572 726f    except KeyErro
+00016690: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+000166a0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000166b0: 7428 224d 6973 7369 6e67 2061 7267 756d  t("Missing argum
+000166c0: 656e 7473 2066 6f72 2061 6e6e 6f74 6174  ents for annotat
+000166d0: 696f 6e20 636f 6e76 6572 7369 6f6e 2229  ion conversion")
+000166e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000166f0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00016700: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00016710: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00016720: 2020 2020 2020 2061 6e6e 6f74 6174 696f         annotatio
+00016730: 6e5f 6172 6773 203d 207b 7d0d 0a0d 0a20  n_args = {}.... 
 00016740: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00016750: 2320 6578 6365 6375 7465 0d0a 2020 2020  # excecute..    
-00016760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016770: 2020 2020 7365 6c66 2e63 6f6e 7461 696e      self.contain
-00016780: 6572 2e72 756e 280d 0a20 2020 2020 2020  er.run(..       
-00016790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167a0: 2020 2020 2066 756e 3d6d 6574 686f 645f       fun=method_
-000167b0: 6e61 6d65 2c0d 0a20 2020 2020 2020 2020  name,..         
-000167c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167d0: 2020 2066 756e 5f6b 7761 7267 733d 6d65     fun_kwargs=me
-000167e0: 7468 6f64 5f61 7267 732c 0d0a 2020 2020  thod_args,..    
-000167f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016800: 2020 2020 2020 2020 616e 6e6f 7461 7469          annotati
-00016810: 6f6e 5f6b 7761 7267 733d 616e 6e6f 7461  on_kwargs=annota
-00016820: 7469 6f6e 5f61 7267 732c 0d0a 2020 2020  tion_args,..    
-00016830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016840: 2020 2020 2020 2020 616e 6e6f 7461 7469          annotati
-00016850: 6f6e 5f63 6f75 6e74 6572 3d61 6e6e 6f74  on_counter=annot
-00016860: 6174 696f 6e5f 636f 756e 7465 722c 0d0a  ation_counter,..
-00016870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016880: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00016890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168a0: 2020 2023 2320 6665 6564 6261 636b 2063     ## feedback c
-000168b0: 6c65 616e 7570 0d0a 2020 2020 2020 2020  leanup..        
-000168c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168d0: 5f63 6f6e 6669 672e 6c61 7374 5f70 7269  _config.last_pri
-000168e0: 6e74 5f6d 7367 203d 2022 220d 0a0d 0a20  nt_msg = "".... 
-000168f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016900: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-00016910: 696f 6e20 6173 2065 783a 0d0a 2020 2020  ion as ex:..    
-00016920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016930: 2020 2020 6966 2073 656c 662e 666c 6167      if self.flag
-00016940: 732e 6465 6275 673a 0d0a 2020 2020 2020  s.debug:..      
-00016950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016960: 2020 2020 2020 7261 6973 650d 0a20 2020        raise..   
-00016970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016980: 2020 2020 2073 656c 662e 6c6f 672e 6170       self.log.ap
-00016990: 7065 6e64 2865 7829 0d0a 2020 2020 2020  pend(ex)..      
-000169a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169b0: 2020 6c6f 6361 7469 6f6e 203d 2028 0d0a    location = (..
-000169c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169d0: 2020 2020 2020 2020 2020 2020 7374 6570              step
-000169e0: 5f6e 616d 650d 0a20 2020 2020 2020 2020  _name..         
+00016750: 2320 6372 6561 7465 2041 4e4e 4f54 4154  # create ANNOTAT
+00016760: 494f 4e20 7374 7269 6e67 2061 6e64 2061  ION string and a
+00016770: 6464 2074 6f20 636f 6e66 6967 0d0a 2020  dd to config..  
+00016780: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00016790: 2061 6e6e 6f74 6174 696f 6e5f 6172 6773   annotation_args
+000167a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000167b0: 2020 2020 2020 2061 6e6e 6f74 6174 696f         annotatio
+000167c0: 6e5f 6172 6773 203d 2075 7469 6c73 5f6c  n_args = utils_l
+000167d0: 6f77 6c65 7665 6c2e 5f79 616d 6c5f 666c  owlevel._yaml_fl
+000167e0: 6f77 5f73 7479 6c65 2861 6e6e 6f74 6174  ow_style(annotat
+000167f0: 696f 6e5f 6172 6773 290d 0a20 2020 2020  ion_args)..     
+00016800: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00016810: 6574 686f 645f 6172 6773 5f75 7064 6174  ethod_args_updat
+00016820: 6564 203d 207b 2241 4e4e 4f54 4154 494f  ed = {"ANNOTATIO
+00016830: 4e22 3a20 616e 6e6f 7461 7469 6f6e 5f61  N": annotation_a
+00016840: 7267 737d 0d0a 2020 2020 2020 2020 2020  rgs}..          
+00016850: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00016860: 5f61 7267 735f 7570 6461 7465 642e 7570  _args_updated.up
+00016870: 6461 7465 286d 6574 686f 645f 6172 6773  date(method_args
+00016880: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00016890: 2020 2020 2020 2073 656c 662e 636f 6e66         self.conf
+000168a0: 6967 5f75 7064 6174 6564 5b22 7072 6f63  ig_updated["proc
+000168b0: 6573 7369 6e67 5f73 7465 7073 225d 5b73  essing_steps"][s
+000168c0: 7465 705f 6964 785d 5b73 7465 705f 6e61  tep_idx][step_na
+000168d0: 6d65 5d5b 6d65 7468 6f64 5f69 6478 5d20  me][method_idx] 
+000168e0: 3d20 7b6d 6574 686f 645f 6e61 6d65 3a20  = {method_name: 
+000168f0: 6d65 7468 6f64 5f61 7267 735f 7570 6461  method_args_upda
+00016900: 7465 647d 0d0a 0d0a 2020 2020 2020 2020  ted}....        
+00016910: 2020 2020 2020 2020 2320 3d3d 3d3d 3d3d          # ======
+00016920: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016930: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016940: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016950: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016960: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020 2020  =======..       
+00016970: 2020 2020 2020 2020 2023 204d 4554 484f           # METHO
+00016980: 4420 2f20 4558 4543 5554 450d 0a20 2020  D / EXECUTE..   
+00016990: 2020 2020 2020 2020 2020 2020 2023 203d               # =
+000169a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000169b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000169c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000169d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000169e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a  ============....
 000169f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a00: 2020 202b 2022 2e22 0d0a 2020 2020 2020     + "."..      
-00016a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a20: 2020 2020 2020 2b20 6d65 7468 6f64 5f6e        + method_n
-00016a30: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
-00016a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a50: 202b 2022 3a20 220d 0a20 2020 2020 2020   + ": "..       
-00016a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a70: 2020 2020 202b 2073 7472 2865 782e 5f5f       + str(ex.__
-00016a80: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-00016a90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00016aa0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00016ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ac0: 2020 2020 2020 7072 696e 7428 6c6f 6361        print(loca
-00016ad0: 7469 6f6e 202b 2022 202d 2022 202b 2073  tion + " - " + s
-00016ae0: 7472 2865 7829 290d 0a0d 0a20 2020 2020  tr(ex))....     
-00016af0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00016b00: 2320 6368 6563 6b20 666f 7220 7079 7065  # check for pype
-00016b10: 2d72 6573 7461 7274 2061 6674 6572 2063  -restart after c
-00016b20: 6f6e 6669 6720 6368 616e 6765 0d0a 2020  onfig change..  
-00016b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b40: 2020 6966 205f 636f 6e66 6967 2e70 7970    if _config.pyp
-00016b50: 655f 7265 7374 6172 743a 0d0a 2020 2020  e_restart:..    
-00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b70: 2020 2020 7072 696e 7428 2242 5245 414b      print("BREAK
-00016b80: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00016b90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00016ba0: 726e 0d0a 2020 2020 2020 2020 2020 2020  rn..            
-00016bb0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00016bc0: 2020 2320 7379 732e 7374 646f 7574 203d    # sys.stdout =
-00016bd0: 2073 656c 662e 6f6c 645f 7374 646f 7574   self.old_stdout
-00016be0: 0d0a 0d0a 2020 2020 2020 2020 2320 3d3d  ....        # ==
-00016bf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016c00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016c10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016c20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016c30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
-00016c40: 2020 2020 2023 2043 4f4e 4649 472d 5550       # CONFIG-UP
-00016c50: 4441 5445 2041 4e44 2041 5554 4f53 484f  DATE AND AUTOSHO
-00016c60: 5720 286f 7074 696f 6e61 6c29 0d0a 2020  W (optional)..  
-00016c70: 2020 2020 2020 2320 3d3d 3d3d 3d3d 3d3d        # ========
-00016c80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016c90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016ca0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016cb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00016cc0: 3d3d 3d3d 3d0d 0a0d 0a20 2020 2020 2020  =====....       
-00016cd0: 2069 6620 6e6f 7420 7365 6c66 2e63 6f6e   if not self.con
-00016ce0: 6669 675f 7570 6461 7465 6420 3d3d 2073  fig_updated == s
-00016cf0: 656c 662e 636f 6e66 6967 3a0d 0a20 2020  elf.config:..   
-00016d00: 2020 2020 2020 2020 2075 7469 6c73 5f6c           utils_l
-00016d10: 6f77 6c65 7665 6c2e 5f73 6176 655f 7961  owlevel._save_ya
-00016d20: 6d6c 2873 656c 662e 636f 6e66 6967 5f75  ml(self.config_u
-00016d30: 7064 6174 6564 2c20 7365 6c66 2e63 6f6e  pdated, self.con
-00016d40: 6669 675f 7061 7468 290d 0a20 2020 2020  fig_path)..     
-00016d50: 2020 2020 2020 2070 7269 6e74 2822 5570         print("Up
-00016d60: 6461 7469 6e67 2070 7970 6520 636f 6e66  dating pype conf
-00016d70: 6967 3a20 6170 706c 7969 6e67 2073 7461  ig: applying sta
-00016d80: 6765 6420 6368 616e 6765 7322 290d 0a0d  ged changes")...
-00016d90: 0a20 2020 2020 2020 2069 6620 666c 6167  .        if flag
-00016da0: 732e 6578 6563 7574 653a 0d0a 2020 2020  s.execute:..    
-00016db0: 2020 2020 2020 2020 7072 696e 7428 0d0a          print(..
+00016a00: 2323 2072 756e 206d 6574 686f 6420 7769  ## run method wi
+00016a10: 7468 2065 7272 6f72 2068 616e 646c 696e  th error handlin
+00016a20: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
+00016a30: 2020 2069 6620 666c 6167 732e 6578 6563     if flags.exec
+00016a40: 7574 653a 0d0a 2020 2020 2020 2020 2020  ute:..          
+00016a50: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00016a60: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00016a70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016a80: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00016a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016aa0: 2020 2020 2323 2065 6e73 7572 6520 6665      ## ensure fe
+00016ab0: 6564 6261 636b 2069 6e20 4755 4920 6973  edback in GUI is
+00016ac0: 2061 6374 6976 650d 0a20 2020 2020 2020   active..       
+00016ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ae0: 206d 6574 686f 645f 6172 6773 5b22 6665   method_args["fe
+00016af0: 6564 6261 636b 225d 203d 2066 6c61 6773  edback"] = flags
+00016b00: 2e66 6565 6462 6163 6b20 2020 2020 2020  .feedback       
+00016b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b20: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00016b30: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00016b40: 645f 6172 6773 5b22 7a6f 6f6d 5f6d 656d  d_args["zoom_mem
+00016b50: 6f72 7922 5d20 3d20 7365 6c66 2e66 6c61  ory"] = self.fla
+00016b60: 6773 2e7a 6f6f 6d5f 6d65 6d6f 7279 2020  gs.zoom_memory  
+00016b70: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00016b80: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00016b90: 2020 2020 2020 2020 2020 2023 2320 6578             ## ex
+00016ba0: 6365 6375 7465 0d0a 2020 2020 2020 2020  cecute..        
+00016bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016bc0: 7365 6c66 2e63 6f6e 7461 696e 6572 2e72  self.container.r
+00016bd0: 756e 280d 0a20 2020 2020 2020 2020 2020  un(..           
+00016be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016bf0: 2066 756e 3d6d 6574 686f 645f 6e61 6d65   fun=method_name
+00016c00: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00016c10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00016c20: 756e 5f6b 7761 7267 733d 6d65 7468 6f64  un_kwargs=method
+00016c30: 5f61 7267 732c 0d0a 2020 2020 2020 2020  _args,..        
+00016c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c50: 2020 2020 616e 6e6f 7461 7469 6f6e 5f6b      annotation_k
+00016c60: 7761 7267 733d 616e 6e6f 7461 7469 6f6e  wargs=annotation
+00016c70: 5f61 7267 732c 0d0a 2020 2020 2020 2020  _args,..        
+00016c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c90: 2020 2020 616e 6e6f 7461 7469 6f6e 5f63      annotation_c
+00016ca0: 6f75 6e74 6572 3d61 6e6e 6f74 6174 696f  ounter=annotatio
+00016cb0: 6e5f 636f 756e 7465 722c 0d0a 2020 2020  n_counter,..    
+00016cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cd0: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+00016ce0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00016cf0: 2320 6665 6564 6261 636b 2063 6c65 616e  # feedback clean
+00016d00: 7570 0d0a 2020 2020 2020 2020 2020 2020  up..            
+00016d10: 2020 2020 2020 2020 2020 2020 5f63 6f6e              _con
+00016d20: 6669 672e 6c61 7374 5f70 7269 6e74 5f6d  fig.last_print_m
+00016d30: 7367 203d 2022 220d 0a0d 0a20 2020 2020  sg = ""....     
+00016d40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00016d50: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00016d60: 6173 2065 783a 0d0a 2020 2020 2020 2020  as ex:..        
+00016d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d80: 6966 2073 656c 662e 666c 6167 732e 6465  if self.flags.de
+00016d90: 6275 673a 0d0a 2020 2020 2020 2020 2020  bug:..          
+00016da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016db0: 2020 7261 6973 650d 0a20 2020 2020 2020    raise..       
 00016dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016dd0: 225c 6e5c 6e2d 2d2d 2d2d 2d2d 2d2d 2d2d  "\n\n-----------
-00016de0: 2d2b 2b2b 2066 696e 6973 6865 6420 7079  -+++ finished py
-00016df0: 7065 2069 7465 7261 7469 6f6e 202b 2b2b  pe iteration +++
-00016e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 5c6e  --------------\n
-00016e10: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00016e20: 2020 2022 2d2d 2d2d 2d2d 2d28 456e 6420     "-------(End 
-00016e30: 7769 7468 2043 7472 6c2b 456e 7465 7220  with Ctrl+Enter 
-00016e40: 6f72 2072 652d 7275 6e20 7769 7468 2045  or re-run with E
-00016e50: 6e74 6572 292d 2d2d 2d2d 2d2d 2d5c 6e5c  nter)--------\n\
-00016e60: 6e22 0d0a 2020 2020 2020 2020 2020 2020  n"..            
-00016e70: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00016e80: 666c 6167 732e 6175 746f 7368 6f77 3a0d  flags.autoshow:.
-00016e90: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00016ea0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00016eb0: 2020 2070 7269 6e74 2822 4155 544f 5348     print("AUTOSH
-00016ec0: 4f57 2229 0d0a 2020 2020 2020 2020 2020  OW")..          
-00016ed0: 2020 2020 2020 6966 2073 656c 662e 636f        if self.co
-00016ee0: 6e74 6169 6e65 722e 6361 6e76 6173 2e5f  ntainer.canvas._
-00016ef0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-00016f00: 5f20 3d3d 2022 4e6f 6e65 5479 7065 223a  _ == "NoneType":
-00016f10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016f20: 2020 2020 2020 7365 6c66 2e63 6f6e 7461        self.conta
-00016f30: 696e 6572 2e72 756e 2866 756e 3d22 7365  iner.run(fun="se
-00016f40: 6c65 6374 5f63 616e 7661 7322 290d 0a20  lect_canvas").. 
-00016f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f60: 2020 2070 7269 6e74 2822 2d20 6175 746f     print("- auto
-00016f70: 7365 6c65 6374 2063 616e 7661 7322 290d  select canvas").
-00016f80: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00016f90: 2020 2073 656c 662e 6775 6920 3d20 7574     self.gui = ut
-00016fa0: 696c 735f 6c6f 776c 6576 656c 2e5f 4755  ils_lowlevel._GU
-00016fb0: 4928 7365 6c66 2e63 6f6e 7461 696e 6572  I(self.container
-00016fc0: 2e63 616e 7661 7329 0d0a 2020 2020 2020  .canvas)..      
-00016fd0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-00016fe0: 6c61 6773 2e74 6572 6d69 6e61 7465 203d  lags.terminate =
-00016ff0: 2073 656c 662e 6775 692e 666c 6167 732e   self.gui.flags.
-00017000: 656e 645f 7079 7065 0d0a 0d0a 2020 2020  end_pype....    
-00017010: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-00017020: 7863 6570 7469 6f6e 2061 7320 6578 3a0d  xception as ex:.
-00017030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017040: 2070 7269 6e74 2822 7669 7375 616c 6973   print("visualis
-00017050: 6174 696f 6e3a 2022 202b 2073 7472 2865  ation: " + str(e
-00017060: 782e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  x.__class__.__na
-00017070: 6d65 5f5f 2920 2b20 2220 2d20 2220 2b20  me__) + " - " + 
-00017080: 7374 7228 6578 2929 0d0a 2020 2020 2020  str(ex))..      
-00017090: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000170a0: 2020 2020 2069 6620 666c 6167 732e 6578       if flags.ex
-000170b0: 6563 7574 653a 0d0a 2020 2020 2020 2020  ecute:..        
-000170c0: 2020 2020 2020 2020 7365 6c66 2e66 6c61          self.fla
-000170d0: 6773 2e74 6572 6d69 6e61 7465 203d 2054  gs.terminate = T
-000170e0: 7275 650d 0a                             rue..
+00016dd0: 2073 656c 662e 6c6f 672e 6170 7065 6e64   self.log.append
+00016de0: 2865 7829 0d0a 2020 2020 2020 2020 2020  (ex)..          
+00016df0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00016e00: 6361 7469 6f6e 203d 2028 0d0a 2020 2020  cation = (..    
+00016e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e20: 2020 2020 2020 2020 7374 6570 5f6e 616d          step_nam
+00016e30: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+00016e40: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+00016e50: 2022 2e22 0d0a 2020 2020 2020 2020 2020   "."..          
+00016e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e70: 2020 2b20 6d65 7468 6f64 5f6e 616d 650d    + method_name.
+00016e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016e90: 2020 2020 2020 2020 2020 2020 202b 2022               + "
+00016ea0: 3a20 220d 0a20 2020 2020 2020 2020 2020  : "..           
+00016eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ec0: 202b 2073 7472 2865 782e 5f5f 636c 6173   + str(ex.__clas
+00016ed0: 735f 5f2e 5f5f 6e61 6d65 5f5f 290d 0a20  s__.__name__).. 
+00016ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ef0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+00016f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f10: 2020 7072 696e 7428 6c6f 6361 7469 6f6e    print(location
+00016f20: 202b 2022 202d 2022 202b 2073 7472 2865   + " - " + str(e
+00016f30: 7829 290d 0a0d 0a20 2020 2020 2020 2020  x))....         
+00016f40: 2020 2020 2020 2020 2020 2023 2320 6368             ## ch
+00016f50: 6563 6b20 666f 7220 7079 7065 2d72 6573  eck for pype-res
+00016f60: 7461 7274 2061 6674 6572 2063 6f6e 6669  tart after confi
+00016f70: 6720 6368 616e 6765 0d0a 2020 2020 2020  g change..      
+00016f80: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00016f90: 205f 636f 6e66 6967 2e70 7970 655f 7265   _config.pype_re
+00016fa0: 7374 6172 743a 0d0a 2020 2020 2020 2020  start:..        
+00016fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016fc0: 7072 696e 7428 2242 5245 414b 2229 0d0a  print("BREAK")..
+00016fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016fe0: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
+00016ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017000: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+00017010: 7379 732e 7374 646f 7574 203d 2073 656c  sys.stdout = sel
+00017020: 662e 6f6c 645f 7374 646f 7574 0d0a 0d0a  f.old_stdout....
+00017030: 2020 2020 2020 2020 2320 3d3d 3d3d 3d3d          # ======
+00017040: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00017050: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00017060: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00017070: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00017080: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020 2020  =======..       
+00017090: 2023 2043 4f4e 4649 472d 5550 4441 5445   # CONFIG-UPDATE
+000170a0: 2041 4e44 2041 5554 4f53 484f 5720 286f   AND AUTOSHOW (o
+000170b0: 7074 696f 6e61 6c29 0d0a 2020 2020 2020  ptional)..      
+000170c0: 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    # ============
+000170d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000170e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000170f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00017100: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00017110: 3d0d 0a0d 0a20 2020 2020 2020 2069 6620  =....        if 
+00017120: 6e6f 7420 7365 6c66 2e63 6f6e 6669 675f  not self.config_
+00017130: 7570 6461 7465 6420 3d3d 2073 656c 662e  updated == self.
+00017140: 636f 6e66 6967 3a0d 0a20 2020 2020 2020  config:..       
+00017150: 2020 2020 2075 7469 6c73 5f6c 6f77 6c65       utils_lowle
+00017160: 7665 6c2e 5f73 6176 655f 7961 6d6c 2873  vel._save_yaml(s
+00017170: 656c 662e 636f 6e66 6967 5f75 7064 6174  elf.config_updat
+00017180: 6564 2c20 7365 6c66 2e63 6f6e 6669 675f  ed, self.config_
+00017190: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
+000171a0: 2020 2070 7269 6e74 2822 5570 6461 7469     print("Updati
+000171b0: 6e67 2070 7970 6520 636f 6e66 6967 3a20  ng pype config: 
+000171c0: 6170 706c 7969 6e67 2073 7461 6765 6420  applying staged 
+000171d0: 6368 616e 6765 7322 290d 0a0d 0a20 2020  changes")....   
+000171e0: 2020 2020 2069 6620 666c 6167 732e 6578       if flags.ex
+000171f0: 6563 7574 653a 0d0a 2020 2020 2020 2020  ecute:..        
+00017200: 2020 2020 7072 696e 7428 0d0a 2020 2020      print(..    
+00017210: 2020 2020 2020 2020 2020 2020 225c 6e5c              "\n\
+00017220: 6e2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2b 2b2b  n------------+++
+00017230: 2066 696e 6973 6865 6420 7079 7065 2069   finished pype i
+00017240: 7465 7261 7469 6f6e 202b 2b2b 2d2d 2d2d  teration +++----
+00017250: 2d2d 2d2d 2d2d 2d2d 2d2d 5c6e 220d 0a20  ----------\n".. 
+00017260: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00017270: 2d2d 2d2d 2d2d 2d28 456e 6420 7769 7468  -------(End with
+00017280: 2043 7472 6c2b 456e 7465 7220 6f72 2072   Ctrl+Enter or r
+00017290: 652d 7275 6e20 7769 7468 2045 6e74 6572  e-run with Enter
+000172a0: 292d 2d2d 2d2d 2d2d 2d5c 6e5c 6e22 0d0a  )--------\n\n"..
+000172b0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
+000172c0: 0a20 2020 2020 2020 2069 6620 666c 6167  .        if flag
+000172d0: 732e 6175 746f 7368 6f77 3a0d 0a20 2020  s.autoshow:..   
+000172e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000172f0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00017300: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00017310: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00017320: 4155 544f 5348 4f57 2229 0d0a 2020 2020  AUTOSHOW")..    
+00017330: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00017340: 656c 662e 636f 6e74 6169 6e65 722e 6361  elf.container.ca
+00017350: 6e76 6173 2e5f 5f63 6c61 7373 5f5f 2e5f  nvas.__class__._
+00017360: 5f6e 616d 655f 5f20 3d3d 2022 4e6f 6e65  _name__ == "None
+00017370: 5479 7065 223a 0d0a 2020 2020 2020 2020  Type":..        
+00017380: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017390: 2e63 6f6e 7461 696e 6572 2e72 756e 2866  .container.run(f
+000173a0: 756e 3d22 7365 6c65 6374 5f63 616e 7661  un="select_canva
+000173b0: 7322 290d 0a20 2020 2020 2020 2020 2020  s")..           
+000173c0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+000173d0: 2d20 6175 746f 7365 6c65 6374 2063 616e  - autoselect can
+000173e0: 7661 7322 290d 0a0d 0a20 2020 2020 2020  vas")....       
+000173f0: 2020 2020 2020 2020 2073 656c 662e 6775           self.gu
+00017400: 6920 3d20 7574 696c 735f 6c6f 776c 6576  i = utils_lowlev
+00017410: 656c 2e5f 4755 4928 7365 6c66 2e63 6f6e  el._GUI(self.con
+00017420: 7461 696e 6572 2e63 616e 7661 732c 207a  tainer.canvas, z
+00017430: 6f6f 6d5f 6d65 6d6f 7279 3d73 656c 662e  oom_memory=self.
+00017440: 666c 6167 732e 7a6f 6f6d 5f6d 656d 6f72  flags.zoom_memor
+00017450: 792c 2070 7970 655f 6d6f 6465 3d54 7275  y, pype_mode=Tru
+00017460: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00017470: 2020 2020 7365 6c66 2e66 6c61 6773 2e74      self.flags.t
+00017480: 6572 6d69 6e61 7465 203d 2073 656c 662e  erminate = self.
+00017490: 6775 692e 666c 6167 732e 656e 645f 7079  gui.flags.end_py
+000174a0: 7065 0d0a 0d0a 2020 2020 2020 2020 2020  pe....          
+000174b0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+000174c0: 6f6e 2061 7320 6578 3a0d 0a20 2020 2020  on as ex:..     
+000174d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000174e0: 2822 7669 7375 616c 6973 6174 696f 6e3a  ("visualisation:
+000174f0: 2022 202b 2073 7472 2865 782e 5f5f 636c   " + str(ex.__cl
+00017500: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2920  ass__.__name__) 
+00017510: 2b20 2220 2d20 2220 2b20 7374 7228 6578  + " - " + str(ex
+00017520: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
+00017530: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00017540: 6620 666c 6167 732e 6578 6563 7574 653a  f flags.execute:
+00017550: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017560: 2020 7365 6c66 2e66 6c61 6773 2e74 6572    self.flags.ter
+00017570: 6d69 6e61 7465 203d 2054 7275 650d 0a    minate = True..
```

## phenopype/settings.py

```diff
@@ -179,14 +179,15 @@
 _reference_type = "reference"
 _shape_feature_type = "shape_features"
 _texture_feature_type = "texture_features"
 
 _annotation_functions = {
     ## comments
     "write_comment": _comment_type,
+    "detect_QRcode": _comment_type,
     
     ## contours
     "detect_contour": _contour_type,
     
     ## drawings
     "edit_contour": _drawing_type,
     
@@ -240,14 +241,15 @@
     'point_colour',
     'point_size',
     'overlay_blend',
     'overlay_line_width',
     'overlay_colour_left',
     'overlay_colour_right',
     'pype_mode',
+    'zoom_memory',
     'zoom_mode',
     'zoom_magnification',
     'zoom_n_steps',
     'wait_time',
     'window_aspect',
     'window_control',
     'window_max_dim',
```

## phenopype/utils.py

```diff
@@ -98,16 +98,14 @@
             if contours == False:
                 if settings._contour_type in annotations_loaded:
                     annotations_loaded.pop(settings._contour_type)
             
             if annotations_loaded:
                 self.annotations.update(annotations_loaded)
 
-            self.annotations["data"] = {}
-
             annotation_types_loaded = {}
             for annotation_type in self.annotations.keys():
                 id_list = []
                 for annotation_id in self.annotations[annotation_type].keys():
                     id_list.append(annotation_id)
                 if len(id_list) > 0:
                     annotation_types_loaded[annotation_type] = utils_lowlevel._NoIndent(
@@ -235,15 +233,15 @@
         ## use pype tag
         kwargs_function["tag"] = self.tag
 
         ## verbosity
         if settings.flag_verbose:
             kwargs_function["verbose"] = True
 
-        ## enable zoom-config memory
+        ## indicate pype use 
         kwargs_function["pype_mode"] = True
 
         ## attributes
         if hasattr(self, "image_attributes"):
             image_name = self.image_attributes["image_original"]["filename"]
         elif self.image_name:
             image_name = self.image_name
@@ -278,15 +276,16 @@
             self.image = core.preprocessing.blur(self.image, **kwargs_function)
         if fun == "create_mask":
             annotations_updated = core.preprocessing.create_mask(self.image, **kwargs_function)
         if fun == "create_reference":
             annotations_updated = core.preprocessing.create_reference(self.image, **kwargs_function)
         if fun == "detect_mask":
             annotations_updated = core.preprocessing.detect_mask(self.image, **kwargs_function)
-            # print(annotations_updated)
+        if fun == "detect_QRcode":
+            annotations_updated = core.preprocessing.detect_QRcode(self.image, **kwargs_function)
         if fun == "write_comment":
             annotations_updated = core.preprocessing.write_comment(self.image, **kwargs_function)
         if fun == "detect_reference":
             if all(
                 hasattr(self, attr)
                 for attr in [
                     "reference_template_px_ratio",
@@ -361,14 +360,16 @@
             self.canvas = core.visualization.draw_contour(self.canvas, **kwargs_function)
         if fun == "draw_landmark":
             self.canvas = core.visualization.draw_landmark(self.canvas, **kwargs_function)
         if fun == "draw_mask":
             self.canvas = core.visualization.draw_mask(self.canvas, **kwargs_function)
         if fun == "draw_polyline":
             self.canvas = core.visualization.draw_polyline(self.canvas, **kwargs_function)
+        if fun == "draw_QRcode":
+            self.canvas = core.visualization.draw_QRcode(self.canvas, **kwargs_function)
         if fun == "draw_reference":
             self.canvas = core.visualization.draw_reference(self.canvas, **kwargs_function)
 
         ## export
         if fun == "convert_annotation":
             annotations_updated = core.export.convert_annotation(**kwargs_function)
         if fun == "save_annotation":
@@ -383,18 +384,21 @@
                 self.canvas,
                 dir_path=self.dir_path,
                 **kwargs_function,
             )
         if fun == "save_ROI":
             if not "file_name" in kwargs_function:
                 ext = kwargs_function.get("ext", ".jpg")
-                kwargs_function["file_name"] = self._construct_file_name("canvas", ext)
+                kwargs_function["file_name"] = self._construct_file_name("roi", ext)
+            if not "dir_path" in kwargs_function:
+                kwargs_function["dir_path"] = os.path.join(self.dir_path, "ROI")
+                if not os.path.isdir(kwargs_function["dir_path"]):
+                    os.makedirs(kwargs_function["dir_path"])
             core.export.save_ROI(
                 self.image_copy,
-                dir_path=self.dir_path,
                 **kwargs_function,
             )
 
         if fun == "export_csv":
             core.export.export_csv(
                 dir_path=self.dir_path,
                 save_prefix=self.file_prefix,
```

## phenopype/utils_lowlevel.py

```diff
@@ -12,14 +12,15 @@
 from timeit import default_timer as timer
 import ruamel.yaml
 from ruamel.yaml.constructor import SafeConstructor
 from ruamel.yaml import YAML
 
 from functools import wraps
  
+from math import pi
 from math import sqrt
 from pathlib import Path
 from PIL import Image
 from stat import S_IWRITE
 from watchdog.observers import Observer
 from watchdog.events import PatternMatchingEventHandler
 
@@ -27,28 +28,35 @@
 import io
 
 from phenopype import _config
 from phenopype import main
 from phenopype import settings
 from phenopype import utils
 
+#%% options
+
+Image.MAX_IMAGE_PIXELS = 999999999
+
+
 #%% classes
 
 
 # @_image_viewer_settings
 class _GUI:
     def __init__(
         self,
         image,
         tool=None,
         feedback=True,
+        pype_mode=False,
         wait_time=500,
         window_aspect="normal",
         window_control="internal",
         window_name="phenopype",
+        zoom_memory=False,
         zoom_magnification=0.5,
         zoom_mode="continuous",
         zoom_n_steps=20,
         **kwargs
     ):
 
         """
@@ -116,16 +124,17 @@
             
             ('overlay_blend', float, kwargs.get('overlay_blend', 0.2)),
             ('overlay_line_width', int, kwargs.get('overlay_line_width', 1)),
             ('overlay_colour_left', tuple, kwargs.get('overlay_colour_left',settings._default_overlay_left)),
             ('overlay_colour_right', tuple, kwargs.get('overlay_colour_right',settings._default_overlay_right)),
             
             ('feedback', bool, feedback),
-            ('pype_mode', bool, kwargs.get('pype_mode', False)),
+            ('pype_mode', bool, pype_mode),
             
+            ('zoom_memory', bool, zoom_memory),
             ('zoom_mode', str, zoom_mode),
             ('zoom_magnification', float, zoom_magnification),
             ('zoom_n_steps', int, zoom_n_steps),
             
             ('wait_time', int, wait_time),
             
             ('window_aspect', str, window_aspect),
@@ -179,18 +188,19 @@
                         contourIdx=0,
                         thickness=-1,
                         color=255,
                         maxLevel=3,
                         offset=(0, 0),
                     )
             else:
-                raise AttributeError(
+                print(
                     "Could not find contours to edit - check annotations."
                 )
-
+                return
+            
         ## get canvas dimensions
         if self.image_height > window_max_dim or self.image_width > window_max_dim:
             if self.image_width >= self.image_height:
                 self.canvas_width, self.canvas_height = (
                     window_max_dim,
                     int((window_max_dim / self.image_width) * self.image_height),
                 )
@@ -227,17 +237,17 @@
             mag = int(self.settings.zoom_magnification * self.settings.zoom_n_steps)
             self.zoom.step_x, self.zoom.step_y = (
                 mag * self.zoom.step_x,
                 mag * self.zoom.step_y,
             )
 
         # ## update zoom from previous call
-        # if hasattr(_config, "gui_zoom_config") and self.settings.pype_mode == True:
-        #     if not _config.gui_zoom_config.__class__.__name__ == "NoneType":
-        #         self.zoom = _config.gui_zoom_config
+        if hasattr(_config, "gui_zoom_config") and self.settings.zoom_memory == True:
+            if not _config.gui_zoom_config.__class__.__name__ == "NoneType":
+                self.zoom = _config.gui_zoom_config
                 
         # if kwargs.get("ImageViewer_previous"):
         #     prev_attr = kwargs.get("ImageViewer_previous").__dict__
         #     prev_attr = {
         #         i: prev_attr[i] for i in prev_attr
 
         #         ## don't update arrays or provided kwargs
@@ -308,16 +318,15 @@
             self.keypress = None
 
             if self.settings.window_control == "internal":
                 while not any([self.flags.end, self.flags.end_pype]):
                     if self.settings.feedback:
                         
                         ## sync zoom settings with config
-                        if self.settings.pype_mode == True:
-                            _config.gui_zoom_config = self.zoom
+                        _config.gui_zoom_config = self.zoom
 
                         ## comment tool
                         if self.tool == "comment":
                             self.keypress = cv2.waitKey(1)
                             self._comment_tool()
                         else:
                             self.keypress = cv2.waitKey(self.settings.wait_time)
@@ -1101,16 +1110,16 @@
 #%% functions - ANNOTATION helpers
 
 
 def annotation_function(fun, *args, **kwargs):
     
     @wraps(fun)
     def annotation_function_wrapper(*args, **kwargs):
-        
-        ## determine the annotation type from function nam,e
+                
+        ## determine the annotation type from function name
         kwargs["annotation_type"] = _get_annotation_type(fun.__name__)
 
         ## get annotation using 
         if "annotations" in kwargs:
             if kwargs["annotations"].__class__.__name__ in ["dict"]:
                 if len(kwargs["annotations"]) > 0:                      
                     kwargs["annotation_id"] = _get_annotation_id(**kwargs)   
@@ -1118,17 +1127,20 @@
                 else:
                     print("empty annotations supplied")
             else:
                 print("wrong annotations data supplied - need dict")
                 
         ## run function
         kwargs["annotation"] = fun(*args, **kwargs)
-        
-        ## return annotations        
-        return _update_annotations(**kwargs)
+    
+        ## return and update annotations    
+        if "annotations" in kwargs:
+            return _update_annotations(**kwargs)
+        else:
+            return kwargs["annotation"]
     
     ## close function wrapper
     return annotation_function_wrapper
     
 
 
 def _get_annotation(
@@ -1808,16 +1820,17 @@
                 filepaths4.append(filepath)
     else:
         filepaths4 = filepaths3
 
     ## check if files found
     filepaths = filepaths4
     if len(filepaths) == 0 and not pype_mode:
-        sys.exit("No files found under the given location that match given criteria.")
-
+        print("No files found under the given location that match given criteria.")
+        return [], []
+    
     ## allow unique filenames filepath or by filename only
     filenames, unique_filename, unique, duplicate = [], [], [], []
     for filepath in filepaths:
         filenames.append(os.path.basename(filepath))
     if flag_unique in ["filepaths", "filepath", "path"]:
         for filename, filepath in zip(filenames, filepaths):
             if not filepath in unique:
@@ -1937,15 +1950,14 @@
                     }
                 )
         else:
             raise FileNotFoundError("Invalid image path - could not load image.")
     else:
         raise TypeError("Not a valid image file - cannot read image data.")
 
-    # Image.MAX_IMAGE_PIXELS = 999999999
 
     ## issue warnings for large images
     if width * height > 125000000:
         warnings.warn("Large image - expect slow processing.")
     elif width * height > 250000000:
         warnings.warn(
             "Extremely large image - expect very slow processing \
@@ -2028,14 +2040,34 @@
                 fy=1 * factor,
                 interpolation=settings.opencv_interpolation_flags[interpolation],
             )
 
     ## return results
     return image
 
+def _rotate_image(image, angle, ret_center=False):
+    
+    row, col = image.shape[1::-1]
+    center = tuple(np.array([row, col]) / 2)
+    rotation_matrix = cv2.getRotationMatrix2D(center, angle, 1)
+    rotated_image = cv2.warpAffine(image, rotation_matrix, (col, row), flags=cv2.INTER_LINEAR)
+    
+    if ret_center:
+        return rotated_image, center
+    else:
+        return rotated_image
+
+def _rotate_2Darray(array, center, angle):
+        
+    radian = angle * (pi/180)
+    rotation_matrix = np.array([[np.cos(radian),np.sin(radian)],[-np.sin(radian),np.cos(radian)]])
+    rotated_array = np.dot(array - center, rotation_matrix)+center
+    
+    return rotated_array
+
 
 def _save_prompt(object_type, filepath, ow_flag):
 
     if os.path.isfile(filepath) and ow_flag == False:
         print_msg = "- {} not saved - file already exists (overwrite=False)".format(
             object_type
         )
```

## phenopype/core/export.py

```diff
@@ -1,23 +1,24 @@
 #%% modules
 
 from collections import defaultdict
 import copy
 import json
 import os
-import sys 
+import sys
 
 import cv2
 import numpy as np
 import pandas as pd
 
 from phenopype import __version__
 from phenopype import settings
 from phenopype import utils_lowlevel
 from phenopype import utils
+from phenopype.core import preprocessing
 
 #%% functions
 
 
 
 
 def convert_annotation(
@@ -26,32 +27,32 @@
     annotation_id,
     annotation_type_new,
     annotation_id_new,
     overwrite=False,
     **kwargs
 ):
     """
-    convert coordinates from one annotation type to another. currently, only 
+    convert coordinates from one annotation type to another. currently, only
     converting from contour to mask format is possible
-    
+
     Parameters
     ----------
 
     annotations : dict
         A phenopype annotation dictionary.
     annotation_type : str | list of str
-        If dict contains multiple annotation types, select one or more to 
-        load. None will load all types. 
+        If dict contains multiple annotation types, select one or more to
+        load. None will load all types.
     annotation_id : str | list of str
-        If file contains multiple annotation IDs, select one or more to 
-        load. None will load all IDs within a type. 
-    annotation_type_new : str 
-       target annotation type 
+        If file contains multiple annotation IDs, select one or more to
+        load. None will load all IDs within a type.
+    annotation_type_new : str
+       target annotation type
     annotation_id_new : str | list of str, optional
-       target annotation id 
+       target annotation id
     overwrite : bool, optional
         if target exists, overwrite? The default is False.
 
     Returns
     -------
     None.
 
@@ -64,40 +65,40 @@
     annotation = utils_lowlevel._get_annotation(
         annotations=annotations,
         annotation_type=annotation_type,
         annotation_id=annotation_id,
         kwargs=kwargs,
         prep_msg="- extracting annotation:",
     )
-   
+
     # =============================================================================
     # setup
-    
+
     ## convert_annotation
     fun_name = sys._getframe().f_code.co_name
 
     # =============================================================================
     # method
 
     if annotation_type_new == settings._mask_type:
-                
+
         ## method setup
         if "label" in annotation["data"]:
             label = annotation["data"]["label"]
         else:
             label = kwargs.get("label", "mask1")
-        include = kwargs.get("include", True)    
-        
+        include = kwargs.get("include", True)
+
         annotation_old_data = annotation["data"][annotation_type]
-        
+
         annotation_new_data = []
         for idx, coord_list in enumerate(annotation_old_data):
             annotation_new_data.append(utils_lowlevel._convert_arr_tup_list(coord_list,  add_first=True))
-        
-        
+
+
         annotation = {
             "info": {
                 "annotation_type": annotation_type_new,
                 "phenopype_function": fun_name,
                 "phenopype_version": __version__,
             },
             "settings": {
@@ -107,16 +108,14 @@
                 "label": label,
                 "include": include,
                 "n": len(annotation_new_data),
                 annotation_type_new: annotation_new_data,
             },
         }
 
-    # print(annotations)
-
     return utils_lowlevel._update_annotations(
         annotations=annotations,
         annotation=annotation,
         annotation_type=annotation_type_new,
         annotation_id=annotation_id_new,
         kwargs=kwargs,
     )
@@ -129,26 +128,26 @@
     dir_path,
     annotation_type=None,
     image_name=None,
     overwrite=False,
     **kwargs
 ):
     """
-    export annotations from json to csv format. 
+    export annotations from json to csv format.
 
     Parameters
     ----------
     annotations : dict
         A phenopype annotation dictionary.
     dir_path : str
-        To which folder should the csv file be exported. 
+        To which folder should the csv file be exported.
         PYPE: Automatically set to the current image directory
     annotation_type : str / list, optional
         Which annotation types should be exported - can be string or list of strings.
-    image_name : str 
+    image_name : str
        Image name to be added as a column
        PYPE: Automatically adds the image name.
     overwrite : bool, optional
         Should an existing csv file be overwritten. The default is False.
 
 
     Returns
@@ -194,17 +193,17 @@
     # annotation_types = annotation_types1
 
     for annotation_type in annotation_types:
 
         list_flattened = []
 
         ## comment
-        if annotation_type == settings._comment_type:
+        if annotation_type == settings._comment_type and annotation_type in annotations.keys():
             for annotation_id in annotations[annotation_type].keys():
-                
+
                 label = annotations[annotation_type][annotation_id]["data"]["label"]
                 comment = annotations[annotation_type][annotation_id]["data"][annotation_type]
                 list_flattened.append(
                     pd.DataFrame(
                         {
                             **{"image_name": image_name},
                             **{"annotation_type": annotation_type},
@@ -237,16 +236,16 @@
                                 **{"hierarchy_level": support["hierarchy_level"]},
                                 **{"hierarchy_idx_child": support["hierarchy_idx_child"]},
                                 **{"hierarchy_idx_parent": support["hierarchy_idx_parent"]},
                             },
                             index=[0],
                         )
                     )
-                    
-                    
+
+
         ## landmark
         if annotation_type == settings._landmark_type:
             for annotation_id in annotations[annotation_type].keys():
                 lm_tuple_list = list(zip(*annotations[annotation_type][annotation_id]["data"][annotation_type]))
                 list_flattened.append(
                     pd.DataFrame.from_dict(
                         {
@@ -256,15 +255,15 @@
                             **{"landmark_idx": range(1,len(lm_tuple_list[0])+1)},
                             **{"x_coords": lm_tuple_list[0]},
                             **{"y_coords": lm_tuple_list[1]},
 
                         },
                     )
                 )
-                
+
         ## polyline
         if annotation_type == settings._line_type:
             for annotation_id in annotations[annotation_type].keys():
                 for idx, (coords, length) in enumerate(zip(
                     annotations[annotation_type][annotation_id]["data"][annotation_type],
                     annotations[annotation_type][annotation_id]["data"]["lengths"],
                 ), 1):
@@ -279,15 +278,15 @@
                                 **{"node_idx": range(1,len(line_tuple_list[0])+1)},
                                 **{"x_coords": line_tuple_list[0]},
                                 **{"y_coords": line_tuple_list[1]},
                                 **{"length": length},
                             },
                         )
                     )
-                    
+
         ## reference
         if annotation_type == settings._reference_type:
             for annotation_id in annotations[annotation_type].keys():
                 distance = annotations[annotation_type][annotation_id]["data"][annotation_type][0]
                 unit = annotations[annotation_type][annotation_id]["data"][annotation_type][1]
                 list_flattened.append(
                     pd.DataFrame(
@@ -295,15 +294,14 @@
                             **{"image_name": image_name},
                             **{"annotation_type": annotation_type},
                             **{"annotation_id": annotation_id},
                             **{"distance": distance},
                             **{"unit": unit},
                         },
                         index=[0],
-
                     )
                 )
 
 
         ## shape_features
         if annotation_type == settings._shape_feature_type:
             for annotation_id in annotations[annotation_type].keys():
@@ -324,17 +322,17 @@
                             index=[0],
                         )
                     )
 
         ## texture_features
         if annotation_type == settings._texture_feature_type:
             for annotation_id in annotations[annotation_type].keys():
-                
+
                 contour_id = annotations[annotation_type][annotation_id]["settings"][settings._contour_type + "_id"]
-                
+
                 for idx, annotation in enumerate(
                     annotations[annotation_type][annotation_id]["data"][annotation_type], 1
                 ):
                     list_flattened.append(
                         pd.DataFrame(
                             {
                                 **{"image_name": image_name},
@@ -353,51 +351,50 @@
             df = pd.concat(list_flattened)
             filepath = os.path.join(
                 dir_path, save_prefix + annotation_type + save_suffix + ".csv"
             )
             df.to_csv(filepath, index=False)
 
 
-
 def load_annotation(filepath, annotation_type=None, annotation_id=None, tag=None,**kwargs):
     """
     load phenopype annotations file
 
     Parameters
     ----------
     filepath : str
         Path to JSON file containing annotations
     annotation_type : str | list of str, optional
-        If file contains multiple annotation types, select one or more to 
+        If file contains multiple annotation types, select one or more to
         load. None will load all types. The default is None.
     annotation_id : str | list of str, optional
-        If file contains multiple annotation IDs, select one or more to 
+        If file contains multiple annotation IDs, select one or more to
         load. None will load all IDs within a type. The default is None.
 
     Returns
     -------
     dict
         Loaded annotations.
 
     """
-    
+
     flag_verbose = kwargs.get("verbose", False)
 
     ## load annotation file
     if os.path.isfile(filepath):
         with open(filepath) as file:
             try:
                 annotation_file = json.load(file)
             except Exception as ex:
                 print(
                     "load_annotation: " + str(ex.__class__.__name__) + " - " + str(ex)
                 )
                 return
         annotation_file = defaultdict(dict, annotation_file)
-        
+
     elif os.path.isdir(filepath):
         if tag.__class__.__name__ == "NoneType":
             print("Attempting to load directory without specifying tag - aborting")
             return
         else:
             filepath = os.path.join(filepath, "annotations_{}.json".format(tag))
             with open(filepath) as file:
@@ -478,22 +475,22 @@
     annotations,
     dir_path,
     annotation_type=None,
     annotation_id=None,
     overwrite=False,
     **kwargs
 ):
-    """  
+    """
     save phenopype annotations file
-    
+
     Parameters
     ----------
     annotation : dict
-        Annotation dictionary formatted by phenopype specifications: 
-            
+        Annotation dictionary formatted by phenopype specifications:
+
         .. code-block:: python
 
             {
                 annotation_type = {
                     annotation_id = annotation,
                     annotation_id = annotation,
                     ...
@@ -501,37 +498,37 @@
                 annotation_type = {
                     annotation_id = annotation,
                     annotation_id = annotation,
                     ...
                     },
                 ...
             }
-            
+
     annotation_id : str, optional
-        String ("a"-"z") specifying the annotation ID to be saved. None will 
+        String ("a"-"z") specifying the annotation ID to be saved. None will
         save all IDs. The default is None.
     dir_path : str, optional
-        Path to folder where annotation should be saved. None will save the 
+        Path to folder where annotation should be saved. None will save the
         annotation in the current Python working directory. The default is None.
     file_name : str, optional
-        Filename for JSON file containing annotation. The default is 
+        Filename for JSON file containing annotation. The default is
         "annotations.json".
     overwrite : bool, optional
         Overwrite options should file or annotation entry in file exist:
-            
+
             - False = Neither file or entry will be overwritten
             - True or "entry" = A single entry will be overwritten
-            - "file" = The whole will be overwritten. 
-            
+            - "file" = The whole will be overwritten.
+
         The default is False.
 
     Returns
     -------
     None.
-    
+
     """
 
     ## kwargs
     indent = kwargs.get("indent", 4)
     file_name = kwargs.get("file_name","annotations")
 
     if not file_name.endswith(".json"):
@@ -576,15 +573,15 @@
     if annotation_type.__class__.__name__ == "NoneType":
         print("- no annotation_type selected - exporting all annotations")
         annotation_types = list(annotations.keys())
     elif annotation_type.__class__.__name__ == "str":
         annotation_types = [annotation_type]
     elif annotation_type.__class__.__name__ in ["list", "CommentedSeq"]:
         annotation_types = annotation_type
-        
+
     for annotation_type in annotation_types:
 
     ## write annotations to output dict
     # for annotation_type in annotations:
         for annotation_id in annotations[annotation_type]:
             annotation_id_new = annotation_id
             if str(annotation_id) in annotation_file[annotation_type]:
@@ -646,42 +643,43 @@
     with open(filepath, "w") as file:
         json.dump(
             annotation_file, file, indent=indent, cls=utils_lowlevel._NoIndentEncoder
         )
 
 
 def save_ROI(
-    image, 
-    annotations, 
-    dir_path, 
-    file_name, 
+    image,
+    annotations,
+    dir_path,
+    file_name,
+    channel="raw",
     counter=True,
-    prefix=None, 
-    suffix=None, 
+    prefix=None,
+    suffix=None,
     extension=None,
     white_background=False,
     **kwargs
 ):
     """
-    save a region of interest (ROI) indicated by contour or mask coordinates as 
+    save a region of interest (ROI) indicated by contour or mask coordinates as
     a crop of the original image, optionally with white background
 
     Parameters
     ----------
     image : ndarray
         An image containing regions of interest (ROI).
     annotations : dict
         A phenopype annotation dict containing one or more contour coordinate
         entries.
     name : str
         Name for ROI series (should reflect image content, not "ROI" or the like
         which is specified with prefix or suffix arguments). The contour index
         will be added as a numeric string at the end of the filename.
     dir_path : str, optional
-        Path to folder where annotation should be saved. None will save the 
+        Path to folder where annotation should be saved. None will save the
         annotation in the current Python working directory. The default is None.
     prefix : str, optional
         Prefix to prepend to individual ROI filenames. The default is None.
     suffix : str, optional
         Suffix to append to individual ROI filenames. The default is "roi".
 
     Returns
@@ -718,61 +716,66 @@
         annotations=annotations,
         annotation_type=annotation_type,
         annotation_id=annotation_id,
         kwargs=kwargs,
     )
 
     data = annotation["data"][annotation_type]
+    image = preprocessing.decompose_image(image, channel, **kwargs)
     
-    # print(len(data))
-
-
     for idx, roi_coords in enumerate(data):
         
+
         if annotation_type == settings._mask_type:
             coords = utils_lowlevel._convert_tup_list_arr(roi_coords)[0]
         else:
             coords = copy.deepcopy(roi_coords)
-            
+
         rx, ry, rw, rh = cv2.boundingRect(coords)
-        roi_rect = copy.deepcopy(image[ry : ry + rh, rx : rx + rw])
+        roi_rect = image[ry : ry + rh, rx : rx + rw]
 
         if white_background:
-        
-            roi_rect_mask = np.zeros(roi_rect.shape, dtype="uint8")              
+
+            roi_rect_mask = np.zeros(roi_rect.shape, dtype="uint8")
             roi_rect_mask = cv2.drawContours(
                 image=roi_rect_mask,
                 contours=[coords],
                 contourIdx=0,
                 thickness=-1,
                 color=(255,255,255),
                 offset=(-rx, -ry),
             )
 
             roi_rect = cv2.bitwise_and(roi_rect_mask, roi_rect)
             roi_rect = cv2.bitwise_xor(roi_rect, cv2.bitwise_not(roi_rect_mask))
 
         if counter:
-            roi_name = prefix + file_name + suffix + "_" + str(idx).zfill(2) + ext
+            roi_name = prefix + file_name + suffix + "_" + str(idx+1).zfill(3) + ext
         else:
             roi_name = prefix + file_name + suffix + ext
+            
 
         save_path = os.path.join(dir_path, roi_name)
-        cv2.imwrite(save_path, roi_rect)
-
+        saved = cv2.imwrite(save_path, roi_rect)
+        
+        if saved:
+            print("saving ROI: {}".format(roi_name))
+        else:
+            print("something went wrong - didn't save ROI")
+               
         # roi_new_coords = []
         # for coord in roi_coords:
         #     new_coord = [coord[0][0] - rx, coord[0][1] - ry]
         #     roi_new_coords.append([new_coord])
         # roi_new_coords = np.asarray(roi_new_coords, np.int32)
 
 
 def save_canvas(image, dir_path, file_name="canvas", **kwargs):
     """
-    
+
 
     Parameters
     ----------
     image : ndarray
         A canvas to be saved.
     save_suffix : str
         A suffix to be appended to the filename.
```

## phenopype/core/measurement.py

```diff
@@ -400,15 +400,15 @@
         annotations=annotations,
         annotation_type=settings._contour_type,
         annotation_id=contour_id,
         kwargs=kwargs,
     )
     contours = annotation["data"][settings._contour_type]
     contours_support = annotation["data"]["support"]
-
+    
     ##  features
     fun_name = sys._getframe().f_code.co_name
     annotation_type = utils_lowlevel._get_annotation_type(fun_name)
     annotation_id = kwargs.get("annotation_id", None)
 
     # =============================================================================
     # execute
```

## phenopype/core/preprocessing.py

```diff
@@ -6,16 +6,18 @@
 import sys
 
 from dataclasses import make_dataclass
 import math
 
 from phenopype import __version__
 from phenopype import settings
+from phenopype import utils
 from phenopype import utils_lowlevel
 from phenopype.core import segmentation
+from phenopype.utils_lowlevel import annotation_function
 
 #%% functions
 
 
 def blur(
     image, kernel_size=5, method="averaging", sigma_color=75, sigma_space=75, **kwargs
 ):
@@ -164,15 +166,15 @@
         label=label,
         label_size=label_size,
         label_width=label_width,
         label_colour=label_colour,
         data=gui_data,
         **gui_settings,
     )
-
+        
     # =============================================================================
     # assemble results
 
     annotation = {
         "info": {
             "annotation_type": annotation_type,
             "phenopype_function": fun_name,
@@ -265,15 +267,15 @@
                  "min_radius":0,
                  "max_radius":0
                  }
 
     Returns
     -------
     annotations: dict
-        phenopype annotation containing mask coordinates
+        phenopype annotation
 
     """
 
     # =============================================================================
     # annotation management
 
     fun_name = sys._getframe().f_code.co_name
@@ -418,18 +420,16 @@
     label_size: {"auto", ... int > 0} int, optional 
         contour label font size - automatically scaled to image by default
     label_width:  {"auto", ... int > 0} int, optional 
         contour label font thickness - automatically scaled to image by default
         
     Returns
     -------
-    annotation_ref: dict
-        phenopype annotation containing mask coordinates pixel to mm ratio
-    annotation_mask: dict
-        phenopype annotation containing mask coordinates
+    annotations: dict
+        phenopype annotation
 
     """
     # =============================================================================
     # setup
 
     label = kwargs.get("label")
 
@@ -597,18 +597,16 @@
         images with diameter > 5000px (WARNING: too low values may 
         result in poor detection performance or even crashes)
     px_mm_ratio_template : int, optional
         pixel-to-mm-ratio of the template image
 
     Returns
     -------
-    annotation_ref: dict
-        phenopype annotation containing mask coordinates pixel to mm ratio
-    annotation_mask: dict
-        phenopype annotation containing mask coordinates
+    annotations: dict
+        phenopype annotation
     """
 
     # =============================================================================
     # annotation management
 
     fun_name = sys._getframe().f_code.co_name
 
@@ -766,14 +764,167 @@
         annotations=annotations,
         annotation=annotation,
         annotation_type=annotation_type,
         annotation_id=annotation_id,
         kwargs=kwargs,
     )
 
+@annotation_function
+def detect_QRcode(
+    image,
+    rot_steps=20,
+    enter_manually=False,
+    show_results=False,
+    label_colour="default",
+    label_size="auto",
+    label_width="auto",
+    **kwargs,
+):
+    """
+    Find and read out a QR code that is contained inside an image. Rotate image
+    until code is detected, or enter code manually if detection fails.
+
+    Parameters
+    ----------
+    image: ndarray 
+        input image
+    rot_steps : TYPE, optional
+        angle by which image is rotated (until 360 is reached). The default is 20.
+    enter_manually : TYPE, optional
+        enter code manually of detection fails. The default is False.
+    show_results : TYPE, optional
+        show the detection results. The default is False.
+    label_colour : {"default", ... see phenopype.print_colours()} str, optional
+        text colour - default colour as specified in settings
+    label_size: {"auto", ... int > 0} int, optional 
+        text label font size - automatically scaled to image by default
+    label_width:  {"auto", ... int > 0} int, optional 
+        text label font thickness - automatically scaled to image by default
+
+    Returns
+    -------
+    annotations: dict
+        phenopype annotation
+
+    """
+    
+    # =============================================================================
+    # annotation management
+
+    fun_name = sys._getframe().f_code.co_name
+    annotation_type = utils_lowlevel._get_annotation_type(fun_name)
+
+    annotation = kwargs.get("annotation")
+    
+    gui_data = {settings._comment_type: utils_lowlevel._get_GUI_data(annotation)}
+    gui_settings = utils_lowlevel._get_GUI_settings(kwargs, annotation)
+
+    # =============================================================================
+    # setup
+    
+    flags = make_dataclass(
+        cls_name="flags",
+        fields=[("found", bool, False), 
+                ("enter_manually",bool, enter_manually),
+                ("show_results",bool, show_results)
+                ],
+    )
+    
+    if label_size == "auto":
+        label_size = utils_lowlevel._auto_text_size(image)
+    if label_width == "auto":
+        label_width = utils_lowlevel._auto_text_width(image)
+
+    if label_colour == "default":
+        label_colour = settings._default_label_colour
+
+    label_colour = utils_lowlevel._get_bgr(label_colour)
+    
+
+    # =============================================================================
+    # execute
+    
+    ## init QR-code detector
+    qrCodeDetector = cv2.QRCodeDetector()
+    
+    ## rotate image 
+    print("rotating image to detect code:")
+    for angle in range(0, 360, rot_steps):
+        print("- rotating image - {} degrees".format(angle))
+        image_rot, image_center = utils_lowlevel._rotate_image(image, angle, ret_center=True)  
+        decodedText, points_rot, _ = qrCodeDetector.detectAndDecode(image_rot)
+        if not decodedText == "" and not points_rot.__class__.__name__ == 'NoneType':
+            flags.found = True
+            break
+            
+    if flags.found:
+        points = utils_lowlevel._rotate_2Darray(points_rot, image_center, angle)  
+        points = utils_lowlevel._convert_arr_tup_list(points)
+        print("found text: {}".format(decodedText))
+    else:
+        print("did not find QR-code - enter code manually")
+        if flags.enter_manually:
+            gui = utils_lowlevel._GUI(
+                image,
+                tool="comment",
+                label="code",
+                label_size=label_size,
+                label_width=label_width,
+                label_colour=label_colour,
+                data=gui_data,
+                **gui_settings,
+            )
+            decodedText = gui.data[settings._comment_type]
+        else:
+            print("did not find QR-code")
+        points = None
+        
+    # =============================================================================
+    # execute
+    
+    if flags.show_results and flags.found:
+        canvas = cv2.polylines(
+            image, 
+            [np.asarray(points, np.int32)], 
+            True, 
+            label_colour, 
+            5)
+        utils.show_image(canvas)
+        
+    # =============================================================================
+    # assemble results
+
+    annotation = {
+        "info": {
+            "annotation_type": annotation_type,
+            "phenopype_function": fun_name,
+            "phenopype_version": __version__,
+        },
+        "settings": {
+            "rotation_steps": rot_steps,
+            "angle": angle,
+            "label_size": label_size,
+            "label_width": label_width,
+            "label_colour": label_colour,
+        },
+        "data": {
+            annotation_type: decodedText,
+            "label": "QRcode",
+            settings._mask_type: points,
+            },
+    }
+
+    if len(gui_settings) > 0:
+        annotation["settings"]["GUI"] = gui_settings
+
+    # =============================================================================
+    # return
+
+    return annotation
+
 
 def decompose_image(
     image, channel="gray", invert=False, **kwargs,
 ):
 
     """
     Extract single channel from multi-channel array.
@@ -899,16 +1050,14 @@
         label_colour = settings._default_label_colour
 
     label_colour = utils_lowlevel._get_bgr(label_colour)
 
     # =============================================================================
     # execute
 
-    print(label)
-
     gui = utils_lowlevel._GUI(
         image,
         tool="comment",
         label=label,
         label_size=label_size,
         label_width=label_width,
         label_colour=label_colour,
@@ -922,15 +1071,18 @@
     annotation = {
         "info": {
             "phenopype_function": fun_name,
             "phenopype_version": __version__,
             "annotation_type": annotation_type,
         },
         "settings": {},
-        "data": {"label": label, annotation_type: gui.data[settings._comment_type],},
+        "data": {
+            "label": label, 
+            annotation_type: gui.data[settings._comment_type],
+            },
     }
 
     if len(gui_settings) > 0:
         annotation["settings"]["GUI"] = gui_settings
 
     # =============================================================================
     # return
```

## phenopype/core/visualization.py

```diff
@@ -546,14 +546,121 @@
                    
     # =============================================================================
     # return
 
     return canvas
 
 
+def draw_QRcode(
+    image,
+    annotations,
+    line_colour="default",
+    line_width="auto",
+    label=False,
+    label_colour="default",
+    label_size="auto",
+    label_width="auto",
+    **kwargs,
+):   
+    """
+    
+
+    Parameters
+    ----------
+    image : ndarray
+        image used as canvas 
+    annotation: dict
+        phenopype annotation containing QR-code (comment)
+    line_colour: {"default", ... see phenopype.print_colours()} str, optional
+        contour line colour - default colour as specified in settings
+    line_width: {"auto", ... int > 0} int, optional 
+        contour line width - automatically scaled to image by default
+    label : bool, optional
+        draw reference label
+    label_colour : {"default", ... see phenopype.print_colours()} str, optional
+        contour label colour - default colour as specified in settings
+    label_size: {"auto", ... int > 0} int, optional 
+        contour label font size - automatically scaled to image by default
+    label_width:  {"auto", ... int > 0} int, optional 
+        contour label font thickness - automatically scaled to image by default
+    **kwargs : TYPE
+        DESCRIPTION.
+
+    Returns
+    -------
+    canvas : TYPE
+        DESCRIPTION.
+
+    """
+    # =============================================================================
+    # setup
+
+    flags = make_dataclass(cls_name="flags", fields=[("label", bool, label)])
+    
+    if line_width == "auto":
+        line_width = utils_lowlevel._auto_line_width(image)
+    if label_size == "auto":
+        label_size = utils_lowlevel._auto_text_size(image)
+    if label_width == "auto":
+        label_width = utils_lowlevel._auto_text_width(image)
+
+    if line_colour == "default":
+        line_colour = settings._default_line_colour
+    if label_colour == "default":
+        label_colour = settings._default_label_colour
+
+    label_colour = utils_lowlevel._get_bgr(label_colour)
+    line_colour = utils_lowlevel._get_bgr(line_colour)
+
+    # =============================================================================
+    # annotation management
+
+    annotation_type = settings._comment_type
+    annotation_id = kwargs.get(annotation_type + "_id", None)
+
+    annotation = utils_lowlevel._get_annotation(
+        annotations=annotations,
+        annotation_type=annotation_type,
+        annotation_id=annotation_id,
+        kwargs=kwargs,
+    )
+
+    points = annotation["data"][settings._mask_type]
+    label = annotation["data"][annotation_type]
+
+    
+    canvas = cv2.polylines(
+        image, 
+        [np.asarray(points, np.int32)], 
+        True, 
+        line_colour, 
+        line_width)
+
+    if flags.label:
+        
+        (x,y), _ = cv2.minEnclosingCircle(np.array(points))
+
+        label_coords = (int(x),int(y))
+
+        cv2.putText(
+            canvas,
+            label,
+            label_coords,
+            cv2.FONT_HERSHEY_SIMPLEX,
+            label_size,
+            label_colour,
+            label_width,
+            cv2.LINE_AA,
+        )
+
+    # =============================================================================
+    # return
+
+    return canvas
+
 def draw_reference(
     image,
     annotations,
     line_colour="default",
     line_width="auto",
     label=True,
     label_colour="default",
@@ -578,16 +685,14 @@
         draw reference label
     label_colour : {"default", ... see phenopype.print_colours()} str, optional
         contour label colour - default colour as specified in settings
     label_size: {"auto", ... int > 0} int, optional 
         contour label font size - automatically scaled to image by default
     label_width:  {"auto", ... int > 0} int, optional 
         contour label font thickness - automatically scaled to image by default
-    label_width : TYPE, optional
-        DESCRIPTION. The default is "auto".
 
     Returns
     -------
     canvas : TYPE
         DESCRIPTION.
 
     """
@@ -630,14 +735,15 @@
 
     # =============================================================================
     # execute
 
     canvas = copy.deepcopy(image)
 
     ## draw referenc mask outline
+    print([polygons[0]])
     cv2.polylines(canvas, np.array([polygons[0]]), False, line_colour, line_width)
 
     ## draw scale
     if flags.label:
         height, width = canvas.shape[:2]
 
         hp, wp = height / 100, width / 100
```

## tests/test_08_tracking.py

```diff
@@ -78,15 +78,15 @@
 
 def test_motion_tracker(motion_tracker):
     filepath = motion_tracker.df_image_data["filepath"][0]
     assert filepath == pytest.video_path
 
 def test_video_output(motion_tracker):
     with mock.patch('builtins.input', return_value='y'):
-        motion_tracker.video_output(video_format="DIVX", dirpath=pytest.test_dir)
+        motion_tracker.video_output(video_format="mp4v", dirpath=pytest.test_dir)
     assert os.path.isfile(os.path.join(pytest.test_dir, 
                                        os.path.splitext(os.path.basename(pytest.video_path))[0] 
                                        + "_out" 
                                        + os.path.splitext(os.path.basename(pytest.video_path))[1])) 
     
 def test_tracking_method(motion_tracker):
     isopod = pp.tracking_method(
```

## Comparing `phenopype-3.3.6.dist-info/LICENSE` & `phenopype-3.4.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `phenopype-3.3.6.dist-info/METADATA` & `phenopype-3.4.0.dist-info/METADATA`

 * *Files 16% similar despite different names*

```diff
@@ -1,103 +1,110 @@
-Metadata-Version: 2.1
-Name: phenopype
-Version: 3.3.6
-Summary: A phenotyping pipeline for python
-Home-page: https://www.phenopype.org
-Author: Moritz Luerig
-Author-email: moritz.luerig@gmail.com
-License: LGPL
-Description-Content-Type: text/markdown
-License-File: LICENSE
-Requires-Dist: colour
-Requires-Dist: numpy
-Requires-Dist: opencv-contrib-python (==3.4.9.33)
-Requires-Dist: pandas
-Requires-Dist: pillow
-Requires-Dist: pyradiomics (==3.0.1)
-Requires-Dist: ruamel.yaml (==0.16.12)
-Requires-Dist: tqdm
-Requires-Dist: watchdog
-Provides-Extra: test_pks
-Requires-Dist: pytest ; extra == 'test_pks'
-Requires-Dist: coverage ; extra == 'test_pks'
-Requires-Dist: coveralls ; extra == 'test_pks'
-Requires-Dist: mock ; extra == 'test_pks'
-Requires-Dist: pytest-xvfb ; extra == 'test_pks'
-Requires-Dist: pytest-cov ; extra == 'test_pks'
-Requires-Dist: pyyaml ; extra == 'test_pks'
-
-
-![](https://github.com/phenopype/phenopype/raw/main/assets/phenopype_logo_text.png)
-
-| Project status | Windows build | Linux build | OSX build | Coverage | Style |
-|:---:|:---:|:---:|:---:|:---:|:---:|
-| [![Project Status: Active](http://www.repostatus.org/badges/latest/active.svg)](http://www.repostatus.org/#active) | [![Build status](https://ci.appveyor.com/api/projects/status/20ncgfq137mmvbgb?svg=true)](https://ci.appveyor.com/project/mluerig/phenopype-9386w) | *soon to come* | *none* | [![Coverage Status](https://coveralls.io/repos/github/phenopype/phenopype/badge.svg?branch=main)](https://coveralls.io/github/phenopype/phenopype?branch=main) | [![Code style](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black) |  
-
-**Author:** [Moritz Lrig](https://luerig.net)  
-**License:** [LGPL](https://opensource.org/licenses/LGPL-3.0)  
-**Homepage** [www.phenopype.org](https://www.phenopype.org)  
-**Publication** https://doi.org/10.1111/2041-210x.13771
-
----
-
-#### What is phenopype?
-
-phenopype is a Python package to rapidly extract high dimensional phenotypic data from digital images. At the core, phenopype provides a project management ecosystem for large image datasets, signal processing based segmentation and data extraction routines, and the possibility to export the processed data in various formats - e.g. for direct analysis (`csv` - e.g. landmarks, coordinates, etc.), or for further processing in other machine learning pipelines (`json` - e.g. segmentation masks).  
-
-#### Why phenopype
-phenopype is aiming to augment, rather than replace the utility of existing CV low level libraries for scientists who want to extract phenotypic data from images. Put differently, phenopype does not intend to be an exhaustive library of granular image processing functions, like OpenCV, scikit-image or ImageJ, but instead, it is a set of wrappers and convenient management tools to allow biologists to *get their data fast* without having to fiddle with too much code.
-
-#### Who uses phenopype?
-phenopype is intended for ecologists and evolutionary biologists with "laboratory grade" images, which, for example, contain specimens that have been photographed against a standardized background. It is also useful for anyone interested in building a robust training dataset for deep learning models: with phenopype segmentation masks can be created semi-automatically (instead of annotating the images by hand), and, in the process, phenotypic data can already by extracted and evaluated. 
-
-![](https://github.com/phenopype/phenopype/raw/main/assets/phenopype_features.png)
-
----
-
-#### Main features
-
-(For a complete list [check the API reference](https://www.phenopype.org/docs/api/))
-
-- image analysis workflow:
-  - preprocessing (automatic reference detection, colour and size correction, morphology operations)
-  - segmentation (thresholding, watershed, contour-filtering, foreground-background subtraction)
-  - measurement (pixel intensities, landmarks, shape features, texture features)
-  - visualization (various options) and export (csv, json, ROI images, ...)
-  - video analysis module for object tracking
-- project management tools to organize images and data (automatic creation of project directory tree)
-- customizable analysis-templates that allow anyone to reproduce all collected data with only a few lines of code (suitable for repositories like Dryad or OSF).
-
-![](https://github.com/mluerig/phenopype/raw/master/source/phenopype_demo.gif)
-
----
-
-#### Quickstart
-
-https://www.phenopype.org/docs/quickstart/
-
-#### Documentation
-
-https://www.phenopype.org/docs/
-
-#### Vignette gallery
-
-https://www.phenopype.org/gallery/
-
-#### Contributions and feedback
-phenopype development is ongoing and contributions towards making it more broadly applicable and user-friendly are most welcome. This can be in the form of feature requests (e.g. more functions from the [OpenCV library](https://docs.opencv.org/master/modules.html)) or by reporting bugs via the [issue tracker](https://github.com/phenopype/phenopype/issues). You can also [get in touch with me](https://www.luerig.net) directly if you would like to contribute code - in that case, please have a look at the [API](https://www.phenopype.org/docs/api/).
-
-#### How to cite phenopype
-
-Lrig, M. D. (2021). phenopype : A phenotyping pipeline for Python. Methods in Ecology and Evolution. https://doi.org/10.1111/2041-210x.13771
-
-	@ARTICLE{Lurig2021,
-	  title     = "phenopype : A phenotyping pipeline for Python",
-	  author    = "L{\"u}rig, Moritz D",
-	  journal   = "Methods in Ecology and Evolution",
-	  publisher = "Wiley",
-	  month     =  dec,
-	  year      =  2021,
-	  copyright = "http://creativecommons.org/licenses/by-nc/4.0/",
-	  language  = "en",
-	  doi       = "10.1111/2041-210x.13771"
-	}
+Metadata-Version: 2.1
+Name: phenopype
+Version: 3.4.0
+Summary: A phenotyping pipeline for python
+Home-page: https://www.phenopype.org
+Author: Moritz Luerig
+Author-email: moritz.luerig@gmail.com
+License: LGPL
+Description-Content-Type: text/markdown
+License-File: LICENSE
+Requires-Dist: colour
+Requires-Dist: numpy
+Requires-Dist: opencv-contrib-python (==3.4.9.33)
+Requires-Dist: pandas
+Requires-Dist: pillow
+Requires-Dist: pyradiomics (==3.0.1)
+Requires-Dist: ruamel.yaml (==0.16.12)
+Requires-Dist: tqdm
+Requires-Dist: watchdog
+Provides-Extra: test_pks
+Requires-Dist: pytest ; extra == 'test_pks'
+Requires-Dist: coverage ; extra == 'test_pks'
+Requires-Dist: coveralls ; extra == 'test_pks'
+Requires-Dist: mock ; extra == 'test_pks'
+Requires-Dist: pytest-xvfb ; extra == 'test_pks'
+Requires-Dist: pytest-cov ; extra == 'test_pks'
+Requires-Dist: pyyaml ; extra == 'test_pks'
+
+
+![](https://github.com/phenopype/phenopype/raw/main/assets/phenopype_logo_text.png)
+
+| Code review | Windows build | Linux build | OSX build | Code coverage for CI| Code Style |
+|:---:|:---:|:---:|:---:|:---:|:---:|
+|[![pyOpenSci](https://tinyurl.com/y22nb8up)](https://github.com/pyOpenSci/software-review/issues/24) | [![Build status](https://ci.appveyor.com/api/projects/status/20ncgfq137mmvbgb?svg=true)](https://ci.appveyor.com/project/mluerig/phenopype-9386w) | *soon to come* | *none* | [![Coverage Status](https://coveralls.io/repos/github/phenopype/phenopype/badge.svg?branch=main)](https://coveralls.io/github/phenopype/phenopype?branch=main) | [![Code style](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black) |  
+
+
+
+**Author:** [Moritz Lrig](https://luerig.net)  
+**License:** [LGPL](https://opensource.org/licenses/LGPL-3.0)  
+**Homepage** [www.phenopype.org](https://www.phenopype.org)  
+**Publication** https://doi.org/10.1111/2041-210x.13771
+
+---
+
+#### What is phenopype?
+
+phenopype is a Python package to rapidly extract high dimensional phenotypic data from digital images. At the core, phenopype provides a project management ecosystem for large image datasets, signal processing based segmentation and data extraction routines, and the possibility to export the processed data in various formats - e.g. for direct analysis (`csv` - e.g. landmarks, coordinates, etc.), or for further processing in other machine learning pipelines (`json` - e.g. segmentation masks).  
+
+#### Why phenopype
+phenopype is aiming to augment, rather than replace the utility of existing CV low level libraries for scientists who want to extract phenotypic data from images. Put differently, phenopype does not intend to be an exhaustive library of granular image processing functions, like OpenCV, scikit-image or ImageJ, but instead, it is a set of wrappers and convenient management tools to allow biologists to *get their data fast* without having to fiddle with too much code.
+
+#### Who uses phenopype?
+phenopype is intended for ecologists and evolutionary biologists with "laboratory grade" images, which, for example, contain specimens that have been photographed against a standardized background. It is also useful for anyone interested in building a robust training dataset for deep learning models: with phenopype segmentation masks can be created semi-automatically (instead of annotating the images by hand), and, in the process, phenotypic data can already by extracted and evaluated. 
+
+![](https://github.com/phenopype/phenopype/raw/main/assets/phenopype_features.png)
+
+---
+
+#### Main features
+
+(For a complete list [check the API reference](https://www.phenopype.org/docs/api/))
+
+- image analysis workflow:
+  - preprocessing (automatic reference detection, colour and size correction, morphology operations)
+  - segmentation (thresholding, watershed, contour-filtering, foreground-background subtraction)
+  - measurement (pixel intensities, landmarks, shape features, texture features)
+  - visualization (various options) and export (csv, json, ROI images, ...)
+  - video analysis module for object tracking
+- project management tools to organize images and data (automatic creation of project directory tree)
+- customizable analysis-templates that allow anyone to reproduce all collected data with only a few lines of code (suitable for repositories like Dryad or OSF).
+
+![](https://github.com/mluerig/phenopype/raw/master/source/phenopype_demo.gif)
+
+---
+
+#### Quickstart
+
+https://www.phenopype.org/docs/quickstart/
+
+#### Documentation
+
+https://www.phenopype.org/docs/
+
+#### Vignette gallery
+
+https://www.phenopype.org/gallery/
+
+#### Contributions and feedback
+phenopype development is ongoing and contributions towards making it more broadly applicable and user-friendly are most welcome. This can be in the form of feature requests (e.g. more functions from the [OpenCV library](https://docs.opencv.org/master/modules.html)) or by reporting bugs via the [issue tracker](https://github.com/phenopype/phenopype/issues). You can also [get in touch with me](https://www.luerig.net) directly if you would like to contribute code - in that case, please have a look at the [API](https://www.phenopype.org/docs/api/).
+
+#### How to cite phenopype
+
+Lrig, M. D. (2021). phenopype : A phenotyping pipeline for Python. Methods in Ecology and Evolution. https://doi.org/10.1111/2041-210x.13771
+	
+	@ARTICLE{Lurig2022-pb,
+	  title     = "phenopype : A phenotyping pipeline for Python",
+	  author    = "L{\"u}rig, Moritz D",
+	  journal   = "Methods in ecology and evolution / British Ecological Society",
+	  publisher = "Wiley",
+	  volume    =  13,
+	  number    =  3,
+	  pages     = "569--576",
+	  month     =  mar,
+	  year      =  2022,
+	  copyright = "http://creativecommons.org/licenses/by-nc/4.0/",
+	  language  = "en",
+	  issn      = "2041-210X",
+	  doi       = "10.1111/2041-210x.13771"
+	}
+
```

## Comparing `phenopype-3.3.6.dist-info/RECORD` & `phenopype-3.4.0.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,37 +1,37 @@
 phenopype/__init__.py,sha256=P0_SorMOVcXGkVDx-2NdhNUtC5obaQjcGPqlU5yb9gI,461
 phenopype/_config.py,sha256=nDbaNqd_0BmKegEYTjGJ3CCUPM0U8NBL735qHZuFqHM,232
-phenopype/_version.py,sha256=rM-b8eDDns9Vk9s0lZ2zHOuWibe_SaNoyPgwLH7ApUk,280
-phenopype/main.py,sha256=WargtYBZIbPJ0LVfd5UMbexE0e6798kqfzFWuVCFOgU,94437
-phenopype/settings.py,sha256=IUdJM2q7oQQt3xq645IycPG80C6uE6Td6lpX_2Bv3Ek,8056
+phenopype/_version.py,sha256=ZIEXyKVeYmMb2bQJi-ffUdm_JNt-5JZ4U_ruaIohtjk,280
+phenopype/main.py,sha256=jxpv5MNUGthBuJu0iiLgmA7EsNm7bvohZ7M7SdtSFd0,95615
+phenopype/settings.py,sha256=HXt1aOCYxEp427fZclA2NaiKmwYd5rpUKK8mHPaF7oQ,8113
 phenopype/tracking.py,sha256=mFzSLF8EJxqJfXPoDoa2gNHSS9YvwjO8H6DQeHy1Qa4,32918
-phenopype/utils.py,sha256=8kS3o0OKfG7QxI6tGSooAMPOo0vLQ6mvrl1sHbLTcXI,31113
-phenopype/utils_lowlevel.py,sha256=l2tx-pSUeQb1029iooZItRczbG3CV-zzEhHDwX0qBC4,74682
+phenopype/utils.py,sha256=N8tJHejbm6OTuvkFRanMC8Um33V2TIXeaM5tGFZImJE,31497
+phenopype/utils_lowlevel.py,sha256=hy2M1l1oDrzDcC59SSfo4ydk3S_A06Sd01Tv18sZZe8,75575
 phenopype/assets/wc3_colours.html,sha256=GW_42htekp7PpuNMQBD4MhONHIk_e06DJWJ2mn5gO00,53700
 phenopype/core/__init__.py,sha256=fUpw0muwmlUq4A-Ayeip-QlbTwnmZsXDF0Yfa1IiKgU,79
-phenopype/core/export.py,sha256=z7CwJkWdqLZa-v0qNnZ3z7mLCNNvyrQM5zvF6MCrS08,28999
-phenopype/core/measurement.py,sha256=HZIhA_BqCrMqrhxkg3ZPcsCCeh6iba5DVHzC3vNIqZI,22138
-phenopype/core/preprocessing.py,sha256=oKWrmyHxGlB92X3Rx_gskBHO1Mx_VUkVRs6xDx5s34E,31002
+phenopype/core/export.py,sha256=3gi03J8B6KQL2_IRZ2j87HSR8AmtAv0iZiOWSfukqaQ,28967
+phenopype/core/measurement.py,sha256=JTSvCOBsQOW4jddXLUXh4x5XUyd6fAow_jTBSQI95bQ,22142
+phenopype/core/preprocessing.py,sha256=IzXYVQgvZe2mhKSbVYWWDNmUoLNMo5fahrz2vTtbf6U,35997
 phenopype/core/segmentation.py,sha256=rxOmil4HM43wvMRX_eT2qmLQ5i6oSybplnphiOENJpE,35186
-phenopype/core/visualization.py,sha256=Q2vUjeVlpxWxAeksV_S9PL9WN1VL4XkH7ArkorNlw-s,24730
+phenopype/core/visualization.py,sha256=lB-4JATCdTm-ZiAxEjXIOKaVkUJtO4ztte-PLN8IfOE,27898
 phenopype/plugins/__init__.py,sha256=RI3DL1qgkxAzOJeNbhFCYtEK1AUHbxRXVExg7_0tDdg,253
 phenopype/plugins/measurement.py,sha256=Bf36EES1MmTndRlPLzUT1609TV_b6bTvOIOax163hIg,3567
 phenopype/plugins/segmentation.py,sha256=93M2wOyIYqy2jJHi2E6rbrNykRtC7UmkfkL0ztc_Ddk,6009
 phenopype/plugins/libraries/__init__.py,sha256=2xQwbIt66lMZMoPpsc0sB21T5gMZdhPyiVleHlZoxjs,695
 tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tests/conftest.py,sha256=tZkHyUivIyGVOMs7JpB3ceBM-Q0Rzxn7vVcj-qxR27A,6375
 tests/test_00_prep.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tests/test_01_project.py,sha256=ktQnW7JhH-7ww1xz_JVVu36Ei9ryCu03ChGICfd581g,3351
 tests/test_02_core_preprocessing.py,sha256=kSYyZ68DbUIDmzvRUtmXZNGQSnKezfLk4kYPKgv0sVQ,3594
 tests/test_03_core_segmentation.py,sha256=W3Ru3E4YwqUDO2axtyJMT9OM17_dHW-5Hl82GrpZ8sU,3111
 tests/test_04_core_measurement.py,sha256=j6Oy5nOh1GjzshHJVJyJUt0dHEoWjivaWtj54UCbIHI,1571
 tests/test_05_core_visualization.py,sha256=f8rreOeQmj0mdEK4eBlPhw8Y_vVj7Ro4KRfooqvKZnU,3879
 tests/test_06_core_export.py,sha256=hlrchnytR3cFJnXMov9QoVj0qNmoycP4ZquIQDbqec0,3609
 tests/test_07_pype.py,sha256=LZM3p1zlpFdY-yAWESZbj5Su3F5lHgymY1D3IqOxmvo,1584
-tests/test_08_tracking.py,sha256=g-lwaS5gjDDxQKj5P153fguFf1FE9zu4QYVivLQ9VEU,3654
+tests/test_08_tracking.py,sha256=spiqPOWYEBwGVmiepyJtkjMvdgNdNplxc4mBKXBZ0-8,3654
 tests/test_09_utils.py,sha256=8nAbPCGTT0lJsJyBghbWHH7g_2pzZ5NCDPte6ujuBig,2277
 tests/test_10_utils_lowlevel.py,sha256=IoiHviPDBbV8QSXRlC379ZO9xoBfnXGMUapuK758UDw,312
-phenopype-3.3.6.dist-info/LICENSE,sha256=-DHn7tV3SBaHqbwLSAJOXkC29lX83gc-3pZLUL5dVdk,7815
-phenopype-3.3.6.dist-info/METADATA,sha256=pQC2LTxLeQWOst7ssAjw9eMuIMJcjtl76MHedk3X2lE,5684
-phenopype-3.3.6.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-phenopype-3.3.6.dist-info/top_level.txt,sha256=P1iFHA2YPya2Ogho7C_b1G0qA3ShkMkX0U-142RxqrE,16
-phenopype-3.3.6.dist-info/RECORD,,
+phenopype-3.4.0.dist-info/LICENSE,sha256=-DHn7tV3SBaHqbwLSAJOXkC29lX83gc-3pZLUL5dVdk,7815
+phenopype-3.4.0.dist-info/METADATA,sha256=xGBXhU4ZiO4EeFqv2aoHxpY0kHgTm29EogpJo_B0Dvs,5922
+phenopype-3.4.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+phenopype-3.4.0.dist-info/top_level.txt,sha256=P1iFHA2YPya2Ogho7C_b1G0qA3ShkMkX0U-142RxqrE,16
+phenopype-3.4.0.dist-info/RECORD,,
```

